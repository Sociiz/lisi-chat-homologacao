/*!
*  filename: ej2-pivotview.min.js
*  version : 26.2.12
*  Copyright Syncfusion Inc. 2001 - 2023. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("SyncfusionBase"),require("SyncfusionData"),require("SyncfusionPdfExport"),require("SyncfusionPopups"),require("SyncfusionGrids"),require("SyncfusionNavigations"),require("SyncfusionInputs"),require("SyncfusionDropdowns"),require("SyncfusionCalendars"),require("SyncfusionSplitbuttons"),require("SyncfusionButtons"),require("SyncfusionCharts"),require("SyncfusionSvgBase"),require("SyncfusionFileUtils"),require("SyncfusionExcelExport")):"function"==typeof define&&define.amd?define(["SyncfusionBase","SyncfusionData","SyncfusionPdfExport","SyncfusionPopups","SyncfusionGrids","SyncfusionNavigations","SyncfusionInputs","SyncfusionDropdowns","SyncfusionCalendars","SyncfusionSplitbuttons","SyncfusionButtons","SyncfusionCharts","SyncfusionSvgBase","SyncfusionFileUtils","SyncfusionExcelExport"],t):"object"==typeof exports?exports.SyncfusionPivotview=t(require("SyncfusionBase"),require("SyncfusionData"),require("SyncfusionPdfExport"),require("SyncfusionPopups"),require("SyncfusionGrids"),require("SyncfusionNavigations"),require("SyncfusionInputs"),require("SyncfusionDropdowns"),require("SyncfusionCalendars"),require("SyncfusionSplitbuttons"),require("SyncfusionButtons"),require("SyncfusionCharts"),require("SyncfusionSvgBase"),require("SyncfusionFileUtils"),require("SyncfusionExcelExport")):e.SyncfusionPivotview=t(e.SyncfusionBase,e.SyncfusionData,e.SyncfusionPdfExport,e.SyncfusionPopups,e.SyncfusionGrids,e.SyncfusionNavigations,e.SyncfusionInputs,e.SyncfusionDropdowns,e.SyncfusionCalendars,e.SyncfusionSplitbuttons,e.SyncfusionButtons,e.SyncfusionCharts,e.SyncfusionSvgBase,e.SyncfusionFileUtils,e.SyncfusionExcelExport)}(self,((e,t,i,a,r,n,s,o,l,d,p,h,u,c,g)=>(()=>{"use strict";var m={766:t=>{t.exports=e},741:e=>{e.exports=p},570:e=>{e.exports=l},60:e=>{e.exports=h},74:e=>{e.exports=t},778:e=>{e.exports=o},437:e=>{e.exports=g},115:e=>{e.exports=c},707:e=>{e.exports=r},323:e=>{e.exports=s},215:e=>{e.exports=n},461:e=>{e.exports=i},197:e=>{e.exports=a},295:e=>{e.exports=d},727:e=>{e.exports=u}},f={};function S(e){var t=f[e];if(void 0!==t)return t.exports;var i=f[e]={exports:{}};return m[e](i,i.exports,S),i.exports}S.d=(e,t)=>{for(var i in t)S.o(t,i)&&!S.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},S.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),S.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var v={};return(()=>{S.r(v),S.d(v,{AggregateMenu:()=>us,Authentication:()=>Hs,AxisFieldRenderer:()=>gl,AxisTableRenderer:()=>ul,CalculatedField:()=>Nl,CalculatedFieldSettings:()=>ks,CellEditSettings:()=>Jo,Common:()=>Ts,CommonKeyboardInteraction:()=>gs,ConditionalFormatSettings:()=>Is,ConditionalFormatting:()=>Ll,ConditionalSettings:()=>Zo,CustomGroups:()=>Rs,DataSourceSettings:()=>Vs,DataSourceUpdate:()=>Ss,DialogRenderer:()=>pl,DisplayOption:()=>il,DrillOptions:()=>js,DrillThrough:()=>Ys,ErrorDialog:()=>vs,EventBase:()=>ms,ExcelExport:()=>ol,FieldList:()=>El,FieldListFieldOptions:()=>Ps,FieldOptions:()=>Os,Filter:()=>Es,FilterDialog:()=>xs,FormatSettings:()=>Ls,GroupSettings:()=>As,Grouping:()=>kl,GroupingBar:()=>Fl,GroupingBarSettings:()=>Xo,HyperlinkSettings:()=>$o,KeyboardInteraction:()=>Gs,MDXQuery:()=>Bo,MdxQuery:()=>ft,NodeStateModified:()=>fs,NumberFormatting:()=>Rl,OlapEngine:()=>_o,PDFExport:()=>ll,PageSettings:()=>el,Pager:()=>dl,PagerSettings:()=>tl,PivotChart:()=>Xs,PivotCommon:()=>ws,PivotContextMenu:()=>zs,PivotEngine:()=>s,PivotFieldList:()=>vl,PivotUtil:()=>r,PivotView:()=>rl,Render:()=>cs,Sort:()=>Fs,Style:()=>Ns,Toolbar:()=>Al,TreeViewRenderer:()=>hl,ValueSortSettings:()=>qs,VirtualScroll:()=>Ws,VirtualScrollSettings:()=>al,actionBegin:()=>Ve,actionComplete:()=>Ue,actionDropped:()=>Gi,actionFailure:()=>Be,addNewRecord:()=>Qt,addNewReport:()=>lt,afterPivotTableRender:()=>g,afterServiceInvoke:()=>He,aggregateCellInfo:()=>xe,aggregateField:()=>Kt,aggregateMenuOpen:()=>Re,animationComplete:()=>ie,axisLabelFont:()=>Js,axisTitleFont:()=>Zs,beforeColumnsRender:()=>F,beforeExcelExport:()=>Ne,beforeExport:()=>m,beforePdfExport:()=>Pe,beforePivotTableRender:()=>c,beforePrint:()=>te,beforeServiceInvoke:()=>qe,beginDrillThrough:()=>V,calculatedFieldApplied:()=>ei,calculatedFieldCreate:()=>Ie,calculatedFieldEdited:()=>Ei,cellClick:()=>E,cellDeselected:()=>j,cellSelected:()=>k,cellSelecting:()=>A,chartAxisLabelRender:()=>be,chartLegendClick:()=>Z,chartLoad:()=>ve,chartLoaded:()=>$,chartMouseClick:()=>le,chartMouseDown:()=>he,chartMouseLeave:()=>pe,chartMouseMove:()=>oe,chartMouseUp:()=>ue,chartPointClick:()=>je,chartResized:()=>ye,chartSeriesCreated:()=>Ce,chartSubTitleFont:()=>eo,chartTitleFont:()=>$s,chartTooltipRender:()=>J,chartView:()=>yt,chartViewed:()=>bi,click:()=>et,closeFieldlist:()=>ri,columnPageNavigated:()=>_i,columnPageNavigation:()=>$t,conditionalFormatting:()=>Oe,conditionalFormattingMenu:()=>jt,conditionallyFormatted:()=>Si,contentReady:()=>Ye,contextMenuCalculatedField:()=>Xt,contextMenuClick:()=>Te,contextMenuOpen:()=>Me,crosshairLabelFont:()=>to,csvExport:()=>Mt,csvExported:()=>ui,dataBound:()=>T,dataReady:()=>Ke,dragComplete:()=>ce,drill:()=>R,drillDown:()=>ot,drillThrough:()=>I,drillThroughClosed:()=>Hi,drillUp:()=>st,editCalculatedField:()=>Vt,editCompleted:()=>U,editRecord:()=>zt,editedRecordsSaved:()=>ti,enginePopulated:()=>p,enginePopulating:()=>d,excelExport:()=>Tt,excelExported:()=>hi,excelHeaderQueryCellInfo:()=>y,excelQueryCellInfo:()=>C,exportComplete:()=>f,fetchReport:()=>G,fieldAggregated:()=>Ai,fieldDragStart:()=>ke,fieldDrop:()=>u,fieldFiltered:()=>Fi,fieldListRefreshed:()=>De,fieldRemove:()=>Le,fieldRemoved:()=>Li,fieldSorted:()=>Ii,fieldTreeSorted:()=>ni,filterField:()=>Bt,grandTotalsColumn:()=>At,grandTotalsColumnShown:()=>Oi,grandTotalsHidden:()=>Mi,grandTotalsRow:()=>Lt,grandTotalsRowShown:()=>Di,grandTotalsShown:()=>Pi,headerCellInfo:()=>D,hideGrandTotals:()=>Ft,hideSubTotals:()=>Pt,horizontalScroll:()=>Qe,horizontalScrolled:()=>Ui,hyperlinkCellClick:()=>O,initCalculatedField:()=>$e,initFormatting:()=>at,initGrouping:()=>rt,initPivotPager:()=>it,initSubComponent:()=>Xe,initToolbar:()=>tt,initialLoad:()=>_e,jpegExport:()=>Dt,jpegExported:()=>mi,legendLabelFont:()=>ao,legendRender:()=>ae,load:()=>l,loadReport:()=>z,loadReports:()=>ct,memberEditorOpen:()=>Fe,memberFiltering:()=>Ee,multiLevelLabelClick:()=>B,multiLevelLabelRender:()=>ee,multipleAxis:()=>bt,newRecordAdded:()=>ii,newReport:()=>Y,newReportAdded:()=>oi,numberFormatted:()=>vi,numberFormatting:()=>Ae,numberFormattingMenu:()=>kt,onFieldDropped:()=>h,onHeadersSort:()=>we,onPdfCellRender:()=>w,openCalculatedField:()=>Gt,openConditionalFormatting:()=>gt,openNumberFormatting:()=>mt,pdfExport:()=>xt,pdfExported:()=>ci,pdfHeaderQueryCellInfo:()=>b,pdfQueryCellInfo:()=>x,pivotButtonUpdate:()=>Ze,pngExport:()=>wt,pngExported:()=>gi,pointMove:()=>de,pointRender:()=>ne,queryCellInfo:()=>M,recordEdited:()=>Ri,recordRemoved:()=>ai,recordUpdated:()=>qi,removeCurrentReport:()=>ut,removeField:()=>_t,removeRecord:()=>Yt,removeReport:()=>Q,renameCurrentReport:()=>ht,renameReport:()=>W,reportChange:()=>qt,reportChanged:()=>ki,reportReSaved:()=>li,reportRemoved:()=>pi,reportRenamed:()=>di,reportSaved:()=>si,resizeStop:()=>N,resizing:()=>P,rowDeselected:()=>H,rowPageNavigated:()=>Bi,rowPageNavigation:()=>Zt,rowSelected:()=>q,saveAsCurrentReport:()=>pt,saveCurrentReport:()=>dt,saveEditedRecords:()=>Wt,saveReport:()=>_,scroll:()=>ze,scrollChanged:()=>Se,scrollEnd:()=>fe,scrollStart:()=>me,selected:()=>L,seriesRender:()=>se,showFieldList:()=>St,showGrandTotals:()=>Rt,showLegend:()=>Ct,showSubTotals:()=>It,sortField:()=>Ut,sortFieldTree:()=>Ht,sortValue:()=>nt,stockEventFont:()=>no,stripLineLabelFont:()=>ro,subTotalsColumn:()=>Et,subTotalsColumnShown:()=>wi,subTotalsHidden:()=>Ci,subTotalsRow:()=>Nt,subTotalsRowShown:()=>xi,subTotalsShown:()=>Ti,svgExport:()=>Ot,svgExported:()=>fi,tableView:()=>vt,tableViewed:()=>yi,textRender:()=>re,toolbarClick:()=>X,toolbarRender:()=>K,tooltipLabelFont:()=>io,treeViewUpdate:()=>Je,uiUpdate:()=>Ge,valueSorted:()=>Ni,verticalScroll:()=>We,verticalScrolled:()=>Vi,windowResize:()=>Jt,windowResized:()=>ji,zoomComplete:()=>ge});var e,t=S(766),i=S(74),a=S(461),r=function(){function e(){}return e.getType=function(e){var t=new Date(e);return"boolean"==typeof e?"boolean":isNaN(Number(e))?t instanceof Date&&!isNaN(t.valueOf())?t&&t.getDay()&&(t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0||t.getMilliseconds()>0)?"datetime":"date":typeof e:"number"},e.resetTime=function(e){return e.setHours(0,0,0,0),e},e.getClonedData=function(e){var t=[];if(e)for(var i=0,a=e;i<a.length;i++){for(var r=a[i],n=Object.keys(r),s=0,o={};s<n.length;)o[n[s]]=r[n[s]],s++;t.push(o)}return t},e.getClonedCSVData=function(e){return e.map((function(e){return e.slice()}))},e.getDefinedObj=function(e){var t=0,i={};if(null!=e)for(var a=Object.keys(e);t<a.length;)null!==e[a[t]]&&void 0!==e[a[t]]&&(i[a[t]]=e[a[t]]),t++;else i=e;return i},e.inArray=function(e,t){if(t)for(var i=0,a=t.length;i<a;i++)if(t[i]===e)return i;return-1},e.setPivotProperties=function(e,t){e.allowServerDataBinding=!1,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!1),e.setProperties(t,!0),e.allowServerDataBinding=!0,e.pivotGridModule&&(e.pivotGridModule.allowServerDataBinding=!0)},e.getClonedDataSourceSettings=function(e){return this.getDefinedObj({type:e.type,catalog:e.catalog,cube:e.cube,providerType:e.providerType,url:e.url,localeIdentifier:e.localeIdentifier,excludeFields:(0,t.isNullOrUndefined)(e.excludeFields)?[]:e.excludeFields.slice(),expandAll:e.expandAll,allowLabelFilter:e.allowLabelFilter,allowValueFilter:e.allowValueFilter,allowMemberFilter:e.allowMemberFilter,enableSorting:!!e.enableSorting,rows:this.cloneFieldSettings(e.rows),columns:this.cloneFieldSettings(e.columns),filters:this.cloneFieldSettings(e.filters),values:this.cloneFieldSettings(e.values),filterSettings:this.cloneFilterSettings(e.filterSettings),sortSettings:this.cloneSortSettings(e.sortSettings),drilledMembers:this.cloneDrillMemberSettings(e.drilledMembers),valueSortSettings:this.CloneValueSortObject(e.valueSortSettings),valueAxis:e.valueAxis,grandTotalsPosition:e.grandTotalsPosition,formatSettings:this.cloneFormatSettings(e.formatSettings),calculatedFieldSettings:this.cloneCalculatedFieldSettings(e.calculatedFieldSettings),fieldMapping:this.cloneFieldSettings(e.fieldMapping),showSubTotals:e.showSubTotals,showRowSubTotals:e.showRowSubTotals,showColumnSubTotals:e.showColumnSubTotals,subTotalsPosition:e.subTotalsPosition,showGrandTotals:e.showGrandTotals,showRowGrandTotals:e.showRowGrandTotals,showColumnGrandTotals:e.showColumnGrandTotals,showHeaderWhenEmpty:e.showHeaderWhenEmpty,alwaysShowValueHeader:e.alwaysShowValueHeader,conditionalFormatSettings:this.cloneConditionalFormattingSettings(e.conditionalFormatSettings),emptyCellsTextContent:e.emptyCellsTextContent,groupSettings:this.cloneGroupSettings(e.groupSettings),showAggregationOnValueField:e.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(e.authentication)})},e.getClonedFieldList=function(e){for(var t=Object.keys(e),i={},a=0,r=t.length;a<r;a++){var n=e[t[a]];e[t[a]]&&(i[t[a]]={type:n.type,caption:n.caption,id:n.id,isSelected:n.isSelected,sort:n.sort,filterType:n.filterType,index:n.index,filter:n.filter,isCustomField:n.isCustomField,showRemoveIcon:n.showRemoveIcon,showFilterIcon:n.showFilterIcon,showSortIcon:n.showSortIcon,showNoDataItems:n.showNoDataItems,isCalculatedField:n.isCalculatedField,showEditIcon:n.showEditIcon,showValueTypeIcon:n.showValueTypeIcon,allowDragAndDrop:n.allowDragAndDrop,showSubTotals:n.showSubTotals,expandAll:n.expandAll,pid:n.pid,aggregateType:n.aggregateType,baseField:n.baseField,baseItem:n.baseItem,dateMember:this.cloneDateMembers(n.dateMember),members:this.cloneFormatMembers(n.members),formatString:n.formatString,format:n.format,formula:n.formula,isExcelFilter:n.isExcelFilter,membersOrder:n.membersOrder?n.membersOrder.slice():n.membersOrder,isAlphanumeric:n.isAlphanumeric,tag:n.tag,expanded:n.expanded,spriteCssClass:n.spriteCssClass,name:n.name,defaultHierarchy:n.defaultHierarchy,hasAllMember:n.hasAllMember,allMember:n.allMember,isChecked:n.isChecked,filterMembers:this.cloneFieldMembers(n.filterMembers),childMembers:this.cloneFieldMembers(n.childMembers),searchMembers:this.cloneFieldMembers(n.searchMembers),htmlAttributes:this.getDefinedObj(n.htmlAttributes),currrentMembers:this.cloneFormatMembers(n.currrentMembers),isHierarchy:n.isHierarchy,isNamedSets:n.isNamedSets,actualFilter:n.actualFilter?n.actualFilter.slice():n.actualFilter,levels:this.cloneFieldMembers(n.levels),levelCount:n.levelCount,fieldType:n.fieldType,memberType:n.memberType,parentHierarchy:n.parentHierarchy})}return i},e.cloneDateMembers=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push({formattedText:r.formattedText,actualText:r.actualText})}return t}return e},e.cloneFormatMembers=function(e){if(e){for(var t=Object.keys(e),i={},a=0,r=t.length;a<r;a++){var n=e[t[a]];i[t[a]]={index:n.index?n.index.slice():n.index,isDrilled:n.isDrilled,ordinal:n.ordinal}}return i}return e},e.cloneFieldMembers=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push({caption:r.caption,hasChildren:r.hasChildren,id:r.id,isSelected:r.isSelected,name:r.name,tag:r.tag,htmlAttributes:this.getDefinedObj(r.htmlAttributes),type:r.type,spriteCssClass:r.spriteCssClass,pid:r.pid,isChecked:r.isChecked})}return t}return e},e.updateDataSourceSettings=function(e,i){e&&this.setPivotProperties(e,{dataSourceSettings:this.getDefinedObj({type:i.type,catalog:i.catalog,cube:i.cube,providerType:i.providerType,url:i.url,localeIdentifier:i.localeIdentifier,excludeFields:(0,t.isNullOrUndefined)(i.excludeFields)?[]:i.excludeFields,expandAll:i.expandAll,allowLabelFilter:i.allowLabelFilter,allowValueFilter:i.allowValueFilter,allowMemberFilter:i.allowMemberFilter,enableSorting:!!i.enableSorting,rows:i.rows,columns:i.columns,filters:i.filters,values:i.values,filterSettings:i.filterSettings,sortSettings:i.sortSettings,drilledMembers:i.drilledMembers,valueSortSettings:i.valueSortSettings,valueAxis:i.valueAxis,grandTotalsPosition:i.grandTotalsPosition,formatSettings:i.formatSettings,calculatedFieldSettings:i.calculatedFieldSettings,fieldMapping:i.fieldMapping,showSubTotals:i.showSubTotals,showRowSubTotals:i.showRowSubTotals,showColumnSubTotals:i.showColumnSubTotals,subTotalsPosition:i.subTotalsPosition,showGrandTotals:i.showGrandTotals,showRowGrandTotals:i.showRowGrandTotals,showColumnGrandTotals:i.showColumnGrandTotals,showHeaderWhenEmpty:i.showHeaderWhenEmpty,alwaysShowValueHeader:i.alwaysShowValueHeader,conditionalFormatSettings:i.conditionalFormatSettings,emptyCellsTextContent:i.emptyCellsTextContent,groupSettings:i.groupSettings,showAggregationOnValueField:i.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(i.authentication)})})},e.cloneFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,caption:r.caption,axis:r.axis,baseField:r.baseField,baseItem:r.baseItem,isCalculatedField:r.isCalculatedField,isNamedSet:r.isNamedSet,showNoDataItems:r.showNoDataItems,showSubTotals:r.showSubTotals,type:r.type,dataType:r.dataType,showFilterIcon:r.showFilterIcon,showSortIcon:r.showSortIcon,showRemoveIcon:r.showRemoveIcon,showValueTypeIcon:r.showValueTypeIcon,showEditIcon:r.showEditIcon,allowDragAndDrop:r.allowDragAndDrop,expandAll:r.expandAll,groupName:r.groupName}))}return t}return e},e.cloneOlapFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({caption:r.caption,hasChildren:r.hasChildren,id:r.id,isSelected:r.isSelected,name:r.name,spriteCssClass:r.spriteCssClass,tag:r.tag,type:r.type,pid:r.pid,expanded:r.expanded,defaultHierarchy:r.defaultHierarchy,hasAllMember:r.hasAllMember,allMember:r.allMember,isChecked:r.isChecked,filterMembers:r.filterMembers,childMembers:r.childMembers,searchMembers:r.searchMembers,htmlAttributes:this.getDefinedObj(r.htmlAttributes),currrentMembers:r.currrentMembers,isHierarchy:r.isHierarchy,isNamedSets:r.isNamedSets,formatString:r.formatString,actualFilter:r.actualFilter,levels:r.levels,levelCount:r.levelCount,memberType:r.memberType,fieldType:r.fieldType,parentHierarchy:r.parentHierarchy}))}return t}return e},e.cloneFilterSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,type:r.type,condition:r.condition,items:r.items?r.items.slice():r.items,levelCount:r.levelCount,measure:r.measure,selectedField:r.selectedField,showDateFilter:r.showDateFilter,showLabelFilter:r.showLabelFilter,showNumberFilter:r.showNumberFilter,value1:r.value1,value2:r.value2}))}return t}return e},e.cloneSortSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,order:r.order,membersOrder:r.membersOrder?r.membersOrder.slice():r.membersOrder}))}return t}return e},e.getFormattedHeader=function(t,i){var a=e.frameHeaderWithKeys(t);if(a.valueSort&&a.valueSort.axis){var r=a.valueSort.axis,n=this.isDateField(r,i);a.formattedText=n||!i.formatFields[r]||!0===t.isSum?a.formattedText:i.getFormattedValue(a.actualText,r).formattedText}return a},e.getFormattedMembers=function(e,t,i){var a=this.isDateField(t,i);if(a||i.groupingFields[t]){for(var r={},n=Object.keys(e),s=i.fieldList[t].dateMember,o=0,l=n.length;o<l;o++){var d=e[n[o]];if(a)r[d.caption]=d;else r[s[d.ordinal-1].actualText]=d}return r}return e},e.isDateField=function(e,t){return t.formatFields[e]&&["date","dateTime","time"].indexOf(t.formatFields[e].type)>-1},e.formatChartHeaders=function(e,i,a){for(var r=[],n=0,s=e.length;n<s;n++){var o=a?i.parent.dataSourceSettings.columns.length>0&&!(0,t.isNullOrUndefined)(i.parent.dataSourceSettings.columns[n])?i.parent.dataSourceSettings.columns[n].name:void 0:i.parent.dataSourceSettings.rows.length>0&&!(0,t.isNullOrUndefined)(i.parent.dataSourceSettings.rows[n])?i.parent.dataSourceSettings.rows[n].name:void 0;(0,t.isNullOrUndefined)(o)||i.engineModule.formatFields[o]&&["date","dateTime","time"].indexOf(i.engineModule.formatFields[o].type)>-1?r.push(e[n]):r.push(i.engineModule.getFormattedValue(e[n],o).formattedText)}return r.join(" - ")},e.cloneDrillMemberSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,delimiter:r.delimiter,items:r.items?r.items.slice():r.items}))}return t}return e},e.cloneFormatSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,calendar:r.calendar,currency:r.currency,format:r.format,maximumFractionDigits:r.maximumFractionDigits,maximumSignificantDigits:r.maximumSignificantDigits,minimumFractionDigits:r.minimumFractionDigits,minimumIntegerDigits:r.minimumIntegerDigits,minimumSignificantDigits:r.minimumSignificantDigits,skeleton:r.skeleton,type:r.type,useGrouping:r.useGrouping}))}return t}return e},e.CloneValueSortObject=function(e){return e?{columnIndex:e.columnIndex,headerDelimiter:e.headerDelimiter,headerText:e.headerText,measure:e.measure,sortOrder:e.sortOrder}:e},e.CloneAuthenticationObject=function(e){return e?{userName:e.userName,password:e.password}:e},e.cloneCalculatedFieldSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,formatString:r.formatString,formula:r.formula,hierarchyUniqueName:r.hierarchyUniqueName}))}return t}return e},e.cloneConditionalFormattingSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({applyGrandTotals:r.applyGrandTotals,conditions:r.conditions,label:r.label,measure:r.measure,style:r.style?{backgroundColor:r.style.backgroundColor,color:r.style.color,fontFamily:r.style.fontFamily,fontSize:r.style.fontSize}:r.style,value1:r.value1,value2:r.value2}))}return t}return e},e.cloneGroupSettings=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({name:r.name,caption:r.caption,customGroups:this.cloneCustomGroups(r.customGroups),endingAt:r.endingAt,startingAt:r.startingAt,groupInterval:r.groupInterval,rangeInterval:r.rangeInterval,type:r.type}))}return t}return e},e.cloneCustomGroups=function(e){if(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];t.push(this.getDefinedObj({groupName:r.groupName,items:r.items?r.items.slice():r.items}))}return t}return e},e.getFilterItemByName=function(e,t){var a=new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e));if(a&&a.length>0)return a[a.length-1]},e.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.getFieldInfo=function(e,t,i){if(!i)for(var a=[this.cloneFieldSettings(t.dataSourceSettings.rows),this.cloneFieldSettings(t.dataSourceSettings.columns),this.cloneFieldSettings(t.dataSourceSettings.values),this.cloneFieldSettings(t.dataSourceSettings.filters)],r=0,n=a.length;r<n;r++)for(var s=0,o=a[r]?a[r].length:0;s<o;s++)if(a[r][s]&&a[r][s].name===e)return{fieldName:e,fieldItem:a[r][s],axis:0===r?"rows":1===r?"columns":2===r?"values":"filters",position:s};var l="olap"===t.dataType?t.olapEngineModule.fieldList[e]:t.engineModule.fieldList[e];return{fieldName:e,fieldItem:l?{name:e,caption:l.caption,baseField:l.baseField,baseItem:l.baseItem,isCalculatedField:l.isCalculatedField,isNamedSet:l.isNamedSets,showNoDataItems:l.showNoDataItems,showSubTotals:l.showSubTotals,type:l.aggregateType,showFilterIcon:l.showFilterIcon,showSortIcon:l.showSortIcon,showRemoveIcon:l.showRemoveIcon,showValueTypeIcon:l.showValueTypeIcon,showEditIcon:l.showEditIcon,allowDragAndDrop:l.allowDragAndDrop,expandAll:l.expandAll}:void 0,axis:"fieldlist",position:-1}},e.isButtonIconRefesh=function(e,i,a){var r=!1;try{if("dataSourceSettings"===e&&i.dataSourceSettings&&a.dataSourceSettings){var n=["notAvail","notAvail","notAvail","notAvail"],s=Object.keys(i.dataSourceSettings),o=Object.keys(a.dataSourceSettings);if(s&&o&&o.length>0&&s.length===o.length)for(var l=["rows","columns","values","filters"],d=0;d<o.length;d++){var p=o[d]in i.dataSourceSettings&&!(0,t.isNullOrUndefined)(i.dataSourceSettings[o[d]])?Object.keys(i.dataSourceSettings[o[d]]):[],h=o[d]in a.dataSourceSettings&&!(0,t.isNullOrUndefined)(a.dataSourceSettings[o[d]])?Object.keys(a.dataSourceSettings[o[d]]):[];if(-1!==l.indexOf(o[d])&&-1!==l.indexOf(s[d])&&p&&h&&h.length>0&&p.length===h.length)for(var u=["showFilterIcon","showSortIcon","showRemoveIcon","showValueTypeIcon","showEditIcon","allowDragAndDrop","expandAll"],c=0;c<h.length;c++){for(var g=Object.keys(i.dataSourceSettings[o[d]][h[c]]),m=Object.keys(a.dataSourceSettings[o[d]][h[c]]),f=0;f<m.length;f++){if(-1===u.indexOf(m[f])||-1===u.indexOf(g[f])){n[d]="break";break}n[d]="update"}if("break"===n[d])break}else n[d]="break";if("break"===n[d])break}for(var S=0,v=0,y=0,b=0,C=n;b<C.length;b++){var x=C[b];"break"===x&&S++,"notAvail"===x&&v++,"update"===x&&y++}r=!(S>0||4===v)&&(0===S&&v<4&&y>0)}}catch(e){r=!1}return r},e.formatPivotValues=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i]){t[i]=[];for(var a=0;a<e[i].length;a++)e[i][a]&&(t[i][a]={axis:e[i][a].Axis,actualText:e[i][a].ActualText,indexObject:e[i][a].IndexObject,index:e[i][a].Index,rowHeaders:e[i][a].RowHeaders,columnHeaders:e[i][a].ColumnHeaders,formattedText:e[i][a].FormattedText,actualValue:e[i][a].ActualValue,rowIndex:e[i][a].RowIndex,colIndex:e[i][a].ColIndex,colSpan:e[i][a].ColSpan,level:e[i][a].Level,rowSpan:e[i][a].RowSpan,isSum:e[i][a].IsSum,isGrandSum:e[i][a].IsGrandSum,valueSort:e[i][a].ValueSort,ordinal:e[i][a].Ordinal,hasChild:e[i][a].HasChild,isDrilled:e[i][a].IsDrilled,value:e[i][a].Value,type:e[i][a].Type,members:e[i][a].Members})}return t},e.formatFieldList=function(e){for(var t=Object.keys(e),i={},a=0;a<t.length;a++)e[t[a]]&&(i[t[a]]={id:e[t[a]].Id,caption:e[t[a]].Caption,type:e[t[a]].Type,formatString:e[t[a]].FormatString,index:e[t[a]].Index,members:e[t[a]].Members,formattedMembers:e[t[a]].FormattedMembers,dateMember:e[t[a]].DateMember,filter:e[t[a]].Filter,sort:e[t[a]].Sort,aggregateType:e[t[a]].AggregateType,baseField:e[t[a]].BaseField,baseItem:e[t[a]].BaseItem,filterType:e[t[a]].FilterType,format:e[t[a]].Format,formula:e[t[a]].Formula,isSelected:e[t[a]].IsSelected,isExcelFilter:e[t[a]].IsExcelFilter,showNoDataItems:e[t[a]].ShowNoDataItems,isCustomField:e[t[a]].IsCustomField,showFilterIcon:e[t[a]].ShowFilterIcon,showSortIcon:e[t[a]].ShowSortIcon,showRemoveIcon:e[t[a]].ShowRemoveIcon,showEditIcon:e[t[a]].ShowEditIcon,showValueTypeIcon:e[t[a]].ShowValueTypeIcon,allowDragAndDrop:e[t[a]].AllowDragAndDrop,isCalculatedField:e[t[a]].IsCalculatedField,showSubTotals:e[t[a]].ShowSubTotals,expandAll:e[t[a]].expandAll,groupName:e[t[a]].groupName});return i},e.frameContent=function(e,t,i,a){var r=[],n=a;if(n.dataSourceSettings.values.length>0&&!n.engineModule.isEmptyData&&(n.enableValueSorting||!n.engineModule.isEngineUpdated))for(var s=0,o="value"===t?i:0,l="value"===t?e.length:i,d=o;d<l;d++)if(e[d]){r[s="header"===t?d:s]={};for(var p=0;p<e[d].length;p++)e[d][p]&&(r[s][p]=e[d][p]);s++}return r},e.getLocalizedObject=function(e){var t={};return t.Null=e.localeObj.getConstant("null"),t.Years=e.localeObj.getConstant("Years"),t.Quarters=e.localeObj.getConstant("Quarters"),t.Months=e.localeObj.getConstant("Months"),t.Days=e.localeObj.getConstant("Days"),t.Hours=e.localeObj.getConstant("Hours"),t.Minutes=e.localeObj.getConstant("Minutes"),t.Seconds=e.localeObj.getConstant("Seconds"),t.QuarterYear=e.localeObj.getConstant("QuarterYear"),t.Of=e.localeObj.getConstant("of"),t.Qtr=e.localeObj.getConstant("qtr"),t.Undefined=e.localeObj.getConstant("undefined"),t.GroupOutOfRange=e.localeObj.getConstant("groupOutOfRange"),t.Group=e.localeObj.getConstant("group"),t},e.updateReport=function(e,t){e.setProperties({dataSourceSettings:{rows:[]}},!0),e.setProperties({dataSourceSettings:{columns:[]}},!0),e.setProperties({dataSourceSettings:{formatSettings:[]}},!0);for(var i=0;i<t.Rows.length;i++)e.dataSourceSettings.rows.push({name:t.Rows[i].Name,caption:t.Rows[i].Caption,showNoDataItems:t.Rows[i].ShowNoDataItems,baseField:t.Rows[i].BaseField,baseItem:t.Rows[i].BaseItem,showFilterIcon:t.Rows[i].ShowFilterIcon,showSortIcon:t.Rows[i].ShowSortIcon,showEditIcon:t.Rows[i].ShowEditIcon,showRemoveIcon:t.Rows[i].ShowRemoveIcon,showSubTotals:t.Rows[i].ShowValueTypeIcon,allowDragAndDrop:t.Rows[i].AllowDragAndDrop,axis:t.Rows[i].Axis,dataType:t.Rows[i].DataType,isCalculatedField:t.Rows[i].IsCalculatedField,showValueTypeIcon:t.Rows[i].ShowValueTypeIcon,type:t.Rows[i].Type,expandAll:t.Rows[i].expandAll});for(i=0;i<t.Columns.length;i++)e.dataSourceSettings.columns.push({name:t.Columns[i].Name,caption:t.Columns[i].Caption,showNoDataItems:t.Columns[i].ShowNoDataItems,baseField:t.Columns[i].BaseField,baseItem:t.Columns[i].BaseItem,showFilterIcon:t.Columns[i].ShowFilterIcon,showSortIcon:t.Columns[i].ShowSortIcon,showEditIcon:t.Columns[i].ShowEditIcon,showRemoveIcon:t.Columns[i].ShowRemoveIcon,showSubTotals:t.Columns[i].ShowValueTypeIcon,allowDragAndDrop:t.Columns[i].AllowDragAndDrop,axis:t.Columns[i].Axis,dataType:t.Columns[i].DataType,isCalculatedField:t.Columns[i].IsCalculatedField,showValueTypeIcon:t.Columns[i].ShowValueTypeIcon,type:t.Columns[i].Type,expandAll:t.Columns[i].expandAll});for(i=0;i<t.FormatSettings.length;i++)e.dataSourceSettings.formatSettings.push({name:t.FormatSettings[i].Name,format:t.FormatSettings[i].Format,type:t.FormatSettings[i].Type,currency:t.FormatSettings[i].Currency,maximumFractionDigits:t.FormatSettings[i].MaximumFractionDigits,maximumSignificantDigits:t.FormatSettings[i].MaximumSignificantDigits,minimumFractionDigits:t.FormatSettings[i].MinimumFractionDigits,minimumIntegerDigits:t.FormatSettings[i].MinimumIntegerDigits,minimumSignificantDigits:t.FormatSettings[i].MinimumSignificantDigits,skeleton:t.FormatSettings[i].Skeleton,useGrouping:t.FormatSettings[i].UseGrouping})},e.generateUUID=function(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(t+a)%16|0,t=Math.floor(t/16)),("x"===i?a:3&a|8).toString(16)}))},e.applyCustomSort=function(e,t,i,a,r){var n,s=[];s=e.IsOrderChanged?e.members:"Ascending"===e.sortOrder||"None"===e.sortOrder||void 0===e.sortOrder?[].concat(e.members):[].concat(e.members).reverse();var o=[],l=void 0===i||"string"===i||"number"===i;"Grand Total"===t[0].actualText&&(n=t[0],t.shift());for(var d=0,p=0;d<t.length;d++){var h=t[d],u=r?h.formattedText:l?h.actualText:!0===i?h.actualText.toString():h.dateText;if(s[p]===u){if(t.splice(p++,0,h),t.splice(++d,1),!(p<s.length)){a||o.splice(--p,0,u);break}d=-1}d>=0&&!a&&(o[d]=u)}if(!a){for(d=o.length;d<t.length;d++){h=t[d],u=r?h.formattedText:l?h.actualText:!0===i?h.actualText.toString():h.dateText;o[d]=u}"Grand Total"===o[o.length-1]&&o.pop(),e.members=o}return n&&t.splice(0,0,n),t},e.applyHeadersSort=function(e,t,i,a){return e=a?e.sort((function(e,i){var a=e.actualText,r=i.actualText;return"Grand Total"===a||"Grand Total"===r?0:"Out of Range"===a?1:"Out of Range"===r?-1:isNaN(parseFloat(a))||isNaN(parseFloat(r))?"Ascending"===t?a.localeCompare(r,void 0,{numeric:!0,sensitivity:"base"}):r.localeCompare(a,void 0,{numeric:!0,sensitivity:"base"}):"Ascending"===t?parseFloat(a)-parseFloat(r):parseFloat(r)-parseFloat(a)})):"datetime"===i||"date"===i||"time"===i?"Ascending"===t?e.sort((function(e,t){return e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0})):"Descending"===t?e.sort((function(e,t){return e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0})):e:!0===i?"Ascending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:"Out of Range"===e.actualText?1:"Out of Range"===t.actualText?-1:Number(e.actualText.toString().match(/\d+/))>Number(t.actualText.toString().match(/\d+/))?1:Number(t.actualText.toString().match(/\d+/))>Number(e.actualText.toString().match(/\d+/))?-1:0})):"Descending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:"Out of Range"===e.actualText?-1:"Out of Range"===t.actualText||Number(e.actualText.toString().match(/\d+/))<Number(t.actualText.toString().match(/\d+/))?1:Number(t.actualText.toString().match(/\d+/))<Number(e.actualText.toString().match(/\d+/))?-1:0})):e:"Ascending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0})):"Descending"===t?e.sort((function(e,t){return"Grand Total"===e.actualText||"Grand Total"===t.actualText?0:e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0})):e},e.renderOlapEngine=function(e,t){try{e.olapEngineModule.renderEngine(e.dataSourceSettings,t||e.frameCustomProperties(e.olapEngineModule.fieldListData,e.olapEngineModule.fieldList),e.onHeadersSort?e.getHeaderSortInfo.bind(e):void 0),e.setProperties({dataSourceSettings:{valueIndex:e.olapEngineModule.measureIndex}},!0)}catch(t){e.actionObj.actionName="engineFormation",e.olapEngineModule.errorInfo?(e.actionFailureMethod(e.olapEngineModule.errorInfo),e.olapEngineModule.errorInfo=void 0):e.actionFailureMethod(t)}},e.frameHeaderWithKeys=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],i++;return a},e.getPageSize=function(e){switch(e){case"Letter":return new a.SizeF(612,792);case"Note":return new a.SizeF(540,720);case"Legal":return new a.SizeF(612,1008);case"A0":return new a.SizeF(2380,3368);case"A1":return new a.SizeF(1684,2380);case"A2":return new a.SizeF(1190,1684);case"A3":return new a.SizeF(842,1190);case"A5":return new a.SizeF(421,595);case"A6":return new a.SizeF(297,421);case"A7":return new a.SizeF(210,297);case"A8":return new a.SizeF(148,210);case"A9":return new a.SizeF(105,148);case"B0":return new a.SizeF(2836,4008);case"B1":return new a.SizeF(2004,2836);case"B2":return new a.SizeF(1418,2004);case"B3":return new a.SizeF(1002,1418);case"B4":return new a.SizeF(709,1002);case"B5":return new a.SizeF(501,709);case"Archa":return new a.SizeF(648,864);case"Archb":return new a.SizeF(864,1296);case"Archc":return new a.SizeF(1296,1728);case"Archd":return new a.SizeF(1728,2592);case"Arche":return new a.SizeF(2592,3456);case"Flsa":return new a.SizeF(612,936);case"HalfLetter":return new a.SizeF(396,612);case"Letter11x17":return new a.SizeF(792,1224);case"Ledger":return new a.SizeF(1224,792);default:return new a.SizeF(595,842)}},e.getSortedValue=function(e,t){return e.sort((function(e,i){return"Descending"===t?(i.value||"grand sum"===i.header.type?i.value:0)-(e.value||"grand sum"===e.header.type?e.value:0):(e.value||"grand sum"===e.header.type?e.value:0)-(i.value||"grand sum"===i.header.type?i.value:0)})),e.map((function(e){return e.header}))},e}(),n=function(){return n=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)},s=function(){function e(){this.aggregatedValueMatrix=[],this.valueContent=[],this.formatFields={},this.groupingFieldsInfo={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.columnPageCount=0,this.rowPageCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.rMembers=[],this.cMembers=[],this.groupingFields={},this.isLastHeaderHasMeasures=!0,this.measureIndex=-1,this.isPagingOrVirtualizationEnabled=!1,this.valueMatrix=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.reformAxisCount=0,this.isEditing=!1,this.valueAxisFields={},this.data=[],this.actualData=[],this.groupRawIndex={},this.fieldKeys={},this.allowDataCompression=!1,this.dataSourceSettings={},this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.columnKeys={},this.fieldDrillCollection={},this.formatRegex=/^(?:[ncpae])(?:([0-9]|1[0-9]|20))?$/i,this.measureNames={},this.enablePaging=!1,this.enableVirtualization=!1,this.enableHtmlSanitizer=!1,this.isParentLevelAdded=!0,this.enableOptimizedRendering=!1,this.groupedDataType={}}return e.prototype.clearProperties=function(e){this.isPagingOrVirtualizationEnabled||e||(this.columnKeys={},this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0}),this.enableValueSorting&&(this.valueContent=[]),this.saveDataHeaders=this.allowValueFilter?this.saveDataHeaders:{},this.rMembers=[],this.cMembers=[],this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.rawIndexObject={},this.dataSourceSettings.valueIndex>-1&&(this.valueAxisFields={}),this.headerObjectsCollection={},this.fieldDrillCollection={}},e.prototype.renderEngine=function(e,a,n,s){if(this.getValueCellInfo=n,this.getHeaderSortInfo=s,this.fieldList)for(var o=0,l=e.formatSettings;o<l.length;o++)!this.formatFields[l[o].name]&&this.fieldList[l[o].name]&&(this.fieldList[l[o].name].members={},this.fieldList[l[o].name].formattedMembers={},this.fieldList[l[o].name].dateMember=[]);var d;if(this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.columnPageCount=0,this.rowPageCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.dataSourceSettings.excludeFields=(0,t.isNullOrUndefined)(e.excludeFields)?[]:e.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.aggregatedValueMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isLastHeaderHasMeasures=!0,this.isEditing=!1,this.globalize=a&&a.globalize?a.globalize:new t.Internationalization,this.currencyCode=a&&a.currenyCode?a.currenyCode:void 0,this.localeObj=a?a.localeObj:void 0,this.fieldsType=a?a.fieldsType:{},this.clonedReport=a?a.clonedReport&&a.clonedReport.properties?a.clonedReport.properties:a.clonedReport:{},this.enablePaging=a.enablePaging,this.enableVirtualization=a.enableVirtualization,this.enableOptimizedRendering=a.enableOptimizedRendering,this.enableHtmlSanitizer=a.enableHtmlSanitizer,this.isPagingOrVirtualizationEnabled=this.enablePaging||this.enableVirtualization,this.enableSort=e.enableSorting,this.dataSourceSettings.alwaysShowValueHeader=e.alwaysShowValueHeader,this.dataSourceSettings.showHeaderWhenEmpty=!!(0,t.isNullOrUndefined)(e.showHeaderWhenEmpty)||e.showHeaderWhenEmpty,this.dataSourceSettings.showSubTotals=!!(0,t.isNullOrUndefined)(e.showSubTotals)||e.showSubTotals,this.dataSourceSettings.showRowSubTotals=!!(0,t.isNullOrUndefined)(e.showRowSubTotals)||e.showRowSubTotals,this.dataSourceSettings.showColumnSubTotals=!!(0,t.isNullOrUndefined)(e.showColumnSubTotals)||e.showColumnSubTotals,this.dataSourceSettings.showGrandTotals=!!(0,t.isNullOrUndefined)(e.showGrandTotals)||e.showGrandTotals,this.dataSourceSettings.grandTotalsPosition=(0,t.isNullOrUndefined)(e.grandTotalsPosition)?"Bottom":e.grandTotalsPosition,this.dataSourceSettings.showRowGrandTotals=!!(0,t.isNullOrUndefined)(e.showRowGrandTotals)||e.showRowGrandTotals,this.dataSourceSettings.showColumnGrandTotals=!!(0,t.isNullOrUndefined)(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.showSubTotalsAtTop=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&"Top"===e.subTotalsPosition,this.showSubTotalsAtBottom=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals&&"Bottom"===e.subTotalsPosition,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!a&&a.enableValueSorting,this.isDrillThrough=!!a&&(!!a.isDrillThrough&&a.isDrillThrough),this.valueContent=[],this.dataSourceSettings=r.getClonedDataSourceSettings(e),e.dataSource instanceof i.DataManager||(this.data=e.dataSource),this.data&&this.data[0]){if(!this.fieldList){"CSV"===e.type?this.fields=this.data.shift():this.fields=Object.keys(this.data[0]);for(o=0;o<this.fields.length;o++)this.fieldKeys[this.fields[o]]="CSV"===e.type?o:this.fields[o]}a&&a.pageSettings&&a.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e)),this.dataSourceSettings.rows=e.rows?e.rows:[],this.dataSourceSettings.columns=e.columns?e.columns:[],this.dataSourceSettings.filters=e.filters?e.filters:[],this.dataSourceSettings.values=e.values?e.values:[],this.dataSourceSettings.formatSettings=e.formatSettings?e.formatSettings:[],this.dataSourceSettings.groupSettings=e.groupSettings?e.groupSettings:[],this.dataSourceSettings.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.dataSourceSettings.fieldMapping=e.fieldMapping?e.fieldMapping:[],this.valueAxisFields={};for(var p=0,h=this.dataSourceSettings.values;p<h.length;p++){var u=h[p];this.valueAxisFields[u.name]=u}d=this.getGroupData(this.data);for(o=0;o<this.fields.length;o++)this.fieldKeys[this.fields[o]]="CSV"===e.type?o:this.fields[o];this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMultiMeasures=this.dataSourceSettings.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.measureIndex=(0,t.isNullOrUndefined)(e.valueIndex)?-1:e.valueIndex,this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.dataSourceSettings.values.length:1,this.colValuesLength=0===this.valueAxis?this.dataSourceSettings.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.pageSettings=a?a.pageSettings?a.pageSettings:this.pageSettings:void 0,this.allowDataCompression=a&&a.allowDataCompression,this.savedFieldList=a?a.savedFieldList:void 0,this.getFieldList(d,this.enableSort,e.allowValueFilter),this.removeIrrelevantFields(Object.keys(this.fieldList)),this.fillFieldMembers(),this.updateSortSettings(e.sortSettings,this.enableSort),this.filterMembers=[];var c=this.dataSourceSettings.columns.length-1;for(this.columnKeys={};c>-1;)this.columnKeys[this.dataSourceSettings.columns[c].name]=this.dataSourceSettings.columns[c],c--;this.updateFilterMembers(e),this.generateGridData(e)}},e.prototype.removeIrrelevantFields=function(e){var i={};i[0]=this.dataSourceSettings.rows,i[1]=this.dataSourceSettings.columns,i[2]=this.dataSourceSettings.values,i[3]=this.dataSourceSettings.filters;for(var a=0;a<4;){if(i[a])for(var r=0;r<i[a].length;r++){var n=i[a][r].name;this.dataSourceSettings.excludeFields.indexOf(n)>-1||!(0,t.isNullOrUndefined)(e)&&-1===e.indexOf(n)?(i[a].splice(r,1),r--):2===a&&(this.measureNames[n]=i[a][r].caption?i[a][r].caption:n,this.measureNames[i[a][r].caption?i[a][r].caption:n]=n)}a++}this.isMultiMeasures=this.dataSourceSettings.values.length>1,this.measureIndex=-1===this.measureIndex?this.valueAxis?i[0].length:i[1].length:this.measureIndex},e.prototype.updateDataSourceSettings=function(e,i){i&&(this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.valueAxis="row"===e.valueAxis?1:0,this.rowValuesLength=1===this.valueAxis?this.dataSourceSettings.values.length:1,this.colValuesLength=0===this.valueAxis?this.dataSourceSettings.values.length:1,this.measureIndex=(0,t.isNullOrUndefined)(e.valueIndex)?-1:e.valueIndex,this.enableSort=e.enableSorting,this.dataSourceSettings.alwaysShowValueHeader=e.alwaysShowValueHeader,this.dataSourceSettings.showHeaderWhenEmpty=!!(0,t.isNullOrUndefined)(e.showHeaderWhenEmpty)||e.showHeaderWhenEmpty,this.dataSourceSettings.showSubTotals=!!(0,t.isNullOrUndefined)(e.showSubTotals)||e.showSubTotals,this.dataSourceSettings.showRowSubTotals=!!(0,t.isNullOrUndefined)(e.showRowSubTotals)||e.showRowSubTotals,this.dataSourceSettings.showColumnSubTotals=!!(0,t.isNullOrUndefined)(e.showColumnSubTotals)||e.showColumnSubTotals,this.dataSourceSettings.showGrandTotals=!!(0,t.isNullOrUndefined)(e.showGrandTotals)||e.showGrandTotals,this.dataSourceSettings.grandTotalsPosition=(0,t.isNullOrUndefined)(e.grandTotalsPosition)?"Bottom":e.grandTotalsPosition,this.dataSourceSettings.showRowGrandTotals=!!(0,t.isNullOrUndefined)(e.showRowGrandTotals)||e.showRowGrandTotals,this.dataSourceSettings.showColumnGrandTotals=!!(0,t.isNullOrUndefined)(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.showSubTotalsAtTop=this.dataSourceSettings.showSubTotals&&"Top"===e.subTotalsPosition&&e.showColumnSubTotals,this.showSubTotalsAtBottom=this.dataSourceSettings.showSubTotals&&"Bottom"===e.subTotalsPosition&&e.showRowSubTotals,this.allowValueFilter=e.allowValueFilter,this.dataSourceSettings.formatSettings=e.formatSettings?e.formatSettings:[],this.dataSourceSettings.groupSettings=e.groupSettings?e.groupSettings:[],this.dataSourceSettings.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.dataSourceSettings.fieldMapping=e.fieldMapping?e.fieldMapping:[],this.removeIrrelevantFields(Object.keys(this.fieldList)))},e.prototype.getGroupedRawData=function(e){this.data=[];for(var i=0,a=this.actualData;i<a.length;i++){var n=a[i];this.data[this.data.length]=r.frameHeaderWithKeys(n)}var s=e.values.filter((function(e){return"Count"===e.type||"DistinctCount"===e.type})).map((function(e){return e.name})),o=s.length>0,l=this.data,d=e.rows.concat(e.columns.concat(e.filters)).map((function(e){return e.name})),p={},h=[];this.groupRawIndex={};for(var u={},c=0,g=0;g<l.length;g++){var m=l[g],f=[];if(o)for(var S=0;S<s.length;S++)m[this.fieldKeys[s[S]]]=(0,t.isNullOrUndefined)(m[this.fieldKeys[s[S]]])?m[this.fieldKeys[s[S]]]:1;for(var v=0;v<d.length;v++)f.push(m[this.fieldKeys[d[v]]]);var y=f.join("-");if(p[y]){for(S=0;S<e.values.length;S++){var b=e.values[S].name,C=m[this.fieldKeys[b]],x=p[y],w=e.values[S].type;(0,t.isNullOrUndefined)(C)||("number"==typeof C&&"DistinctCount"!==w||(w="Count"),(0,t.isNullOrUndefined)(x[b])?x[b]="Product"===w?1:"Min"===w||"Max"===w?void 0:0:"number"!=typeof x[b]&&(x[b]=1),"Count"===w?x[b]+=1:"Min"===w?(0,t.isNullOrUndefined)(x[b])||(x[b]=x[b]>C?C:x[b]):"Max"===w?(0,t.isNullOrUndefined)(x[b])||(x[b]=x[b]<C?C:x[b]):"Product"===w?x[b]*=C:x[b]+=C)}this.isDrillThrough&&this.groupRawIndex[u[y]].push(g)}else p[y]=m,h.push(m),this.isDrillThrough&&(this.groupRawIndex[c]=[g],u[y]=c,c++)}return h},e.prototype.getGroupData=function(e){for(var i=this,a=e[0],n=function(n){var o=n.name,l=n.caption;if(!(s.fields.indexOf(o)>-1))return{value:a};var d={},p=void 0;if("Date"===n.type&&s.groupingFields[o]||"Custom"===n.type&&s.groupingFields[o])return{value:a};if("Number"===n.type){if("number"!==r.getType(a[o])&&s.groupingFields[o])return{value:a};n.rangeInterval&&e.sort((function(e,t){return Number(e[i.fieldKeys[o]])>Number(t[i.fieldKeys[o]])?1:Number(t[i.fieldKeys[o]])>Number(e[i.fieldKeys[o]])?-1:0}))}for(var h=e.length;h--;){var u=e[h];if(u[s.fieldKeys[o]]&&"Date"===n.type){var c=new Date(u[s.fieldKeys[o]].toString());if(!(0,t.isNullOrUndefined)(c)&&n.groupInterval.length>0)for(var g=0,m=n.groupInterval.length;g<m;g++){var f=n.groupInterval[g],S=s.getRange(n,c.getTime()),v=r.resetTime(new Date);switch(f){case"Years":d[b=g===n.groupInterval.length-1?o:o+"_date_group_years"]=f,s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:new Date(v.setFullYear(c.getFullYear())).toString();break;case"Quarters":d[b=g===n.groupInterval.length-1?o:o+"_date_group_quarters"]=f;var y=Math.ceil((c.getMonth()+1)/3);s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:(s.localeObj?s.localeObj.getConstant("qtr"):"Qtr")+y.toString();break;case"QuarterYear":d[b=g===n.groupInterval.length-1?o:o+"_date_group_quarterYear"]=f;y=Math.ceil((c.getMonth()+1)/3);s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:(s.localeObj?s.localeObj.getConstant("qtr"):"Qtr")+y.toString()+" "+(s.localeObj?s.localeObj.getConstant("of"):"of")+" "+c.getFullYear().toString();break;case"Months":d[b=g===n.groupInterval.length-1?o:o+"_date_group_months"]=f,s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:new Date(v.setMonth(c.getMonth(),1)).toString();break;case"Days":d[b=g===n.groupInterval.length-1?o:o+"_date_group_days"]=f,s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:new Date(v.setMonth(c.getMonth(),c.getDate())).toString();break;case"Hours":d[b=g===n.groupInterval.length-1?o:o+"_date_group_hours"]=f,s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:new Date(v.setHours(c.getHours())).toString();break;case"Minutes":d[b=g===n.groupInterval.length-1?o:o+"_date_group_minutes"]=f,s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:new Date(v.setMinutes(c.getMinutes())).toString();break;case"Seconds":d[b=g===n.groupInterval.length-1?o:o+"_date_group_seconds"]=f,s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b),u[s.fieldKeys[b]]=S?void 0:new Date(v.setSeconds(c.getSeconds())).toString()}}}else if(isNaN(Number(u[s.fieldKeys[o]]))||"Number"!==n.type){if(u[s.fieldKeys[o]]&&"Custom"===n.type&&n.customGroups&&n.customGroups.length>0){var b=o+"_custom_group",C=n.customGroups,x=void 0;s.groupingFieldsInfo[o]=o,s.groupingFieldsInfo[b]=o;g=0;for(var w=C.length;g<w;g++){var T=C[g];if(T.items&&T.items.length>1){p=b,s.fieldKeys[b]="CSV"===s.dataSourceSettings.type?s.fieldKeys[b]?s.fieldKeys[b]:s.fields.length:b,-1===s.fields.indexOf(b)&&s.fields.push(b);var M=-1!==r.inArray(u[s.fieldKeys[o]].toString(),T.items);u[s.fieldKeys[b]]=M?T.groupName&&""!==T.groupName?T.groupName:s.localeObj.getConstant("group")+" "+g:x&&x!==u[s.fieldKeys[o]].toString()?x:u[s.fieldKeys[o]].toString(),x=u[s.fieldKeys[b]]}}}}else{S=s.getRange(n,Number(u[s.fieldKeys[o]]));u[s.fieldKeys[o]]=S?void 0:u[s.fieldKeys[o]]}for(var D=[],O=0,P=de=Object.keys(u);O<P.length;O++){var N=P[O];D.push(!!u[N])}a=-1===D.indexOf(!1)&&de.length===Object.keys(e[0]).length?u:a}if("Date"===n.type){for(var E=!1,I=[s.dataSourceSettings.rows,s.dataSourceSettings.columns,s.dataSourceSettings.values,s.dataSourceSettings.filters],F=Object.keys(d),L=Object.keys(F).length,A=void 0,R=0,k=I;R<k.length;R++){var j=k[R];if(!E&&j){var q=j.length;for(g=0;g<q;){if(j[g].name===o){E=!0;var H=j[g];for(j.splice(g,1),Se=(Se=s.dataSourceSettings.rows).concat(s.dataSourceSettings.columns,s.dataSourceSettings.values,s.dataSourceSettings.filters);L--;){var V=H.caption?H.caption:H.name;if(s.clonedReport){var U=s.clonedReport.rows;U=U.concat(s.clonedReport.columns,s.clonedReport.values,s.clonedReport.filters);var B=r.getFieldByName(F[L],U);B&&(V=B.caption?B.caption:B.name)}if(r.getFieldByName(F[L],Se))s.groupingFieldsInfo[F[L]]=o;else{A=d[F[L]],V=-1!==V.indexOf(" (")&&-1!==V.indexOf(")")?V.slice(V.indexOf("(")+1,V.length-1):V;var _={name:F[L],caption:(s.localeObj?s.localeObj.getConstant(A):A)+" ("+V+")",type:"Count",showNoDataItems:H.showNoDataItems,baseField:H.baseField,baseItem:H.baseItem,showFilterIcon:H.showFilterIcon,showSortIcon:H.showSortIcon,showEditIcon:H.showEditIcon,showRemoveIcon:H.showRemoveIcon,showSubTotals:H.showValueTypeIcon,allowDragAndDrop:H.allowDragAndDrop,expandAll:H.expandAll,groupName:H.groupName};j.splice(g,0,_),s.groupingFieldsInfo[_.name]=o}}break}if(j[g].name.indexOf(o)>-1){var G=d[j[g].name],z=j.filter((function(e){return e.name===o}))[0];if(!(0,t.isNullOrUndefined)(z)){var W=-1!==z.caption.indexOf(" (")&&-1!==z.caption.indexOf(")")?z.caption.slice(z.caption.indexOf("(")+1,z.caption.length-1):z.caption;j[g].caption=(s.localeObj?s.localeObj.getConstant(G):z)+" ("+W+")"}}g++}if(E)break}}L=Object.keys(F).length;for(var Q=(ge=s.getMappingField(o,s.clonedReport?s.clonedReport.fieldMapping:s.dataSourceSettings.fieldMapping)).caption?ge.caption:o;L--;){A=d[F[L]];g=0;for(var Y=s.dataSourceSettings.formatSettings.length;g<Y;g++)if(s.dataSourceSettings.formatSettings[g].name===F[L]){s.dataSourceSettings.formatSettings.splice(g,1);break}if("Quarters"!==A&&"QuarterYear"!==A){var K={name:F[L],type:["Years","Months","Days"].indexOf(A)>-1?"date":"time",format:"Years"===A?"yyyy":"Months"===A?"MMM":"Days"===A?"d-MMM":"Hours"===A?"hh a":"Minutes"===A?":mm":"Seconds"===A?":ss":void 0};s.dataSourceSettings.formatSettings.push(K)}if(!E){var X=s.getMappingField(F[L],s.dataSourceSettings.fieldMapping);if(F[L]!==o&&(0,t.isNullOrUndefined)(X.name)){_={name:F[L],caption:(s.localeObj?s.localeObj.getConstant(A):A)+" ("+Q+")"};s.dataSourceSettings.fieldMapping.push(_),s.groupingFieldsInfo[_.name]=o}else F[L]!==o&&(X.caption=(s.localeObj?s.localeObj.getConstant(A):A)+" ("+Q+")",s.groupingFieldsInfo[X.name]=o)}}if(!E){X=s.getMappingField(o,s.dataSourceSettings.fieldMapping);if(A=d[o],F[L]!==o&&(0,t.isNullOrUndefined)(X.name)){_={name:o,caption:(s.localeObj?s.localeObj.getConstant(A):A)+" ("+Q+")"};s.dataSourceSettings.fieldMapping.push(_),s.groupingFieldsInfo[_.name]=o}else X.caption=(s.localeObj?s.localeObj.getConstant(A):A)+" ("+Q+")",s.groupingFieldsInfo[X.name]=o}}else if("Number"===n.type&&n.rangeInterval){var J=void 0,Z=[],$=[],ee=e.length;q=0;s.groupingFields[o]=o;for(var te=[];q<ee;){var ie=Number(e[q][o]);$.push(ie),isNaN(ie)||-1!==Z.indexOf(ie)||Z.push(ie),q++}for(ee=e.length,q=0;q<ee;){var ae=e[q];if(ae&&!isNaN(Number(ae[o]))){J=("string"==typeof n.endingAt?parseInt(n.endingAt,10):n.endingAt)||Math.max.apply(Math,Z);var re=Math.round(Number(ae[o])),ne=Math.round(re+(n.rangeInterval-1));if(re>=te[0]&&re<=te[te.length-1]){var se=te[0],oe=te[te.length-1];ae[o]=s.getNumberGroupHeaders(se,oe,J),(0,t.isNullOrUndefined)(s.groupedDataType[o])&&(s.groupedDataType[o]="string")}else if(0===te.length){for(g=re;g<=ne;g++)te.push(g);se=te[0],oe=te[te.length-1];ae[o]=s.getNumberGroupHeaders(se,oe,J),(0,t.isNullOrUndefined)(s.groupedDataType[o])&&(s.groupedDataType[o]="string")}else{oe=(se=te[te.length-1]+1)+(n.rangeInterval-1);var le=!0;for(te.splice(0,te.length);le;)re>=se&&re<=oe&&(ae[o]=s.getNumberGroupHeaders(se,oe,J),(0,t.isNullOrUndefined)(s.groupedDataType[o])&&(s.groupedDataType[o]="string"),te.push(se),te.push(oe),le=!1),oe=(se=oe+1)+(n.rangeInterval-1)}D=[];for(var de,pe=0,he=de=Object.keys(ae);pe<he.length;pe++){N=he[pe];D.push(!!ae[N])}a=-1===D.indexOf(!1)&&de.length===Object.keys(e[0]).length?ae:a}q++}for(var ue=0,ce=I=[s.dataSourceSettings.rows,s.dataSourceSettings.columns,s.dataSourceSettings.values,s.dataSourceSettings.filters];ue<ce.length;ue++){var ge,me=ce[ue];(ge=r.getFieldByName(o,me))&&((ge=ge.properties?ge.properties:ge).type="Count")}g=0;for(var fe=s.dataSourceSettings.formatSettings.length;g<fe;g++)if(s.dataSourceSettings.formatSettings[g].name===o){s.dataSourceSettings.formatSettings.splice(g,1);break}}else if("Custom"===n.type&&p){var Se,ve=p;E=!1,I=[s.dataSourceSettings.rows,s.dataSourceSettings.columns,s.dataSourceSettings.values,s.dataSourceSettings.filters];Se=(Se=s.dataSourceSettings.rows).concat(s.dataSourceSettings.columns,s.dataSourceSettings.values,s.dataSourceSettings.filters);var ye=[];l&&""!==l||(ye=ve.match(/_custom_group/g));for(var be=r.getFieldByName(o.replace(/_custom_group/g,""),Se),Ce=r.getFieldByName(ve,Se),xe=0,we=I;xe<we.length;xe++){j=we[xe];if(!E&&j){for(q=j.length,g=0;g<q;){if(j[g].name===n.name&&!Ce){E=!0;H=j[g],_={name:ve,caption:l&&""!==l?l:(be.caption?be.caption:be.name)+(ye.length+1),type:"Count",showNoDataItems:H.showNoDataItems,baseField:H.baseField,baseItem:H.baseItem,showSubTotals:H.showValueTypeIcon,allowDragAndDrop:H.allowDragAndDrop,showFilterIcon:H.showFilterIcon,showSortIcon:H.showSortIcon,showRemoveIcon:H.showRemoveIcon,showEditIcon:H.showEditIcon,expandAll:H.expandAll,groupName:H.groupName};j.splice(g,0,_),s.groupingFieldsInfo[_.name]=o,s.groupingFieldsInfo[o]=o;break}if(j[g].name===ve&&Ce){_={name:Ce.name,caption:l&&""!==l?l:Ce.caption,type:Ce.type,showNoDataItems:Ce.showNoDataItems,baseField:Ce.baseField,baseItem:Ce.baseItem,showRemoveIcon:Ce.showRemoveIcon,showSubTotals:Ce.showValueTypeIcon,allowDragAndDrop:Ce.allowDragAndDrop,showFilterIcon:Ce.showFilterIcon,showSortIcon:Ce.showSortIcon,showEditIcon:Ce.showEditIcon,expandAll:Ce.expandAll,groupName:Ce.groupName};j.splice(g,1,_),s.groupingFieldsInfo[_.name]=o,s.groupingFieldsInfo[o]=o;break}g++}if(E)break}}var Te=r.getFieldByName(o,r.cloneFormatSettings(s.dataSourceSettings.formatSettings));Te&&(Te.name=ve,s.dataSourceSettings.formatSettings.push(Te)),s.groupingFields[o]=o}s.groupingFields=(0,t.extend)(s.groupingFields,d)},s=this,o=0,l=this.dataSourceSettings.groupSettings;o<l.length;o++){var d=n(l[o]);if("object"==typeof d)return d.value}return a},e.prototype.getNumberGroupHeaders=function(e,t,i){return e===t?e.toString():i>=e&&i<=t?i===e?e.toString():e.toString()+"-"+i.toString():e.toString()+"-"+t.toString()},e.prototype.getRange=function(e,t){var i;if("Date"===e.type){var a=new Date(t),r="string"==typeof e.startingAt?new Date(e.startingAt):e.startingAt,n="string"==typeof e.endingAt?new Date(e.endingAt):e.endingAt;i=!!(r&&a.getTime()<r.getTime()||n&&a.getTime()>n.getTime())}else{var s="string"==typeof e.startingAt?parseInt(e.startingAt,10):e.startingAt,o="string"==typeof e.endingAt?parseInt(e.endingAt,10):e.endingAt;i=!isNaN(s)&&t<s||!isNaN(o)&&t>o}return i},e.prototype.getPercentFormat=function(e,i){var a=(0,t.isNullOrUndefined)(e[i])||(0,t.isNullOrUndefined)(this.formatFields[i].format)?void 0:this.formatFields[i].format.toLowerCase().match(/p[0-9]/);return(0,t.isNullOrUndefined)(a)?2:Number(this.formatFields[i].format.replace(/[^0-9]/g,""))},e.prototype.getFormattedFields=function(e){this.formatFields=this.setFormattedFields(e.formatSettings)},e.prototype.setFormattedFields=function(e){for(var t=e.length,i={};t--;)i[e[t].name]=e[t],e[t].type&&(this.dateFormatFunction[e[t].name]={exactFormat:this.globalize.getDateFormat(e[t]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:e[t].type})});return i},e.prototype.getFieldList=function(e,i,a){for(var n,s=this.dataSourceSettings.excludeFields.length-1;s>-1;){var o=this.fields.indexOf(this.dataSourceSettings.excludeFields[s]);-1!==o&&this.fields.splice(o,1),this.fieldList&&delete this.fieldList[this.dataSourceSettings.excludeFields[s]],s--}var l=this.fields,d=(0,t.extend)([],this.dataSourceSettings.rows,null,!0);d=d.concat(this.dataSourceSettings.columns,this.dataSourceSettings.values,this.dataSourceSettings.filters),this.getFormattedFields(this.dataSourceSettings),this.getCalculatedField(l);var p=(l=this.fields).length,h=["string","number","datetime","date","boolean"];if(this.savedFieldList)for(this.fieldList=this.savedFieldList;p--;){var u=l[p],c=this.getMappingField(u,this.dataSourceSettings.fieldMapping);this.fieldList[u]?(this.fieldList[u].isSelected=!1,this.fieldList[u].index=p,this.fieldList[u].filter=[],this.fieldList[u].sort=i?"Ascending":"None",this.fieldList[u].isExcelFilter=!1,this.fieldList[u].filterType="",this.fieldList[u].showFilterIcon=!c||!("showFilterIcon"in c)||c.showFilterIcon,this.fieldList[u].showRemoveIcon=!c||!("showRemoveIcon"in c)||c.showRemoveIcon,this.fieldList[u].showSortIcon=!c||!("showSortIcon"in c)||c.showSortIcon,this.fieldList[u].showEditIcon=!c||!("showEditIcon"in c)||c.showEditIcon,this.fieldList[u].showValueTypeIcon=!c||!("showValueTypeIcon"in c)||c.showValueTypeIcon,this.fieldList[u].allowDragAndDrop=!c||!("allowDragAndDrop"in c)||c.allowDragAndDrop,this.fieldList[u].isCalculatedField=!(!c||!("isCalculatedField"in c))&&c.isCalculatedField,this.fieldList[u].showNoDataItems=!(!c||!("showNoDataItems"in c))&&c.showNoDataItems,this.fieldList[u].showSubTotals=!c||!("showSubTotals"in c)||c.showSubTotals,this.fieldList[u].expandAll=!(!c||!("expandAll"in c))&&c.expandAll,this.fieldList[u].pid=c&&"groupName"in c&&c.groupName?c.groupName:this.groupingFieldsInfo[u]?this.groupingFieldsInfo[u]:void 0,this.isValueFiltersAvail&&a&&(this.fieldList[u].dateMember=[],this.fieldList[u].members={},this.fieldList[u].isMembersFilled=!1),this.updateMembersOrder(u)):(n=(0,t.isNullOrUndefined)(this.groupedDataType[u])?c&&"dataType"in c&&c.dataType&&h.indexOf(c.dataType.toLowerCase())>-1?c.dataType.toLowerCase():n:this.groupedDataType[u],this.fieldList[u]={caption:c&&"caption"in c&&c.caption?c.caption:u,id:u,type:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===n||"undefined"===n?"number":n,isSelected:!1,sort:i?"Ascending":"None",filterType:"",index:p,filter:[],isCustomField:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group"),showRemoveIcon:!c||!("showRemoveIcon"in c)||c.showRemoveIcon,showFilterIcon:!c||!("showFilterIcon"in c)||c.showFilterIcon,showSortIcon:!c||!("showSortIcon"in c)||c.showSortIcon,showNoDataItems:!(!c||!("showNoDataItems"in c))&&c.showNoDataItems,isCalculatedField:!(!c||!("isCalculatedField"in c))&&c.isCalculatedField,showEditIcon:!c||!("showEditIcon"in c)||c.showEditIcon,showValueTypeIcon:!c||!("showValueTypeIcon"in c)||c.showValueTypeIcon,allowDragAndDrop:!c||!("allowDragAndDrop"in c)||c.allowDragAndDrop,showSubTotals:!c||!("showSubTotals"in c)||c.showSubTotals,expandAll:!(!c||!("expandAll"in c))&&c.expandAll,pid:c&&"groupName"in c&&c.groupName?c.groupName:this.groupingFieldsInfo[u]?this.groupingFieldsInfo[u]:void 0,aggregateType:c&&"type"in c?c.type:"number"===(-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===n||"undefined"===n?"number":n)?"Sum":"Count",baseField:c&&"baseField"in c?c.baseField:void 0,baseItem:c&&"baseItem"in c?c.baseItem:void 0},this.updateMembersOrder(u))}else for(this.fieldList={};p--;){u=l[p],c=this.getMappingField(u,this.dataSourceSettings.fieldMapping);n=(0,t.isNullOrUndefined)(this.groupedDataType[u])?c&&"dataType"in c&&c.dataType&&h.indexOf(c.dataType.toLowerCase())>-1?c.dataType.toLowerCase():r.getType(e[this.fieldKeys[u]]):this.groupedDataType[u],this.fieldList[u]={id:u,pid:c&&"groupName"in c&&c.groupName?c.groupName:this.groupingFieldsInfo[u]?this.groupingFieldsInfo[u]:void 0,caption:c&&"caption"in c&&c.caption?c.caption:u,type:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===n||"undefined"===n?"number":n,filterType:"",index:p,filter:[],sort:i?"Ascending":"None",isSelected:!1,isCustomField:-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group"),showFilterIcon:!c||!("showFilterIcon"in c)||c.showFilterIcon,showRemoveIcon:!c||!("showRemoveIcon"in c)||c.showRemoveIcon,showSortIcon:!c||!("showSortIcon"in c)||c.showSortIcon,showEditIcon:!c||!("showEditIcon"in c)||c.showEditIcon,showValueTypeIcon:!c||!("showValueTypeIcon"in c)||c.showValueTypeIcon,allowDragAndDrop:!c||!("allowDragAndDrop"in c)||c.allowDragAndDrop,showSubTotals:!c||!("showSubTotals"in c)||c.showSubTotals,showNoDataItems:!(!c||!("showNoDataItems"in c))&&c.showNoDataItems,isCalculatedField:!(!c||!("isCalculatedField"in c))&&c.isCalculatedField,expandAll:!(!c||!("expandAll"in c))&&c.expandAll,aggregateType:c&&"type"in c?c.type:"number"===(-1!==u.indexOf("_custom_group")||-1!==u.indexOf("_date_group")?"string":void 0===n||"undefined"===n?"number":n)?"Sum":"Count",baseField:c&&"baseField"in c?c.baseField:void 0,baseItem:c&&"baseItem"in c?c.baseItem:void 0},this.updateMembersOrder(u)}this.groupedDataType={},this.updateTreeViewData(d)},e.prototype.updateMembersOrder=function(e){for(var t=0,i=this.dataSourceSettings.sortSettings;t<i.length;t++){var a=i[t];if(e===a.name&&a.membersOrder){this.fieldList[e].membersOrder=a.membersOrder;break}}},e.prototype.getMappingField=function(e,t){var i={};if(t&&t.length>0)for(var a=0,r=t.length;a<r;a++)if(t[a].name===e){i=t[a];break}return i},e.prototype.updateFieldList=function(e){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter},e.prototype.updateTreeViewData=function(e){for(var t=e.length,i=this.dataSourceSettings.calculatedFieldSettings.length;t--;)if(this.fieldList[e[t].name]){var a=this.fieldList[e[t].name];a.type=e[t].dataType?e[t].dataType.toLowerCase():a.type,a.caption=e[t].caption?e[t].caption:e[t].name,a.isSelected=!0,a.showNoDataItems=e[t].showNoDataItems,a.aggregateType=e[t].type,a.baseField=e[t].baseField,a.baseItem=e[t].baseItem,a.allowDragAndDrop=e[t].allowDragAndDrop,a.showFilterIcon=e[t].showFilterIcon,a.showSortIcon=e[t].showSortIcon,a.showRemoveIcon=e[t].showRemoveIcon,a.showValueTypeIcon=e[t].showValueTypeIcon,a.showEditIcon=e[t].showEditIcon,a.showSubTotals=e[t].showSubTotals,a.expandAll=e[t].expandAll}for(;i--;)this.fieldList[this.dataSourceSettings.calculatedFieldSettings[i].name]&&(this.fieldList[this.dataSourceSettings.calculatedFieldSettings[i].name].aggregateType="CalculatedField",this.fieldList[this.dataSourceSettings.calculatedFieldSettings[i].name].isCalculatedField=!0,this.fieldList[this.dataSourceSettings.calculatedFieldSettings[i].name].formula=this.dataSourceSettings.calculatedFieldSettings[i].formula)},e.prototype.getCalculatedField=function(e){for(var i=0,a=this.dataSourceSettings.calculatedFieldSettings;i<a.length;i++){var r=a[i];this.calculatedFields[r.name]=(0,t.extend)({},r,null,!0),this.calculatedFields[r.name].actualFormula=r.formula}for(var n=Object.keys(this.calculatedFields),s=function(t,i){var a=o.calculatedFields[n[t]],r=a.properties,s=(r?r.formula:a.formula).trim(),l=s.replace(/"/g,"");a.formula=l.indexOf("^")>-1?o.powerFunction(l):l,-1===a.formula.indexOf("Math.min(")&&a.formula.indexOf("min(")>-1&&(a.formula=a.formula.replace(/min\(/g,"Math.min(")),-1===a.formula.indexOf("Math.max(")&&a.formula.indexOf("max(")>-1&&(a.formula=a.formula.replace(/max\(/g,"Math.max(")),-1===a.formula.indexOf("Math.abs(")&&a.formula.indexOf("abs(")>-1&&(a.formula=a.formula.replace(/abs\(/g,"Math.abs(")),a.name=r?r.name:a.name,"CSV"===o.dataSourceSettings.type?-1===e.indexOf(a.name)&&e.push(a.name):(e=e.filter((function(e){return e!==a.name}))).push(a.name);for(var d=s.split('"'),p=0,h=d.length;p<h;p++){var u=d[p].trim(),c=u.split(/[ .:;?!~,`"&|()<>{}[\]\r\n/\\]+/),g=u.match(/^([^()]+)\((.*)\)$/),m="DistinctCount"===c[0]?"DistinctCount":"PopulationStDev"===c[0]?"PopulationStDev":"SampleStDev"===c[0]?"SampleStDev":"PopulationVar"===c[0]?"PopulationVar":"SampleVar"===c[0]?"SampleVar":c[0];if(-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar","Median"].indexOf(m)){var f=-1===e.indexOf(c[1])&&g[2]?e.indexOf(g[2]):e.indexOf(c[1]);o.calculatedFormulas[a.name]?o.calculatedFormulas[a.name].push({index:f,type:m,formula:u}):o.calculatedFormulas[a.name]=[{index:f,type:m,formula:u}]}}},o=this,l=0,d=n.length;l<d;l++)s(l);this.fields=e},e.prototype.validateFilters=function(e){this.isValueFiltersAvail=!1;var i=e.filterSettings?e.filterSettings:[],a=(0,t.extend)([],this.dataSourceSettings.rows,null,!0);a=a.concat(this.dataSourceSettings.columns);for(var r=0,n=i;r<n.length;r++){for(var s=n[r],o=0,l=a;o<l.length;o++){var d=l[o];if(s.name===d.name&&"Value"===s.type){this.isValueFiltersAvail=!0;break}}if(this.isValueFiltersAvail)break}},e.prototype.validateValueFields=function(){this.isValueHasAdvancedAggregate=!1;for(var e=0,t=this.dataSourceSettings.values;e<t.length;e++){var i=t[e];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(i.type)){this.isValueHasAdvancedAggregate=!0;break}}},e.prototype.fetchFieldMembers=function(e){var t=this.fieldList[e].index;this.generateMembers(t,new Set)},e.prototype.generateMembers=function(e,i){var a=this.data.length,n=this.fields,s=this.fieldList,o=n[e];s[o].members&&!this.allowDataCompression||(s[o].members={},this.allowDataCompression&&(s[o].isMembersFilled=!1)),s[o].dateMember&&!this.allowDataCompression||(s[o].dateMember=[]);var l=s[o].members,d=s[o].dateMember;if((s[o].isSelected||i.has(e))&&!s[o].isMembersFilled){for(var p=Object.keys(l).length>0,h=0,u=s[o].expandAll,c=r.isDateField(o,this),g=0;g<a;g++){var m=this.data[g][this.fieldKeys[o]],f=m;if(f=this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(f):f,!p){var S=c?this.getFormattedValue(f,o):{formattedText:null===f?this.localeObj?this.localeObj.getConstant("null"):String(f):void 0===f?this.localeObj?o in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(f):f.toString(),actualText:null===f?this.localeObj?this.localeObj.getConstant("null"):String(f):void 0===f?this.localeObj?o in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(f):f};Object.prototype.hasOwnProperty.call(l,f)?l[f].index.push(g):(h++,l[f]={index:[g],ordinal:h,isDrilled:this.isExpandAll||u,caption:S.formattedText},d.push({formattedText:S.formattedText,actualText:c?S.dateText:S.actualText}))}var v=(0,t.isNullOrUndefined)(m)?m:"number"===s[o].type?isNaN(Number(m))?void 0:Number(m):1,y={ordinal:l[f].ordinal,member:v};this.valueMatrix[g]||(this.valueMatrix[g]=[]),this.valueMatrix[g][e]=y}s[o].isMembersFilled=!0}},e.prototype.fillFieldMembers=function(){var e=this.fields,t=this.fieldList,i=e.length;this.data.length-this.valueMatrix.length<0&&(this.valueMatrix=this.valueMatrix.slice(0,this.data.length));var a=new Set;if(this.calculatedFormulas&&Object.keys(this.calculatedFormulas).length>0)for(var r in this.calculatedFormulas)if(t[r]&&t[r].isSelected)for(var n=this.calculatedFormulas[r],s=0;s<n.length;s++){var o=n[s];a.add(o.index)}for(var l=0;l<i;l++)this.generateMembers(l,a)},e.prototype.generateValueMatrix=function(){for(var e=this.fields,i=this.data.length,a=e.length,r=this.fieldList;i--;)for(var n=a;n--;){var s=e[n],o=r[s];if(o.isMembersFilled){var l=this.data[i][this.fieldKeys[s]];this.valueMatrix[i][n].member=(0,t.isNullOrUndefined)(l)?l:"number"===o.type?isNaN(Number(l))?void 0:Number(l):1}}},e.prototype.updateSortSettings=function(e,t){for(var i=0,a=e?e.length:0;i<a&&t;i++)this.fieldList[e[i].name]&&(this.fieldList[e[i].name].sort=e[i].order)},e.prototype.updateFilterMembers=function(e){var t=this.filterMembers,i={},a=this.getFilters(e,i),r=this.valueMatrix.length;if(a)for(var n=i.include.index,s=0;s<n.length;s++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[n[s]]||t.push(n[s]);else for(s=0;s<r;s++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[s]||t.push(s)},e.prototype.getFilters=function(e,t){for(var i=e.filterSettings?e.filterSettings:[],a=!1,r=[],n=0,s=i.length;n<s;n++){var o=i[n].properties?i[n].properties:i[n];this.fieldList[o.name]&&this.fieldList[o.name].isSelected&&this.isValidFilterField(o,e.allowMemberFilter,e.allowLabelFilter)&&(this.applyLabelFilter(o),o&&(r=o.items),o.type&&"Include"===o.type?(this.frameFilterList(r,o.name,t,"include",o.showLabelFilter,a),a=!0):this.frameFilterList(r,o.name,t,"exclude",o.showLabelFilter),o.showLabelFilter&&(o.items=[],o.type=o.showDateFilter?"Date":o.showNumberFilter?"Number":"Label"))}return a},e.prototype.isValidFilterField=function(e,i,a){var r=e.name,n=!1,s=(0,t.extend)([],this.dataSourceSettings.rows,null,!0);if(s=s.concat(this.dataSourceSettings.columns),this.fieldList[r].isSelected&&i&&["Include","Exclude"].indexOf(e.type)>=0){n=!0;for(var o=0,l=this.dataSourceSettings.values;o<l.length;o++){if(r===l[o].name){n=!1;break}}}else if(a)for(var d=0,p=s;d<p.length;d++){if(r===p[d].name&&["Label","Date","Number"].indexOf(e.type)>=0){n=!0;break}}return n},e.prototype.applyLabelFilter=function(e){if(["Label","Date","Number"].indexOf(e.type)>=0){var t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type){e.showDateFilter=!0;var i="string"==typeof e.value1?new Date(e.value1):e.value1,a="string"==typeof e.value2?new Date(e.value2):e.value2;e.items=this.getDateFilterMembers(t,e.name,e.condition,i,a)}else{e.showNumberFilter=!0,e.items=[];for(var r=0,n=t;r<n.length;r++){var s=n[r],o=this.getParsedValue(e.name,e.value1),l=this.getParsedValue(e.name,e.value2),d=this.getParsedValue(e.name,s);this.validateFilterValue(d,e.condition,o,l)&&e.items.push(s)}}e.type=e.condition?["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"].indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include":"Exclude"}else e.showLabelFilter=!1},e.prototype.getLabelFilterMembers=function(e,t,i,a){for(var r=[],n=0,s=e;n<s.length;n++){var o=s[n],l=o.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":default:l===i.toLowerCase()&&r.push(o);break;case"BeginWith":case"DoesNotBeginWith":0===l.indexOf(i.toLowerCase())&&r.push(o);break;case"EndsWith":case"DoesNotEndsWith":null!==l.match(i.toLowerCase()+"$")&&r.push(o);break;case"Contains":case"DoesNotContains":l.indexOf(i.toLowerCase())>-1&&r.push(o);break;case"GreaterThan":l>i.toLowerCase()&&r.push(o);break;case"GreaterThanOrEqualTo":l>=i.toLowerCase()&&r.push(o);break;case"LessThan":l<i.toLowerCase()&&r.push(o);break;case"LessThanOrEqualTo":l<=i.toLowerCase()&&r.push(o);break;case"Between":case"NotBetween":l>=i.toLowerCase()&&l<=a.toLowerCase()&&r.push(o)}}return r},e.prototype.getDateFilterMembers=function(e,t,i,a,r){for(var n=[],s=0,o=e;s<o.length;s++){var l=o[s],d=new Date(l);if(a)switch(i){case"Equals":case"DoesNotEquals":default:this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(a.toString(),t).formattedText&&n.push(this.getFormattedValue(l,t).formattedText);break;case"After":d.getTime()>a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"AfterOrEqualTo":d.getTime()>=a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"Before":d.getTime()<a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"BeforeOrEqualTo":d.getTime()<=a.getTime()&&n.push(this.getFormattedValue(l,t).formattedText);break;case"Between":case"NotBetween":d.getTime()>=a.getTime()&&d.getTime()<=r.getTime()&&n.push(this.getFormattedValue(l,t).formattedText)}}return n},e.prototype.validateFilterValue=function(e,t,i,a){var r=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(r=!0);break;case"DoesNotEquals":default:e!==i&&(r=!0);break;case"GreaterThan":e>i&&(r=!0);break;case"GreaterThanOrEqualTo":e>=i&&(r=!0);break;case"LessThan":e<i&&(r=!0);break;case"LessThanOrEqualTo":e<=i&&(r=!0);break;case"Between":e>=i&&e<=a&&(r=!0);break;case"NotBetween":e>=i&&e<=a||(r=!0)}return r},e.prototype.frameFilterList=function(e,t,i,a,r,n){i[a]||(i[a]={indexObject:{},index:[]}),this.updateFilter(e,t,i,a,r,n)},e.prototype.updateFilter=function(e,i,a,n,s,o){var l=0,d=this.fieldList[i];d.filter=e,d.filterType=n,d.isExcelFilter=s;var p=r.getFormattedMembers(d.members,i,this),h=o,u={},c={};for(u[n]={indexObject:{},index:[]},this.fieldFilterMem[i]={memberObj:{}};!(0,t.isNullOrUndefined)(e[l]);){if(p[e[l]]){var g=p[e[l]].index;if("include"===n)for(var m=0,f=g.length;m<f;m++)h&&void 0===a[n].indexObject[g[m]]||(u[n].indexObject[g[m]]=g[m],u[n].index.push(g[m]));else{for(m=0,f=g.length;m<f;m++)void 0===a[n].indexObject[g[m]]&&(a[n].indexObject[g[m]]=g[m],a[n].index.push(g[m]));this.fieldFilterMem[i].memberObj[e[l]]=e[l]}}l++}if("include"===n){a[n]=u[n];for(m=0;m<e.length;m++)p[e[m]]&&(c[e[m]]=e[m]);var S=Object.keys(p);for(m=0,f=S.length;m<f;m++)void 0===c[S[m]]&&(this.fieldFilterMem[i].memberObj[S[m]]=S[m])}},e.prototype.applyValueFiltering=function(e,i,a,r,n,s,o){this.isValueFiltered=!1;var l=(0,t.extend)({},"row"===o&&this.rowGrandTotal?this.rowGrandTotal:"column"===o&&this.columnGrandTotal?this.columnGrandTotal:"Top"!==this.dataSourceSettings.grandTotalsPosition?a[a.length-1]:a[0],null,!0);return this.getFilteredData(a,r,n,s,i,e.name,l,o),this.isValueFiltered&&(("row"===o&&null===this.rowGrandTotal||"column"===o&&null===this.columnGrandTotal)&&s.push(l),a=s),a},e.prototype.getFilteredData=function(e,i,a,r,n,s,o,l){for(var d=e.length,p=0;p<d;p++)if(a[s])if(e[p].level===n){this.isValueFiltered=!0,this.fieldList[s].isExcelFilter=!0;var h=0,u=a[s].measure,c=this.fieldList[u].index,g=this.fieldList[u].aggregateType;this.rawIndexObject={},h="row"===l?this.getAggregateValue(e[p].index,i.indexObject,c,g,!1):this.getAggregateValue(i.index,e[p].indexObject,c,g,!1);var m={fieldName:u,row:e[p],column:i,value:h,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:e[p].hasChild&&e[p].isDrilled?"subTotal":"grand sum"===e[p].type?"grandTotal":"value",columnCellType:i.hasChild&&i.isDrilled?"subTotal":"grand sum"===i.type?"grandTotal":"value",aggregateType:g,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(m),h=m.value,this.rawIndexObject={};var f=this.getParsedValue(u,a[s].value1),S=this.getParsedValue(u,a[s].value2);if(this.validateFilterValue(h,a[s].condition,f,S)||"grand sum"===e[p].type)"grand sum"!==e[p].type&&(r.push((0,t.extend)({},e[p],null,!0)),r[r.length-1].isLevelFiltered=!0);else{var v=this.removefilteredData(e[p],this.valueFilteredData),y=v||e[p];this.validateFilteredParentData(y,this.valueFilteredData,o,0,n,l)}}else e[p].hasChild&&e[p].members.length>0&&"grand sum"!==e[p].type&&(r.push((0,t.extend)({},e[p],null,!0)),r[r.length-1].members=[],r[r.length-1].isLevelFiltered=!0,this.getFilteredData(e[p].members,i,a,r[r.length-1].members,n,s,o,l))},e.prototype.getParsedValue=function(e,i){var a=i?i.toString():"";if(this.formatFields[e]&&i){var r=(0,t.extend)({},this.formatFields[e],null,!0);return delete r.name,this.globalize.parseNumber(a,r)}return this.globalize.parseNumber(a,{format:"N"})},e.prototype.removefilteredData=function(e,i){for(var a,r=(0,t.extend)([],i,null,!0),n=0;n<r.length;n++){if(e.isLevelFiltered&&e.axis===r[n].axis&&e.valueSort.levelName===r[n].valueSort.levelName&&e.actualText===r[n].actualText&&e.axis===r[n].axis&&e.level===r[n].level&&e.ordinal===r[n].ordinal){a=r[n],i.splice(n,1);break}i[n].hasChild&&i[n].members.length>0&&this.removefilteredData(e,i[n].members)}return a},e.prototype.validateFilteredParentData=function(e,t,i,a,r,n){if(t.length>0)for(var s=0,o=t;s<o.length;s++){var l=o[s];if(l.level===a){if("row"===n)for(var d=0,p=u=e.index;d<p.length;d++){var h=p[d];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1),e.valueSort.levelName.toString().indexOf(l.valueSort.levelName.toString())>=0&&l.level!==r&&l.index.indexOf(h)>=0&&l.index.splice(l.index.indexOf(h),1)}else for(var u=e.indexObject,c=0,g=Object.keys(u);c<g.length;c++){h=g[c];Object.prototype.hasOwnProperty.call(u,h)&&(delete i.indexObject[h],e.valueSort.levelName.toString().indexOf(l.valueSort.levelName.toString())>=0&&l.level!==r&&delete l.indexObject[h])}l&&l.members.length>0&&l.members[0].level===a+1&&l.members[0].level!==r&&this.validateFilteredParentData(e,l.members,i,a+1,r,n)}}else if("row"===n)for(var m=0,f=u=e.index;m<f.length;m++){h=f[m];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1)}else{u=e.indexObject;for(var S=0,v=Object.keys(u);S<v.length;S++){h=v[S];Object.prototype.hasOwnProperty.call(u,h)&&delete i.indexObject[h]}}},e.prototype.updateFramedHeaders=function(e,i,a,r,n){for(var s=0,o=e;s<o.length;s++){var l=o[s];this.isHeaderAvail=!1,(this.validateFilteredHeaders(l,a,n)||"grand sum"===l.type)&&("row"===n?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,r.push((0,t.extend)({},l,null,!0)),r[r.length-1].members=[],l.hasChild&&l.isDrilled&&l.members.length>0&&this.updateFramedHeaders(l.members,i,a,r[r.length-1].members,n))}return this.filterFramedHeaders},e.prototype.validateFilteredHeaders=function(e,t,i){for(var a=0,r=t;a<r.length;a++){var n=r[a];if(!this.isHeaderAvail){if(e.actualText===n.actualText&&e.level===n.level&&e.valueSort.levelName===n.valueSort.levelName)return"row"===i?n.index.length>0?(this.isHeaderAvail=!0,e.index=n.index,!0):(this.isHeaderAvail=!1,e.index=n.index,!1):Object.keys(n.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=n.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=n.indexObject,!1);n.hasChild&&n.members.length>0&&"grand sum"!==n.type&&this.validateFilteredHeaders(e,n.members,i)}}return this.isHeaderAvail},e.prototype.isEmptyDataAvail=function(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0),0!==e.length&&0!==t.length||(this.isEmptyData=!0)},e.prototype.updateGridData=function(e){this.updateDataSourceSettings(e,!0),this.data=e.dataSource,this.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(e));for(var t=0,i=this.fields;t<i.length;t++){var a=i[t];this.fieldList[a].members={},this.fieldList[a].dateMember=[],this.fieldList[a].isMembersFilled=!1}this.fillFieldMembers(),this.filterMembers=[],this.cMembers=[],this.rMembers=[],this.updateFilterMembers(e),this.isEditing=!0,this.isDrillThrough=!0,this.generateGridData(e),this.isEditing=!1},e.prototype.generateGridData=function(e,i,a,n){void 0===i&&(i=!1),this.updateDataSourceSettings(e,i);var s=e.columns?e.columns:[],o=this.data,l=e.rows?e.rows:[],d=e.filterSettings,p=e.values?e.values:[];this.removeCount=0,this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;var h=[];if(l[0]&&l[0].showNoDataItems||s[0]&&s[0].showNoDataItems)for(var u=0;u<this.valueMatrix.length;u++)h.push(u);for(u=0;u<this.filterMembers.length;u++)this.filterPosObj[this.filterMembers[u]]=this.filterMembers[u];this.valueSortSettings.columnIndex=void 0,this.validateValueFields(),this.frameDrillObject(),this.isValueFilterEnabled&&!this.isEditing||n||(this.isLastHeaderHasMeasures=!0,this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==l.length&&0!==p.length&&(this.rMembers=this.getIndexedHeaders(l,o,0,l[0].showNoDataItems?h:this.filterMembers,"row","",this.allowValueFilter)),0!==s.length&&0!==p.length&&(this.cMembers=this.getIndexedHeaders(s,o,0,s[0].showNoDataItems?h:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:(0,t.extend)([],this.rMembers,null,!0),columnHeaders:(0,t.extend)([],this.cMembers,null,!0)}:{}),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];var c=[],g=[],m=[],f=[],S=[],v=this.dataSourceSettings.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter&&!n){this.valueFilteredData=[];var y=this.saveDataHeaders.rowHeaders?this.saveDataHeaders.rowHeaders:[],b=this.saveDataHeaders.columnHeaders?this.saveDataHeaders.columnHeaders:[];if(d.length>0){for(var C={},x={},w=0,T=p;w<T.length;w++){var M=T[w];x[M.name]=M}for(var D=0,O=d;D<O.length;D++){var P=O[D];y=m.length>0?m:y,b=f.length>0?f:b,this.valueFilteredData=[];var N=P.properties?P.properties:P;if("Value"===N.type&&this.fieldList[P.name]&&this.fieldList[P.name].isSelected){C[P.name]=P,N.items=[];for(var E=!1,I=l.length,F=s.length,L=0;L<I;L++)if(N.name===l[L].name&&x[N.measure]&&!E){E=!0,m=this.applyValueFiltering(l[L],L,y,this.columnGrandTotal?this.columnGrandTotal:"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?b[0]:b[b.length-1],C,this.valueFilteredData,"row");break}for(var A=0;A<F;A++)if(N.name===s[A].name&&x[N.measure]&&!E){E=!0,f=this.applyValueFiltering(s[A],A,b,this.rowGrandTotal?this.rowGrandTotal:"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?y[0]:y[y.length-1],C,this.valueFilteredData,"column");break}}}}m=m.length>0?m:y,f=f.length>0?f:b,this.isEmptyDataAvail(m,f);var R=r.getClonedFieldList(this.fieldList),k=this.data[0];this.getFieldList(k,this.enableSort,e.allowValueFilter),this.fillFieldMembers(),this.updateSortSettings(e.sortSettings,this.enableSort),this.filterMembers=[],this.updateFilterMembers(e),this.isLastHeaderHasMeasures=!0,this.rMembers=0!==l.length?this.getIndexedHeaders(l,o,0,l[0].showNoDataItems?h:this.filterMembers,"row",""):[],this.cMembers=0!==s.length?this.getIndexedHeaders(s,o,0,s[0].showNoDataItems?h:this.filterMembers,"column",""):[],this.insertAllMembersCommon(),this.updateFieldList(R),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,m,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,f,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}n||this.applyValueSorting(),this.isPagingOrVirtualizationEnabled&&(n?(this.rMembers=n.rowHeaders,this.cMembers=n.columnHeaders,this.rowCount=n.rowHeadersCount,this.columnCount=n.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues()),!this.valueAxis&&this.isLastHeaderHasMeasures&&this.getAggregatedHeaders(l,s,this.rMembers,this.cMembers,p),this.getHeaderData(l,s,p,S,this.cMembers,g,this.pivotValues,0,this.valueAxis?1:v),this.insertSubTotals(),this.getTableData(S.length>0?S:this.rMembers,c,g,0,this.pivotValues,v,0,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(c,g,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers),this.clearProperties(a)},e.prototype.updateHeaders=function(e,i){e=(0,t.isNullOrUndefined)(e)?!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)||!(this.dataSourceSettings.rows.length>0):e,(this.pageSettings&&this.removeRowGrandTotal||!e&&!this.rowGrandTotal)&&"grand sum"===this.rMembers[this.rMembers.length-1].type&&(this.rMembers=this.rMembers.slice(0,this.rMembers.length-1)),i=(0,t.isNullOrUndefined)(i)?!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||!(this.dataSourceSettings.columns.length>0):i,(this.pageSettings&&this.removeColumnGrandTotal||!i&&!this.columnGrandTotal)&&"grand sum"===this.cMembers[this.cMembers.length-1].type&&(this.cMembers=this.cMembers.slice(0,this.cMembers.length-1))},e.prototype.updatePivotValues=function(e){var t=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)||!(this.dataSourceSettings.rows.length>0),i=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||!(this.dataSourceSettings.columns.length>0);if(e&&this.updateHeaders(t,i),(this.pageSettings&&this.removeRowGrandTotal||!t&&!this.rowGrandTotal)&&this.valueContent.length>0){var a=1;this.valueAxis&&this.dataSourceSettings.values.length>0&&(a=1+this.dataSourceSettings.values.length),this.pivotValues[this.pivotValues.length-a]&&"grand sum"===this.pivotValues[this.pivotValues.length-a][0].type&&(this.pivotValues=this.pivotValues.slice(0,this.pivotValues.length-a),this.valueContent=this.valueContent.slice(0,this.valueContent.length-a))}if((this.pageSettings&&this.removeColumnGrandTotal||!i&&!this.columnGrandTotal)&&this.headerContent.length>0){a=this.dataSourceSettings.values.length;if(this.valueAxis&&this.dataSourceSettings.values.length>0&&(a=1),this.pivotValues[0][this.pivotValues[0].length-a]&&"grand sum"===this.pivotValues[0][this.pivotValues[0].length-a].type)for(var r=0;r<this.pivotValues.length;r++)if(this.pivotValues[r]&&(this.pivotValues[r]=this.pivotValues[r].slice(0,this.pivotValues[r].length-a)),this.headerContent[r])for(var n=this.pivotValues[r].length;n<this.pivotValues[r].length+a;n++)delete this.headerContent[r][n]}this.removeRowGrandTotal=this.removeColumnGrandTotal=!1},e.prototype.onDrill=function(e){this.frameDrillObject(e);var t=this.getHeadersInfo(e.fieldName,e.axis);this.performDrillOperation(t.headers,e,t.fields,t.position,0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount,"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers,this.updateEngine()},e.prototype.onSort=function(e){var t=this.getHeadersInfo(e.name,"");this.fieldList[e.name].sort=e.order,this.performSortOperation(t.headers,e,t,0),this.updateEngine()},e.prototype.onFilter=function(e,t){this.updateDataSourceSettings(t,!0);var i=this.getHeadersInfo(e.name,"");this.isLastHeaderHasMeasures=!!(this.valueAxis&&"row"===i.axis||!this.valueAxis&&"column"===i.axis)||this.isLastHeaderHasMeasures,"Include"===e.type&&e.items.length===this.fieldList[e.name].dateMember.length?(this.fieldList[e.name].filter=[],this.fieldList[e.name].filterType=""):(this.fieldList[e.name].filter=e.items,this.fieldList[e.name].filterType=e.type);for(var a={},r=0,n=this.filterMembers;r<n.length;r++){var s=n[r];a[s]=s}this.filterMembers=[],this.fieldFilterMem={},this.updateFilterMembers(t);for(var o=this.filterMembers.filter((function(e){return void 0===a[e]})),l={},d=0,p=e.items;d<p.length;d++){var h=p[d];l[h]=h}var u=this.dataSourceSettings.rows[0]&&this.dataSourceSettings.rows[0].showNoDataItems||this.dataSourceSettings.columns[0]&&this.dataSourceSettings.columns[0].showNoDataItems;if(u&&this.columnKeys[e.name]?u=!(!this.dataSourceSettings.columns[0]||!this.dataSourceSettings.columns[0].showNoDataItems):u&&"row"===i.axis&&(u=!(!this.dataSourceSettings.rows[0]||!this.dataSourceSettings.rows[0].showNoDataItems)),u){var c=[];this.filterPosObj={};for(var g=0;g<o.length;g++)this.filterPosObj[o[g]]=o[g];for(g=0;g<this.valueMatrix.length;g++)c.push(g);o=c}this.performFilterCommonUpdate(e,i,o),this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.updateEngine()},e.prototype.onAggregation=function(e){this.fieldList[e.name].aggregateType=e.type,this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.allowDataCompression&&(this.data=this.getGroupedRawData(this.dataSourceSettings),this.generateValueMatrix()),this.updateEngine()},e.prototype.onCalcOperation=function(e,t){this.dataSourceSettings.calculatedFieldSettings=t.calculatedFieldSettings?t.calculatedFieldSettings:[],this.dataSourceSettings.values=t.values?t.values:[],this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.getCalculatedField(this.fields),this.fieldList[e.name]?this.fieldList[e.name].formula=e.formula:(this.fieldList[e.name]={id:e.name,caption:e.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:e.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.dataSourceSettings.values.length-1)*this.dataSourceSettings.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.dataSourceSettings.values.length-1)*this.dataSourceSettings.values.length),this.getFormattedFields(t),this.fillFieldMembers(),this.updateEngine()},e.prototype.performDrillOperation=function(e,t,i,a,r){for(var n=0;n<e.length;){if(a===r){var s=e[n].valueSort.levelName.split(this.valueSortSettings.headerDelimiter);if(t.memberName===s.join(t.delimiter?t.delimiter:"**")){if("down"===t.action){e[n].isDrilled=!0,e[n].members=this.getIndexedHeaders(i,this.data,a+1,e[n].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter));var o=void 0;if("row"===t.axis)o=this.applyValueSorting(e[n].members,this.cMembers),e[n].members=o.rMembers,this.rowCount+=this.showSubTotalsAtBottom?1:0;else{var l=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&i[a].showSubTotals;this.columnCount-=l?0:this.colValuesLength,o=this.applyValueSorting(this.rMembers,e[n].members),e[n].members=o.cMembers}}else e[n].isDrilled=!1,this.updateHeadersCount(e[n].members,t.axis,a,i,"minus",!0),e[n].members=[],"row"===t.axis&&(this.rowCount-=this.showSubTotalsAtBottom?1:0);break}}else e[n].members.length>0&&(e[n].members=this.performDrillOperation(e[n].members,t,i,a,r+1));n++}return e},e.prototype.performSortOperation=function(e,t,i,a){for(var r=0;r<e.length;){if(i.position===a){e=this.getSortedHeaders(e,t.order.toString());break}e[r].members.length>0&&(e[r].members=this.performSortOperation(e[r].members,t,i,a+1)),r++}return e},e.prototype.performFilterDeletion=function(e,t,i,a,r){for(var n=0,s=!0,o=function(){if(i.position===r){var o=l;e=e.filter((function(e){return""!==o.fieldFilterMem[t.name].memberObj[e.formattedText]&&(!o.fieldFilterMem[t.name].memberObj[e.formattedText]||"grand sum"===e.type)})),s=!1}else e[n].members.length>0&&(e[n].members=l.performFilterDeletion(e[n].members,t,i,a,r+1));n++},l=this;n<e.length&&s;)o();var d=this;return e.filter((function(e){return e.members.length>0||"grand sum"===e.type||d.matchIndexes(e.indexObject,a)}))},e.prototype.matchIndexes=function(e,t){var i=Object.keys(e),a=i.length;if(0===a)return!0;for(;a>-1;){if(void 0!==t[e[i[a]]])return!0;a--}return!1},e.prototype.performFilterAddition=function(e,t,i){for(var a=0,r=function(){var r=e[a].valueSort.levelName;if(n.headerObjectsCollection[r]){for(var s={},o=0,l=e[a].members;o<l.length;o++){var d=l[o];s[d.valueSort.levelName.toString()]=d.valueSort.levelName.toString()}var p=n.headerObjectsCollection[r].filter((function(e){return!s[e.valueSort.levelName.toString()]}));e[a].members=e[a].members.concat(p),e[a].members=n.getSortedHeaders(e[a].members,n.fieldList[i.fields[e[a].members[0].level].name].sort),delete n.headerObjectsCollection[r]}e[a].members.length>0&&(e[a].members=n.performFilterAddition(e[a].members,t,i)),a++},n=this;a<e.length;)r();return e},e.prototype.performFilterCommonUpdate=function(e,t,i){if("row"===t.axis||"column"===t.axis){for(var a="row"===t.axis?this.rMembers:this.cMembers,r={},n=0,s=this.filterMembers;n<s.length;n++){var o=s[n];r[o]=o}if(this.fieldFilterMem[e.name]&&(a=this.performFilterDeletion(t.headers,e,t,r,0)),i.length>0&&t.fields.length>0){if(this.frameHeaderObjectsCollection=!0,t.fields.filter((function(e){return e.showNoDataItems})).length>0)for(var l=0;l<this.data.length;l++)i.push(l);this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,""),a=this.performFilterAddition(a,t.fields,t);for(var d={},p=0,h=a;p<h.length;p++){var u=h[p];d[u.valueSort.levelName.toString()]=u.valueSort.levelName.toString()}var c=this.headerObjectsCollection.parent.filter((function(e){return!d[e.valueSort.levelName.toString()]})),g=a.filter((function(e){return"grand sum"===e.type}));g.length>0&&a.pop(),a=this.getSortedHeaders(a.concat(c),this.fieldList[t.fields[0].name].sort).concat(g),"row"===t.axis?(this.cMembers=this.getIndexedHeaders(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column",""),this.insertAllMember(this.cMembers,this.filterMembers,"","column")):(this.rMembers=this.getIndexedHeaders(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row",""),this.insertAllMember(this.rMembers,this.filterMembers,"","row"))}"row"===t.axis?this.rowCount=0:this.columnCount=0,this.updateHeadersCount(a,t.axis,0,t.fields,"plus",!1),"row"===t.axis?(t.position>0&&this.insertPosition(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row","",a),this.insertTotalPosition(a),this.rMembers=this.headerCollection.rowHeaders=a,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column","",a),this.insertTotalPosition(a),this.cMembers=this.headerCollection.columnHeaders=a,this.headerCollection.columnHeadersCount=this.columnCount)}else{var m=this.dataSourceSettings.rows[0]&&this.dataSourceSettings.rows[0].showNoDataItems||this.dataSourceSettings.columns[0]&&this.dataSourceSettings.columns[0].showNoDataItems;this.rMembers=this.getIndexedHeaders(this.dataSourceSettings.rows,this.data,0,m?i:this.filterMembers,"row",""),this.cMembers=this.getIndexedHeaders(this.dataSourceSettings.columns,this.data,0,m?i:this.filterMembers,"column",""),this.insertAllMembersCommon(),this.rowCount=0,this.columnCount=0,this.updateHeadersCount(this.cMembers,"column",0,this.dataSourceSettings.columns,"plus",!1),this.updateHeadersCount(this.rMembers,"row",0,this.dataSourceSettings.rows,"plus",!1),m&&(this.insertPosition(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row","",this.rMembers),this.insertPosition(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column","",this.cMembers)),this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.columnHeadersCount=this.columnCount}this.applyValueSorting()},e.prototype.getHeadersInfo=function(e,t){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders;for(var i="row"===(t=""===t?this.getAxisByFieldName(e):t)?this.rMembers:this.cMembers,a="row"===t?this.dataSourceSettings.rows:this.dataSourceSettings.columns,r=0,n=0,s=a;n<s.length;n++){if(s[n].name===e)break;r++}return{axis:t,fields:a,headers:i,position:r}},e.prototype.updateEngine=function(){this.removeCount=0,this.validateValueFields(),this.calculatePagingValues(),this.pivotValues=[],this.headerContent=[],this.valueContent=[];var e=[],t=[],i=[],a=this.dataSourceSettings.values.length;this.getAggregatedHeaders(this.dataSourceSettings.rows,this.dataSourceSettings.columns,this.rMembers,this.cMembers,this.dataSourceSettings.values),this.getHeaderData(this.dataSourceSettings.rows,this.dataSourceSettings.columns,this.dataSourceSettings.values,i,this.cMembers,t,this.pivotValues,0,this.valueAxis?1:a),this.insertSubTotals(),this.getTableData(i.length>0?i:this.rMembers,e,t,0,this.pivotValues,a,0,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(e,t,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.getAxisByFieldName=function(e){for(var t=0,i="";t<4&&""===i;){switch(t){case 0:i=this.getFieldByName(e,this.dataSourceSettings.rows)?"row":"";break;case 1:i=this.getFieldByName(e,this.dataSourceSettings.columns)?"column":""}t++}return i},e.prototype.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.updateHeadersCount=function(e,t,i,a,r,n){var s=0,o=a[i],l=!0;for(l="column"===t?this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&(!o||o.showSubTotals):this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals&&(!o||o.showSubTotals);s<e.length;)"row"===t?this.rowCount=this.rowCount-("plus"===r?-(1===this.valueAxis?this.dataSourceSettings.values.length:1):1===this.valueAxis?this.dataSourceSettings.values.length:1):this.columnCount=this.columnCount-("plus"===r?-(1===this.valueAxis?1:this.dataSourceSettings.values.length):1===this.valueAxis?1:this.dataSourceSettings.values.length),e[s].members.length>0&&(this.updateHeadersCount(e[s].members,t,i+1,a,r,!0),"row"===t&&(this.rowCount+=this.showSubTotalsAtBottom&&e[s].hasChild&&e[s].isDrilled?1:0)),s++;"column"===t&&!l&&n&&(this.columnCount+="plus"===r?-this.colValuesLength:this.colValuesLength)},e.prototype.getSortedHeaders=function(e,t){var i="Grand Total"!==e[0].actualText?e[0].valueSort.axis:e[1].valueSort.axis,a=!(this.formatFields&&this.formatFields[i]&&this.formatFields[i].type),r=this.fieldList[i];if(a){if(r&&"number"===r.type&&e.length>0&&"string"==typeof e[0].actualText){for(var n=[],s=[],o=[],l=0;l<e.length;l++)if(isNaN(Number(e[l].actualText.toString().charAt(0))))n.push(e[l]);else{if(""!==e[l].actualText){s.push(e[l]);break}o.push(e[l])}return s.length>0&&(s=this.sortHeaders(i,r,e,r.sort,r.isAlphanumeric)),e}return this.sortHeaders(i,r,e,t,r.type)}return this.sortHeaders(i,r,e,t,r.type)},e.prototype.sortHeaders=function(e,i,a,n,s){var o=!1,l=this.fieldList[e]&&this.fieldList[e].membersOrder?this.fieldList[e].membersOrder.slice():[],d={fieldName:e,sortOrder:n,members:l&&l.length>0?l:Object.keys(i.members),IsOrderChanged:!1},p="datetime"===(s="datetime"===s||"date"===s||"time"===s?this.formatFields[e]&&["date","dateTime","time"].indexOf(this.formatFields[e].type)>-1?s:"string":s)||"date"===s||"time"===s,h=!1;if(this.dataSourceSettings.groupSettings.length>0){var u=this.dataSourceSettings.groupSettings.filter((function(e){return e.name===i.id}));!(0,t.isNullOrUndefined)(u)&&u.length>0&&(h="number"===u[0].type.toLocaleLowerCase()&&"string"===i.type.toLocaleLowerCase())}if(l&&l.length>0?r.applyCustomSort(d,a,s):(r.applyHeadersSort(a,n,s,h),o=!0),o&&this.getHeaderSortInfo){for(var c=[],g=0,m=0;g<a.length;g++){var f=a[g],S=p?f.dateText:f.actualText;"Grand Total"!==f.actualText&&(c[m++]=S)}d.members=c}return this.getHeaderSortInfo&&this.getHeaderSortInfo(d),d.IsOrderChanged&&r.applyCustomSort(d,a,s,!0),a},e.prototype.applyValueSorting=function(e,t){var i=!1;if(void 0===e||void 0===t){if(this.valueSortHeaderText=void 0,this.enableValueSorting&&this.valueSortSettings.headerText&&!this.valueSortHeaderText&&""!==this.valueSortSettings.headerText&&this.dataSourceSettings.values.length>0){this.valueSortHeaderText=this.valueSortSettings.headerText;for(var a=this.valueSortHeaderText.split(this.valueSortSettings.headerDelimiter),r=0,n=this.dataSourceSettings.values;r<n.length;r++){var s=n[r],o=s.caption?s.caption:s.name,l=a.indexOf(o);if(l>-1){a.splice(l,1),a.push(o),this.valueSortHeaderText=a.join(this.valueSortSettings.headerDelimiter);break}}}e=this.rMembers,t=this.cMembers,i=!0}if(this.valueSortHeaderText){a=this.valueSortHeaderText.split(this.valueSortSettings.headerDelimiter);for(var d="",p=void 0,h=void 0,u=void 0,c=0;c<this.dataSourceSettings.values.length;c++){if(this.dataSourceSettings.values[c].caption===a[a.length-1]){u=this.dataSourceSettings.values[c].name;break}u=a[a.length-1]}if((1===this.dataSourceSettings.values.length&&0===this.dataSourceSettings.columns.length||this.dataSourceSettings.values.length>1)&&u&&this.fieldList[u]){for(c=0;c<a.length-1;c++)d=""===d?a[c]:d+this.valueSortSettings.headerDelimiter+a[c];p=this.fieldList[u].index,h=this.fieldList[u].aggregateType}else{if(this.dataSourceSettings.alwaysShowValueHeader&&1!==a.length)for(c=0;c<a.length-1;c++)d=""===d?a[c]:d+this.valueSortSettings.headerDelimiter+a[c];else d=this.valueSortHeaderText;p=this.fieldList[this.dataSourceSettings.values[0].name].index,h=this.fieldList[this.dataSourceSettings.values[0].name].aggregateType}var g=void 0;0===this.valueAxis?(g=this.getMember(t,d))&&(e=this.sortByValueRow(e,g,this.valueSortSettings.sortOrder,p,h)):(g=this.getMember(e,d))&&(t=this.sortByValueRow(t,g,this.valueSortSettings.sortOrder,p,h)),i&&(this.rMembers=e,this.cMembers=t,this.isPagingOrVirtualizationEnabled&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:e,cMembers:t}},e.prototype.getMember=function(e,t){for(var i,a=e.length,r=0;r<a;r++){if(e[r].valueSort.levelName===t){i=e[r];break}if(e[r].members.length>0&&(i=this.getMember(e[r].members,t)),i)return i}return i},e.prototype.sortByValueRow=function(e,t,i,a,n){for(var s=[],o=0,l=e;o<l.length;o++){if("grand sum"===(c=l[o]).type)s.push({header:c});else{this.rawIndexObject={};var d=this.getAggregateValue(c.index,t.indexObject,a,n,!1),p={fieldName:this.fields[a],row:c,column:t,value:d,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:c.hasChild&&c.isDrilled?"subTotal":"grand sum"===c.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:n,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(p),d=p.value,this.rawIndexObject={},s.push({header:c,value:d})}}for(var h=0,u=e=r.getSortedValue(s,i);h<u.length;h++){var c;(c=u[h]).members.length>0&&(c.members=this.sortByValueRow(c.members,t,i,a,n))}return e},e.prototype.insertAllMembersCommon=function(){this.rowGrandTotal=this.columnGrandTotal=null;var e=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)||!(this.dataSourceSettings.rows.length>0),t=!(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||!(this.dataSourceSettings.columns.length>0);this.isValueHasAdvancedAggregate?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),e&&(this.rowCount+=this.rowValuesLength),this.insertAllMember(this.cMembers,this.filterMembers,"","column"),t&&(this.columnCount+=this.colValuesLength)):(e?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),this.rowCount+=this.rowValuesLength):this.rowGrandTotal=this.insertAllMember([],this.filterMembers,"","row")[0],t?(this.insertAllMember(this.cMembers,this.filterMembers,"","column"),this.columnCount+=this.colValuesLength):this.columnGrandTotal=this.insertAllMember([],this.filterMembers,"","column")[0])},e.prototype.insertSubTotals=function(){for(var e=this.pivotValues.length,i=0;i<e;i++){var a=this.pivotValues[i];if(a)for(var r=void 0,n=1,s=a.length,o=void 0,l=1,d=this.showSubTotalsAtTop?this.reformAxisCount:s,p=this.showSubTotalsAtTop?l:d-1,h=void 0,u=void 0;l<d;){var c=a[p];if(c){r&&(r.colSpan=n,r.colIndex=this.showSubTotalsAtTop?r.colIndex+(n-1):r.colIndex-(n-1)),this.showSubTotalsAtTop&&(h=u=this.getMemberSpanCount(this.pivotValues[i],p)),o={index:c.index,indexObject:c.indexObject},c.index=[],c.indexObject={},r=(0,t.extend)({},c,null,!0),c.index=o.index,c.indexObject=o.indexObject;for(var g=i+1;this.pivotValues[g]&&!this.pivotValues[g][p];){var m=this.pivotValues[i][p];m.isDrilled||!this.valueAxis&&!this.isLastHeaderHasMeasures&&m.members&&m.members.length>0&&g>this.measureIndex||(m.rowSpan=g-i+1,r.rowSpan=g-i+1);var f="sum"===c.type||"grand sum"===c.type?c.type:"sum";this.pivotValues[g][p]=this.headerContent[g][p]={type:f,formattedText:"sum"===c.type||"grand sum"===c.type?c.formattedText:c.formattedText+" Total",axis:"column",hierarchyName:c.hierarchyName,level:-1,colIndex:p,rowIndex:g,valueSort:c.valueSort},c.valueSort&&c.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=p);var S=!1;"grand sum"===f?(m.rowSpan=g-i+1,r.rowSpan=g-i+1):"sum"!==m.type&&(m.isDrilled||this.valueAxisFields[m.actualText]&&!this.valueAxis&&!this.isLastHeaderHasMeasures&&m.members&&m.members.length>0)?(this.pivotValues[i+1][p].rowSpan=g-i,S=!0):this.pivotValues[g][p].rowSpan=-1,g>i+1&&("sum"===m.type||S)&&(this.pivotValues[g][p].rowSpan=-1),g++}n=1}else a[p]=this.headerContent[i][p]=(0,t.extend)({},r,null,!0),a[p].index=this.headerContent[i][p].index=o.index,a[p].indexObject=this.headerContent[i][p].indexObject=o.indexObject,n++,this.showSubTotalsAtTop?(u--,a[p].colSpan=u,a[p].colIndex=a[p].colIndex+(n-1)):(a[p].colSpan=n,a[p].colIndex=a[p].colIndex-(n-1));if(1===p&&r&&(this.showSubTotalsAtTop?(r.colSpan=h,r.colIndex=r.colIndex+(n-1)):(r.colSpan=n,r.colIndex=r.colIndex-(n-1))),this.showSubTotalsAtTop&&(a[p+1]||p+1===this.reformAxisCount)){var v=this.pivotValues[i][p-n+1];v.colSpan=h,this.pivotValues[i][p-n+1]=v}p=this.showSubTotalsAtTop?p+1:p-1,l++}}},e.prototype.getMemberSpanCount=function(e,t){for(var i=1,a=t+1;a<this.reformAxisCount&&!e[a];a++)i++;return i},e.prototype.frameDrillObject=function(e){void 0===e&&(e=null),this.fieldDrillCollection={};for(var t=0;t<this.drilledMembers.length;t++){for(var i=this.drilledMembers[t],a=!1,r=1,n=!1,s=this.fieldList[i.name],o=s&&s.expandAll,l=0;l<this.dataSourceSettings.rows.length;l++)if(this.dataSourceSettings.rows[l].name===i.name){r=((d=this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.measureIndex>-1&&this.measureIndex<=l)?l+1:l)+1,a=!!d,n=!0;break}if(!n)for(l=0;l<this.dataSourceSettings.columns.length;l++)if(this.dataSourceSettings.columns[l].name===i.name){var d;r=((d=!this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.measureIndex>-1&&this.measureIndex<=l)?l+1:l)+1,a=!!d,n=!0;break}for(var p=0,h=i.items;p<h.length;p++){var u=h[p],c=u.split(i.delimiter);if(r===c.length){var g=i.name+this.valueSortSettings.headerDelimiter+c.join(this.valueSortSettings.headerDelimiter);if(this.fieldDrillCollection[g]=g,a){var m=!1;if(this.isExpandAll||o)for(var f=0,S=this.dataSourceSettings.values;f<S.length;f++){var v=S[f],y=v.caption?v.caption:v.name;if(c[this.measureIndex]=y,!(i.items.indexOf(c.join(i.delimiter))>-1)){m=!1;break}m=!0}((this.isExpandAll||o)&&m||!this.isExpandAll||!o)&&((c=u.split(i.delimiter)).splice(this.measureIndex,1),e&&e.memberName===u&&(e.memberName=c.join(i.delimiter)),g=i.name+this.valueSortSettings.headerDelimiter+c.join(this.valueSortSettings.headerDelimiter),this.fieldDrillCollection[g]=g)}}}}},e.prototype.getIndexedHeaders=function(e,i,a,r,n,s,o){var l=[],d=0;if(e&&e.length>0){d++;var p=e.length,h={},u=e[a].name,c=e[a],g=this.fieldList[u];if((0,t.isNullOrUndefined)(this.reportDataType)){this.reportDataType={};for(var m=0;m<this.dataSourceSettings.rows.length;m++)this.reportDataType[this.dataSourceSettings.rows[m].name]=this.dataSourceSettings.rows[m].dataType;for(m=0;m<this.dataSourceSettings.columns.length;m++)this.reportDataType[this.dataSourceSettings.columns[m].name]=this.dataSourceSettings.columns[m].dataType;for(m=0;m<this.dataSourceSettings.values.length;m++)this.reportDataType[this.dataSourceSettings.values[m].name]=this.dataSourceSettings.values[m].dataType}g.type=(0,t.isNullOrUndefined)(this.reportDataType[g.id])?g.type:this.reportDataType[g.id];var f=!1,S=this.formatFields[u]&&["date","dateTime","time"].indexOf(this.formatFields[u].type)>-1,v=r.length<1&&a>0||c.showNoDataItems,y={};if(v){for(var b=Object.keys(g.members),C=0,x=b.length;C<x;C++)(this.dataSourceSettings.showHeaderWhenEmpty||this.localeObj&&b[C]!==this.localeObj.getConstant("undefined"))&&(y[b[C]]=b[C]);r.length<1&&(f=!0,r.length=b.length)}n===this.dataSourceSettings.valueAxis&&this.measureIndex===a&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(this.isLastHeaderHasMeasures=!1);for(C=0,x=r.length;C<x;C++){var w={};(0,t.isNullOrUndefined)(e[a].showSubTotals)||e[a].showSubTotals||(w.showSubTotals=!1),w.hasChild=a<p-1,w.level=a,w.axis=n,w.colSpan=1;var T=f?g.members[Object.keys(y)[0]].ordinal:this.valueMatrix[r[C]][g.index].ordinal,M=f?Object.keys(y)[0]:i[r[C]][this.fieldKeys[u]];if(M=this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(M):M,!((0,t.isNullOrUndefined)(M)||this.localeObj&&M===this.localeObj.getConstant("undefined"))||this.dataSourceSettings.showHeaderWhenEmpty){if(delete y[M],!v||!this.fieldFilterMem[u]||this.fieldFilterMem[u].memberObj[M]!==M){var D=S?{actualText:M,formattedText:g.dateMember[T-1].formattedText,dateText:g.dateMember[T-1].actualText}:{formattedText:null===M?this.localeObj?this.localeObj.getConstant("null"):String(M):void 0===M&&this.localeObj?u in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(M),actualText:null===M?this.localeObj?this.localeObj.getConstant("null"):String(M):void 0===M?this.localeObj?u in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(M):M};w.actualText=D.actualText,w.formattedText=D.formattedText,S&&(w.dateText=D.dateText);var O=!v||void 0!==this.filterPosObj[r[C]]&&!f,P=!1;if(v&&g.filter.length>0&&"include"===g.filterType&&(P=!0),h&&h[T]||P&&!(P&&g.filter.indexOf(M.toString())>-1))O&&(h[T].index.push(r[C]),h[T].indexObject[r[C]]=r[C]);else{h[T]={index:[],indexObject:{}},w.index=h[T].index,w.indexObject=h[T].indexObject,O&&(w.index=h[T].index=[r[C]],h[T].indexObject[r[C]]=r[C],w.indexObject=h[T].indexObject),w.ordinal=T,w.valueSort={},w.valueSort.axis=u,0!==a?(w.valueSort.levelName=s+this.valueSortSettings.headerDelimiter+w.formattedText,w.valueSort[s+this.valueSortSettings.headerDelimiter+w.formattedText]=1,w.valueSort.uniqueName=s+this.valueSortSettings.headerDelimiter+(w.actualText?w.actualText:w.formattedText),w.valueSort[s+this.valueSortSettings.headerDelimiter+(w.actualText?w.actualText:w.formattedText)]=1):(w.valueSort[w.formattedText]=1,w.valueSort.levelName=w.formattedText,w.valueSort[w.actualText?w.actualText:w.formattedText]=1,w.valueSort.uniqueName=w.actualText?w.actualText:w.formattedText);var N=w.valueSort.axis+this.valueSortSettings.headerDelimiter+w.valueSort.levelName,E=this.isExpandAll||c&&c.expandAll;w.isDrilled=!(!o||!this.isValueFiltersAvail)||(w.hasChild&&this.fieldDrillCollection[N]?!E||!this.valueAxis&&!this.isLastHeaderHasMeasures&&d>=this.measureIndex:E),w.members=[],l.push(w)}v&&!f&&a>0&&C+1===r.length&&Object.keys(y).length>0&&(f=!0,x=Object.keys(y).length,C=-1)}}else v&&!f&&a>0&&C+1===r.length&&Object.keys(y).length>0&&(x=Object.keys(y).length,f=!0,C=-1)}for(var I=0,F=l.length;I<F;I++){this.frameHeaderObjectsCollection||("row"===n?this.rowCount+=this.rowValuesLength+(l[I].isDrilled&&l[I].hasChild&&this.showSubTotalsAtBottom?1:0):this.columnCount+=this.colValuesLength);var L=null;if(l[I].valueSort&&l[I].valueSort.levelName&&(L=l[I].valueSort.levelName),s=L||l[I].formattedText,!this.dataSourceSettings.showHeaderWhenEmpty&&p-1>a&&l[I].index&&l[I].index.length>0)if(v&&e[a+1]&&e[a+1].name&&Object.keys(this.fieldList[e[a+1].name].members).length>0)l[I].hasChild=!0;else{for(var A=l[I].index.length,R=0,k=0;k<A;k++){M=i[l[I].index[k]][this.fieldKeys[e[a+1].name]];((0,t.isNullOrUndefined)(M)||this.localeObj&&M===this.localeObj.getConstant("undefined"))&&R++}l[I].hasChild=R!==A}if(p-1>a&&l[I].isDrilled){this.columnCount-=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&c.showSubTotals||"column"!==n?0:this.colValuesLength;var j=l[I].index;l[I].members=this.getIndexedHeaders(e,i,a+1,void 0===j?[]:j,n,s,o),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[s]=l[I].members)}}if(this.enableSort){if(S)return this.sortHeaders(u,g,l,g.sort,"date");if("number"===g.type.toLowerCase()&&l.length>0&&"string"==typeof l[0].actualText&&l[0].actualText.match(/[a-zA-Z]+/g)){var q=[],H=void 0,V=[],U=[];for(m=0;m<l.length;m++)if((0,t.isNullOrUndefined)(l[m].actualText.toString().match(/\d+/)))q.push(l[m]),H||"None"===g.sort||"Out of Range"===l[m].actualText&&(H=l[m],l.splice(m,1));else{if(""!==l[m].actualText){this.fieldList[u].isAlphanumeric=!0,V.push(l[m]);break}U.push(l[m])}return H&&("Ascending"===g.sort?"Grand Total"===l[0].actualText?l.splice(1,0,H):l.splice(0,0,H):"Grand Total"===l[l.length-1].actualText?l.splice(l.length-1,0,H):l.splice(l.length,0,H)),V.length>0&&this.sortHeaders(u,g,l,g.sort,g.isAlphanumeric),l}return this.sortHeaders(u,g,l,g.sort,g.type)}return l}return l},e.prototype.getOrderedIndex=function(e){for(var t={},i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t},e.prototype.insertPosition=function(e,t,i,a,r,n,s){var o=[],l=this.getOrderedIndex(s);if(e){for(var d={},p=e[i].name,h=this.fieldList[p],u=0,c=a.length;u<c;u++){var g={},m=this.valueMatrix[a[u]][h.index].ordinal,f=s[l[m]],S=t[a[u]][this.fieldKeys[p]];S=null===S?this.localeObj?this.localeObj.getConstant("null"):String(S):S;var v=this.formatFields[p]&&["date","dateTime","time"].indexOf(this.formatFields[p].type)>-1?this.getFormattedValue(S,p):{formattedText:S.toString(),actualText:S.toString()};f&&f.formattedText===v.formattedText&&(d&&d[m]?(d[m].index.push(a[u]),d[m].indexObject[a[u]]=a[u]):(d[m]={index:[],indexObject:{}},f.index=d[m].index=[a[u]],d[m].indexObject[a[u]]=a[u],f.indexObject=d[m].indexObject,f.valueSort={},f.valueSort.axis=p,0!==i?(f.valueSort.levelName=n+this.valueSortSettings.headerDelimiter+f.formattedText,f.valueSort[n+this.valueSortSettings.headerDelimiter+f.formattedText]=1,f.valueSort.uniqueName=n+this.valueSortSettings.headerDelimiter+(f.actualText?f.actualText:f.formattedText),f.valueSort[n+this.valueSortSettings.headerDelimiter+(f.actualText?f.actualText:f.formattedText)]=1):(f.valueSort[f.formattedText]=1,f.valueSort.levelName=f.formattedText,f.valueSort[f.actualText?f.actualText:f.formattedText]=1,f.valueSort.uniqueName=f.actualText?f.actualText:f.formattedText),g.members=[],o.push(g)))}for(var y=s.length-o.length;y>0;)o.push({members:[]}),y--;for(var b=0,C=o.length;b<C;b++)if(s[b].members.length>0){var x=null;s[b].valueSort&&s[b].valueSort.levelName&&(x=s[b].valueSort.levelName),n=x||s[b].formattedText,o[b].members=this.insertPosition(e,t,i+1,s[b].index,r,n,s[b].members)}return o}return o},e.prototype.insertTotalPosition=function(e){var t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers,t.indexObject={};for(var i=0,a=this.filterMembers.length;i<a;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i]}return e},e.prototype.calculatePagingValues=function(){if(this.isPagingOrVirtualizationEnabled){1===this.valueAxis?this.rowValuesLength=this.dataSourceSettings.values.length:this.colValuesLength=this.dataSourceSettings.values.length,this.columnPageCount=Math.ceil(this.columnCount/this.pageSettings.columnPageSize),this.rowPageCount=Math.ceil(this.rowCount/this.pageSettings.rowPageSize),this.pageSettings.currentColumnPage=this.pageSettings.currentColumnPage>=this.columnPageCount||this.enableOptimizedRendering&&this.pageSettings.currentColumnPage>1&&(this.pageSettings.currentColumnPage+1)*this.colValuesLength>=this.columnPageCount?this.columnPageCount:this.pageSettings.currentColumnPage,this.pageSettings.currentRowPage=this.pageSettings.currentRowPage>=this.rowPageCount||this.enableOptimizedRendering&&this.pageSettings.currentRowPage>1&&(this.pageSettings.currentRowPage+1)*this.rowValuesLength>=this.rowPageCount?this.rowPageCount:this.pageSettings.currentRowPage;var e=this.enablePaging||this.enableOptimizedRendering?1:3;this.memberCnt=this.enablePaging?0:-this.rowValuesLength,this.rowStartPos=(this.pageSettings.currentRowPage*this.pageSettings.rowPageSize-this.pageSettings.rowPageSize)*(this.enablePaging?1:this.rowValuesLength)+(this.enablePaging?1:0);var t=this.enablePaging?this.rowStartPos:this.rowStartPos+this.pageSettings.rowPageSize*e*this.rowValuesLength>this.rowCount?this.rowCount-this.pageSettings.rowPageSize*e*this.rowValuesLength:this.rowStartPos;t<0&&(t=this.rowStartPos=0,this.pageSettings.currentRowPage=1),this.rowFirstLvl=(this.rowStartPos-t)%this.pageSettings.rowPageSize,this.rowStartPos=t,this.endPos=this.rowStartPos+this.pageSettings.rowPageSize*e*(this.enablePaging?1:this.rowValuesLength)-(this.enablePaging?1:0),this.endPos=this.endPos>this.rowCount+1?this.rowCount+1:this.endPos,this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=this.enablePaging?0:-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.currentColumnPage*this.pageSettings.columnPageSize-this.pageSettings.columnPageSize)*(this.enablePaging?1:this.colValuesLength)+(this.enablePaging?1:0),(t=this.enablePaging?this.colStartPos:this.colStartPos+this.pageSettings.columnPageSize*e*this.colValuesLength>this.columnCount?this.columnCount-this.pageSettings.columnPageSize*e*this.colValuesLength:this.colStartPos)<0&&(t=this.colStartPos=0,this.pageSettings.currentColumnPage=1),this.colFirstLvl=(this.colStartPos-t)%this.pageSettings.columnPageSize,this.colStartPos=t,this.endPos=this.colStartPos+this.pageSettings.columnPageSize*e*(this.enablePaging?1:this.colValuesLength)-(this.enablePaging?1:0),this.endPos=this.endPos>this.columnCount+1?this.columnCount+1:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column"),this.memberCnt=-1,this.pageInLimit=!1,this.isValueHasAdvancedAggregate?("grand sum"!==this.rMembers[this.rMembers.length-1].type&&"grand sum"===this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1].type&&(this.rMembers.push(this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1]),this.removeRowGrandTotal=!0),"grand sum"!==this.cMembers[this.cMembers.length-1].type&&"grand sum"===this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1].type&&(this.cMembers.push(this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1]),this.removeColumnGrandTotal=!0)):(this.rowGrandTotal=this.rowGrandTotal?this.rowGrandTotal:this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1],this.columnGrandTotal=this.columnGrandTotal?this.columnGrandTotal:this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1])}},e.prototype.performSlicing=function(e,t,i,a){for(var r=0;e[r]&&!(this.enablePaging&&this.endPos<=this.memberCnt&&0!==r);){if(this.memberCnt+=e[r].level<=this.measureIndex?"column"===a?this.colValuesLength:this.rowValuesLength:1,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===a?this.colFirstLvl=this.colFirstLvl+e[r].level:this.rowFirstLvl=this.rowFirstLvl+e[r].level,this.isParentLevelAdded="column"===a?!(this.colFirstLvl>0):!(this.rowFirstLvl>0),this.pageInLimit=!0),this.pageInLimit&&!this.enablePaging&&this.endPos<=this.memberCnt){if("column"!==a)break;if(0===e[r].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[r].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(e[r].members.length>0?this.removeChildMembers(e[r]):e[r]),e[r].members.length>0&&("column"===a?this.memberCnt-=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&this.columnKeys[e[r].valueSort.axis].showSubTotals?0:this.colValuesLength:this.showSubTotalsAtBottom&&this.memberCnt++,t[t.length-1].members=this.performSlicing(e[r].members,[],i,a)),!this.isParentLevelAdded&&this.enablePaging&&(this.memberCnt+=(t[t.length-1].level<=this.measureIndex?"column"===a?this.colValuesLength:this.rowValuesLength:1)*t[t.length-1].level,this.isParentLevelAdded=!0),this.pageInLimit||t.pop(),0===e[r].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;r++}return t},e.prototype.removeChildMembers=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],"members"===t[i]&&(a.members=[]),i++;return a},e.prototype.insertAllMember=function(e,t,i,a){var r=e.length,n={hasChild:!1,index:t,level:0,axis:a,isDrilled:!1,indexObject:{},members:[],actualText:"Grand"+(i=" Total"),formattedText:this.localeObj?this.localeObj.getConstant("grandTotal"):"Grand"+i,ordinal:r,type:"grand sum",valueSort:{}};n.valueSort[n.formattedText]=1,n.valueSort.levelName=n.formattedText,n.valueSort[n.actualText]=1,n.valueSort.uniqueName=n.actualText;for(var s=0,o=t.length;s<o;s++)n.indexObject[t[s]]=t[s];return"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?e.unshift(n):e.push(n),e},e.prototype.getTableData=function(e,i,a,n,s,o,l,d,p,h){for(var u=e.length,c=0;c<u;c++){var g=!this.valueAxis&&!this.isLastHeaderHasMeasures&&s.length<this.dataSourceSettings.columns.length+1?this.dataSourceSettings.columns.length+1:s.length,m=e[c];i[g]=m;var f=g-Number(Object.keys(i)[0]),S=!i[g].members.length;m.colIndex=0,m.rowIndex=g;var v=!1,y=this.dataSourceSettings.valueSortSettings.headerDelimiter;if(this.valueAxis&&0===this.dataSourceSettings.rows.length&&this.dataSourceSettings.values.length>1&&(this.rowIndex=(0,t.isNullOrUndefined)(this.rowIndex)&&!S&&0===this.dataSourceSettings.rows.length?m.index:this.rowIndex,v=this.valueAxis&&0===this.dataSourceSettings.rows.length&&m.valueSort.levelName&&0!==m.valueSort.levelName.toString().indexOf("Grand Total"+y),this.valueAxis&&0===this.dataSourceSettings.rows.length&&0===m.valueSort.levelName.toString().indexOf("Grand Total"+y)&&(m.index=this.rowIndex)),v)S||this.recursiveRowData(e,i,a,g,s,o,S,c,0,l,d,p);else{var b=!1;if(this.showSubTotalsAtBottom&&i[n]&&i[n].hasChild)for(var C=0,x=i[n].members;C<x.length;C++)if("value"===x[C].type){b=!0;break}if(b&&!i[g].isSum&&i[g].members&&0===i[g].members.length)continue;if(s[g]||(s[g]=[],this.valueContent[f]={}),s[g][0]=i[g]=this.valueContent[f][0]=r.getFormattedHeader(m,this),this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)){var w=g,T=f,M=g,D=!1;if(((0!==l||0!==this.measureIndex)&&!S||S)&&"value"===m.type&&!m.valueSort.axis||l>this.measureIndex&&"row"===m.axis&&m.valueSort.axis)for(var O=0,P=!1,N=m.valueSort.uniqueName?m.valueSort.uniqueName.toString().split(this.valueSortSettings.headerDelimiter):[],E=0,I=1,F=a.length;E<F;++E){if(!P)for(O=0;O<o;O++)if(N.indexOf(this.dataSourceSettings.values[O].name)>-1){P=!0,D=!0;break}if(l>this.measureIndex&&"row"===m.axis&&m.valueSort.axis)this.updateRowData(e,a,g,s,O,c,E,I,f,d,p);else{if(!i[n]){D=!1;break}var L=this.showSubTotalsAtBottom&&h?h:n;this.updateRowData(i,a,g,s,O,L,E,I,f,d,p)}I=s[g].length}if(!D)for(E=0,I=1,F=a.length;E<F;++E)I=s[g].length,s[w][I]=this.valueContent[T][I]={axis:"value",actualText:"",colSpan:1,colIndex:I,formattedText:"",hasChild:!1};this.recursiveRowData(e,i,a,M,s,o,S,c,o,l,d,p)}else{for(E=0,I=1,F=a.length;E<F;++E){var A=a[E].valueSort.uniqueName?a[E].valueSort.uniqueName.toString().split(this.valueSortSettings.headerDelimiter):[];for(O=0;O<o;O++)(this.valueAxis||this.isLastHeaderHasMeasures||A.indexOf(this.dataSourceSettings.values[O].name)>-1)&&(this.updateRowData(e,a,g,s,O,c,E,I,f,d,p),I=s[g].length)}this.recursiveRowData(e,i,a,g,s,o,S,c,0,l,d,p)}}}},e.prototype.insertRowSubTotals=function(e,t,i,a,n,s,o,l){var d=!!e[i].type&&("value"===e[i].type&&e[i].valueSort.levelName!==e[i].actualText);if(e[i].hasChild&&e[i].members.length>0){var p=[],h=r.frameHeaderWithKeys(e[i]);if("value"===e[i].members[0].type){for(var u=0,c=[],g=1,m=0,f=h.members;m<f.length;m++){var S=f[m];"value"===S.type&&(c[c.length]=S)}for(;u<c.length;){for(var v=r.frameHeaderWithKeys(c[u]),y=void 0;g<e.length;g++)if(e[g]&&e[g].valueSort.levelName===v.valueSort.levelName){y=e.indexOf(e[g]);break}y>-1&&(p[p.length]=y),v.formattedText=h.formattedText+" "+v.formattedText,v.isSum=!0,v.members=[],this.getTableData([v],e,t,i,a,n,s,o,l),u++}}else{h.formattedText=h.formattedText+" Total",h.members=[],h.isDrilled=!1,h.hasChild=!1,h.isSum=!0,h.type="sum";var b=d?this.getParentIndex(e,h):0;this.getTableData([h],e,t,i,a,n,s,o,l,b),p=[i]}for(y=0;y<p.length;y++){var C=a[p[y]];C=C.map((function(e){return e.formattedText=0===e.colIndex?e.formattedText:"",e})),a[p[y]]=C}}},e.prototype.getParentIndex=function(e,t){for(var i=0,a=e.length-1;a>0;a--)if(t.level===e[a].level&&e[a].index){i=a;break}return i},e.prototype.getAggregatedHeaders=function(e,t,i,a,r){this.selectedHeaders={selectedHeader:[],values:[]};for(var n=r.length,s=0;s<n;s++)switch(r[s].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var o=void 0,l=void 0;this.selectedHeaders.values.push(r[s].name),r[s].baseField&&r[s].baseItem?(o=r[s].baseField,l=r[s].baseItem):this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&t.length>0?(o=t[0].name,l=Object.keys(this.fieldList[t[0].name].members)[0]):e.length>0&&(o=e[0].name,l=Object.keys(this.fieldList[e[0].name].members)[0]);for(var d=!1,p=0,h=e;p<h.length;p++){if(h[p].name===o){this.getAggregatedHeaderData(i,r[s].name,l,!1,"row",r[s].type,this.selectedHeaders.selectedHeader,s),d=!0;break}}if(!d)for(var u=0,c=t;u<c.length;u++){if(c[u].name===o){this.getAggregatedHeaderData(a,r[s].name,l,!1,"column",r[s].type,this.selectedHeaders.selectedHeader,s);break}}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(r[s].name),this.getAggregatedHeaderData("PercentageOfParentRowTotal"===r[s].type?i:a,r[s].name,void 0,!1,"PercentageOfParentRowTotal"===r[s].type?"row":"column",r[s].type,this.selectedHeaders.selectedHeader,s);break;case"RunningTotals":this.selectedHeaders.values.push(r[s].name),this.getAggregatedHeaderData(this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)?a:i,r[s].name,void 0,!1,this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)?"column":"row",r[s].type,this.selectedHeaders.selectedHeader,s);break;case"PercentageOfParentTotal":o=void 0;this.selectedHeaders.values.push(r[s].name),r[s].baseField?o=r[s].baseField:this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&t.length>0?o=t[0].name:e.length>0&&(o=e[0].name);d=!1;for(var g=e.length,m=0;m<g;m++)if(e[m].name===o){var f=m>=this.measureIndex?m+1:m;this.getAggregatedHeaderData(i,r[s].name,void 0,!1,"row",r[s].type,this.selectedHeaders.selectedHeader,s,f),d=!0;break}if(!d)for(g=t.length,m=0;m<g;m++)if(t[m].name===o){f=m;this.valueAxis||this.isLastHeaderHasMeasures||(f=m>=this.measureIndex?m+1:m),this.getAggregatedHeaderData(a,r[s].name,void 0,!1,"column",r[s].type,this.selectedHeaders.selectedHeader,s,f);break}}},e.prototype.getAggregatedHeaderData=function(e,i,a,r,n,s,o,l,d){for(var p=0,h=e;p<h.length;p++){var u=h[p];switch(s){case"DifferenceFrom":case"PercentageOfDifferenceFrom":if(-1!==u.valueSort.levelName.toString().split(this.valueSortSettings.headerDelimiter).indexOf(a)){var c=[];if(!r&&"row"===n)for(var g=0,m=e;g<m.length;g++){var f=m[g];f.level>=u.level&&c.push(f)}if(o.push(this.updateSelectedHeaders(a,u.level,n,r,i,s,u.valueSort.levelName,r?[u]:"column"===n?e:c,l+1)),u.members.length>0){var S=!1,v=[];if("row"===n)for(var y=0,b=u.members;y<b.length;y++){if("value"!==(T=b[y]).type||0!==T.members.length){v.push(T),S=!1;break}S=!0}(!S&&v.length>0||"column"===n)&&this.getAggregatedHeaderData("column"===n?u.members:v,i,a,!0,n,s,o[o.length-1].childMembers,l)}}else u.members.length>0&&this.getAggregatedHeaderData(u.members,i,a,!1,n,s,o,l);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===u.type?o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,e,l+1)):u.members.length>0&&(o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,u.members,l+1)),this.getAggregatedHeaderData(u.members,i,void 0,!1,n,s,o,l));break;case"PercentageOfParentTotal":if("grand sum"!==u.type)if(u.valueSort.levelName.split(this.valueSortSettings.headerDelimiter).length-1===d)if(u.members.length>0){if(r)for(var C=o[o.length-1].aggregateHeaders,x=0,w=u.members;x<w.length;x++){var T=w[x];C.push((0,t.extend)({},T,null,!0))}else{var M=(0,t.extend)([],u.members,null,!0);o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,M,l+1)),(C=o[o.length-1].aggregateHeaders).push((0,t.extend)({},u,null,!0))}this.getAggregatedHeaderData(u.members,i,void 0,!0,n,s,o,l,d+1)}else r||o.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,s,u.valueSort.levelName,[u],l+1));else u.members.length>0&&this.getAggregatedHeaderData(u.members,i,void 0,!1,n,s,o,l,d)}}},e.prototype.updateSelectedHeaders=function(e,i,a,r,n,s,o,l,d){return{name:e,level:i,axis:a,isChild:r,value:n,type:s,uniqueName:o,aggregateHeaders:(0,t.extend)([],l,null,!0),childMembers:[],valueCount:d}},e.prototype.applyAdvancedAggregate=function(e,t,i){if(this.aggregatedValueMatrix=[],this.selectedHeaders.values.length>0){for(var a={},r=[],n=[],s=!1,o=i.length,l=0;l<o;l++)if(void 0!==i[l]&&void 0!==i[l][0]){if(!s)for(var d=i[l].length,p=0;p<d;p++){var h=i[l][p].actualText;"value"===i[l][p].axis&&-1!==this.selectedHeaders.values.indexOf(h)&&(r.push(p),s=!0)}if(!(this.showSubTotalsAtBottom&&i[l][0].isDrilled&&i[l][0].hasChild)&&r.length>0&&"value"===i[l][r[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][r[0]].actualText)){n.push(l);for(var u=0,c=r;u<c.length;u++){a[l+","+(f=c[u])]=[l,f]}}}this.updateAggregates(e,t,i,this.selectedHeaders.selectedHeader,r,n,a);for(var g=0,m=Object.keys(a);g<m.length;g++){var f;i[a[f=m[g]][0]][a[f][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A",this.aggregatedValueMatrix[a[f][0]]||(this.aggregatedValueMatrix[a[f][0]]=[]),this.aggregatedValueMatrix[a[f][0]][a[f][1]]=0}this.updatePivotValues(!0)}},e.prototype.updateAggregates=function(e,i,a,r,n,s,o){for(var l=0,d=r;l<d.length;l++){var p=d[l],h=p.aggregateHeaders,u=p.value,c=p.type,g=p.uniqueName,m="row"===p.axis,f=void 0,S=[],v=[],y=[],b=[],C=[],x=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(p.type))if(m){if("RunningTotals"!==p.type)for(var w=0,T=s;w<T.length;w++){if(void 0!==e[Ve=T[w]]&&e[Ve].valueSort[g]){f=e[Ve],C=0===this.valueAxis||this.valueAxis&&a[Ve]&&a[Ve][1]&&a[Ve][1].actualText===u?a[Ve]:[];break}}}else{for(var M=a.length,D=0;D<M&&(void 0!==a[D]&&void 0===a[D][0]);D++)y.push(a[D]);for(var O=y.length;O--;){var P=(R=y[O][n[0]]).actualText;-1===this.selectedHeaders.values.indexOf(P)&&(v=y[O],O=0)}if("RunningTotals"!==p.type){for(var N=v.length,E=0;E<N;E++){var I=!1;if(void 0!==v[E]&&v[E].valueSort[g]){f=v[E];var F=a.length;for(D=0;D<F;D++){void 0!==(R=a[D])&&void 0!==R[0]&&"value"===R[E].axis&&-1!==this.selectedHeaders.values.indexOf(R[E].actualText)&&(I=!0,x[D]=R[E],b.push(D))}if(I)break}}if(0===x.length&&0===b.length)for(N=v.length,E=0;E<N;E++){I=!1;if(void 0!==v[E]&&0===v[E].valueSort.levelName.indexOf(g)){f=v[E];for(var L=a.length,A=0;A<L;A++){var R;void 0!==(R=a[A])&&void 0!==R[0]&&"value"===R[E].axis&&-1!==this.selectedHeaders.values.indexOf(R[E].actualText)&&(I=!0,b.push(A))}if(I)break}}}}switch(p.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var k=p.isChild;if(m){if(k)for(var j=g.split(this.valueSortSettings.headerDelimiter),q=0,H=s;q<H.length;q++){if(void 0!==e[je=H[q]])if(-1!==e[je].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(j[j.length-1])&&f&&e[je].level===f.level)for(var V=0,U=n;V<U.length;V++){K=U[V];"value"===(Z=a[je][K]).axis&&Z.actualText===u&&(S.push([je,K]),o[je+","+K]&&delete o[je+","+K])}}else for(var B=0,_=h;B<_.length;B++)for(var G=_[B],z=0,W=s;z<W.length;z++){if(void 0!==e[Ve=W[z]]&&e[Ve].valueSort[G.valueSort.levelName]&&e[Ve].level===f.level&&"grand sum"!==e[Ve].type)for(var Q=0,Y=n;Q<Y.length;Q++){var K=Y[Q];"value"===(Z=a[Ve][K]).axis&&Z.actualText===u&&(S.push([Ve,K]),o[Ve+","+K]&&delete o[Ve+","+K])}}for(var X=0,J=S;X<J.length;X++){var Z=a[(K=J[X])[0]][K[1]],$=(0,t.isNullOrUndefined)(C[K[1]].actualValue)?0:C[K[1]].actualValue,ee=((0,t.isNullOrUndefined)(Z.actualValue)?0:Z.actualValue)-$;ee=isNaN(ee)||0===Z.value&&0===C[K[1]].value?0:ee,this.aggregatedValueMatrix[K[0]]||(this.aggregatedValueMatrix[K[0]]=[]),"DifferenceFrom"===c?(this.aggregatedValueMatrix[K[0]][K[1]]=ee,Z.formattedText=0===ee?this.emptyCellTextContent:this.getFormattedValue(ee,u).formattedText):(ee=0===$?0:ee/$,this.aggregatedValueMatrix[K[0]][K[1]]=ee,Z.formattedText=Z.showSubTotals?0!==ee?this.globalize.formatNumber(ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent:Z.formattedText)}}else{if(k){j=g.split(this.valueSortSettings.headerDelimiter),N=v.length;for(var te=0;te<N;te++){I=!1;if(void 0!==v[te])if(-1!==v[te].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(j[j.length-1])&&v[te].level===f.level){for(var ie=0,ae=b;ie<ae.length;ie++){"value"===(Z=a[K=ae[ie]][te]).axis&&Z.actualText===u&&(I=!0,S.push([K,te]),o[K+","+te]&&delete o[K+","+te])}if(I)break}}}else for(var re=0,ne=h;re<ne.length;re++){G=ne[re];var N=v.length;for(E=0;E<N;E++){var I=!1;if(void 0!==v[E]&&v[E].valueSort[G.valueSort.levelName]&&f&&v[E].level===f.level&&"grand sum"!==v[E].type){for(var se=0,oe=b;se<oe.length;se++){"value"===(Z=a[K=oe[se]][E]).axis&&Z.actualText===u&&(I=!0,S.push([K,E]),o[K+","+E]&&delete o[K+","+E])}if(I)break}}}var le=void 0;0===x.length&&(le=this.getSelectedColumn(p.uniqueName,i));for(var de=0,pe=S;de<pe.length;de++){Z=a[(K=pe[de])[0]][K[1]];var he=0;if(0===x.length){var ue=this.getSelectedRow(Z.rowHeaders,e);he=this.getAggregateValue(ue.index,le.indexObject,this.fieldList[u].index,p.type,!1)}else he=x[K[0]].value;ee=Z.value-he;ee=isNaN(ee)?0:ee,this.aggregatedValueMatrix[K[0]]||(this.aggregatedValueMatrix[K[0]]=[]),"DifferenceFrom"===c?(Z.formattedText=0===ee?this.emptyCellTextContent:this.getFormattedValue(ee,u).formattedText,this.aggregatedValueMatrix[K[0]][K[1]]=ee):(ee=0===x[K[0]].value?0:ee/x[K[0]].value,Z.formattedText=0!==ee?this.globalize.formatNumber(ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[K[0]][K[1]]=ee)}}p.childMembers.length>0&&this.updateAggregates(e,i,a,p.childMembers,n,s,o);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(m){for(var ce=0,ge=h;ce<ge.length;ce++){G=ge[ce];for(var me=0,fe=s;me<fe.length;me++){if(void 0!==e[D=fe[me]]&&e[D].valueSort[G.valueSort.levelName]&&e[D].level===G.level)for(var Se=0,ve=n;Se<ve.length;Se++){K=ve[Se];"value"===(Z=a[D][K]).axis&&Z.actualText===u&&(S.push([D,K]),o[D+","+K]&&delete o[D+","+K])}}}for(var ye=0,be=S;ye<be.length;ye++){Z=a[(D=be[ye])[0]][D[1]];var Ce=0;Ce=0===C.length&&f?this.getAggregateValue(f.index,i[D[1]-1].indexObject,this.fieldList[u].index,p.type,!1):C[D[1]]?C[D[1]].actualValue:0;ee=Z.value/Ce;ee=isNaN(ee)?0:ee,Z.formattedText=Z.showSubTotals?0!==ee?this.globalize.formatNumber(ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent:Z.formattedText,this.aggregatedValueMatrix[D[0]]||(this.aggregatedValueMatrix[D[0]]=[]),this.aggregatedValueMatrix[D[0]][D[1]]=ee}}else{for(var xe=0,we=h;xe<we.length;xe++)for(G=we[xe],N=v.length,A=0;A<N;A++){I=!1;if(void 0!==v[A]&&v[A].valueSort[G.valueSort.levelName]){for(var Te=0,Me=b;Te<Me.length;Te++){K=Me[Te];if(!(this.showSubTotalsAtBottom&&a[K][0].isDrilled&&a[K][0].hasChild))"value"===(Z=a[K][A]).axis&&Z.actualText===u&&(I=!0,S.push([K,A]),o[K+","+A]&&delete o[K+","+A])}if(I)break}}var De=void 0;0===x.length&&(De=this.getSelectedColumn(p.uniqueName,i));for(var Oe=0,Pe=S;Oe<Pe.length;Oe++){Z=a[(D=Pe[Oe])[0]][D[1]];var Ne=0;if(0===x.length){ue=this.getSelectedRow(Z.rowHeaders,e);Ne=this.getAggregateValue(ue.index,De.indexObject,this.fieldList[u].index,p.type,!1)}else Ne=x[D[0]].value;var Ee=Z.value/Ne;Ee=isNaN(Ee)?0:Ee,Z.formattedText=0!==Ee?this.globalize.formatNumber(Ee,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,Z.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[D[0]]||(this.aggregatedValueMatrix[D[0]]=[]),this.aggregatedValueMatrix[D[0]][D[1]]=Ee}}break;case"RunningTotals":if(m)for(var Ie=0,Fe=n;Ie<Fe.length;Ie++){K=Fe[Ie],ee=0;for(var Le=0,Ae=h;Le<Ae.length;Le++){G=Ae[Le];for(var Re=0,ke=s;Re<ke.length;Re++){var je;if(void 0!==e[je=ke[Re]]){Z=a[je][K];if(void 0!==e[je]&&e[je].valueSort[G.valueSort.levelName]&&e[je].level===G.level&&"value"===Z.axis&&Z.actualText===u){"grand sum"!==e[je].type&&(ee+=Z.showSubTotals||!(0,t.isNullOrUndefined)(Z.actualValue)&&isNaN(Z.actualValue)?(0,t.isNullOrUndefined)(Z.value)||isNaN(Z.value)?null:Z.value:Z.actualValue,Z.formattedText=Z.showSubTotals?0===ee&&Z.actualValue&&0!==Z.actualValue?"":this.getFormattedValue(ee,u).formattedText:Z.formattedText,this.aggregatedValueMatrix[je]||(this.aggregatedValueMatrix[je]=[]),this.aggregatedValueMatrix[je][K]=ee),o[je+","+K]&&delete o[je+","+K];break}}}}}else for(var qe=0,He=s;qe<He.length;qe++){var Ve;if(void 0!==a[Ve=He[qe]]){ee=0;for(var Ue=0,Be=h;Ue<Be.length;Ue++){G=Be[Ue];var _e=e[Ve].hasChild&&e[Ve].isDrilled&&(!(0,t.isNullOrUndefined)(e[Ve].showSubTotals)&&!e[Ve].showSubTotals||!this.dataSourceSettings.showSubTotals||!this.dataSourceSettings.showRowSubTotals);for(N=v.length,E=0;E<N;E++){Z=a[Ve][E];if(void 0!==v[E]&&v[E].valueSort[G.valueSort.levelName]&&"value"===Z.axis&&Z.actualText===u){"grand sum"!==v[E].type&&((0,t.isNullOrUndefined)(Z.value)||(ee+=Z.value),Z.formattedText=_e?"":this.getFormattedValue(ee,u).formattedText,this.aggregatedValueMatrix[Ve]||(this.aggregatedValueMatrix[Ve]=[]),this.aggregatedValueMatrix[Ve][E]=ee),o[Ve+","+E]&&delete o[Ve+","+E];break}}}}}}}},e.prototype.getSelectedColumn=function(e,t){for(var i={axis:"column",index:[],indexObject:{}},a=0,r=t;a<r.length;a++){var s=r[a];s&&s.valueSort&&0===s.valueSort.levelName.indexOf(e)&&(i.index=i.index.concat(s.index).sort((function(e,t){return e-t})),i.indexObject=n({},i.indexObject,s.indexObject))}return i},e.prototype.getSelectedRow=function(e,t){for(var i=0,a=t;i<a.length;i++){var r=a[i];if(r){if(r.valueSort&&r.valueSort.levelName===e)return r;if(""===e&&"grand sum"===r.type)return r}}return null},e.prototype.recursiveRowData=function(e,i,a,r,n,s,o,l,d,p,h,u){o||this.getTableData(i[r].members,i,a,r,n,s,p+1,h,u),this.showSubTotalsAtBottom&&((0,t.isNullOrUndefined)(e[l].showSubTotals)||e[l].showSubTotals)&&this.insertRowSubTotals(i,a,r,n,s,p,h,u),this.isPagingOrVirtualizationEnabled||(i[r].members=[])},e.prototype.updateRowData=function(e,i,a,r,n,s,o,l,d,p,h){var u=this.fieldList[this.dataSourceSettings.values[n].name].index,c=this.fieldList[this.dataSourceSettings.values[n].name].aggregateType,g=this.dataSourceSettings.values[n].name,m=[],f={},S=0,v=0;switch(c){case"Index":for(var y=["cVal","rTotalVal","cTotalVal","gTotalVal"],b=0,C=0,x=m=[[e[s],i[o]],[e[s],h],[p,i[o]],[p,h]];C<x.length;C++){var w=x[C];f[y[b]]=this.getAggregateValue(w[0].index,w[1].indexObject,u,c,0!==b),b++}var T=f.cVal*f.gTotalVal/(f.rTotalVal*f.cTotalVal);S=!(e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled)||((0,t.isNullOrUndefined)(e[s].showSubTotals)||e[s].showSubTotals)&&this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals?(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T:void 0,v=(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":(m=[[e[s],i[o]]]).push("PercentageOfGrandTotal"===c?[p,h]:"PercentageOfColumnTotal"===c?[p,i[o]]:[e[s],h]);y=["cVal","gTotalVal"],b=0;for(var M=0,D=m;M<D.length;M++){w=D[M];f[y[b]]=this.getAggregateValue(w[0].index,w[1].indexObject,u,c,0!==b),b++}T=f.cVal/f.gTotalVal;S=!(e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled)||((0,t.isNullOrUndefined)(e[s].showSubTotals)||e[s].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals?(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T:void 0,v=(0,t.isNullOrUndefined)(f.cVal)?f.cVal:isNaN(T)?0:T;break;default:T=this.getAggregateValue(e[s].index,i[o].indexObject,u,c,!1);S=!(e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled)||((0,t.isNullOrUndefined)(e[s].showSubTotals)||e[s].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals?T:void 0,v=T}var O={fieldName:this.dataSourceSettings.values[n].name,row:e[s],column:i[o],value:S,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:e[s].hasChild&&e[s].isDrilled?"subTotal":"grand sum"===e[s].type?"grandTotal":"value",columnCellType:i[o].hasChild&&i[o].isDrilled?"subTotal":"grand sum"===i[o].type?"grandTotal":"value",aggregateType:c,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(O),S=O.value;var P=e[s].hasChild||i[o].hasChild||"grand sum"===e[s].type||"grand sum"===i[o].type||this.showSubTotalsAtBottom&&e[s].isSum,N="grand sum"===e[s].type||"grand sum"===i[o].type,E=e[s].members.length>0&&e[s].hasChild&&e[s].isDrilled&&(!(0,t.isNullOrUndefined)(e[s].showSubTotals)&&!e[s].showSubTotals||!this.dataSourceSettings.showSubTotals||!this.dataSourceSettings.showRowSubTotals),I=E?"":void 0===S?this.emptyCellTextContent:"Count"===c||"DistinctCount"===c?S.toLocaleString():this.getFormattedValue(S,g).formattedText;!isNaN(S)&&!(0,t.isNullOrUndefined)(S)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(c)>=0?I=this.globalize.formatNumber(S,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,O.fieldName)}):E||!isNaN(S)||(0,t.isNullOrUndefined)(S)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(c)||(I="#DIV/0!",S=0),I=O.skipFormatting?(0,t.isNullOrUndefined)(S)?this.emptyCellTextContent:S.toString():I,r[a][l]=this.valueContent[d][l]={axis:"value",actualText:g,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===e[s].type?"":e[s].valueSort.levelName,columnHeaders:"grand sum"===i[o].type?"":i[o].valueSort.levelName,formattedText:I,value:S,hierarchyName:i[o].hierarchyName,actualValue:v,rowIndex:a,colIndex:l,isSum:P,isGrandSum:N,showSubTotals:!E},this.rawIndexObject={}},e.prototype.getCellSet=function(e){for(var t=[],i=0,a=Object.keys(e);i<a.length;i++){var r=a[i];this.data[parseInt(r,10)]&&t.push(this.data[parseInt(r,10)])}return t},e.prototype.updateValueMembers=function(e,i,a,n,s,o,l){var d=a&&!(0,t.isNullOrUndefined)(a.levelName)?a.levelName.toString():void 0,p=a&&!(0,t.isNullOrUndefined)(a.uniqueName)?a.uniqueName.toString():void 0;if(e)for(var h=0;h<o;h++){var u=this.dataSourceSettings.values[h],c=u.caption?u.caption:u.name,g={axis:this.valueAxis?"row":"column",rowIndex:this.valueAxis?0:i&&l<=i.rowIndex?i.rowIndex+1:l,actualText:u.name,formattedText:c,level:0,valueSort:{},members:[],type:this.valueAxis?"value":i?i.type:null,index:!this.valueAxis&&i?i.index:null,indexObject:!this.valueAxis&&i?i.indexObject:null};s.length>0&&(g.showSubTotals=u.showSubTotals);var m=g.valueSort;m.axis=this.valueAxis?void 0:u.name,m[(d?d+this.valueSortSettings.headerDelimiter:"")+c]=1,m[(p?p+this.valueSortSettings.headerDelimiter:"")+u.name]=1,m.levelName=(d?d+this.valueSortSettings.headerDelimiter:"")+c,m.uniqueName=(p?p+this.valueSortSettings.headerDelimiter:"")+u.name,n.push(g),this.updateValueMembers(!1,i,m,g.members,s,o,l+1)}else for(var f=0,S=s.length;f<S;f++){var v=r.frameHeaderWithKeys(s[f]);v.members=[],v.rowIndex=this.valueAxis?v.rowIndex:l<0?0:l;var y={};y.axis=v.valueSort.axis,y[(d?d+this.valueSortSettings.headerDelimiter:"")+v.formattedText]=1,y[(p?p+this.valueSortSettings.headerDelimiter:"")+v.actualText]=1,y.levelName=(d?d+this.valueSortSettings.headerDelimiter:"")+v.formattedText,y.uniqueName=(p?p+this.valueSortSettings.headerDelimiter:"")+v.actualText,v.hierarchyName=v.valueSort.uniqueName,v.valueSort=y;var b=y.axis+this.valueSortSettings.headerDelimiter+y.levelName,C=this.fieldList[y.axis];v.isDrilled&&((this.isExpandAll||C.expandAll)&&this.fieldDrillCollection[b]||!this.isExpandAll&&!C.expandAll&&!this.fieldDrillCollection[b])&&(v.isDrilled=!1),n.push(v),v.isDrilled&&s[f].members.length>0?(this.valueAxis&&l<this.measureIndex&&this.measureIndex!==l+1&&(!s[f].hasChild||((0,t.isNullOrUndefined)(s[f].showSubTotals)||s[f].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals)&&this.updateValueMembers(!0,v,y,n[n.length-1].members,[],o,l),this.updateValueMembers(this.measureIndex===l+1,v,y,n[n.length-1].members,s[f].members,o,l+1),!this.valueAxis&&l<this.measureIndex&&this.measureIndex!==l+1&&(!s[f].hasChild||((0,t.isNullOrUndefined)(s[f].showSubTotals)||s[f].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals)&&this.updateValueMembers(!0,v,y,n[n.length-1].members,[],o,l)):l<this.measureIndex&&this.updateValueMembers(!0,v,y,n[n.length-1].members,[],o,l)}},e.prototype.reArrangeValueMember=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var r=a[i];this.valueAxisFields[r.actualText]&&(t[t.length]=r)}return t.concat(e).slice(0,e.length)},e.prototype.frameDefinedHeaderData=function(e,i,a,n,s,o){for(var l=0,d=e.length;l<d;l++){var p=!0;!(e[l].members.length>0)||((0,t.isNullOrUndefined)(e[l].showSubTotals)||e[l].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals||(p=!1);var h=this.measureIndex<n&&p?1:this.measureIndex>n&&e[l].members.length>0||this.measureIndex!==n+1||!e[l].isDrilled?this.measureIndex===n&&0!==this.measureIndex&&p||this.measureIndex>n&&p&&e[l].valueSort&&e[l].valueSort.axis&&this.measureNames[e[l].valueSort.axis.toString()]?1:0:0!==this.measureIndex&&p?1:0;if(e[l].members.length){var u=void 0,c=e[l].members;this.showSubTotalsAtTop?n+1<this.measureIndex&&p?(u=s,c=this.reArrangeValueMember(c)):u=s+h:u=s,this.frameDefinedHeaderData(c,i,a,n+1,u,o)}var g=this.measureIndex>n&&e[l].valueSort&&e[l].valueSort.axis&&this.measureNames[e[l].valueSort.axis.toString()]?this.measureIndex:n;i[(s=this.showSubTotalsAtTop?s+1:i.length+h)-1]||(i[s-1]=r.frameHeaderWithKeys(e[l])),e[l].colIndex=s,a[g]||(a[g]=[],this.headerContent[g]={}),a[g][s]=this.headerContent[g][s]=r.frameHeaderWithKeys(e[l]),this.isPagingOrVirtualizationEnabled||this.showSubTotalsAtTop&&0===h||i[s-1]&&(i[s-1].members=[]),this.showSubTotalsAtTop&&(s=i.length,l+1===d&&0===e[l].level&&(this.reformAxisCount=i.length+1))}},e.prototype.getHeaderData=function(e,i,a,n,s,o,l,d,p){if(this.valueAxis||this.isLastHeaderHasMeasures){if(0===n.length&&this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.dataSourceSettings.values.length>0){if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&"grand sum"===this.rMembers[this.rMembers.length-1].type)this.updateValueMembers(0===this.measureIndex&&this.rMembers.length>1,null,null,n,this.rMembers.slice(0,this.rMembers.length-1),this.dataSourceSettings.values.length,0),this.updateValueMembers(!1,null,null,n,this.rMembers.slice(this.rMembers.length-1,this.rMembers.length),this.dataSourceSettings.values.length,-1);else if("Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&0===this.measureIndex)this.updateValueMembers(!1,null,null,n,this.rMembers.slice(0,1),this.dataSourceSettings.values.length,-1),this.updateValueMembers(0===this.measureIndex&&this.rMembers.length>1,null,null,n,this.rMembers.slice(1,this.rMembers.length),this.dataSourceSettings.values.length,0);else{var h=0===e.length&&1===this.rMembers.length&&"grand sum"===this.rMembers[0].type;this.updateValueMembers(!h&&0===this.measureIndex,null,null,n,this.rMembers,this.dataSourceSettings.values.length,h?-1:0)}if(this.getAggregatedHeaders(e,i,n,s,a),this.selectedHeaders.values.length>0)for(I=this.selectedHeaders.selectedHeader.length,F=0;F<I;F++){if("row"===(L=this.selectedHeaders.selectedHeader[F]).axis){var u=L.aggregateHeaders.length;for(R=0;R<u;R++)if(L.aggregateHeaders[R].actualText===L.value)if(-1!==L.aggregateHeaders[R].valueSort.levelName.indexOf(L.uniqueName))L.uniqueName=L.aggregateHeaders[R].valueSort.levelName,L.aggregateHeaders.splice(R,1),R--,u--;else for(var c=L.aggregateHeaders[R].members.length,g=0;g<c;g++){if("value"!==(q=L.aggregateHeaders[R].members[g]).type&&q.level===L.aggregateHeaders[R].level){var m=(0,t.extend)([],L.aggregateHeaders[R].members,null,!0);L.aggregateHeaders=[].concat(L.aggregateHeaders,m,L.aggregateHeaders.splice(R)),L.aggregateHeaders.splice(m.length+R,1),R=m.length+R-1,u=L.aggregateHeaders.length}}else if(L.aggregateHeaders[R].actualText!==L.value&&L.aggregateHeaders[R].members.length>0)for(c=L.aggregateHeaders[R].members.length,g=0;g<c;g++){if((q=L.aggregateHeaders[R].members[g]).actualText===L.value){L.uniqueName===L.aggregateHeaders[R].valueSort.levelName&&(L.uniqueName=q.valueSort.levelName),L.aggregateHeaders[R].members.splice(g,1),L.aggregateHeaders[R]=q;break}}}}}for(var f=s.length,S=this.dataSourceSettings.columns.length,v=this.valueSortSettings.headerText,y=0;y<f;y++){var b=!(0,t.isNullOrUndefined)(s[y].showSubTotals)&&!s[y].showSubTotals;s[y].members.length&&this.getHeaderData(e,i,a,n,s[y].members,o,l,this.showSubTotalsAtTop&&!b?d+1:d,p);var C=!0;d=this.showSubTotalsAtTop?d:o.length,!b&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals?o[d]=r.frameHeaderWithKeys(s[y]):(s[y].members.length>0?(this.removeCount++,C=!1):o[this.showSubTotalsAtTop?d:o.length]=r.frameHeaderWithKeys(s[y]),d=this.showSubTotalsAtTop?d:o.length-1);var x=s[y].level;s[y].rowIndex=x;var w=d*p+(this.showSubTotalsAtTop?1:p);s[y].colIndex=w,l[x]||(l[x]=[],this.headerContent[x]={}),l[x][w]=this.headerContent[x][w]=r.getFormattedHeader(s[y],this);var T=0===this.dataSourceSettings.columns.length&&1===this.dataSourceSettings.values.length;if((this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader||T)&&!this.valueAxis&&C)for(var M=0;M<p;M++){var D=this.dataSourceSettings.values[M].caption?this.dataSourceSettings.values[M].caption:this.dataSourceSettings.values[M].name,O={axis:"column",actualText:this.dataSourceSettings.values[M].name,formattedText:D,level:0,valueSort:{},colIndex:d*p+1+M,rowIndex:S};l[S]||(l[S]=[],this.headerContent[S]={}),l[S][d*p+1+M]=this.headerContent[S][d*p+1+M]=O;var P=l[S][d*p+1+M].valueSort;P[s[y].valueSort.levelName+this.valueSortSettings.headerDelimiter+D]=1,P.levelName=s[y].valueSort.levelName+this.valueSortSettings.headerDelimiter+D,P[s[y].valueSort.uniqueName+this.valueSortSettings.headerDelimiter+this.dataSourceSettings.values[M].name]=1,P.uniqueName=s[y].valueSort.uniqueName+this.valueSortSettings.headerDelimiter+this.dataSourceSettings.values[M].name,P&&P[v]&&(this.valueSortSettings.columnIndex=d*p+1+M)}else s[y].valueSort&&s[y].valueSort[v]&&(this.valueSortSettings.columnIndex=d*p+1);this.isPagingOrVirtualizationEnabled||(o[d].members=[]),this.showSubTotalsAtTop&&(d=o.length,0===s[y].level&&y+1===f&&(this.reformAxisCount=o.length*p+1))}}else{var N=[];if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals&&"grand sum"===s[s.length-1].type)this.updateValueMembers(0===this.measureIndex&&s.length>1,null,null,N,s.slice(0,s.length-1),p,0),this.updateValueMembers(!1,null,null,N,s.slice(s.length-1,s.length),p,-1);else if("Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&0===this.measureIndex)this.updateValueMembers(!1,null,null,N,s.slice(0,1),p,-1),this.updateValueMembers(0===this.measureIndex&&s.length>1,null,null,N,s.slice(1,s.length),p,0);else{var E=0===i.length&&1===s.length&&"grand sum"===s[0].type;this.updateValueMembers(!E&&0===this.measureIndex,null,null,N,s,p,E?-1:0)}if(this.getAggregatedHeaders(e,i,this.rMembers,N,a),this.selectedHeaders.values.length>0)for(var I=this.selectedHeaders.selectedHeader.length,F=0;F<I;F++){var L;if("column"===(L=this.selectedHeaders.selectedHeader[F]).axis)if(L.uniqueName===L.value)this.selectedHeaders.selectedHeader.splice(F,1),F--,I--;else if("Grand Total"===L.uniqueName)for(var A=L.aggregateHeaders.length,R=0;R<A;R++)if(L.aggregateHeaders[R]&&L.aggregateHeaders[R].members.length>0)for(var k=0,j=L.aggregateHeaders[R].members;k<j.length;k++){var q;(q=j[k]).actualText===L.value&&(L.aggregateHeaders[R]=q,"grand sum"===q.type&&(L.uniqueName=q.valueSort.levelName))}}this.frameDefinedHeaderData(N,o,l,0,this.showSubTotalsAtTop?0:1,p)}},e.prototype.getAggregateValue=function(e,i,a,r,n){var s=0,o=0,l=0,d=!0,p=!1;switch(r.toLowerCase()){case"median":for(var h=[],u=0;void 0!==e[s];){void 0!==i[w=e[s]]&&(p=!0,this.rawIndexObject[w]=w,(0,t.isNullOrUndefined)(this.valueMatrix[w][a].member)||h.push(this.valueMatrix[w][a].member)),s++}(E=h.length)>0&&(h.sort((function(e,t){return e-t})),o=E%2==0?(h[u=E/2<=1?0:E/2-1]+h[u+1])/2:h[u=(E+1)/2<=1?0:(E+1)/2-1]);break;case"count":for(;void 0!==e[s];){void 0!==i[w=e[s]]&&(p=!0,this.rawIndexObject[w]=w,o+=(0,t.isNullOrUndefined)(this.valueMatrix[w][a].member)?0:this.allowDataCompression?this.valueMatrix[w][a].member:1),s++}break;case"distinctcount":for(var c=[];void 0!==e[s];){if(void 0!==i[e[s]]){this.rawIndexObject[e[s]]=e[s],p=!0;var g=this.data[e[s]][this.fieldKeys[this.fields[a]]];if(!(0,t.isNullOrUndefined)(g)){var m=g.toString();(0===c.length||c.length>0&&-1===c.indexOf(m))&&(o+=this.allowDataCompression&&"number"==typeof g?g:1,c.push(m))}}s++}break;case"product":for(;void 0!==e[s];){if(void 0!==i[w=e[s]]){this.rawIndexObject[w]=w,p=!0;m=this.valueMatrix[w][a].member;(0,t.isNullOrUndefined)(m)?d&&(o=m):(o=d||(0,t.isNullOrUndefined)(o)?1:o,o*=m),d=!1}s++}break;case"populationstdev":case"samplestdev":case"populationvar":case"samplevar":for(var f=0,S=(g=0,[]),v=0,y=0,b=0;void 0!==e[s];){if(void 0!==i[w=e[s]]){p=!0,this.rawIndexObject[w]=w;m=this.valueMatrix[w][a].member;(0,t.isNullOrUndefined)(m)||(g+=m,S.push(m),f++)}s++}if(f>0){v=g/f;for(var C=0,x=S;C<x.length;C++){var w=x[C];b+=Math.pow(w-v,2)}o=0===(y=-1!==["populationstdev","samplestdev"].indexOf(r.toLowerCase())?Math.sqrt(b/("populationstdev"===r.toLowerCase()?f:f-1)):b/("populationvar"===r.toLowerCase()?f:f-1))?NaN:y}else o=g;break;case"min":var T=!0;for(o=void 0;void 0!==e[s];){void 0!==i[w=e[s]]&&void 0!==this.valueMatrix[w][a].member&&(p=!0,this.rawIndexObject[w]=w,(0,t.isNullOrUndefined)(o)&&(0,t.isNullOrUndefined)(this.valueMatrix[w][a].member)?o=this.valueMatrix[w][a].member:T?(o=this.valueMatrix[w][a].member,T=!1):o=this.valueMatrix[w][a].member<o?this.valueMatrix[w][a].member:o),s++}break;case"max":for(var M=!0;void 0!==e[s];){void 0!==i[w=e[s]]&&void 0!==this.valueMatrix[w][a].member&&(p=!0,this.rawIndexObject[w]=w,M?(o=this.valueMatrix[w][a].member,M=!1):o=this.valueMatrix[w][a].member>o?this.valueMatrix[w][a].member:o),s++}break;case"calculatedfield":p=!0;var D=this.calculatedFields[this.fields[a]],O=D.formula,P={};if(this.calculatedFormulas[D.name])for(var N=this.calculatedFormulas[D.name],E=0,I=N.length;E<I;E++){var F=N[E],L=P[F.formula];if(void 0===L){var A=F.type;L=this.getAggregateValue(e,i,F.index,A,!1),P[F.formula]=L}O=O.replace(F.formula,String(L))}o=(o=this.evaluate(O))===1/0||o===-1/0?1/0:void 0===o||isNaN(o)?void 0:JSON.parse(String(o));break;default:for(o=void 0;void 0!==e[s];){if(void 0!==i[w=e[s]]){p=!0,n||(this.rawIndexObject[w]=w);m=this.valueMatrix[w][a].member;(0,t.isNullOrUndefined)(o)&&(0,t.isNullOrUndefined)(m)?o=m:((0,t.isNullOrUndefined)(o)&&(o=0),o+=(0,t.isNullOrUndefined)(m)?0:m),(0,t.isNullOrUndefined)(m)||l++}s++}}return r&&"avg"===r.toLowerCase()&&0!==o&&!(0,t.isNullOrUndefined)(o)?o/l:p?o:void 0},e.prototype.evaluate=function(e){return Function('"use strict";return ('+e+")")()},e.prototype.getFormattedValue=function(e,i){var a=null===e?this.localeObj?this.localeObj.getConstant("null"):String(e):void 0===e?this.localeObj?i in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(e):e,r={formattedText:a.toString(),actualText:a,dateText:a};if(this.formatFields[i]&&(this.formatFields[i].format||this.formatFields[i].skeleton)&&!(0,t.isNullOrUndefined)(e))try{var n=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i],s=(0,t.extend)({},n,null,!0);delete s.name,!s.minimumSignificantDigits&&s.minimumSignificantDigits<1&&delete s.minimumSignificantDigits,!s.maximumSignificantDigits&&s.maximumSignificantDigits<1&&delete s.maximumSignificantDigits,s.type?(r.formattedText=this.dateFormatFunction[i].exactFormat(new Date(e)),r.actualText=e):(delete s.type,s.format&&!this.formatRegex.test(s.format)&&((0,t.isNullOrUndefined)(s.minimumFractionDigits)&&delete s.minimumFractionDigits,(0,t.isNullOrUndefined)(s.maximumFractionDigits)&&delete s.maximumFractionDigits,(0,t.isNullOrUndefined)(s.minimumIntegerDigits)&&delete s.minimumIntegerDigits),r.formattedText=this.globalize.formatNumber(isNaN(Number(e))?e:Number(e),s),r.actualText=isNaN(Number(e))?e:Number(e),r.dateText=isNaN(Number(e))?e:Number(e)),"None"!==this.fieldList[i].sort&&s.type&&["date","dateTime","time"].indexOf(this.formatFields[i].type)>-1&&(r.dateText=this.dateFormatFunction[i].fullFormat(new Date(e))),this.fieldList[i].isCustomField&&(r.formattedText="NaN"===r.formattedText?a.toString():r.formattedText,r.dateText="NaN"===r.dateText?a.toString():r.dateText)}catch(e){if(!this.fieldList[i].isCustomField)throw e}finally{this.fieldList[i].isCustomField&&(r.formattedText=(0,t.isNullOrUndefined)(r.formattedText)||"NaN"===r.formattedText?a.toString():r.formattedText,r.dateText=(0,t.isNullOrUndefined)(r.dateText)||"NaN"===r.dateText?a.toString():r.dateText)}return r},e.prototype.powerFunction=function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^()]*\))/g,(function(e,i){return t.push(i),"~"+(t.length-1)}));for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),(function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")}))}return e},e}(),o=S(197),l="load",d="enginePopulating",p="enginePopulated",h="onFieldDropped",u="fieldDrop",c="beforePivotTableRender",g="afterPivotTableRender",m="beforeExport",f="exportComplete",y="excelHeaderQueryCellInfo",b="pdfHeaderQueryCellInfo",C="excelQueryCellInfo",x="pdfQueryCellInfo",w="onPdfCellRender",T="dataBound",M="queryCellInfo",D="headerCellInfo",O="hyperlinkCellClick",P="resizing",N="resizeStop",E="cellClick",I="drillThrough",F="beforeColumnsRender",L="selected",A="cellSelecting",R="drill",k="cellSelected",j="cellDeselected",q="rowSelected",H="rowDeselected",V="beginDrillThrough",U="editCompleted",B="multiLevelLabelClick",_="saveReport",G="fetchReport",z="loadReport",W="renameReport",Q="removeReport",Y="newReport",K="toolbarRender",X="toolbarClick",J="chartTooltipRender",Z="chartLegendClick",$="chartLoaded",ee="multiLevelLabelRender",te="beforePrint",ie="animationComplete",ae="legendRender",re="textRender",ne="pointRender",se="seriesRender",oe="chartMouseMove",le="chartMouseClick",de="pointMove",pe="chartMouseLeave",he="chartMouseDown",ue="chartMouseUp",ce="dragComplete",ge="zoomComplete",me="scrollStart",fe="scrollEnd",Se="scrollChanged",ve="chartLoad",ye="chartResized",be="chartAxisLabelRender",Ce="chartSeriesCreated",xe="aggregateCellInfo",we="onHeadersSort",Te="contextMenuClick",Me="contextMenuOpen",De="fieldListRefreshed",Oe="conditionalFormatting",Pe="beforePdfExport",Ne="beforeExcelExport",Ee="memberFiltering",Ie="calculatedFieldCreate",Fe="memberEditorOpen",Le="fieldRemove",Ae="numberFormatting",Re="aggregateMenuOpen",ke="fieldDragStart",je="chartPointClick",qe="beforeServiceInvoke",He="afterServiceInvoke",Ve="actionBegin",Ue="actionComplete",Be="actionFailure",_e="initial-load",Ge="ui-update",ze="scroll",We="vertical-scroll",Qe="horizontal-scroll",Ye="content-ready",Ke="data-ready",Xe="init-groupingbar",Je="tree-view-update",Ze="pivot-button-update",$e="init-calculatedfield",et="click",tt="init-toolbar",it="init-pivotPager",at="init-formatting",rt="init-grouping",nt="Sort value",st="Drill up",ot="Drill down",lt="Add new report",dt="Save current report",pt="Save as current report",ht="Rename current report",ut="Remove current report",ct="Load report",gt="Open conditional formatting dialog",mt="Open number formatting dialog",ft="MdxQuery",St="Open field list",vt="Show table view",yt="Show chart view",bt="Multiple Axis",Ct="Show legend",xt="PDF export",wt="PNG export",Tt="Excel export",Mt="CSV export",Dt="JPEG export",Ot="SVG export",Pt="Hide sub-totals",Nt="Show row sub-totals",Et="Show column sub-totals",It="Show sub-totals",Ft="Hide grand totals",Lt="Show row grand totals",At="Show column grand totals",Rt="Show grand totals",kt="Number Formatting menu",jt="Conditional Formatting menu",qt="Report change",Ht="Sort field tree",Vt="Edit calculated field",Ut="Sort field",Bt="Filter field",_t="Remove field",Gt="Open calculated field dialog",zt="Edit record",Wt="Save edited records",Qt="Add new record",Yt="Remove record",Kt="Aggregate field",Xt="CalculatedField Context menu",Jt="Window resize",Zt="Navigate row page",$t="Navigate column page",ei="Calculated field applied",ti="Edited records saved",ii="New record added",ai="Record removed",ri="Field list closed",ni="Field tree sorted",si="Report saved",oi="New report added",li="Report re-saved",di="Reportrenamed",pi="Report removed",hi="Excel exported",ui="CSV exported",ci="PDF exported",gi="PNG exported",mi="JPEG exported",fi="SVG exported",Si="Conditional formatting applied",vi="Number formatting applied",yi="Table view shown",bi="Chart view shown",Ci="Sub-totals hidden",xi="Row sub-totals shown",wi="Column sub-totals shown",Ti="Sub-totals shown",Mi="Grand totals hidden",Di="Row grand totals shown",Oi="Column grand totals shown",Pi="Grand totals shown",Ni="Value sorted",Ei="Calculated field edited",Ii="Field sorted",Fi="Field filtered",Li="Field removed",Ai="Field aggregated",Ri="Record edited",ki="Report changed",ji="Window resized",qi="Records updated",Hi="Drill-through closed",Vi="Vertically scrolled",Ui="Horizontally scrolled",Bi="Row page navigated",_i="Column page navigated",Gi="Action dropped",zi="e-pivotfieldlist",Wi="e-rtl",Qi="e-device",Yi="e-icons",Ki="e-disable",Xi="e-hide",Ji="e-icon-first",Zi="e-icon-last",$i="e-icon-prev",ea="e-icon-next",ta="e-dropdown-icon",ia="e-pivotfieldlist-container",aa="e-toggle-field-list",ra="e-static",na="e-field-list",sa="e-field-list-tree-outer-div",oa="e-field-list-tree-outer-div-searchMode",la="e-search-mode",da="e-pivot-parent",pa="e-pivot-child",ha="e-field-list-footer",ua="e-left-axis-fields",ca="e-right-axis-fields",ga="e-all-fields-axis",ma="e-hscroll",fa="e-axis-content",Sa="e-draggable-prompt",va="e-pvt-btn-div",ya="e-pivot-button",ba="e-content",Ca="e-pvt-btn-content",xa="e-sort",wa="e-member-sort",Ta="e-descend",Ma="e-btn-filter",Da="e-pv-filter",Oa="e-pv-filtered",Pa="e-remove",Na="e-drag",Ea="e-disable-drag",Ia="e-drop-indicator",Fa="e-drop-hover",La="e-member-editor-outer-container",Aa="e-member-editor-container",Ra="e-drillthrough-body-header",ka="e-drillthrough-body-header-common",ja="e-drillthrough-body-header-value",qa="e-frame",Ha="e-check",Va="e-stop",Ua="e-ok-btn",Ba="e-cancel-btn",_a="e-pivot-error-dialog",Ga="e-droppable",za="e-rows",Wa="e-columns",Qa="e-values",Ya="e-filters",Ka="e-grouping-bar",Xa="e-group-all-fields",Ja="e-group-rows",Za="e-group-columns",$a="e-group-values",er="e-group-filters",tr="e-drag-restrict",ir="e-list-selected",ar="e-title-header",rr="e-text-content",nr="e-field-list-btn",sr="e-calculated-field-btn",or="e-small",lr="e-round",dr="e-add-icon",pr="e-flat",hr="e-list-text",ur="e-selected-node",cr="e-selected-option-icon",gr="e-selected-level-icon",mr="e-between-text-div",fr="e-filter-input-div-2",Sr="e-value-options",vr="e-filter-operator",yr="e-filter-sort",br="e-sort-ascend-icon",Cr="e-sort-descend-icon",xr="e-active",wr="e-collapse",Tr="e-expand",Mr="e-table",Dr="e-columnsheader",Or="e-rowsheader",Pr="e-headercell",Nr="e-cellvalue",Er="e-tooltipheader",Ir="e-tooltipcontent",Fr="e-nextspan",Lr="e-lastspan",Ar="e-editor-search-container",Rr="e-editor-search",kr="e-select-all",jr="e-pivot-calc-check",qr="e-pivot-calc-input",Hr="e-custom-format-input",Vr="e-olap-calc-hierarchy-list-div",Ur="e-pivot-calc-format-type-div",Br="e-olap-calc-member-type-div",_r="e-member-options",Gr="e-flat",zr="e-format",Wr="e-pivot-formula",Qr="e-pivot-treeview",Yr="e-pivot-treeview-outer",Kr="e-treeContainer",Xr="e-pivot-ok-button",Jr="e-pivot-button-div",Zr="e-axis",$r="e-axis-filter",en="e-grid",tn="e-pivotview",an="e-pivot-all-field-title",rn="e-disabled",nn="e-menu-hide",sn="e-member-prompt",on="e-edit",ln="e-edited",dn="e-info",pn="e-empty-field",hn="e-format-condition-button",un="e-format-table",cn="e-input",gn="e-format-color-picker",mn="e-dlg-header",fn="e-virtualtrack",Sn="e-movablescrolldiv",vn="e-content-virtualtable",yn="e-movablescroll",bn="e-headercontent",Cn="e-cellselectionbackground",xn="e-selectionbackground",wn="e-checkbox-wrapper",Tn="e-headercontent",Mn="e-field-list-back-icon",Dn="e-rowcell",On="e-active",Pn="e-spanclicked",Nn="e-rowselect",En="e-gridheader",In="e-gridcontent",Fn="e-pivotview-pdf-export",Ln="e-pivotview-excel-export",An="e-pivotview-csv-export",Rn="e-remove-report",kn="e-pivot-toolbar",jn="e-pivotview-report-input",qn="e-pivotchart",Hn="e-group-chart-rows",Vn="e-group-chart-columns",Un="e-group-chart-values",Bn="e-group-chart-values-drodown-div",_n="e-group-chart-columns-dropdown-div",Gn="e-chart-grouping-bar",zn="e-pivotview-disable-icon",Wn="e-pivotview-select-icon",Qn="e-pivot-grouping-bar",Yn="e-mdx-query-content",Kn="e-pivotchart-inner",Xn="e-group-pivot-rows",Jn="e-pivot-toolbar-menu",Zn="e-pivot-pager",$n="e-pagercontainer",es="e-page-size-disable",ts="e-node-limit",is="e-leftfreeze",as="e-pivot-content-loader",rs="e-hide-loader",ns="e-icon-collapsible",ss="e-icon-expandable",os="e-pivotview-autofit",ls=S(707),ds=S(215),ps=S(323),hs=S(778),us=function(){function e(e){this.menuInfo=[],this.stringAggregateTypes=["Count","DistinctCount"],this.parent=e}return e.prototype.render=function(e,t){this.parentElement=t,this.openContextMenu(e)},e.prototype.openContextMenu=function(e){var t=this,i=e.target.parentElement.getAttribute("data-uid"),a=r.getFieldInfo(i,this.parent);this.buttonElement=e.target.parentElement;var n="number"!==this.parent.engineModule.fieldList[i].type?1:0,s=this.getMenuItem(n).slice();if(this.parent.actionObj.actionName=Kt,this.parent.actionObj.fieldInfo=a.fieldItem,!this.parent.actionBeginMethod()){var o={cancel:!1,fieldName:i,aggregateTypes:s,displayMenuCount:7},l="pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent;try{l.trigger(Re,o,(function(i){if(!i.cancel){s=i.aggregateTypes,t.createContextMenu(n,s,i.displayMenuCount),t.currentMenu=e.target;var a=t.currentMenu.getBoundingClientRect();t.parent.enableRtl?t.menuInfo[n].open(a.top+(window.scrollY||document.documentElement.scrollTop),a.left-105):t.menuInfo[n].open(a.top+(window.scrollY||document.documentElement.scrollTop),a.left)}}))}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.createContextMenu=function(e,i,a){var r=this,n=[];n[e]=[],this.menuInfo[e]&&!this.menuInfo[e].isDestroyed&&this.menuInfo[e].destroy();for(var s=[],o=0;o<i.length;o++){var l=i[o];e?this.stringAggregateTypes.indexOf(l)>-1&&s.indexOf(l)<0&&(n[e].push({text:this.parent.localeObj.getConstant(l),id:this.parent.element.id+"StringMenu_"+l}),s.push(l)):this.parent.getAllSummaryType().indexOf(l)>-1&&s.indexOf(l)<0&&(n[e].push({text:this.parent.localeObj.getConstant(l),id:this.parent.element.id+"_"+l}),s.push(l))}n[e].length>a&&(n[e].splice(a),n[e].push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"}));var d={items:n[e],enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.cssClass,beforeOpen:this.beforeMenuOpen.bind(this,e),onClose:function(){(0,t.select)("#"+r.buttonElement.id,r.parentElement).focus()},select:this.selectOptionInContextMenu.bind(this)},p=document.getElementById(this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu"));null!==p?p.innerHTML="":p=(0,t.createElement)("ul",{id:this.parent.element.id+(e?"valueFieldStringContextMenu":"valueFieldContextMenu")}),this.parent.element.appendChild(p),this.menuInfo[e]=new ds.ContextMenu(d),this.menuInfo[e].isStringTemplate=!0,this.menuInfo[e].appendTo(p)},e.prototype.getMenuItem=function(e){for(var t=[],i=0;i<this.parent.aggregateTypes.length;i++){var a=this.parent.aggregateTypes[i];e?this.stringAggregateTypes.indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a):this.parent.getAllSummaryType().indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a)}return t},e.prototype.beforeMenuOpen=function(e,t){t.element.style.zIndex=(this.menuInfo[e].element.style.zIndex+3).toString(),t.element.style.display="inline"},e.prototype.createValueSettingsDialog=function(e,i,a){this.parentElement=i;var r=(0,t.createElement)("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":e.getAttribute("data-uid")?e.getAttribute("data-uid"):e.getAttribute("data-field")}});this.parentElement.appendChild(r);var n=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(e,a),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){n.hide()},buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"pivotfieldlist"!==this.parent.getModuleName()||"Popup"!==this.parent.renderMode,target:this.parentElement,close:this.removeDialog.bind(this),cssClass:this.parent.cssClass});n.isStringTemplate=!0,n.appendTo(r)},e.prototype.createFieldOptions=function(e,i){var a=this,n=e.getAttribute("data-caption"),s=i&&"MoreOption"!==i?i:e.getAttribute("data-type"),o=e.getAttribute("data-basefield"),l=e.getAttribute("data-baseitem");s="undefined"!==s.toString()?s:"Sum";for(var d=[],p=this.parent.aggregateTypes,h=[],u=0;u<p.length;u++)this.parent.getAllSummaryType().indexOf(p[u])>-1&&h.indexOf(p[u])<0&&(d.push({value:p[u],text:this.parent.localeObj.getConstant(p[u])}),h.push(p[u]));var c=["DifferenceFrom","PercentageOfDifferenceFrom"],g=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],m=(0,t.extend)([],this.parent.dataSourceSettings.rows,null,!0);m=m.concat(this.parent.dataSourceSettings.columns);for(var f=[],S=[],v=0,y=m;v<y.length;v++){var b=y[v],C=b.name,x=b.caption?b.caption:b.name;f.push({value:C,text:x})}if(0===Object.keys(f).length)f.push({value:"",text:""}),o="",S=[];else{var w="undefined"!==(o=o&&"undefined"!==o.toString()&&"null"!==o.toString()?o:f[0].value).toString()?o:f[0].value,T=r.isDateField(w,this.parent.engineModule);S=this.parent.engineModule.fieldList[w].dateMember.map((function(e){return T?e.formattedText:a.parent.engineModule.getFormattedValue(e.actualText,w).formattedText}))}l="undefined"!==l.toString()?l:S[0];var M=(0,t.createElement)("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":s,"data-caption":n,"data-basefield":o,"data-baseitem":l}}),D=(0,t.createElement)("div",{className:"e-field-name-text-container"}),O=(0,t.createElement)("div",{className:"e-field-option-container"}),P=(0,t.createElement)("div",{className:"e-type-option-container"}),N=(0,t.createElement)("div",{className:"e-base-field-option-container"}),E=(0,t.createElement)("div",{className:"e-base-item-option-container"}),I=(0,t.createElement)("div",{className:"e-field-name-title"});I.innerText=this.parent.localeObj.getConstant("sourceName")+" ";var F=(0,t.createElement)("div",{className:"e-field-name-content"});F.innerText=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(e.getAttribute("data-uid")?e.getAttribute("data-uid"):e.getAttribute("data-field")):e.getAttribute("data-uid")?e.getAttribute("data-uid"):e.getAttribute("data-field"),this.buttonElement=this.buttonElement?this.buttonElement:document.querySelector("."+F.innerText);var L=(0,t.createElement)("div",{className:"e-type-option-text"});L.innerText=this.parent.localeObj.getConstant("sourceCaption");var A=(0,t.createElement)("div",{className:"e-base-field-option-text"});A.innerText=this.parent.localeObj.getConstant("summarizeValuesBy");var R=(0,t.createElement)("div",{className:"e-base-item-option-text"});R.innerText=this.parent.localeObj.getConstant("baseField");var k=(0,t.createElement)("div",{className:"e-type-option-text"});k.innerText=this.parent.localeObj.getConstant("baseItem");var j=(0,t.createElement)("div",{className:"e-caption-input-container"}),q=(0,t.createElement)("div",{id:this.parentElement.id+"_type_option"}),H=(0,t.createElement)("div",{id:this.parentElement.id+"_base_field_option"}),V=(0,t.createElement)("div",{id:this.parentElement.id+"_base_item_option"}),U=(0,t.createElement)("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});D.appendChild(I),D.appendChild(F),j.appendChild(L),j.appendChild(U),P.appendChild(A),N.appendChild(R),E.appendChild(k),P.appendChild(q),N.appendChild(H),E.appendChild(V),O.appendChild(D),O.appendChild(j),O.appendChild(P),O.appendChild(N),O.appendChild(E),M.appendChild(O);var B=this,_=new hs.DropDownList({dataSource:d,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:s,cssClass:Sr+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){G.enabled=-1!==g.indexOf(e.value),z.enabled=-1!==c.indexOf(e.value),z.enabled&&1===z.dataSource.length&&(z.dataSource=S,z.dataBind())}});_.isStringTemplate=!0,_.appendTo(q);var G=new hs.DropDownList({dataSource:f,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:o,enabled:-1!==g.indexOf(s),cssClass:Sr+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var t=r.isDateField(e.value,a.parent.engineModule);S=B.parent.engineModule.fieldList[e.value].dateMember.map((function(i){return t?i.formattedText:a.parent.engineModule.getFormattedValue(i.actualText,e.value).formattedText})),z.dataSource=S,z.value=S[0],z.filterBarPlaceholder=B.parent.localeObj.getConstant("example")+" "+S[0],z.itemData=null,z.dataBind()}});G.isStringTemplate=!0,G.appendTo(H);var z=new hs.DropDownList({dataSource:S,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:l,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+S[0],enabled:-1!==c.indexOf(s),cssClass:vr+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%"});z.isStringTemplate=!0,z.appendTo(V);var W=new ps.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:n,width:"100%",cssClass:this.parent.cssClass});return W.isStringTemplate=!0,W.appendTo(U),M},e.prototype.selectOptionInContextMenu=function(e){if(null!==e.item.text){var i=this.currentMenu.parentElement,a=r.getFieldInfo(i?i.getAttribute("data-uid"):"",this.parent);if(this.parent.actionObj.actionName=Kt,this.parent.actionObj.fieldInfo=a.fieldItem,this.parent.actionBeginMethod())return;var n=e.item.id.split("_").pop();try{if("MoreOption"===n||"PercentageOfDifferenceFrom"===n||"PercentageOfParentTotal"===n||"DifferenceFrom"===n)this.createValueSettingsDialog(i,this.parentElement,n);else{var s=i.getAttribute("data-uid"),o=this.parent.dataSourceSettings.values,l=i.querySelector("."+Ca),d=e.item.text+" "+this.parent.localeObj.getConstant("of")+" "+this.parent.engineModule.fieldList[s].caption;d=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(d):d,l.innerText=d,l.setAttribute("title",d),i.setAttribute("data-type",n);for(var p=0;p<this.parent.dataSourceSettings.values.length;p++)if(this.parent.dataSourceSettings.values[p].name===s){var h=(0,t.extend)({},o[p].properties?o[p].properties:o[p],null,!0);h.type=n,this.parent.engineModule.fieldList[s].aggregateType=n,o.splice(p,1,h),this.parent.lastAggregationInfo=h}this.updateDataSource()}}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.updateDataSource=function(e){!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotview"===this.parent.getModuleName()?this.parent.updateDataSource(e):"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(Ge,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent()},e.prototype.updateValueSettings=function(){var e,i=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_ValueDialog",document),o.Dialog),a=i.element,n=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"type_input_option"),ps.MaskedTextBox),s=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_type_option"),hs.DropDownList),l=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_base_field_option"),hs.DropDownList),d=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_base_item_option"),hs.DropDownList),p=a.getAttribute("data-field");if(this.parentElement.querySelector("."+ya)&&(e=this.parentElement.querySelector("."+ya+"."+p.replace(/[^A-Z0-9]/gi,""))),e){var h=e.querySelector("."+Ca),u=this.parent.localeObj.getConstant(s.value)+" "+this.parent.localeObj.getConstant("of")+" "+n.value;u=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(u):u,h.innerText=u,h.setAttribute("title",u),e.setAttribute("data-type",s.value),e.setAttribute("data-caption",n.value),e.setAttribute("data-basefield",l.value),e.setAttribute("data-baseitem",d.value)}var c=r.getFieldByName(p,this.parent.dataSourceSettings.values);(c=c.properties?c.properties:c).caption=n.value,c.type=s.value,c.baseField=l.value,c.baseItem=d.value,i.close(),this.parent.lastAggregationInfo=c,this.updateDataSource(!0)},e.prototype.removeDialog=function(){this.buttonElement&&(0,t.select)("#"+this.buttonElement.id,this.parentElement)&&(0,t.select)("#"+this.buttonElement.id,this.parentElement).focus();var e=(0,t.select)("#"+this.parentElement.id+"_ValueDialog",document),i=e?(0,t.getInstance)(e,o.Dialog):null;i&&!i.isDestroyed&&i.destroy(),document.getElementById(this.parentElement.id+"_ValueDialog")&&(0,t.remove)(document.getElementById(this.parentElement.id+"_ValueDialog"))},e.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&(void 0===this.menuInfo[1]||this.menuInfo[1].isDestroyed||this.menuInfo[1].destroy(),void 0===this.menuInfo[0]||this.menuInfo[0].isDestroyed||this.menuInfo[0].destroy())},e}(),cs=function(){function e(e){this.isAutoFitEnabled=!1,this.pivotColumns=[],this.indentCollection={},this.colPos=0,this.lastSpan=0,this.lvlCollection={},this.hierarchyCollection={},this.lvlPosCollection={},this.hierarchyPosCollection={},this.position=0,this.measurePos=0,this.maxMeasurePos=0,this.hierarchyCount=0,this.actualText="",this.drilledLevelInfo={},this.parent=e,this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=this.parent.gridSettings,this.formatList=this.getFormatList(),this.aggMenu=new us(this.parent)}return e.prototype.render=function(e){if(e&&this.initProperties(),this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=this.parent.gridSettings,this.formatList=this.getFormatList(),this.parent.gridCellCollection={},this.injectGridModules(this.parent),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector("."+en)){this.parent.notEmpty=!0,this.engine.isEngineUpdated?(this.parent.enableValueSorting&&"olap"!==this.parent.dataType&&(this.engine.valueContent=this.frameDataSource("value")),this.engine.isEngineUpdated=!1):(this.engine.headerContent=this.frameDataSource("header"),this.engine.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:("olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0&&this.parent.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData?this.frameGridDataSource(this.engine.valueContent):this.frameDataSource("value")},!0),this.parent.grid.notify("datasource-modified",{}),this.parent.isScrolling&&(this.parent.resizeInfo={}),this.parent.grid.refreshColumns(),this.isAutoFitEnabled?this.addPivotAutoFitClass():this.removePivotAutoFitClass(),this.parent.element.querySelector("."+en).querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),!this.gridSettings.allowAutoResizing&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ka)&&this.parent.groupingBarModule.refreshUI(),this.parent.isScrolling||this.calculateGridHeight(!0)}else{this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData);var i=(0,t.createElement)("div",{id:this.parent.element.id+"_grid"});this.parent.element.appendChild(i),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo(i)}this.parent.grid.on(ls.headerRefreshed,this.refreshHeader,this)},e.prototype.initProperties=function(){this.rowStartPos=void 0,this.maxIndent=void 0,this.resColWidth=void 0,this.isOverflows=void 0,this.indentCollection={},this.formatList=void 0,this.colPos=0,this.colGrandPos=void 0,this.rowGrandPos=void 0,this.lastSpan=0,this.field=void 0,this.fieldCaption=void 0,this.lvlCollection={},this.hierarchyCollection={},this.lvlPosCollection={},this.hierarchyPosCollection={},this.position=0,this.measurePos=0,this.maxMeasurePos=0,this.hierarchyCount=0,this.actualText="",this.timeOutObj=void 0},e.prototype.refreshHeader=function(){var e=this.parent.element.querySelector("."+vn);if(this.parent.enableVirtualization&&!(0,t.isNullOrUndefined)(e)){var i=(0,t.closest)(e,"."+In).querySelector("."+Sn),a=this.parent.element.querySelector("."+bn),r=e.querySelector("."+fn);if(this.parent.virtualHeaderDiv=a.querySelector("."+fn),a.querySelector("."+fn)?(0,t.remove)(a.querySelector("."+fn)):this.parent.virtualHeaderDiv=(0,t.createElement)("div",{className:fn}),a.appendChild(this.parent.virtualHeaderDiv),r&&(0,t.setStyleAttribute)(this.parent.virtualHeaderDiv,{height:0,width:r.style.width}),a.querySelector("."+Mr)){(0,t.setStyleAttribute)(a.querySelector("."+Mr),{transform:e.querySelector("."+Mr).style.transform.split(",")[0]+",0px)"});var n=parseInt(a.querySelector("."+Mr).style.transform.split("(")[1].split(",")[0].split("px")[0],10);this.parent.enableRtl?this.parent.element.querySelector("."+is).style.right=Number(n)+"px":this.parent.element.querySelector("."+is).style.left=Number(-n)+"px"}var s=this.parent.isAdaptive?e:i&&"none"!==i.style.display?i:e.parentElement;a.scrollLeft=s.scrollLeft}},e.prototype.bindGrid=function(e,t){this.injectGridModules(e),this.parent.grid=new ls.Grid({cssClass:this.parent.cssClass,frozenColumns:1,frozenRows:0,enableHover:!1,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.gridSettings.allowAutoResizing?this.parent.width:400:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,clipMode:this.gridSettings.clipMode,allowReordering:!this.parent.showGroupingBar&&this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,beforeExcelExport:this.beforeExcelExport.bind(this),resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this),beforePdfExport:this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,pdfExportComplete:this.pdfExportComplete.bind(this),excelExportComplete:this.excelExportComplete.bind(this),actionComplete:this.actionComplete.bind(this)}),this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this)),this.parent.grid.on("export-DataBound",this.excelDataBound.bind(this))},e.prototype.actionComplete=function(e){e&&"refresh"===e.requestType&&this.isAutoFitEnabled&&this.removePivotAutoFitClass()},e.prototype.addPivotAutoFitClass=function(){document.body.classList.contains(tn)||document.body.classList.add(tn),document.body.classList.contains(os)||document.body.classList.add(os)},e.prototype.removePivotAutoFitClass=function(){document.body.classList.contains(tn)&&document.body.classList.remove(tn),document.body.classList.contains(os)&&document.body.classList.remove(os)},e.prototype.headerRefreshed=function(){var e=this.parent.element.querySelector("."+bn);this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&!(0,t.isNullOrUndefined)(e)&&e.querySelector("."+Mr)&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ka)&&(this.parent.lastGridSettings=void 0,this.parent.groupingBarModule.setGridRowWidth())},e.prototype.beforeExcelExport=function(e){(0,t.isNullOrUndefined)(e.gridObject.columns)||(0,t.isNullOrUndefined)(this.parent.pivotColumns)||(e.gridObject.columns[e.gridObject.columns.length-1].width=this.parent.pivotColumns[this.parent.pivotColumns.length-1].width),this.parent.trigger(Ne,e)},e.prototype.rowSelected=function(e){this.parent.renderModule.selected(),this.parent.trigger(q,e)},e.prototype.rowDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger(H,e)},e.prototype.cellSelected=function(e){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger(L,e))},e.prototype.cellSelecting=function(e){this.parent.trigger(A,e)},e.prototype.cellDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger(j,e)},e.prototype.queryCellInfo=function(e){this.parent.renderModule.rowCellBoundEvent(e)},e.prototype.headerCellInfo=function(e){this.parent.renderModule.columnCellBoundEvent(e)},e.prototype.excelHeaderQueryCellInfo=function(e){this.parent.renderModule.excelColumnEvent(e)},e.prototype.pdfQueryCellInfo=function(e){this.parent.renderModule.pdfRowEvent(e)},e.prototype.excelQueryCellInfo=function(e){this.parent.renderModule.excelRowEvent(e)},e.prototype.pdfHeaderQueryCellInfo=function(e){this.parent.renderModule.pdfColumnEvent(e)},e.prototype.pdfExportComplete=function(e){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0);var t={type:"PDF",promise:e.promise};this.parent.trigger(f,t)},e.prototype.excelExportComplete=function(e){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0);var t={type:"Excel/CSV",promise:e.promise};this.parent.trigger(f,t)},e.prototype.dataBound=function(){this.parent.notEmpty&&this.calculateGridHeight(!0),this.parent.isScrolling=!1,this.setFocusOnLastCell(),(0,t.isNullOrUndefined)(this.parent.renderReactTemplates)||this.parent.renderReactTemplates(),this.parent.isInitial&&(this.parent.isInitial=!1,this.parent.refreshData(),this.parent.enableVirtualization&&this.parent.onContentReady()),this.parent.notify(Ye,{})},e.prototype.setFocusOnLastCell=function(){if(this.parent.keyboardModule&&this.parent.keyboardModule.event&&"TD"===this.parent.keyboardModule.event.target.nodeName){var e=this.parent.grid.serviceLocator.getService("focus");e.setFocusedElement(this.parent.keyboardModule.event.target),e.focus(this.parent.keyboardModule.event),(0,t.addClass)([this.parent.keyboardModule.event.target],["e-focused","e-focus"]),this.parent.keyboardModule.event.target.setAttribute("tabindex","0"),this.parent.keyboardModule.event=void 0}},e.prototype.getCellElement=function(e){var i=(0,t.closest)(e,"td");return(0,t.isNullOrUndefined)(i)&&(i=(0,t.closest)(e,"th")),i},e.prototype.contextMenuOpen=function(e){var i=this;e.element&&this.parent.cssClass&&(0,t.addClass)([e.element.parentElement],this.parent.cssClass);for(var a=function(a){var s=n.parent.lastCellClicked?n.parent.lastCellClicked:n.parent.isAdaptive?e.event.target:n.parent.lastCellClicked,o=n.getCellElement(s),l=void 0,d=void 0;if(!o||o&&0===Number(o.getAttribute("index"))&&0===Number(o.getAttribute("data-colindex")))return e.cancel=!0,{value:void 0};(o.classList.contains("e-valuesheader")||o.classList.contains("e-stot"))&&(l=!0),n.parent.allowGrouping&&n.parent.groupingModule&&!n.validateField(o)&&(d=!0);var p=Number(o.getAttribute("index")),h=Number(o.getAttribute("data-colindex")),u=n.parent.pivotValues[p][h];switch(a.id){case n.parent.element.id+"_expand":o.querySelectorAll("."+Tr).length>0?((0,t.selectAll)("#"+n.parent.element.id+"_expand",e.element)&&(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.add(rn),(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.remove(rn),(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.contains(nn)&&((0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.remove(nn),(0,t.select)("#"+n.parent.element.id+"_collapse",e.element).classList.remove(nn))):l?(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.add(nn):(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.add(rn);break;case n.parent.element.id+"_collapse":o.querySelectorAll("."+wr).length>0?((0,t.select)("#"+n.parent.element.id+"_expand",e.element)&&(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.add(rn),(0,t.select)("#"+n.parent.element.id+"_collapse",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_collapse",e.element).classList.remove(rn),(0,t.select)("#"+n.parent.element.id+"_collapse",e.element).classList.contains(nn)&&((0,t.select)("#"+n.parent.element.id+"_collapse",e.element).classList.remove(nn),(0,t.select)("#"+n.parent.element.id+"_expand",e.element).classList.remove(nn))):l?(0,t.select)("#"+n.parent.element.id+"_collapse",e.element).classList.add(nn):(0,t.select)("#"+n.parent.element.id+"_collapse",e.element).classList.add(rn);break;case n.parent.element.id+"_custom_group":d||2!==e.items.length||(e.cancel=!0),(0,t.selectAll)("#"+n.parent.element.id+"_custom_group",e.element)&&(0,t.addClass)([(0,t.select)("#"+n.parent.element.id+"_custom_group",e.element)],nn),d&&(0,t.selectAll)("#"+n.parent.element.id+"_custom_group",e.element)&&(0,t.removeClass)([(0,t.select)("#"+n.parent.element.id+"_custom_group",e.element)],nn);break;case n.parent.element.id+"_custom_ungroup":if((0,t.selectAll)("#"+n.parent.element.id+"_custom_ungroup",e.element)&&(0,t.addClass)([(0,t.select)("#"+n.parent.element.id+"_custom_ungroup",e.element)],nn),d){var c=!1,g=o.getAttribute("fieldname"),m=r.getFieldByName(g,n.parent.dataSourceSettings.groupSettings);if(m&&"Custom"===m.type||n.parent.engineModule.fieldList[g].isCustomField&&g.indexOf("_custom_group")>-1){if(m=r.getFieldByName(g.replace("_custom_group",""),n.parent.dataSourceSettings.groupSettings)){var f=n.parent.engineModule.pivotValues[Number(o.getAttribute("index"))][Number(o.getAttribute("data-colindex"))],S=n.parent.groupingModule.getSelectedCells(f.axis,g,f.actualText.toString());S.push({axis:f.axis,fieldName:g,name:f.actualText.toString(),cellInfo:f});for(var v=n.parent.groupingModule.getSelectedOptions(S),y=0,b=m.customGroups;y<b.length;y++){var C=b[y];if(v.indexOf(C.groupName)>-1){c=!0;break}}}}else(m&&("Date"===m.type||"Number"===m.type)||n.parent.engineModule.fieldList[g].isCustomField&&g.indexOf("_date_group")>-1)&&(c=!0);(0,t.selectAll)("#"+n.parent.element.id+"_custom_ungroup",e.element)&&c&&(0,t.removeClass)([(0,t.select)("#"+n.parent.element.id+"_custom_ungroup",e.element)],nn)}break;case n.parent.element.id+"_drillthrough":n.parent.allowDrillThrough?o.classList.contains("e-summary")?(0,t.select)("#"+n.parent.element.id+"_drillthrough",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_drillthrough",e.element).classList.remove(rn):""===o.innerText&&(0,t.select)("#"+n.parent.element.id+"_drillthrough",e.element)&&(0,t.select)("#"+n.parent.element.id+"_drillthrough",e.element).classList.add(rn):(0,t.select)("#"+n.parent.element.id+"_drillthrough",e.element)&&(0,t.select)("#"+n.parent.element.id+"_drillthrough",e.element).classList.add(rn);break;case n.parent.element.id+"_sortasc":n.parent.enableValueSorting?o.querySelectorAll(".e-icon-descending").length>0?((0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element)?(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element).classList.add(rn):(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element).classList.remove(rn),(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element).classList.remove(rn)):(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element).classList.remove(rn):(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element)&&(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element).classList.add(rn);break;case n.parent.element.id+"_sortdesc":n.parent.enableValueSorting?o.querySelectorAll(".e-icon-ascending").length>0?((0,t.select)("#"+n.parent.element.id+"_sortasc",e.element)?(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element).classList.add(rn):(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element).classList.remove(rn),(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element).classList.remove(rn)):(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_sortasc",e.element).classList.remove(rn):(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element)&&(0,t.select)("#"+n.parent.element.id+"_sortdesc",e.element).classList.add(rn);break;case n.parent.element.id+"_CalculatedField":n.parent.allowCalculatedField||(0,t.select)("#"+n.parent.element.id+"_CalculatedField",e.element).classList.add(rn);break;case n.parent.element.id+"_pdf":n.parent.allowPdfExport||(0,t.select)("#"+n.parent.element.id+"_pdf",e.element).classList.add(rn);break;case n.parent.element.id+"_excel":n.parent.allowExcelExport||(0,t.select)("#"+n.parent.element.id+"_excel",e.element).classList.add(rn);break;case n.parent.element.id+"_csv":n.parent.allowExcelExport||(0,t.select)("#"+n.parent.element.id+"_csv",e.element).classList.add(rn);break;case n.parent.element.id+"_exporting":n.parent.allowExcelExport||n.parent.allowPdfExport||(0,t.select)("#"+n.parent.element.id+"_exporting",e.element).classList.add(rn);break;case n.parent.element.id+"_aggregate":if((0,t.select)("#"+n.parent.element.id+"_aggregate",e.element)&&!(0,t.select)("#"+n.parent.element.id+"_aggregate",e.element).classList.contains(rn)&&(0,t.select)("#"+n.parent.element.id+"_aggregate",e.element).classList.add(rn),(o.classList.contains("e-valuesheader")||o.classList.contains("e-valuescontent")||o.classList.contains("e-stot")&&o.classList.contains("e-rowsheader"))&&"olap"!==n.parent.dataType){var x;""!==o.innerText&&(x=n.parent.engineModule.fieldList[u.actualText.toString()].type);var w={cancel:!1,fieldName:u.actualText.toString(),aggregateTypes:n.getMenuItem(x).slice(),displayMenuCount:7};n.parent.trigger(Re,w,(function(r){if(!r.cancel&&""!==o.innerText){for(var n=[],s=[],l=0;l<r.aggregateTypes.length;l++){var d=r.aggregateTypes[l];"number"!==x?["Count","DistinctCount"].indexOf(d)>-1&&s.indexOf(d)<0&&(n.push({text:i.parent.localeObj.getConstant(d),id:i.parent.element.id+"_Agg"+d}),s.push(d)):i.parent.getAllSummaryType().indexOf(d)>-1&&s.indexOf(d)<0&&(n.push({text:i.parent.localeObj.getConstant(d),id:i.parent.element.id+"_Agg"+d}),s.push(d))}n.length>r.displayMenuCount&&(n.splice(r.displayMenuCount),n.push({text:i.parent.localeObj.getConstant("MoreOption"),id:i.parent.element.id+"_AggMoreOption"})),n&&n.length>=1&&(a.items=n,(0,t.select)("#"+i.parent.element.id+"_aggregate",e.element).classList.remove(rn))}}))}}},n=this,s=0,o=e.items;s<o.length;s++){var l=a(o[s]);if("object"==typeof l)return l.value}this.parent.trigger(Me,e)},e.prototype.getMenuItem=function(e){for(var t=[],i=0;i<this.parent.aggregateTypes.length;i++){var a=this.parent.aggregateTypes[i];"string"!==e?this.parent.getAllSummaryType().indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a):["Count","DistinctCount"].indexOf(a)>-1&&-1===t.indexOf(a)&&t.push(a)}return t},e.prototype.contextMenuClick=function(e){var t,i=this,a=this.parent.lastCellClicked,r=e.item.id,n=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),s={},o=this.getCellElement(a),l=Number(o.getAttribute("index")),d=Number(o.getAttribute("data-colindex")),p=this.parent.pivotValues[l][d];switch(e.item.id.indexOf(this.parent.element.id+"_Agg")>-1&&(this.field=this.parent.engineModule.fieldList[p.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[p.actualText.toString()].caption,t=e.item.id.split("_Agg")[1]),r){case this.parent.element.id+"_pdf":s={pdfDoc:void 0,isBlob:!1,isMultipleExport:!1,pdfExportProperties:{fileName:"Export.pdf"}},this.parent.trigger(m,s,(function(e){i.parent.pdfExport(e.pdfExportProperties,e.isMultipleExport,e.pdfDoc,e.isBlob)}));break;case this.parent.element.id+"_excel":s={isBlob:!1,isMultipleExport:!1,workbook:void 0,excelExportProperties:{fileName:"Export.xlsx"}},this.parent.trigger(m,s,(function(e){i.parent.excelExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"_csv":s={isBlob:!1,workbook:void 0,isMultipleExport:!1,excelExportProperties:{fileName:"Export.csv"}},this.parent.trigger(m,s,(function(e){i.parent.csvExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"_drillthrough_menu":o.dispatchEvent(n);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:p.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:p.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(o.querySelectorAll("."+Tr)){var h=o.querySelectorAll("."+Tr)[0];this.parent.onDrill(h)}break;case this.parent.element.id+"_collapse":if(o.querySelectorAll("."+wr)){var u=o.querySelectorAll("."+wr)[0];this.parent.onDrill(u)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggMoreOption":case this.parent.element.id+"_AggDifferenceFrom":case this.parent.element.id+"_AggPercentageOfDifferenceFrom":case this.parent.element.id+"_AggPercentageOfParentTotal":o.setAttribute("id",this.field),o.setAttribute("data-caption",this.fieldCaption),o.setAttribute("data-field",this.field),o.setAttribute("data-type",this.engine.fieldList[p.actualText.toString()].aggregateType),o.setAttribute("data-basefield",this.engine.fieldList[p.actualText.toString()].baseField),o.setAttribute("data-baseItem",this.engine.fieldList[p.actualText.toString()].baseItem),this.aggMenu.createValueSettingsDialog(o,this.parent.element,t);break;case this.parent.element.id+"_Agg"+t:this.updateAggregate(t);break;case this.parent.element.id+"_custom_group":case this.parent.element.id+"_custom_ungroup":if(this.parent.groupingModule){var c={target:o,option:r,parentElement:this.parent.element};this.parent.notify(rt,c),this.parent.grid.contextMenuModule.contextMenu.close()}}this.parent.trigger(Te,e)},e.prototype.validateColumnTotalcell=function(e){for(var t=Object.keys(this.engine.headerContent),i=!1,a="",r=t.length-1;r>=0;r--){var n=this.engine.headerContent[Number(t[r])][e];if(!n)return!1;if(i=!(!i||""===a)&&a===n.valueSort.axis,a=n.valueSort.axis?n.valueSort.axis.toString():"","sum"===n.type&&(i=!0),i&&n.members&&n.members.length>0)return!0}return!1},e.prototype.validateField=function(e){var t=!1;if(e.classList.contains("e-stot")||e.classList.contains("e-gtot")||e.classList.contains("e-valuescontent")||e.classList.contains("e-valuesheader"))t=!0;else{var i=e.getAttribute("fieldName");if(!i||""===i){var a=Number(e.getAttribute("index")),r=Number(e.getAttribute("data-colindex"));i=this.engine.pivotValues[a][r].actualText}for(var n=this.parent.dataSourceSettings.values,s=0;s<n.length;s++)if(this.parent.dataSourceSettings.values[s].name===i){t=!0;break}}return t},e.prototype.updateAggregate=function(e){if(this.parent.getAllSummaryType().indexOf(e)>-1)for(var t=this.parent.dataSourceSettings.values,i=0;i<this.parent.dataSourceSettings.values.length;i++){if(this.parent.dataSourceSettings.values[i].name===this.field)t[i].type=e}},e.prototype.injectGridModules=function(e){ls.Grid.Inject(ls.Freeze),e.allowExcelExport&&ls.Grid.Inject(ls.ExcelExport),e.allowPdfExport&&ls.Grid.Inject(ls.PdfExport),ls.Grid.Inject(ls.Selection,ls.Reorder,ls.Resize),this.gridSettings.contextMenuItems&&ls.Grid.Inject(ls.ContextMenu)},e.prototype.updateGridSettings=function(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.clipMode=this.gridSettings.clipMode,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=!this.parent.showGroupingBar&&this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){var e=Object.keys(this.parent.lastGridSettings);e.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height),e.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width),this.updatePivotColumns(),(e.indexOf("allowTextWrap")>-1||e.indexOf("clipMode")>-1)&&this.parent.layoutRefresh()}this.clearColumnSelection()},e.prototype.updatePivotColumns=function(){for(var e=Object.keys(this.parent.lastGridSettings),i=0;i<this.parent.pivotColumns.length;i++)for(var a=this.parent.pivotColumns[i],r=0;r<e.length;r++){var n=e[r];(0,t.isNullOrUndefined)(this.parent.pivotColumns[i][n])||(a[n]=this.parent.lastGridSettings[n])}this.parent.fillGridColumns(this.parent.grid.columns)},e.prototype.clearColumnSelection=function(){(0,t.removeClass)(this.parent.element.querySelectorAll("."+On),[On,xn])},e.prototype.appendValueSortIcon=function(e,i,a,r,n){var s="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,o=this.parent.dataSourceSettings.valueSortSettings;if(this.parent.enableValueSorting&&o&&""!==o.headerText){var l="grand sum"!==e.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?s.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:s.headerContent.length-1:0,d=o&&o.headerText?e.valueSort.levelName===o.headerText:r===o.columnIndex;void 0!==o&&d&&(a===l||a+1===l&&e.level>-1&&s.headerContent[a+1][r]&&-1===s.headerContent[a+1][r].level)&&"column"===this.parent.dataSourceSettings.valueAxis&&i.querySelector("div div").appendChild((0,t.createElement)("span",{className:("Descending"===o.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv e-value-sort-icon":"e-icon-ascending e-icons e-ascending e-sortfilterdiv e-value-sort-icon")+(e.hasChild?" e-value-sort-align":""),styles:"Right"===n.headerTextAlign?"float : left":""}))}return i},e.prototype.onResizeStop=function(e){if(e.column.columns&&e.column.columns.length>0)this.getChildColumnWidth(e.column.columns);else{var i="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[i]=Number(e.column.width.toString().split("px")[0])}if(this.parent.enableVirtualization&&"0.formattedText"===e.column.field){if(this.parent.dataSourceSettings.values.length>1&&!(0,t.isNullOrUndefined)(this.parent.grid.columns[this.parent.grid.columns.length-1].columns)){var a=this.parent.grid.columns[this.parent.grid.columns.length-1].columns;a[a.length-1].minWidth=this.parent.gridSettings.columnWidth}else this.parent.grid.columns[this.parent.grid.columns.length-1].minWidth=this.parent.gridSettings.columnWidth;this.parent.layoutRefresh()}this.setGroupWidth(e),this.calculateGridHeight(!0),this.parent.grid.hideScroll()},e.prototype.getChildColumnWidth=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];if(a.columns&&a.columns.length>0)this.getChildColumnWidth(a.columns);else{var r=a.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[r]=Number(a.width.toString().split("px")[0])}}},e.prototype.setGroupWidth=function(e){if(this.parent.enableVirtualization&&"0.formattedText"===e.column.field&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ka)&&Number(e.column.width.toString().split("px")[0])<250&&(e.cancel=!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ka)){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth){e.cancel=!0;var t=this.parent.grid.columns;t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector("."+Tn).querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector("."+ba).querySelector("col").style.width=this.resColWidth+"px"}this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px";var i=this.parent.element.querySelector("."+Tn).offsetHeight;this.parent.element.querySelector(".e-group-rows").style.height=i+"px"}if(e.cancel){var a="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[a]=Number(e.column.width.toString().split("px")[0]),this.parent.enableVirtualization&&this.parent.layoutRefresh()}this.parent.enableVirtualization&&(this.parent.resizedValue=e.cancel||"0.formattedText"!==e.column.field?this.parent.resizedValue:Number(e.column.width.toString().split("px")[0])),this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?N:P,e)},e.prototype.selected=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.onSelect.bind(this),300)},e.prototype.onSelect=function(){for(var e={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},t=this.parent.element.querySelectorAll("."+Cn+",."+xn),i=0;i<t.length;i++){var a=t[i],r=Number(a.getAttribute("data-colindex")),n=Number(a.getAttribute("index")),s=this.engine.pivotValues[n][r];s&&("value"===s.axis?e.selectedCellsInfo.push({currentCell:s,value:s.value,columnHeaders:s.columnHeaders,rowHeaders:s.rowHeaders,measure:s.actualText.toString()}):"column"===s.axis?e.selectedCellsInfo.push({currentCell:s,value:s.formattedText,columnHeaders:s.valueSort.levelName,rowHeaders:"",measure:""}):e.selectedCellsInfo.push({currentCell:s,value:s.formattedText,columnHeaders:"",rowHeaders:s.valueSort.levelName,measure:""}))}this.parent.trigger(k,e)},e.prototype.rowCellBoundEvent=function(e){var i=e.cell;if(i&&this.parent.notEmpty&&this.engine.headerContent){var a=this.parent.hyperlinkSettings.cssClass,r=e.data[0],n=r.valueSort&&r.valueSort.levelName===(0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+r.formattedText);i.setAttribute("index",r.rowIndex?r.rowIndex.toString():"0");var s=this.parent.pivotValues[r.rowIndex]&&this.parent.pivotValues[r.rowIndex][Number(i.getAttribute("data-colindex"))]?this.parent.pivotValues[r.rowIndex][Number(i.getAttribute("data-colindex"))]:null;if("0"===i.getAttribute("data-colindex")){if("pivot"===this.parent.dataType){var o=r.type&&"value"===r.type;i.innerText="";var l=r.valueSort?r.valueSort.levelName.toString():"",d=r.actualText?r.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,p=l.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(d?d-1:d),h=p?p-1:0;if("Bottom"===this.parent.dataSourceSettings.subTotalsPosition&&!(0,t.isNullOrUndefined)(l)){var u=r.isSum?"value"===r.type?l.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+(this.parent.engineModule.valueAxisFields[r.actualText].caption?this.parent.engineModule.valueAxisFields[r.actualText].caption:this.parent.engineModule.valueAxisFields[r.actualText].name))[0]:"":l;r.isSum&&("value"!==r.type||this.drilledLevelInfo[u])?h-=1:r.isSum||(1===u.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length&&(this.drilledLevelInfo={}),r.members&&r.members.length>0&&(this.drilledLevelInfo[u]=r.isDrilled))}do{h>0&&i.appendChild((0,t.createElement)("span",{className:0===h?"":Fr})),h--}while(h>-1);h=p?p-1:0,this.lastSpan=p?this.lastSpan:0,!r.hasChild&&(o?0:h)>0&&i.appendChild((0,t.createElement)("span",{className:Lr}));var c=void 0;if(this.parent.dataSourceSettings.rows.length>0&&(!r.valueSort||Object.keys(r.valueSort).length>0)){if(o)for(var g=0,m=this.parent.dataSourceSettings.values;g<m.length;g++){var f=m[g],S=f.caption?f.caption:f.name;if(l.indexOf(S)>-1){c=f.name;break}}else c=r.level>-1&&this.parent.dataSourceSettings.rows[r.level]?this.parent.dataSourceSettings.rows[r.level].name:"";i.setAttribute("fieldname",c)}}else i=this.onOlapRowCellBoundEvent(i,r);var v=r.formattedText;if(r.type)if("grand sum"===r.type){this.rowGrandPos=r.rowIndex,i.classList.add("e-gtot");var y=this.parent.dataSourceSettings.values;v=(0,t.isNullOrUndefined)(r.valueSort.axis)?0===this.parent.dataSourceSettings.rows.length&&1===y.length&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(y[y.length-1].type)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(y[y.length-1].caption)?y[y.length-1].name:y[y.length-1].caption):this.parent.localeObj.getConstant("grandTotal"):r.formattedText}else r.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+r.formattedText?(i.classList.add("e-gtot"),v=n?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[r.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+r.formattedText:v):"sum"===r.type&&3!==r.memberType?v=r.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):i.classList.add("e-stot");i.classList.add(Or),!0!==r.hasChild||r.isNamedSet||i.appendChild((0,t.createElement)("div",{className:(!0===r.isDrilled?wr:Tr)+" "+Yi,attrs:{title:!0===r.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}})),i.appendChild((0,t.createElement)("span",{className:Nr,innerHTML:this.parent.isRowCellHyperlink||r.enableHyperlink?'<a  data-url="'+v+'" class="e-hyperlinkcell '+a+'">'+v+"</a>":v}));var b=this.parent.pivotView.dataSourceSettings.valueSortSettings;this.parent.enableValueSorting&&b&&b.headerText&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(i.getAttribute("index"))][0]&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName===b.headerText&&i.appendChild((0,t.createElement)("span",{className:("Descending"===b.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv e-value-sort-icon":"e-icon-ascending e-icons e-ascending e-sortfilterdiv e-value-sort-icon")+(r.hasChild?" e-value-sort-align":""),styles:"right"===i.style.textAlign?"float: left":""}))}else{var C=i.innerText;i.innerText="",i.classList.add("e-valuescontent"),r=e.data[Number(i.getAttribute("data-colindex"))],(r=(0,t.isNullOrUndefined)(r)?e.column.customAttributes.cell:r).isGrandSum=!!n||r.isGrandSum,r.isSum&&i.classList.add("e-summary");var x=(0,t.isNullOrUndefined)(r.isGrandSum)&&!(0,t.isNullOrUndefined)(this.parent.olapEngineModule)&&"column"===this.parent.olapEngineModule.olapValueAxis&&"olap"===this.parent.dataType&&this.colGrandPos-this.parent.dataSourceSettings.values.length<Number(i.getAttribute("data-colindex"));r.isGrandSum||x||this.colGrandPos===Number(i.getAttribute("data-colindex"))||this.rowGrandPos===Number(i.getAttribute("index"))?i.classList.add("e-gtot"):("olap"===this.parent.dataType?r.isSum:this.validateColumnTotalcell(r.colIndex))&&i.classList.add("e-colstot"),s&&s.cssClass&&i.classList.add(s.cssClass),i.appendChild((0,t.createElement)("span",{className:Nr,innerHTML:-1!==i.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===i.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||r.enableHyperlink?'<a data-url="'+C+'" class="e-hyperlinkcell '+a+'">'+C+"</a>":C})),this.parent.gridSettings.allowReordering&&!this.parent.showGroupingBar&&i.setAttribute("data-colindex",e.column.customAttributes?e.column.customAttributes.cell.colIndex.toString():e.column.index.toString())}this.parent.cellTemplate&&this.appendTemplate(i,s),this.unWireEvents(i),this.wireEvents(i)}e.pivotview=this.parent,this.parent.trigger(M,e)},e.prototype.appendTemplate=function(e,i){var a=this.parent.getCellTemplate()({targetCell:e,cellInfo:i},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,e);if(a&&""!==a&&a.length>0)if(this.parent.enableHtmlSanitizer)if(this.parent.isVue||this.parent.isVue3){var r=(0,t.createElement)("div");r.innerHTML=t.SanitizeHtmlHelper.sanitize(a),(0,t.append)([r.firstChild],e)}else this.parent.appendHtml(e,t.SanitizeHtmlHelper.sanitize(a[0].outerHTML));else this.parent.isVue||this.parent.isVue3?(0,t.append)(a,e):this.parent.appendHtml(e,a[0].outerHTML)},e.prototype.onOlapRowCellBoundEvent=function(e,i){e.innerText="";var a=this.engine.rowMeasurePos;if(this.parent.enableVirtualization){if(i.ordinal>-1&&this.parent.olapEngineModule.tupRowInfo.length>0){var r=this.parent.olapEngineModule.tupRowInfo[i.ordinal],n=3===i.memberType?this.engine.fieldList[i.actualText.toString()].tag.toString():i.actualText.toString(),s=r.uNameCollection.indexOf(n),o=(r.uNameCollection.substring(0,s)+(3===i.memberType?"":i.actualText.toString())).split("::[").map((function(e){return"["===e[0]?e:"["+e}));3===i.memberType&&a&&o.push(i.actualText.toString());for(var l=-1,d=0,p=!1,h=0;h<o.length;h++){l+=o[h].split("~~").length;var u="2"!==r.typeCollection[h]&&(!!(this.engine.fieldList[r.members[h].getAttribute("Hierarchy")]&&this.engine.fieldList[r.members[h].getAttribute("Hierarchy")].isHierarchy&&h<this.parent.dataSourceSettings.rows.length-1&&!this.parent.dataSourceSettings.rows[h+1].isNamedSet&&this.parent.dataSourceSettings.rows[h+1].name.indexOf("[Measures]")<0&&this.engine.fieldList[this.parent.dataSourceSettings.rows[h+1].name]&&this.engine.fieldList[this.parent.dataSourceSettings.rows[h+1].name].hasAllMember)||Number(r.members[h].querySelector("CHILDREN_CARDINALITY").textContent)>0);d+=h>0&&p&&!u?1:0,p=u}for(var c=0,g=0;g<l;g++)e.appendChild((0,t.createElement)("span",{className:Fr})),c++;for(g=0;g<d&&l>0;g++)e.appendChild((0,t.createElement)("span",{className:Lr}));this.indentCollection[i.rowIndex]=c,this.maxIndent=this.maxIndent>c?this.maxIndent:c}}else{var m=i.hierarchy,f=i.valueSort?i.valueSort.levelName.toString():"",S=-1===i.level?this.measurePos:f.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-1,v=3===i.memberType?S+"."+i.levelUniqueName:i.levelUniqueName,y=(u=i.hasChild,!1);if(i.isSum&&3===i.memberType){for(var b=this.lvlCollection[i.parentUniqueName].position,C=b+1;C<this.position;C++)delete this.lvlCollection[this.lvlPosCollection[C]],delete this.lvlPosCollection[C];this.position=this.position>b+1?b+1:this.position,y=!0,this.measurePos=this.lvlCollection[i.parentUniqueName].position}if(!this.lvlCollection[v]&&v)this.lvlPosCollection[this.position]=v,this.lvlCollection[v]={position:this.position,hasChild:u},this.position++;else if(v){for(var x=this.lvlCollection[v].position,w=x+1;w<this.position;w++)delete this.lvlCollection[this.lvlPosCollection[w]],delete this.lvlPosCollection[w];this.position=this.position>x+1?x+1:this.position}if(!this.hierarchyCollection[m]&&m)this.hierarchyPosCollection[this.hierarchyCount]=m,this.hierarchyCollection[m]={lvlPosition:this.position-1,hierarchyPOs:this.hierarchyCount},this.hierarchyCount++;else if(m){var T=this.hierarchyCollection[m].hierarchyPOs;for(w=T+1;w<this.hierarchyCount;w++)delete this.hierarchyCollection[this.hierarchyPosCollection[w]],delete this.hierarchyPosCollection[w];this.hierarchyCount=this.hierarchyCount>T+1?T+1:this.hierarchyCount}if(3!==i.memberType&&v&&this.lvlCollection[v]){var M=this.hierarchyCollection[m]?this.hierarchyCollection[m].hierarchyPOs:-1;this.measurePos=a<=M&&this.hierarchyPosCollection[a+1]?this.measurePos:this.lvlCollection[v].position}var D=this.lvlCollection[v]?this.lvlCollection[v].position:-1;D=y?D-1:D;var O=0;for(c=0;O<=D&&D>0&&i.level>-1;){var P=this.lvlCollection[this.lvlPosCollection[O]].hasChild;(p=O>0&&this.lvlCollection[this.lvlPosCollection[O-1]].hasChild)&&!P&&e.appendChild((0,t.createElement)("span",{className:Lr})),O!==D&&(e.appendChild((0,t.createElement)("span",{className:Fr})),c++),O++}"Top"!==this.parent.dataSourceSettings.grandTotalsPosition||(0,t.isNullOrUndefined)(this.parent.olapEngineModule)||"row"!==this.parent.olapEngineModule.olapValueAxis||"olap"!==this.parent.dataType||0!==i.valueSort.levelName.toString().indexOf(this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter)||e.appendChild((0,t.createElement)("span",{className:Fr})),3===i.memberType&&-1===i.level&&Object.keys(this.lvlCollection).length>1&&(e.appendChild((0,t.createElement)("span",{className:Fr})),c++),this.indentCollection[i.rowIndex]=c,this.maxIndent=this.maxIndent>c?this.maxIndent:c}return e.setAttribute("fieldname",i.hierarchy),!!this.parent.olapEngineModule.tupRowInfo[i.ordinal]&&(0===this.parent.olapEngineModule.tupRowInfo[i.ordinal].measurePosition?1===this.parent.olapEngineModule.tupRowInfo[i.ordinal].allStartPos:0===this.parent.olapEngineModule.tupRowInfo[i.ordinal].allStartPos)&&e.classList.add("e-gtot"),e},e.prototype.columnCellBoundEvent=function(e){if(e.cell.column&&e.cell.column.customAttributes){var i=e.cell.column.customAttributes.cell,a=e.node;if(i){for(var r=this.parent.hyperlinkSettings.cssClass,n=!1,s=0,o=this.parent.dataSourceSettings.values;s<o.length;s++){var l=o[s];l.name===i.actualText&&(n=!0,a.setAttribute("fieldname",l.name))}-1===i.level&&!i.rowSpan||-1===i.rowSpan?e.node.style.display="none":i.rowSpan>1&&(e.node.setAttribute("rowspan",i.rowSpan.toString()),e.node.setAttribute("aria-rowspan",i.rowSpan.toString()),i.rowIndex+i.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("data-colindex",i.colIndex.toString()),e.node.setAttribute("index",i.rowIndex.toString());var d=void 0;"pivot"===this.parent.dataType?(!n&&!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&n&&i.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(d=i.level>-1&&this.parent.dataSourceSettings.columns[i.level]?this.parent.dataSourceSettings.columns[i.level].name:"",a.setAttribute("fieldname",d)),this.validateColumnTotalcell(i.colIndex)&&a.classList.add("e-colstot")):a=this.onOlapColumnCellBoundEvent(a,i);var p=0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&i.valueSort&&i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText;if(i.type||p){a.classList.add("grand sum"===i.type?"e-gtot":"e-stot"),"grand sum"===i.type?this.colGrandPos=i.colIndex:i.type&&a.classList.add("e-colstot");var h="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,u="grand sum"===i.type?(0,t.isNullOrUndefined)(i.valueSort.axis)||"olap"===this.parent.dataType?this.parent.localeObj.getConstant("grandTotal"):i.formattedText:i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");u=p&&h.fieldList?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(h.fieldList[i.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+i.formattedText:u,null!==a.querySelector(".e-headertext")?a.querySelector(".e-headertext").innerText=u:a.querySelector(".e-stackedheadercelldiv").innerText=u}if(a.classList.add(Dr),this.parent.isColumnCellHyperlink||i.enableHyperlink)if(a.querySelector(".e-stackedheadercelldiv")){var c=a.querySelector(".e-stackedheadercelldiv").innerText;a.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+c+'" class="e-hyperlinkcell '+r+'">'+c+"</a>"}else if(a.querySelector(".e-headertext")){c=a.querySelector(".e-headertext").innerText;a.querySelector(".e-headertext").innerHTML='<a data-url="'+c+'" class="e-hyperlinkcell '+r+'">'+c+"</a>"}if(!0!==i.hasChild||i.isNamedSet)this.updateWrapper(a);else{var g=a.querySelector(".e-headercelldiv");g&&(g.style.height="auto",g.style.lineHeight="normal");var m=(0,t.createElement)("div",{className:(!0===i.isDrilled?wr:Tr)+" "+Yi,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}});window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?a.children[0].style.display="table":a.children[0].style.display="block",this.updateWrapper(a,m)}a=this.appendValueSortIcon(i,a,i.rowIndex,i.colIndex,e.cell.column),this.parent.cellTemplate&&this.appendTemplate(a,this.parent.pivotValues[i.rowIndex][i.colIndex]);for(var f=this.parent.dataSourceSettings.values.length,S=0;S<f;S++)if(this.parent.dataSourceSettings.values[S].name===i.actualText){if("olap"===this.parent.dataType)!!this.parent.olapEngineModule.tupColumnInfo[i.ordinal]&&(0===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].measurePosition?1===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].allStartPos:0===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].allStartPos)&&a.classList.add("e-gtot");i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText||i.valueSort.levelName==="Grand Total"+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText?a.classList.add("e-gtot"):a.classList.add("e-valuesheader")}this.unWireEvents(a),this.wireEvents(a)}}this.parent.trigger(D,e)},e.prototype.updateWrapper=function(e,i){if(e.querySelectorAll(".e-headercelldiv").length>0||e.querySelectorAll(".e-stackedheadercelldiv").length>0){var a=(0,t.createElement)("div",{className:"e-pivotcell-container"}),r=(0,t.createElement)("div",{className:(i?"e-stackedheadertext":"e-headertext")+" "+Nr,innerHTML:e.querySelectorAll(".e-headercelldiv").length>0?e.querySelector(".e-headercelldiv").innerHTML:e.querySelector(".e-stackedheadercelldiv").innerHTML});i&&a.append(i),a.append(r),e.children[0].innerHTML="",e.children[0].append(a)}return e},e.prototype.onOlapColumnCellBoundEvent=function(e,t){e.setAttribute("fieldname",3===t.memberType?t.actualText.toString():t.hierarchy);var i=this.engine.headerContent[t.rowIndex]?this.engine.headerContent[t.rowIndex][t.colIndex-1]:void 0;return i&&i.actualText===t.actualText&&i.type===t.type&&i.colSpan>1&&(e.style.display="none"),t.rowIndex===this.engine.headerContent.length-1&&2===t.memberType&&(e.style.display=this.isSpannedCell(this.engine.headerContent.length,t)?"none":e.style.display),e},e.prototype.isSpannedCell=function(e,t){for(var i,a,r=this.engine.headerContent[t.rowIndex-1]?this.engine.headerContent[t.rowIndex-1][t.colIndex]:void 0;r&&(r.memberType===t.memberType||r.type&&t.type);)r.rowSpan>0&&(i=r.rowSpan,a=r.rowIndex),r=this.engine.headerContent[r.rowIndex-1]?this.engine.headerContent[r.rowIndex-1][t.colIndex]:void 0;return a+i>=e},e.prototype.onHyperCellClick=function(e){var i=e.target.parentElement.parentElement,a={currentCell:i=i.className.indexOf("e-headercelldiv")>-1?i.parentElement:i,data:this.engine.pivotValues[Number(i.getAttribute("index"))][Number(i.getAttribute("data-colindex"))],cancel:!0,nativeEvent:e};this.parent.trigger(O,a,(function(e){if(!e.cancel){a.currentCell=(0,t.getElement)(a.currentCell);var i=a.currentCell.getAttribute("data-url")?a.currentCell.getAttribute("data-url"):a.currentCell.querySelector("a").getAttribute("data-url");window.open(i)}}))},e.prototype.getRowStartPos=function(){for(var e,t=this.parent.pivotValues,i=0;i<(t?t.length:0);i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e},e.prototype.frameDataSource=function(e){var t=[];if(("pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0||"olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url&&this.engine.pivotValues.length>0)&&this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var i=0,a=this.parent.pivotValues,r="value"===e?this.rowStartPos:0,n="value"===e?a?a.length:0:this.rowStartPos,s=r;s<n;s++)if(a[s]){t[i="header"===e?s:i]={};for(var o=0;o<a[s].length;o++)a[s][o]&&(t[i][o]=a[s][o]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t},e.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},e.prototype.calculateColWidth=function(e){(0,t.isNullOrUndefined)(this.parent.resizedValue)||(this.parent.resizedValue=this.parent.showGroupingBar&&this.parent.resizedValue<250?250:this.parent.resizedValue),this.resColWidth=(0,t.isNullOrUndefined)(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue;var i=this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.element.offsetWidth?this.parent.element.offsetWidth:this.parent.element.getBoundingClientRect().width,a=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*i:i:Number(this.parent.width);if(a-=this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth,e-=1,this.isOverflows=!(e*this.gridSettings.columnWidth<a),!this.isOverflows){var r=this.calculateGridHeight(),n="auto"===r?this.parent.getHeightAsNumber():r,s=this.engine&&this.engine.headerContent?Object.keys(this.engine.headerContent).length:1,o=n-this.gridSettings.rowHeight*s;this.engine&&this.engine.valueContent&&this.gridSettings.rowHeight*this.engine.valueContent.length>o&&(a-=(0,ls.getScrollBarWidth)())}var l=e*this.gridSettings.columnWidth<a?a/e:this.gridSettings.columnWidth;return this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(l):this.gridSettings.columnWidth},e.prototype.resizeColWidth=function(e){(0,t.isNullOrUndefined)(this.parent.resizedValue)||(this.parent.resizedValue=this.parent.showGroupingBar&&this.parent.resizedValue<250?250:this.parent.resizedValue),this.resColWidth=(0,t.isNullOrUndefined)(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue;var i=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);e-=1,i-=this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth,this.isOverflows=!(e*this.gridSettings.columnWidth<i);var a=e*this.gridSettings.columnWidth<i?i/e:this.gridSettings.columnWidth;return this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(a):this.gridSettings.columnWidth},e.prototype.calculateGridWidth=function(){var e=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return 0===t&&(t=this.parent.element.parentElement.getBoundingClientRect().width?this.parent.element.parentElement.getBoundingClientRect().width:this.parent.element.parentElement.offsetWidth),"auto"===this.gridSettings.width?"auto"===this.parent.width?e=t:this.parent.width.toString().indexOf("%")>-1&&(e=parseFloat(this.parent.width.toString())/100*t):e=this.gridSettings.width,!this.gridSettings.allowAutoResizing&&e>this.parent.totColWidth?this.parent.totColWidth:e},e.prototype.calculateGridHeight=function(e){var t=this.parent.element.querySelector("."+en+" ."+ba),i=this.parent.height,a=this.parent.getHeightAsNumber();if(t&&(a=isNaN(a)?a>this.parent.minHeight?a:this.parent.minHeight:t.offsetWidth<t.querySelector("."+Mr).offsetWidth?a-(0,ls.getScrollBarWidth)():a,this.parent.showToolbar&&"Chart"!==this.parent.currentView||!this.parent.showToolbar&&"Chart"!==this.parent.displayOption.view))if("auto"===this.gridSettings.height&&a&&this.parent.element.querySelector("."+En))if(i=(i=a-(this.parent.element.querySelector("."+En).offsetHeight+(this.parent.element.querySelector("."+Qn)?this.parent.element.querySelector("."+Qn).offsetHeight:0)+(this.parent.element.querySelector("."+kn)?42:0)+(this.parent.element.querySelector("."+Zn)?this.parent.element.querySelector("."+Zn).offsetHeight:0))-1)<40?40:i,e){var r=t.querySelector("."+Mr).offsetHeight,n=t.querySelector("."+Mr).offsetHeight,s=t.querySelector("."+Mr).offsetWidth,o=t.offsetWidth<=s;i>=r&&(!o||i>=n)&&!!!(o&&i-r<18)?this.parent.grid.height="auto":(this.parent.grid.height=i,this.parent.grid.dataBind())}else i>this.engine.valueContent.length*this.gridSettings.rowHeight&&(i="auto");else i=this.gridSettings.height;return i<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:i},e.prototype.frameStackedHeaders=function(){var e=this.parent.pivotColumns,i="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,a=this.parent.grid.columnModel,r=!1,n=!(!this.parent.toolbarModule||!this.parent.toolbarModule.isReportChange)||!!this.parent.actionObj&&("Sort value"===this.parent.actionObj.actionName&&1===i.valueAxis||"Sort field"===this.parent.actionObj.actionName&&"columns"===this.parent.actionObj.fieldInfo.axis||this.parent.pivotFieldListModule&&"Sort field"===this.parent.pivotFieldListModule.actionObj.actionName&&"columns"===this.parent.pivotFieldListModule.actionObj.fieldInfo.axis);if(this.pivotColumns=[],("olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||this.parent.dataSourceSettings.values.length>0&&this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url&&this.engine.pivotValues.length>0)&&!this.engine.isEmptyData){var s=this.engine.headerContent.length,o=[],l=[],d=this.calculateColWidth(this.engine.pivotValues&&this.engine.pivotValues[0]?this.engine.pivotValues[0].length:0),p="olap"===this.parent.dataType&&!(0,t.isNullOrUndefined)(this.engine.colMeasurePos)&&this.engine.colDepth-1===this.parent.olapEngineModule.colMeasurePos;do{var h=[],u=0;s--;var c=this.engine.headerContent[s],g=c?Object.keys(c).length:0;if(c)for(var m=0,f=Object.keys(c).length+(c[0]?0:1);m<f;m++){var S=c[m]&&c[m].colSpan?3!==c[m].memberType||3===c[m].memberType&&!p||0===s?c[m].colSpan:o[m]:1;S="olap"===this.parent.dataType&&(0,t.isNullOrUndefined)(S)?1:S;var v=c[m]?"grand sum"===c[m].type?(0,t.isNullOrUndefined)(c[m].valueSort.axis)?this.parent.localeObj.getConstant("grandTotal"):c[m].formattedText:"sum"===c[m].type?c[m].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):c[m].formattedText:"";if(v=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(v):v,s===this.engine.headerContent.length-1)S=1,r=e.length-1===g&&(!n&&!this.parent.isEmptyGrid&&e[u]&&e[u].autoFit),h[u]={field:m+".formattedText",headerText:v,customAttributes:{cell:this.cloneDataWithoutIndex(c[m])},width:r?a[u].width:c[m]&&c[m].valueSort?this.setSavedWidth(c[m].valueSort.levelName,d):this.resColWidth,minWidth:r&&u===g?a[a.length-1].minWidth:30,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,textAlign:this.parent.enableRtl?"Left":"Right",headerTextAlign:this.parent.enableRtl?"Right":"Left"},m===g&&(this.lastColumn=h[u]);else if(o[m]){for(var y=S,b=[],C=m;y>0;){if(h[u]){if(!this.pivotColumns[l[C]])break;b.push(this.pivotColumns[l[C]])}else h[u]={headerText:v,field:c[m]?c[m].valueSort.levelName:"",customAttributes:{cell:this.cloneDataWithoutIndex(c[m])},width:r&&0===u&&!n&&!this.parent.isEmptyGrid&&e[0].autoFit?a[0].width:c[m]?this.setSavedWidth(c[m].valueSort.levelName,d):this.resColWidth,minWidth:30,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,headerTextAlign:this.parent.enableRtl?"Right":"Left"},b=[this.pivotColumns[l[C]]];this.isAutoFitEnabled=!!this.isAutoFitEnabled||r,y-=o[C],C+=o[C]}h[u].columns=b}h[u]&&(h[u].clipMode=this.gridSettings.clipMode),o[m]=S,l[m]=u,u++,m=m+S-1}this.pivotColumns=h.length>0?h:this.pivotColumns}while(s>0);this.pivotColumns[0]={field:"0.formattedText",width:r&&!n&&!this.parent.isEmptyGrid&&e[0].autoFit?a[0].width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,clipMode:this.parent.gridSettings.clipMode}}else this.pivotColumns=this.frameEmptyColumns();return this.parent.toolbarModule&&this.parent.showToolbar&&(this.parent.toolbarModule.isReportChange=!1),r=this.parent.pivotColumns.length>0&&this.parent.pivotColumns[this.parent.pivotColumns.length-1].autoFit,this.lastColumn&&!r&&(this.lastColumn.width=Number(this.lastColumn.width)-3),this.parent.triggerColumnRenderEvent(this.pivotColumns),this.pivotColumns},e.prototype.setSavedWidth=function(e,i){return i="0.formattedText"!==e||(0,t.isNullOrUndefined)(this.parent.resizedValue)?this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:i:this.parent.resizedValue},e.prototype.frameEmptyColumns=function(){var e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t-3}),e},e.prototype.getFormatList=function(){for(var e={},i=0;i<this.parent.dataSourceSettings.values.length;i++){var a=this.parent.dataSourceSettings.values[i],r="N";if("olap"===this.parent.dataType){if(this.parent.olapEngineModule.fieldList[a.name]&&!(0,t.isNullOrUndefined)(this.parent.olapEngineModule.fieldList[a.name].formatString)){var n=this.parent.olapEngineModule.formatFields[a.name]?this.parent.olapEngineModule.formatFields[a.name].format:this.parent.olapEngineModule.fieldList[a.name].formatString;r=(n="Standard"===n?"Number":n).indexOf("#")>-1||null!==n.match(/\d/)?n:n[0]+"2"}}else if(["PercentageOfDifferenceFrom","PercentageOfRowTotal","PercentageOfColumnTotal","PercentageOfGrandTotal","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"].indexOf(a.type)>-1?r="P2":["PopulationStDev","SampleStDev","PopulationVar","SampleVar","Index"].indexOf(a.type)>-1&&(r=void 0),this.parent.dataSourceSettings.formatSettings.length>0)for(var s=0;s<this.parent.dataSourceSettings.formatSettings.length;s++){var o=this.parent.dataSourceSettings.formatSettings[s];if(a.name===o.name){r=o.format;break}}e[a.name]=r}return e},e.prototype.getValidHeader=function(e,i){var a,r=this.parent.dataSourceSettings.values;if("row"===i){var n=e;if(0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length){if(0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+n.value===n.data[0].valueSort.levelName)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[n.value.toString()].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+n.value.toString();if(1===r.length&&0===this.parent.dataSourceSettings.rows.length)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(r[r.length-1].type)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(r[r.length-1].caption)?r[r.length-1].name:r[r.length-1].caption)}a=n.value}else if("column"===i){n=e;if((0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length)&&!(0,t.isNullOrUndefined)(e.gridCell.column.customAttributes)&&0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+n.gridCell.column.customAttributes.cell.formattedText===n.gridCell.column.customAttributes.cell.valueSort.levelName)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[n.gridCell.column.customAttributes.cell.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+n.gridCell.column.customAttributes.cell.formattedText;a=n.cell.value}return a},e.prototype.excelColumnEvent=function(e){0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&(e.cell.value=this.getValidHeader(e,"column")),void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),e=this.exportHeaderEvent(e,"XLSX"),this.parent.trigger(y,e)},e.prototype.pdfColumnEvent=function(e){0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&(e.cell.value=this.getValidHeader(e,"column")),void 0!==e.gridCell&&"auto"===e.gridCell.column.width&&(this.parent.lastColumn=e.gridCell.column,e.gridCell.column.width=e.gridCell.column.minWidth),this.parent.trigger(b,e)},e.prototype.excelRowEvent=function(e){var i;if("0.formattedText"===e.column.field){var a=e.data[0],r=a.type&&"value"===a.type,n=0;if("olap"===this.parent.dataType)n=this.indentCollection[a.rowIndex];else{var s=a.valueSort?a.valueSort.levelName.toString():"",o=a.actualText?a.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,l=s.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(o?o-1:o);n=l?l-1:0}this.colPos=0,e.style={hAlign:"Left",indent:2*n},this.lastSpan=r?this.lastSpan:n}else if(this.colPos++,i=e.data[e.column.customAttributes.cell?e.column.customAttributes.cell.colIndex:this.colPos],(0,t.isNullOrUndefined)(i.value)||(0,t.isNullOrUndefined)(i.formattedText)||""===i.formattedText)e.value="Excel"===this.parent.exportType?null:"";else{var d="pivot"===this.parent.dataType&&this.parent.engineModule?this.parent.engineModule.aggregatedValueMatrix:void 0;d&&d[i.rowIndex]&&d[i.rowIndex][i.colIndex]?e.value=d[i.rowIndex][i.colIndex]:e.value=(0,t.isNullOrUndefined)(i.value)||"#DIV/0!"===i.formattedText?i.formattedText:i.value}e=this.exportContentEvent(e),0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&(e.value="0.formattedText"===e.column.field?this.getValidHeader(e,"row"):e.value),this.parent.trigger(C,e),i&&(e.style&&this.formatList[i.actualText]&&(e.style.type="number",e.style.numberFormat=e.style.numberFormat?e.style.numberFormat:this.formatList[i.actualText]),e.column.format=this.formatList[i.actualText])},e.prototype.pdfRowEvent=function(e){if("0.formattedText"===(e=this.exportContentEvent(e)).column.field){var t=0,i=e.data[0],a=i.type&&"value"===i.type;if("olap"===this.parent.dataType)t=this.indentCollection[i.rowIndex];else{var r=i.valueSort?i.valueSort.levelName.toString():"",n=i.actualText?i.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,s=r.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(n?n-1:n);t=s?s-1:0}e.style={paragraphIndent:10*t},this.lastSpan=a?this.lastSpan:t,0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&(e.value=this.getValidHeader(e,"row"))}this.parent.trigger(x,e)},e.prototype.excelDataBound=function(e){for(var t=e.excelRows,i=Object.keys(this.engine.headerContent).length,a=0;a<i;a++){for(var r=t[a].cells,n=[],s=0;s<r.length;s++)-1!==r[s].rowSpan&&n.push(r[s]);t[a].cells=n}},e.prototype.exportHeaderEvent=function(e,i){var a=1;if(e.gridCell.column.customAttributes){var r=e.gridCell.column.customAttributes.cell;a=r.rowSpan>0?r.rowSpan:1,"XLSX"===i&&(r.rowSpan>0?a=r.rowSpan:(0,t.isNullOrUndefined)(r.type)||0===r.level||(a=1,e.cell.rowSpan=1)),this.actualText=r.actualText}else a=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan!==a&&a>0&&(e.cell.rowSpan=a),e},e.prototype.frameGridDataSource=function(e){for(var t=[],i=0;i<e.length;i++){var a=0;t[i]={};for(var r=Object.keys(e[i]),n=0;null!=e[i]&&n<r.length;n++)for(;a<r.length;)t[i][Number(r[a])]=this.cloneDataWithoutIndex(e[i][Number(r[a])]),a++}return t},e.prototype.cloneDataWithoutIndex=function(e){if(!(0,t.isNullOrUndefined)(e)){for(var i=Object.keys(e),a=0,r={};a<i.length;)"indexObject"!==i[a]&&"index"!==i[a]&&(r[i[a]]=e[i[a]]),a++;return r}return e},e.prototype.exportContentEvent=function(e){var i=e.data[Number(e.column.field.split(".formattedText")[0])];return e.value="grand sum"===i.type?(0,t.isNullOrUndefined)(i.valueSort.axis)?this.parent.localeObj.getConstant("grandTotal"):i.formattedText:e.value,e},e.prototype.unWireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.remove(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},e.prototype.wireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.add(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},e}(),gs=function(){function e(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",shiftE:"shift+E",delete:"delete",enter:"enter",escape:"escape",upArrow:"upArrow",downArrow:"downArrow",altJ:"alt+J"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"shiftE":this.processEdit(e);break;case"delete":this.processDelete(e);break;case"enter":this.processEnter(e);break;case"escape":this.processClose(e);break;case"upArrow":case"downArrow":this.processFilterNodeSelection(e);break;case"altJ":this.processComponentFocus(e)}},e.prototype.processComponentFocus=function(e){if(this.parent.element)return this.parent.element.focus(),e.stopPropagation(),void e.preventDefault()},e.prototype.getButtonElement=function(e){for(var t=[].slice.call(this.parent.element.querySelectorAll("."+ya)),i=0,a=t.length;i<a;i++)if(t[i].getAttribute("data-uid")===e.getAttribute("data-uid"))return t[i];return e},e.prototype.processEnter=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+ya))return i.querySelector("."+ta)&&(0,t.closest)(i,"."+Qa)?i.querySelector("."+ta).click():i.querySelector("."+on)?i.querySelector("."+on).click():!i.querySelector("."+xa)||(0,t.closest)(i,"."+Qa)||(0,t.closest)(i,"."+$r)?i.querySelector("."+Ma)&&!(0,t.closest)(i,"."+Qa)&&i.querySelector("."+Ma).click():(i.querySelector("."+xa).click(),this.getButtonElement(i).focus()),void e.preventDefault()},e.prototype.processSort=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+ya)&&i.querySelector("."+xa)&&!(0,t.closest)(i,"."+Qa)&&!(0,t.closest)(i,"."+$r))return i.querySelector("."+xa).click(),this.getButtonElement(i).focus(),void e.preventDefault()},e.prototype.processEdit=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+ya)&&i.querySelector("."+on))return i.querySelector("."+on).click(),void e.preventDefault()},e.prototype.processFilter=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+ya)&&i.querySelector("."+Ma)&&!(0,t.closest)(i,"."+Qa)){if(i.querySelector("."+Ma).click(),this.parent&&this.parent.control&&"pivotview"===this.parent.moduleName&&this.parent.control.grid&&this.parent.control.showGroupingBar&&this.parent.control.groupingBarModule&&(0,t.closest)(i,"."+Ja)&&this.parent.filterDialog&&this.parent.filterDialog.dialogPopUp&&!this.parent.filterDialog.dialogPopUp.isDestroyed&&this.parent.filterDialog.dialogPopUp.element){var a=this.parent.filterDialog.dialogPopUp.element,r=this.parent.filterDialog.allowExcelLikeFilter;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){a&&a.classList.contains("e-popup-open")&&(r&&a.querySelector(".e-dlg-closeicon-btn")?a.querySelector(".e-dlg-closeicon-btn").focus():a.querySelector("input")&&a.querySelector("input").focus())}))}e.preventDefault()}else;},e.prototype.processFilterNodeSelection=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+kr)&&40===e.keyCode){if((r=(0,t.closest)(i,"."+La).querySelector("."+Aa))&&r.querySelector("li")){var a=r.querySelector("li");return r.querySelector("li#_active")&&((0,t.removeClass)([r.querySelector("li#_active")],["e-node-focus"]),r.querySelector("li#_active").removeAttribute("id")),a.setAttribute("id","_active"),(0,t.addClass)([a],["e-node-focus"]),a.focus(),void e.preventDefault()}}else if(i&&(0,t.closest)(i,"."+Aa)&&38===e.keyCode){var r;if((r=(0,t.closest)(i,"."+Aa)).querySelector("li#_active.e-node-focus")&&r.querySelector("li")&&r.querySelector("li").classList.contains("e-prev-active-node")&&r.querySelector("li")===r.querySelector("li#_active.e-node-focus")){(0,t.removeClass)(r.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node");var n=(0,t.closest)(i,"."+La).querySelector("."+kr);if(n&&n.querySelector("li"))return(a=n.querySelector("li")).setAttribute("id","_active"),(0,t.addClass)([a],["e-node-focus"]),a.focus(),void e.preventDefault()}}else i&&i.id===this.parent.parentID+"_inputbox"&&("upArrow"===e.action?i.parentElement.querySelector(".e-spin-up").click():"downArrow"===e.action&&i.parentElement.querySelector(".e-spin-down").click())},e.prototype.processDelete=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+ya)&&i.querySelector("."+Pa))return i.querySelector("."+Pa).click(),void e.preventDefault()},e.prototype.processClose=function(e){var i=e.target;if(i&&(0,t.closest)(i,".e-popup.e-popup-open")){var a=(0,t.getInstance)((0,t.closest)(i,".e-popup.e-popup-open"),o.Dialog);if(a&&!a.closeOnEscape){var r=a.element.getAttribute("data-fieldName");if(a.hide(),this.parent.element)for(var n=0,s=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));n<s.length;n++){var l=s[n];if(l.getAttribute("data-uid")===r){l.focus();break}}return void e.preventDefault()}}},e.prototype.destroy=function(){this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null)},e}(),ms=function(){function e(e){this.searchListItem=[],this.parent=e}return e.prototype.updateSorting=function(e){if(!e.target.classList.contains(Ma)&&!e.target.classList.contains(Pa)){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var i=e.target,a=void 0,n=void 0,s=void 0;i.id?(a=i.getAttribute("data-uid"),n=[].slice.call(i.querySelectorAll("."+Ta))):(a=i.parentElement.getAttribute("data-uid"),n=[].slice.call(i.parentElement.querySelectorAll("."+Ta))),s=0!==n.length;var o=r.getFieldByName(a,this.parent.dataSourceSettings.sortSettings),l=this.parent.engineModule&&this.parent.engineModule.fieldList[a]&&this.parent.engineModule.fieldList[a].membersOrder?this.parent.engineModule.fieldList[a].membersOrder.slice():[];if((0,t.isNullOrUndefined)(o)){p={name:a,order:s?"Ascending":"Descending",membersOrder:o?o.membersOrder:l};this.parent.dataSourceSettings.sortSettings.push(p)}else{for(var d=0;d<this.parent.dataSourceSettings.sortSettings.length;d++)if(this.parent.dataSourceSettings.sortSettings[d].name===a){this.parent.dataSourceSettings.sortSettings.splice(d,1);break}var p={name:a,order:s?"Ascending":"Descending",membersOrder:o?o.membersOrder:l};this.parent.dataSourceSettings.sortSettings.push(p)}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1],s?(0,t.removeClass)([i],Ta):(0,t.addClass)([i],Ta)}},e.prototype.updateFiltering=function(e){var i=e.target,a=i.parentElement.getAttribute("data-uid"),n=i.parentElement.textContent,s=!1,o=[],l=[];if(this.parent.dataSourceSettings.allowMemberFilter)if("olap"===this.parent.dataType)l=this.getOlapData(a,s);else{var d=this.parent.engineModule.fieldList[a],p=r.getClonedData(d.dateMember);this.parent.isDateField=r.isDateField(a,this.parent.engineModule);var h=d&&d.membersOrder?d.membersOrder.slice():[],u=void 0;"Out of Range"===p[0].actualText?(u=p[0],p.splice(0,1)):"Out of Range"===p[p.length-1].actualText&&(u=p[p.length-1],p.splice(p.length-1,1));var c={fieldName:a,sortOrder:d.sort,members:h&&h.length>0?h:Object.keys(p),IsOrderChanged:!1},g=!1,m=!(!d||!d.isAlphanumeric)||void 0;if(h&&h.length>0)p=r.applyCustomSort(c,p,m);else{var f=this.parent.dataSourceSettings.groupSettings.filter((function(e){return e.name===a&&"number"===e.type.toLocaleLowerCase()})),S=!(0,t.isNullOrUndefined)(f)&&f.length>0;p=r.applyHeadersSort(p,c.sortOrder,m,S),g=!0}var v=r.getFilterItemByName(a,this.parent.dataSourceSettings.filterSettings);if((0,t.isNullOrUndefined)(v)||(s=!(!this.isValidFilterItemsAvail(a,v)||"Include"!==v.type),o=v.items?v.items:[]),u&&("Ascending"===c.sortOrder?"Grand Total"===p[p.length-1].actualText?p.splice(p.length-1,0,u):p.splice(p.length,0,u):"Grand Total"===p[0].actualText?p.splice(1,0,u):p.splice(0,0,u)),g){for(var y=[],b=0,C=0;b<p.length;b++)"Grand Total"!==p[b].actualText&&(y[C++]=p[b].actualText);c.members=y}this.parent.control.trigger(we,c),c.IsOrderChanged&&(p=r.applyCustomSort(c,p,m,!0)),l=this.getTreeData(s,p,o,a)}this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var x=this.parent.control.filterTargetID;(0,t.isNullOrUndefined)(x)&&(x="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Container")),this.parent.filterDialog.createFilterDialog(l,a,n,x)},e.prototype.isValidFilterItemsAvail=function(e,t){var i=!1;if(t&&["Include","Exclude"].indexOf(t.type)>=0)if("Include"===t.type&&0===t.items.length)i=!0;else for(var a=this.parent.engineModule,n=a.fieldList[e],s="olap"===this.parent.dataType?n.members:r.getFormattedMembers(n.members,e,a),o=0,l=t.items;o<l.length;o++){if(s[l[o]]){i=!0;break}}return i},e.prototype.getOlapData=function(e,i){var a=[],n=[];this.parent.filterDialog.isSearchEnabled=!1;var s=this.parent.engineModule,o=r.getFilterItemByName(e,this.parent.dataSourceSettings.filterSettings);0===s.fieldList[e].filterMembers.length?this.parent.control.loadOnDemandInMemberEditor?o&&o.levelCount>1&&s.fieldList[e].levels.length>1?s.getFilterMembers(this.parent.dataSourceSettings,e,o.levelCount):(s.fieldList[e].levelCount=1,s.getMembers(this.parent.dataSourceSettings,e)):s.getMembers(this.parent.dataSourceSettings,e,!0):(s.fieldList[e].currrentMembers={},s.fieldList[e].searchMembers=[]);var l=s.fieldList[e].isHierarchy;a=s.fieldList[e].filterMembers,(0,t.isNullOrUndefined)(o)||(i=!o.type||"Include"===o.type,n=o.items?o.items:[]);for(var d={},p={},h=s.fieldList[e].members,u=0,c=n;u<c.length;u++){var g=c[u];d[g]=g,p[g]=g,h[g]&&(p=this.getParentNode(e,g,p))}return a=this.getFilteredTreeNodes(e,a,p,[]),a=this.getOlapTreeData(i,r.getClonedData(a),d,e,l),a=this.sortOlapFilterData(a,s.fieldList[e].sort)},e.prototype.sortOlapFilterData=function(e,t){if(e.length>0){for(var i=!1,a=[],r=0;r<e.length;r++)a.push(e[r].caption);var n="Grand Total"!==e[0].caption||void 0===e[0].caption?e[0].htmlAttributes["data-fieldName"]:e[1].htmlAttributes["data-fieldName"],s=this.parent.engineModule.fieldList[n],o=s&&s.membersOrder?s.membersOrder.slice():[],l={fieldName:n,sortOrder:t,members:o&&o.length>0?o:a,IsOrderChanged:!1};if(o&&o.length>0?this.applyFilterCustomSort(e,l):(e="Ascending"===t?e.sort((function(e,t){return e.caption>t.caption?1:t.caption>e.caption?-1:0})):"Descending"===t?e.sort((function(e,t){return e.caption<t.caption?1:t.caption<e.caption?-1:0})):e,i=!0),i){for(var d=[],p=0,h=0;p<e.length;p++)"Grand Total"!==e[p].caption&&(d[h++]=e[p].caption);l.members=d}this.parent.control.trigger(we,l),l.IsOrderChanged&&this.applyFilterCustomSort(e,l,!0)}return e},e.prototype.applyFilterCustomSort=function(e,t,i){var a,r=[],n=[];r=t.IsOrderChanged?t.members:"Ascending"===t.sortOrder||"None"===t.sortOrder||void 0===t.sortOrder?[].concat(t.members):[].concat(t.members).reverse(),"Grand Total"===e[0].caption&&(a=e[0],e.shift());for(var s=0,o=0;s<e.length;s++){var l=e[s].caption;if(r[o]===l){if(e.splice(o++,0,e[s]),e.splice(++s,1),!(o<r.length)){i||n.splice(--o,0,l);break}s=-1}s>=0&&!i&&(n[s]=e[s].caption)}if(!i){for(s=n.length;s<e.length;s++)n[s]=e[s].caption;"Grand Total"===n[n.length-1]&&n.pop(),t.members=n}return a&&e.splice(0,0,a),e},e.prototype.getParentIDs=function(e,t,i){for(var a,r=0,n=e.fields.dataSource;r<n.length;r++){var s=n[r];if(s.id===t){a=s.pid;break}}return a&&(i.push(a),this.getParentIDs(e,a,i)),i},e.prototype.getChildIDs=function(e,t,i){for(var a,r=0,n=e.fields.dataSource;r<n.length;r++){var s=n[r];if(s.pid===t){a=s.id;break}}return a&&(i.push(a),this.getParentIDs(e,a,i)),i},e.prototype.searchTreeNodes=function(e,i,a,n){if(a){for(var s=[],o=[],l=0,d=[].slice.call(i.element.querySelectorAll("li"));l<d.length;l++){var p=d[l];p.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?s.push(p):o.push(p)}if(i.enableNodes(s),(0,t.removeClass)(s,Ki),i.disableNodes(o),(0,t.addClass)(o,Ki),s.length>0&&o.length>0)for(var h=0,u=s;h<u.length;h++){var c=u[h].getAttribute("data-uid"),g=this.getParentIDs(i,c,[]),m=this.getChildIDs(i,c,[]),f=[];if(g.length>0)for(var S=0,v=o;S<v.length;S++){var y=v[S];-1!==r.inArray(y.getAttribute("data-uid"),g)&&f.push(y)}if(m.length>0)for(var b=0,C=o;b<C.length;b++){y=C[b];-1!==r.inArray(y.getAttribute("data-uid"),m)&&f.push(y)}i.enableNodes(f),(0,t.removeClass)(f,Ki)}0===[].slice.call(i.element.querySelectorAll("li."+Ki)).length?i.collapseAll():i.expandAll(void 0,void 0,!0),this.searchListItem=s}else if(this.parent.searchTreeItems=[],"olap"!==this.parent.dataType||n){s=[];var x=0;x=1;for(var w=0,T=this.parent.currentTreeItems;w<T.length;w++){var M=T[w];M.name.toLowerCase().indexOf(e.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(M),x<=this.parent.control.maxNodeLimitInMemberEditor&&s.push(M),x++)}--x>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=x-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1),this.parent.isDataOverflow=x>this.parent.control.maxNodeLimitInMemberEditor,this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"block":"none",i.fields={dataSource:s,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},i.dataBind()}else this.updateOlapSearchTree(e,i,n)},e.prototype.updateOlapSearchTree=function(e,t,i){var a=[],n=this.parent.filterDialog.dialogPopUp.element.getAttribute("data-fieldname");if(""===e.value.toLowerCase()){this.parent.filterDialog.isSearchEnabled=!1,this.parent.engineModule.fieldList[n].searchMembers=[];for(var s={},o={},l=this.parent.engineModule.fieldList[n].members,d=[],p=0,h=Object.keys(l);p<h.length;p++){l[g=h[p]].isSelected&&(l[g].parent&&l[l[g].parent].isSelected||d.push(g))}for(var u=0,c=d;u<c.length;u++){var g;s[g=c[u]]=g,o[g]=g,l[g]&&(o=this.getParentNode(n,g,o))}var m=this.parent.engineModule.fieldList[n].filterMembers;a=this.getFilteredTreeNodes(n,m,o,[]),a=this.getOlapTreeData(!0,r.getClonedData(a),s,n,i,!0)}else{this.parent.filterDialog.isSearchEnabled=!0;m=this.parent.engineModule.fieldList[n].searchMembers;a=r.getClonedData(m),a=this.getOlapSearchTreeData(!0,a,n)}t.fields={dataSource:a,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},t.dataBind()},e.prototype.getTreeData=function(e,i,a,r){this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={},this.parent.savedTreeFilterPos={};for(var n=this.parent.engineModule,s=[],o=1,l={},d=0,p=a;d<p.length;d++){var h=p[d];l[h]=h}for(var u=r.replace(/[^a-zA-Z0-9 ]/g,"_"),c=0,g=i;c<g.length;c++){var m=g[c],f=m.actualText.toString();f=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(f):f;var S=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(m.actualText):m.actualText,v={id:u+"_"+o,htmlAttributes:{"data-fieldName":r,"data-memberId":S.toString()},actualText:S,name:this.parent.isDateField?m.formattedText:n.getFormattedValue(S,r).formattedText,isSelected:!e};void 0!==l[this.parent.isDateField?m.formattedText:f]&&(v.isSelected=!!e),o<=this.parent.control.maxNodeLimitInMemberEditor&&s.push(v),v.isSelected||(this.parent.savedTreeFilterPos[o-1]=this.parent.isDateField?m.formattedText:f),this.parent.currentTreeItems.push(v),this.parent.searchTreeItems.push(v),this.parent.currentTreeItemsPos[S]={index:o-1,isSelected:v.isSelected},o++}return this.parent.isDataOverflow=o-1>this.parent.control.maxNodeLimitInMemberEditor,s},e.prototype.getOlapTreeData=function(e,t,i,a,r,n){var s=this.parent.engineModule.fieldList[a];this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={};for(var o=[],l=1,d=0,p=t;d<p.length;d++){var h=p[d],u=h,c=h.id.toString();n||(u.isSelected=!e),void 0!==i[c]&&(u.isSelected=!!e),!n&&h.hasChildren&&this.updateChildNodeStates(s.filterMembers,a,h.id,u.isSelected),s.members[c].isSelected=u.isSelected,s.currrentMembers&&s.currrentMembers[c]&&(s.currrentMembers[c].isSelected=u.isSelected),l<=this.parent.control.maxNodeLimitInMemberEditor&&r&&o.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]={index:l-1,isSelected:u.isSelected},l++}return this.parent.isDataOverflow=!!r&&l-1>this.parent.control.maxNodeLimitInMemberEditor,r?o:t},e.prototype.getOlapSearchTreeData=function(e,t,i){for(var a=this.parent.engineModule.fieldList[i].members,r=0,n=t;r<n.length;r++){var s=n[r],o=s.id.toString();a[o]&&(s.isSelected=a[o].isSelected),this.parent.searchTreeItems.push(s)}return t},e.prototype.updateChildNodeStates=function(e,t,i,a){for(var r=this.parent.engineModule.fieldList[t].members,n=this.parent.engineModule.fieldList[t].currrentMembers,s=0,o=e;s<o.length;s++){var l=o[s];l.pid&&l.pid.toString()===i&&(r[l.id].isSelected=a,n&&n[l.id]&&(n[l.id].isSelected=a),l.hasChildren&&this.updateChildNodeStates(e,t,l.id,a))}},e.prototype.getParentNode=function(e,t,i){var a=this.parent.engineModule.fieldList[e].members;if(a[t].parent&&t!==a[t].parent){var r=a[t].parent;i[r]=r,this.getParentNode(e,r,i)}return i},e.prototype.getFilteredTreeNodes=function(e,i,a,n){for(var s=[],o=this.parent.engineModule.fieldList[e].members,l=0,d=a?Object.keys(a):[];l<d.length;l++){var p=d[l],h=o[p]?o[p].parent:void 0;void 0!==h&&-1===r.inArray(h,s)&&s.push(h)}for(var u=0,c=i;u<c.length;u++){var g=c[u];(0,t.isNullOrUndefined)(g.pid)||-1!==r.inArray(g.pid,s)?(n.push(g),(0,t.isNullOrUndefined)(g.pid)&&-1!==r.inArray(g.id,s)?o[g.id].isNodeExpand=!0:(0,t.isNullOrUndefined)(g.pid)||-1===r.inArray(g.pid,s)?o[g.id].isNodeExpand=!1:(o[g.id].isNodeExpand=!1,o[g.pid].isNodeExpand=!0)):o[g.id].isNodeExpand=!1}return n},e}(),fs=function(){function e(e){this.parent=e}return e.prototype.onStateModified=function(e,i){var a="",r=(0,t.closest)(e.target,"."+Ga),n=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,r&&(a=r.classList[1]===za?"rows":r.classList[1]===Wa?"columns":r.classList[1]===Qa?"values":r.classList[1]===Ya?"filters":""),"olap"===this.parent.dataType||"pivot"===this.parent.dataType){var s="olap"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i;if(e.cancel&&""===a)return!1;if(this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===a||"values"===a)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&s.toLowerCase().indexOf("[measures].")>-1&&"olap"===this.parent.dataType&&("filters"===a||"rows"===a||"columns"===a)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&"olap"===this.parent.dataType&&-1===s.toLowerCase().indexOf("[measures].")&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&("filters"===a||"values"===a)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&"olap"===this.parent.dataType&&-1===s.toLowerCase().indexOf("[measures].")&&"values"===a){var o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(o,l),!1}}else if(e.cancel&&""===a||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===a||"values"===a||a.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return!1;if(""!==a){if("olap"===this.parent.dataType||"pivot"===this.parent.dataType)if((s="olap"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i).toLowerCase().indexOf("[measures].")>-1&&"olap"===this.parent.dataType&&("filters"===a||"rows"===a||"columns"===a)||this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&"filters"===a||"olap"===this.parent.dataType&&"values"===a&&-1===s.toLowerCase().indexOf("[measures].")){o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(o,l),!1}if("pivot"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&"CalculatedField"===this.parent.engineModule.fieldList[i].aggregateType&&"values"!==a){o=this.parent.localeObj.getConstant("warning"),l=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(o,l),!1}n=this.getButtonPosition(e.target,a)}else this.parent.engineModule.fieldList[i]&&(this.parent.engineModule.fieldList[i].isSelected=!1,"olap"===this.parent.dataType&&this.parent.engineModule.updateFieldlistData(i));return this.parent.dataSourceUpdate.updateDataSource(i,a,n)},e.prototype.getButtonPosition=function(e,i){var a=-1,r=(0,t.closest)(e,"."+va);if(!(0,t.isNullOrUndefined)(r)){r=r.querySelector("."+ya);for(var n=this.parent.element.querySelector(".e-"+i),s=[].slice.call(n.querySelectorAll("."+ya)),o=0,l=s.length;o<l;o++)if(s[o].id===r.id){a=o;break}}return a},e}(),Ss=function(){function e(e){this.parent=e}return e.prototype.updateDataSource=function(e,i,a){for(var n,s,o=this,l=-1,d=!0,p=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],c=0,g=p.length;c<g;c++)if(p[c])for(var m=0,f=p[c].length;m<f;m++)(p[c][m].name===e||"olap"===this.parent.dataType&&"[measures]"===p[c][m].name.toLowerCase()&&p[c][m].name.toLowerCase()===e)&&(s=0===c?"rows":1===c?"columns":2===c?"values":"filters",l=m),s||(s="fieldList");var S={fieldName:e,dropField:r.getFieldInfo(e,this.control).fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:i,dropPosition:a,draggedAxis:s,cancel:!1},v="pivotfieldlist"===this.control.getModuleName()&&this.control.isPopupView?this.control.pivotGridModule:this.control;return v.trigger(u,S,(function(p){if(p.cancel)d=!1;else{if(i=p.dropAxis,a=p.dropPosition,e=p.dropField?p.dropField.name:p.fieldName,n=p.dropField,o.control&&o.btnElement&&"true"===o.btnElement.getAttribute("isvalue"))switch(i){case"":o.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":a=a===o.parent.dataSourceSettings.rows.length?-1:a,o.control.setProperties({dataSourceSettings:{valueAxis:"row",valueIndex:a}},!0);break;case"columns":a=a===o.parent.dataSourceSettings.columns.length?-1:a,o.control.setProperties({dataSourceSettings:{valueAxis:"column",valueIndex:a}},!0)}else{if(o.removeFieldFromReport(e.toString()),"pivot"===o.parent.dataType&&o.control.showValuesButton&&o.parent.dataSourceSettings.values.length>1){var u="row"===o.parent.dataSourceSettings.valueAxis&&"rows"===i?o.parent.dataSourceSettings.rows:"column"===o.parent.dataSourceSettings.valueAxis&&"columns"===i?o.parent.dataSourceSettings.columns:void 0;l<o.parent.dataSourceSettings.valueIndex&&("row"===o.parent.dataSourceSettings.valueAxis&&"rows"===s||"column"===o.parent.dataSourceSettings.valueAxis&&"columns"===s)&&o.control.setProperties({dataSourceSettings:{valueIndex:o.parent.dataSourceSettings.valueIndex-1}},!0),(0,t.isNullOrUndefined)(u)||(-1===a&&-1===o.parent.dataSourceSettings.valueIndex?o.control.setProperties({dataSourceSettings:{valueIndex:u.length}},!0):a>-1&&a<=o.parent.dataSourceSettings.valueIndex?o.control.setProperties({dataSourceSettings:{valueIndex:o.parent.dataSourceSettings.valueIndex+1}},!0):o.parent.dataSourceSettings.valueIndex>-1&&a>o.parent.dataSourceSettings.valueIndex&&(a-=1))}"CalculatedField"===(n=o.getNewField(e.toString(),p.dropField)).type&&""!==i&&(i="values")}if("olap"===o.parent.dataType&&(o.removeFieldFromReport(e.toString()),n=o.getNewField(e.toString(),p.dropField),0===o.parent.dataSourceSettings.values.length&&o.removeFieldFromReport("[measures]"),"CalculatedField"===n.type&&""!==i&&(i="values")),o.control){var c={fieldName:e,droppedField:n,dataSourceSettings:r.getClonedDataSourceSettings(o.parent.dataSourceSettings),droppedAxis:i,droppedPosition:a};v.trigger(h,c,(function(e){if(n=e.droppedField){switch(a=e.droppedPosition,i=e.droppedAxis){case"filters":-1!==a?o.parent.dataSourceSettings.filters.splice(a,0,n):o.parent.dataSourceSettings.filters.push(n);break;case"rows":-1!==a?o.parent.dataSourceSettings.rows.splice(a,0,n):o.parent.dataSourceSettings.rows.push(n);break;case"columns":-1!==a?o.parent.dataSourceSettings.columns.splice(a,0,n):o.parent.dataSourceSettings.columns.push(n);break;case"values":if(-1!==a?o.parent.dataSourceSettings.values.splice(a,0,n):o.parent.dataSourceSettings.values.push(n),!("olap"!==o.parent.dataType||o.parent.engineModule.isMeasureAvail||o.parent.dataSourceSettings.values.length>1)){("row"===o.parent.dataSourceSettings.valueAxis?o.parent.dataSourceSettings.rows:o.parent.dataSourceSettings.columns).push({name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0})}}var t="columns"===i?v.dataSourceSettings.columns.length:"rows"===i?v.dataSourceSettings.rows.length:0;0!==t&&v.dataSourceSettings.valueIndex===t&&o.control.setProperties({dataSourceSettings:{valueIndex:-1}},!0)}}))}}})),d},e.prototype.removeFieldFromReport=function(e){for(var t,i=!1,a=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],r=this.parent.engineModule.fieldList[e],n=0,s=a.length;n<s;n++)if(!i&&a[n])for(var o=0,l=a[n].length;o<l;o++)if(a[n][o].name===e||"olap"===this.parent.dataType&&"[measures]"===a[n][o].name.toLowerCase()&&a[n][o].name.toLowerCase()===e){if((t=a[n][o].properties?a[n][o].properties:a[n][o]).type=r&&"number"===r.type?t.type:"Count",a[n].splice(o,1),"olap"===this.parent.dataType){var d=this.parent.engineModule;d&&d.fieldList[e]&&(d.fieldList[e].currrentMembers={},d.fieldList[e].searchMembers=[])}i=!0;break}return t},e.prototype.getNewField=function(e,t){var i;if("olap"===this.parent.dataType){var a=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:a.caption,isNamedSet:t?t.isNamedSet:a.isNamedSets,isCalculatedField:t?t.isCalculatedField:a.isCalculatedField,type:t?void 0===t.type?"number"===a.type?"Sum":"Count":t.type:void 0===a.aggregateType?"number"===a.type?"Sum":"Count":a.aggregateType,showFilterIcon:t?t.showFilterIcon:a.showFilterIcon,showSortIcon:t?t.showSortIcon:a.showSortIcon,showEditIcon:t?t.showEditIcon:a.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:a.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:a.showValueTypeIcon,allowDragAndDrop:t?t.allowDragAndDrop:a.allowDragAndDrop,showSubTotals:t?t.showSubTotals:a.showSubTotals,expandAll:t?t.expandAll:a.expandAll}}else{a=this.parent.engineModule.fieldList[e];i={name:t?t.name:e,caption:t?t.caption:a.caption,type:t?void 0===t.type||null===t.type?"number"===a.type?"Sum":"Count":t.type:void 0===a.aggregateType||null===a.aggregateType?"number"===a.type?"Sum":"Count":a.aggregateType,showNoDataItems:t?t.showNoDataItems:a.showNoDataItems,baseField:t?t.baseField:a.baseField,baseItem:t?t.baseItem:a.baseItem,allowDragAndDrop:t?t.allowDragAndDrop:a.allowDragAndDrop,showSubTotals:t?t.showSubTotals:a.showSubTotals,showFilterIcon:t?t.showFilterIcon:a.showFilterIcon,showSortIcon:t?t.showSortIcon:a.showSortIcon,showEditIcon:t?t.showEditIcon:a.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:a.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:a.showValueTypeIcon,expandAll:t?t.expandAll:a.expandAll}}return i},e}(),vs=function(){function e(e){this.parent=e}return e.prototype.createErrorDialog=function(e,i,a){var r=(0,t.createElement)("div",{id:this.parent.parentID+"_ErrorDialog",className:_a});this.parent.element.appendChild(r);var n=a?Number(a.style.zIndex)+1:"pivotfieldlist"===this.parent.moduleName&&"Popup"===this.parent.renderMode&&this.parent.control?this.parent.control.dialogRenderer.fieldListDialog.zIndex+1:"pivotfieldlist"===this.parent.moduleName&&"Fixed"===this.parent.renderMode&&this.parent.control||"pivotview"===this.parent.moduleName&&this.parent.control?1000002:1000001;this.errorPopUp=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:i,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",zIndex:n,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],cssClass:this.parent.cssClass,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.isStringTemplate=!0,this.errorPopUp.appendTo(r)},e.prototype.closeErrorDialog=function(){this.errorPopUp.close()},e.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&(this.errorPopUp.destroy(),this.errorPopUp=null),document.getElementById(this.parent.parentID+"_ErrorDialog")&&(0,t.remove)(document.getElementById(this.parent.parentID+"_ErrorDialog"))},e}(),ys=S(570),bs=S(295),Cs=S(741),xs=function(){function e(e){this.parent=e}return e.prototype.createFilterDialog=function(e,i,a,r){var n=this,s=(0,t.createElement)("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")+(this.parent.isDataOverflow?" "+ts:""),attrs:{"data-fieldName":i,"aria-label":a}}),l=this.parent.engineModule.fieldList[i].caption,d=this.parent.localeObj.getConstant("filter")+' "'+a+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(i),this.isSearchEnabled=!1,this.allowExcelLikeFilter=this.isExcelFilter(i),this.parent.element.appendChild(s),this.dialogPopUp=new o.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?d:l,content:"",isModal:!0,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" "+Ki)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"Popup"!==this.parent.renderMode,target:r,cssClass:this.parent.cssClass,close:this.removeFilterDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(s);var p={cancel:!1,fieldName:i,fieldMembers:this.parent.dataSourceSettings.allowMemberFilter?e:[],filterSetting:this.filterObject};("pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control).trigger(Fe,p,(function(r){r.cancel?(n.dialogPopUp.close(),n.dialogPopUp=void 0):(e=r.fieldMembers,n.allowExcelLikeFilter?(n.createTabMenu(e,a,i),(0,t.addClass)([n.dialogPopUp.element],"e-excel-filter"),n.updateCheckedState()):(n.dialogPopUp.content=n.createTreeView(e,a,i),n.updateCheckedState()),(0,t.setStyleAttribute)(n.dialogPopUp.element,{visibility:"visible"}),n.allowExcelLikeFilter&&n.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus(),n.memberTreeView.nodeChecked=n.parent.control.pivotButtonModule.nodeStateModified.bind(n.parent.control.pivotButtonModule),n.allMemberSelect.nodeChecked=n.parent.control.pivotButtonModule.nodeStateModified.bind(n.parent.control.pivotButtonModule))}))},e.prototype.createTreeView=function(e,i,a){var r=this,n=(0,t.createElement)("div",{id:this.parent.parentID+"EditorDiv",className:La+(this.allowExcelLikeFilter?" e-excelfilter":"")}),s=(0,t.createElement)("button",{id:this.parent.parentID+"_LevelDiv",className:"e-level-container-class",attrs:{type:"button"}}),o=(0,t.createElement)("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:Ar}),l=this.parent.engineModule.fieldList[a].caption,d=(0,t.createElement)("input",{attrs:{type:"text",className:"e-editor-search-input"}}),p=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",h=(0,t.createElement)("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1",title:p},className:"e-editor-label-container"});this.parent.editorLabelElement=(0,t.createElement)("label",{className:"e-editor-label"}),this.parent.editorLabelElement.innerText=p,h.style.display=this.parent.isDataOverflow?"block":"none",h.appendChild(this.parent.editorLabelElement),o.appendChild(d),this.createSortOptions(a,o,e);var u=(0,t.createElement)("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-container"}),c=(0,t.createElement)("div",{id:this.parent.parentID+"_SelectAllContainer",className:kr}),g=(0,t.createElement)("div",{className:Aa+"-outer-div"}),m=(0,t.createElement)("div",{className:Aa}),f=(0,t.createElement)("div",{className:sn+" "+Ki});f.innerText=this.parent.localeObj.getConstant("noMatches"),"olap"!==this.parent.dataType||!this.parent.control.loadOnDemandInMemberEditor||this.parent.engineModule.fieldList[a].isHierarchy||this.parent.engineModule.fieldList[a].isNamedSets||(o.appendChild(s),this.createLevelWrapper(s,a)),u.appendChild(c),n.appendChild(o),n.appendChild(u),n.appendChild(f),this.editorSearch=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+" &#8220"+l+"&#8220",enableRtl:this.parent.enableRtl,cssClass:Rr+(this.parent.cssClass?" "+this.parent.cssClass:""),showClearButton:!0,change:function(e){if("olap"===r.parent.dataType)r.searchOlapTreeView(e,f);else{r.parent.eventBase.searchTreeNodes(e,r.memberTreeView,!1);var i=r.dialogPopUp.element;0===[].slice.call(r.memberTreeView.element.querySelectorAll("li")).length?(r.allMemberSelect.disableNodes([r.allMemberSelect.element.querySelector("li")]),i.querySelector("."+Ua).setAttribute("disabled","disabled"),(0,t.removeClass)([f],Ki)):(r.allMemberSelect.enableNodes([r.allMemberSelect.element.querySelector("li")]),i.querySelector("."+Ua).removeAttribute("disabled"),(0,t.addClass)([f],Ki)),r.updateCheckedState()}}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(d);var S={"data-fieldName":a,"data-memberId":"all"},v=[{id:"all",name:this.parent.localeObj.getConstant("all"),isSelected:!0,htmlAttributes:S}];if(this.allMemberSelect=new ds.TreeView({fields:{dataSource:v,id:"id",text:"name",isChecked:"isSelected"},showCheckBox:!0,expandOn:"None",enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeClicked:this.nodeCheck.bind(this,!0),keyPress:this.nodeCheck.bind(this,!0),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0},cssClass:this.parent.cssClass}),this.allMemberSelect.isStringTemplate=!0,!(0,t.isNullOrUndefined)(this.parent.currentTreeItems))for(var y=0;y<this.parent.currentTreeItems.length;y++)(this.parent.currentTreeItems[y].id.indexOf("\n")||0===this.parent.currentTreeItems[y].id.indexOf("\n"))&&(this.parent.currentTreeItems[y].id=this.parent.currentTreeItems[y].id.replace("\n"," "));return this.allMemberSelect.appendTo(c),g.appendChild(m),n.appendChild(g),this.memberTreeView=new ds.TreeView({fields:{dataSource:e,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},showCheckBox:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this,!1),keyPress:this.nodeCheck.bind(this,!1),nodeExpanding:this.updateChildNodes.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0},expandOn:"None",cssClass:this.parent.cssClass}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(m),this.parent.isDataOverflow&&this.parent.control.maxNodeLimitInMemberEditor<this.parent.currentTreeItems.length&&n.appendChild(h),n},e.prototype.createSortOptions=function(e,i,a){if("pivot"===this.parent.dataType&&a&&a.length>0){var r=this.parent.engineModule.fieldList[e].sort,n=(0,t.createElement)("div",{className:yr+" e-btn-group"+(this.parent.enableRtl?" "+Wi:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),id:this.parent.element.id+"_Member_Sort"});this.parent.element.appendChild(n);var s=(0,t.createElement)("button",{className:("Ascending"===r?xr+" ":"")+wa,id:this.parent.element.id+"_Sort_Ascend",attrs:{type:"button","aria-label":"button"}}),o=(0,t.createElement)("button",{className:("Descending"===r?xr+" ":"")+wa,id:this.parent.element.id+"_Sort_Descend",attrs:{type:"button","aria-label":"button"}}),l=new Cs.Button({iconCss:Yi+" "+br,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});l.appendTo(s),(l=new Cs.Button({iconCss:Yi+" "+Cr,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass,enableHtmlSanitizer:this.parent.enableHtmlSanitizer})).appendTo(o),n.appendChild(s),n.appendChild(o),i.appendChild(n),this.unWireEvent(s),this.unWireEvent(o),this.wireEvent(s,e),this.wireEvent(o,e)}},e.prototype.createLevelWrapper=function(e,i){for(var a=this,r=this.parent.engineModule,n=r.fieldList[i].levels,s=r.fieldList[i].levelCount,o=[],l=0,d=n.length;l<d;l++)o.push({id:n[l].id,text:n[l].name});this.dropMenu=new bs.DropDownButton({cssClass:"e-level-drop e-caret-hide"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:o,iconCss:"e-icons e-dropdown-icon",disabled:s===n.length,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,beforeOpen:function(e){var r=[].slice.call(e.element.querySelectorAll("li")),n=a.parent.engineModule.fieldList[i].levelCount;(0,t.removeClass)(r,rn);for(var s=0,o=r.length;s<o;s++)s<n&&(0,t.addClass)([r[s]],rn)},select:function(e){for(var t,i=a.dialogPopUp.element.getAttribute("data-fieldname"),r=a.parent.engineModule,n=0,s=o.length;n<s;n++)o[n].id===e.item.id&&(t=n);r.getFilterMembers(a.parent.dataSourceSettings,i,t+1,!1,!0)},close:function(){var e=a.parent.engineModule,t=e.fieldList[i].levels;e.fieldList[i].levelCount===t.length?(a.dropMenu.disabled=!0,a.dropMenu.dataBind()):a.dropMenu.disabled=!1}}),this.dropMenu.appendTo(e)},e.prototype.searchOlapTreeView=function(e,i){var a=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){var r=a.parent.engineModule,n=a.dialogPopUp.element,s=n.getAttribute("data-fieldname"),o=a.parent.control.maxNodeLimitInMemberEditor?a.parent.control.maxNodeLimitInMemberEditor:5e3;if(r.fieldList[s].isHierarchy)a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!0);else{if(a.dropMenu&&""!==e.value?a.dropMenu.disabled=!0:a.dropMenu.disabled=!1,a.parent.control.loadOnDemandInMemberEditor){var l=r.fieldList[s].levelCount?r.fieldList[s].levelCount:1;r.getSearchMembers(a.parent.dataSourceSettings,s,e.value.toLowerCase(),o,!1,l)}else r.getSearchMembers(a.parent.dataSourceSettings,s,e.value.toLowerCase(),o,!0);a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!1)}0===[].slice.call(a.memberTreeView.element.querySelectorAll("li")).length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),n.querySelector("."+Ua).setAttribute("disabled","disabled"),(0,t.removeClass)([i],Ki)):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),n.querySelector("."+Ua).removeAttribute("disabled"),(0,t.addClass)([i],Ki)),a.updateCheckedState()}),500)},e.prototype.nodeCheck=function(e,i){var a=[i.node];if(i.event.target.classList.contains("e-fullrow")||"Enter"===i.event.key){var r=e?this.allMemberSelect:this.memberTreeView;"true"===r.getNode(i.node).isChecked?r.uncheckAll(a):r.checkAll(a)}else 38!==i.event.keyCode||e||((0,t.removeClass)(this.memberTreeView.element.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node"),(0,t.addClass)(a,"e-prev-active-node"))},e.prototype.applySorting=function(e,i){var a=(0,t.closest)(i.target,"."+wa);if(a){var r=[].slice.call((0,t.closest)(a,"."+yr).querySelectorAll("."+wa));a.querySelector("."+br)&&!a.classList.contains(xr)?(this.updateFilterMembers("Ascending",e),(0,t.addClass)([a],xr),(0,t.removeClass)([r[1]],xr)):a.querySelector("."+Cr)&&!a.classList.contains(xr)?(this.updateFilterMembers("Descending",e),(0,t.addClass)([a],xr),(0,t.removeClass)([r[0]],xr)):(this.updateFilterMembers("None",e),(0,t.removeClass)(r,xr))}},e.prototype.updateFilterMembers=function(e,i){var a=this.parent.engineModule.fieldList[i],n="None"===e?r.getClonedData(a.dateMember):this.parent.currentTreeItems.slice(),s=!!a.isAlphanumeric||void 0,o=!1,l=a&&a.membersOrder?a.membersOrder.slice():[],d={fieldName:i,sortOrder:e,members:l&&l.length>0?l:Object.keys(n),IsOrderChanged:!1};if(l&&l.length>0)n=r.applyCustomSort(d,n,s);else{var p=this.parent.dataSourceSettings.groupSettings.filter((function(e){return e.name===i&&"number"===e.type.toLocaleLowerCase()})),h=!(0,t.isNullOrUndefined)(p)&&p.length>0;n=r.applyHeadersSort(n,d.sortOrder,s,h),o=!0}var u="pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control;if(o){for(var c=[],g=0,m=0;g<n.length;g++)"Grand Total"!==n[g].actualText&&(c[m++]=n[g].actualText);d.members=c}u.trigger(we,d),d.IsOrderChanged&&(n=r.applyCustomSort(d,n,s,!0)),this.parent.currentTreeItems=[],this.parent.searchTreeItems=[];for(var f=[],S=i.replace(/[^a-zA-Z0-9 ]/g,"_"),v=this.parent.engineModule,y=0,b=n.length;y<b;y++){if("None"===e){var C=n[y].actualText.toString(),x={id:S+"_"+(y+1),htmlAttributes:{"data-fieldName":i,"data-memberId":C},actualText:n[y].actualText,name:this.parent.isDateField?n[y].formattedText:v.getFormattedValue(C,i).formattedText,isSelected:this.parent.currentTreeItemsPos[n[y].actualText].isSelected};this.parent.currentTreeItems.push(x),""!==this.editorSearch.value?x.name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(x),f.push(x)):(this.parent.searchTreeItems.push(x),f.push(x))}else this.parent.currentTreeItems.push(n[y]),""!==this.editorSearch.value?n[y].name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(n[y]),f.push(n[y])):(this.parent.searchTreeItems.push(n[y]),f.push(n[y]));this.parent.currentTreeItemsPos[n[y].actualText].index=y}var w=this.memberTreeView.fields.dataSource.length;this.memberTreeView.fields={dataSource:f.slice(0,w),id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},this.memberTreeView.dataBind()},e.prototype.updateChildNodes=function(e){if("olap"===this.parent.dataType){var i=this.parent.engineModule,a=e.node.getAttribute("data-fieldname"),n=i.fieldList[a],s=[];if(n&&n.filterMembers.length>0&&!this.isSearchEnabled&&!n.members[e.nodeData.id].isNodeExpand){for(var o=[],l=0,d=n.filterMembers;l<d.length;l++){var p=d[l];p.pid===e.nodeData.id.toString()&&o.push(p)}0===o.length&&(n.childMembers=[],i.getChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString(),a),o=n.childMembers,n.childMembers=[]);var h=r.getClonedData(o),u=this.memberTreeView.fields.dataSource,c=!1;(0,t.isNullOrUndefined)(this.filterObject)||(c="Include"===this.filterObject.type,s=this.filterObject.items?this.filterObject.items:[]),h=this.updateChildData(c,h,s,a,e.nodeData);for(var g=0,m=h=this.parent.eventBase.sortOlapFilterData(h,i.fieldList[a].sort);g<m.length;g++){var f=m[g];u.push(f)}n.members[e.nodeData.id].isNodeExpand=!0,this.memberTreeView.addNodes(h,e.node)}}},e.prototype.updateChildData=function(e,t,i,a,r){for(var n=Object.keys(this.parent.currentTreeItemsPos).length,s=this.parent.engineModule.fieldList[a],o=[],l=1,d=0,p=t;d<p.length;d++){var h=p[d],u=h,c=h.id.toString();s.members[c].isNodeExpand=!1,h.isSelected="true"===r.isChecked,l<=this.parent.control.maxNodeLimitInMemberEditor&&o.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]={index:n,isSelected:u.isSelected},n++,l++}return this.parent.isDataOverflow=!1,o},e.prototype.createTabMenu=function(e,i,a){var n=(0,t.createElement)("div",{id:this.parent.parentID+"_FilterTabContainer",className:"e-filter-tab-container",attrs:{tabindex:"-1"}});this.dialogPopUp.content=n,this.dialogPopUp.dataBind();for(var s=["Label","Value","Include","Exclude"],o="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",l=Object.keys(this.parent.engineModule.fieldList[a].members)[0],d=this.parent.engineModule.fieldList[a].type,p=r.getFieldByName(a,this.parent.dataSourceSettings.formatSettings),h=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&s.indexOf(this.filterObject.type)>1?cr:""},content:this.createTreeView(e,i,a)}],u=0,c=s;u<c.length;u++){var g=c[u];if("Label"===g&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===g&&this.parent.dataSourceSettings.allowValueFilter){var m="Label"===g&&l&&l.match(o)&&l.match(o)[0].length===l.length&&"number"===d?"Number":"Label"===g&&l&&"Invalid Date"!==new Date(l).toString()&&(p&&p.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":g,f={header:{text:"Number"===m?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(m.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===m?cr:""},content:this.createCustomFilter(a,this.filterObject&&this.filterObject.type===m?this.filterObject:void 0,m.toLowerCase())};h.push(f)}}var S=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;S=this.parent.dataSourceSettings.allowMemberFilter||0!==S?S:1,this.tabObj=new ds.Tab({heightAdjustMode:"Auto",items:h,height:"100%",selectedItem:S,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(n),this.parent.dataSourceSettings.allowMemberFilter||this.tabObj.hideTab(0),S>0&&(0,t.addClass)([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===S&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},e.prototype.createCustomFilter=function(e,i,a){for(var r=[],n=[],s=[],o=this.parent.dataSourceSettings.values,l="DoesNotEquals",d=0,p=0,h={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},u=["Between","NotBetween"],c="label"===a?h.label:"date"===a?h.date:h.value,g=0,m=c;g<m.length;g++){var f=m[g];l=i&&f===i.condition?c.indexOf(i.condition)>=0?i.condition:c[0]:l,r.push({value:f,text:this.parent.localeObj.getConstant(f)})}for(var S=o.length;S--;)n.unshift({value:o[S].name,text:o[S].caption?o[S].caption:o[S].name}),d=i&&"Value"===i.type&&i.measure===o[S].name&&i.condition===l?S:d;if("olap"===this.parent.dataType){var v=this.parent.engineModule,y=v.fieldList[e].levels;if(this.parent.engineModule.fieldList[e].isHierarchy){for(var b=void 0,C=0,x=this.parent.engineModule.fieldListData;C<x.length;C++){var w=x[C];if(w&&w.pid===e){b=w;break}}s.push({value:b?b.id:e,text:b?b.caption:v.fieldList[e].name}),p=0,i&&i.name===e&&i.type.toLowerCase()===a&&(s[s.length-1].iconClass=Yi+" "+gr)}else for(var T=0,M=y.length;T<M;T++){p=i&&i.selectedField===y[T].id?T:p,s.push({value:y[T].id,text:y[T].name});for(var D=0,O=this.parent.dataSourceSettings.filterSettings;D<O.length;D++){var P=O[D];if(P.name===e&&P.selectedField===y[T].id&&P.type.toLowerCase()===a){s[s.length-1].iconClass=Yi+" "+gr;break}}}}var N=(0,t.createElement)("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(a)>=0?"label":a)+"-filter"+(this.parent.isDataOverflow?" "+ts:""),id:this.parent.parentID+"_"+a+"_filter_div_content",attrs:{"data-type":a,"data-fieldName":e,"data-operator":l,"data-selectedField":"olap"===this.parent.dataType&&s.length>0?s[p].value.toString():"","data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[d].name:"","data-value1":i&&l===i.condition&&i.value1?i.value1.toString():"","data-value2":i&&l===i.condition&&i.value2?i.value2.toString():""}}),E=(0,t.createElement)("div",{className:"e-filter-text-div"});E.innerText=this.parent.localeObj.getConstant(a+"TextContent");var I=(0,t.createElement)("div",{className:mr+" "+(-1===u.indexOf(l)?Ki:"")});I.innerText=this.parent.localeObj.getConstant("And");var F=(0,t.createElement)("div",{className:"e-separator-div"}),L=(0,t.createElement)("div",{className:"e-filter-option-container-1"}),A=(0,t.createElement)("div",{className:"e-level-option-container "+("olap"===this.parent.dataType?"":Ki)}),R=(0,t.createElement)("div",{className:"e-measure-option-container "+(["label","date","number"].indexOf(a)>=0?Ki:"")}),k=(0,t.createElement)("div",{className:"e-condition-option-container"}),j=(0,t.createElement)("div",{className:"e-filter-option-container-2"}),q=(0,t.createElement)("div",{id:this.parent.parentID+"_"+a+"_level_option_container"}),H=(0,t.createElement)("div",{id:this.parent.parentID+"_"+a+"_measure_option_container"}),V=(0,t.createElement)("div",{id:this.parent.parentID+"_"+a+"_contition_option_container"}),U=(0,t.createElement)("div",{className:"e-filter-input-div-1"}),B=(0,t.createElement)("div",{className:fr+" "+(-1===u.indexOf(l)?Ki:"")}),_=(0,t.createElement)("input",{id:this.parent.parentID+"_"+a+"_input_option_1",attrs:{type:"text"}}),G=(0,t.createElement)("input",{id:this.parent.parentID+"_"+a+"_input_option_2",attrs:{type:"text"}});return U.appendChild(_),B.appendChild(G),A.appendChild(q),A.appendChild(F.cloneNode(!0)),R.appendChild(H),R.appendChild(F),k.appendChild(V),L.appendChild(A),L.appendChild(R),L.appendChild(k),j.appendChild(U),j.appendChild(I),j.appendChild(B),this.createElements(i,u,H,V,_,G,n,r,d,l,a,q,s,p),N.appendChild(E),N.appendChild(L),N.appendChild(j),N},e.prototype.createElements=function(e,i,a,r,n,s,o,l,d,p,h,u,c,g){var m=this;if("olap"===this.parent.dataType){var f=new hs.DropDownList({dataSource:c,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text",iconCss:"iconClass"},index:g,cssClass:"e-level-options"+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab"),a=i.getAttribute("data-fieldName"),r=i.getAttribute("data-type");if(!(0,t.isNullOrUndefined)(i)){var l;m.updateInputValues(i,r,n,s),(0,ls.setStyleAndAttributes)(i,{"data-selectedField":e.value});for(var d=0,p=m.parent.dataSourceSettings.filterSettings;d<p.length;d++){var h=p[d];if(h.name===a&&h.selectedField===e.value){l=h;break}}if(l){"value"===r&&l.measure&&""!==l.measure&&(S.value=l.measure?l.measure:o[0].value),l.condition?v.value=l.condition?l.condition:"DoesNotEquals":v.value="DoesNotEquals";var u=void 0,c=void 0;"value"===r?(u=(0,t.getInstance)(n,ps.NumericTextBox),c=(0,t.getInstance)(s,ps.NumericTextBox),u&&(u.value=l.value1?parseInt(l.value1,10):void 0),c&&(c.value=l.value2?parseInt(l.value2,10):void 0)):(u=(0,t.getInstance)(n,ps.MaskedTextBox),c=(0,t.getInstance)(s,ps.MaskedTextBox),u&&(u.value=l.value1?l.value1:""),c&&(c.value=l.value2?l.value2:""))}m.updateInputValues(i,r,n,s)}}});f.isStringTemplate=!0,f.appendTo(u)}var S=new hs.DropDownList({dataSource:o,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:d,cssClass:Sr+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(m.updateInputValues(i,h,n,s),(0,ls.setStyleAndAttributes)(i,{"data-measure":e.value}))}});S.isStringTemplate=!0,S.appendTo(a);var v=new hs.DropDownList({dataSource:l,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:p,cssClass:vr+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(e){var a=m.dialogPopUp.element.querySelector(".e-selected-tab");if(!(0,t.isNullOrUndefined)(a)){m.updateInputValues(a,h,n,s);for(var r=0,o=[mr,fr];r<o.length;r++){var l=o[r];i.indexOf(e.value)>=0?(0,t.removeClass)([a.querySelector("."+l)],Ki):(0,t.addClass)([a.querySelector("."+l)],Ki)}(0,ls.setStyleAndAttributes)(a,{"data-operator":e.value})}}});if(v.isStringTemplate=!0,v.appendTo(r),"date"===h){var y=new ys.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&p===e.condition?"string"==typeof e.value1?new Date(e.value1):e.value1:null,change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,ls.setStyleAndAttributes)(i,{"data-value1":e.value,"data-value2":b.value})},width:"100%",cssClass:this.parent.cssClass}),b=new ys.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&p===e.condition?"string"==typeof e.value2?new Date(e.value2):e.value2:null,change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,ls.setStyleAndAttributes)(i,{"data-value1":y.value,"data-value2":e.value})},width:"100%",cssClass:this.parent.cssClass});y.isStringTemplate=!0,y.appendTo(n),b.isStringTemplate=!0,b.appendTo(s)}else if("value"===h){var C=new ps.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&p===e.condition?parseInt(e.value1,10):void 0,change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,ls.setStyleAndAttributes)(i,{"data-value1":e.value?e.value.toString():"0","data-value2":x.value?x.value.toString():"0"})},width:"100%",cssClass:this.parent.cssClass}),x=new ps.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&p===e.condition?parseInt(e.value2,10):void 0,change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,ls.setStyleAndAttributes)(i,{"data-value1":C.value?C.value.toString():"0","data-value2":e.value?e.value.toString():"0"})},width:"100%",cssClass:this.parent.cssClass});C.isStringTemplate=!0,C.appendTo(n),x.isStringTemplate=!0,x.appendTo(s)}else{var w=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&p===e.condition?e.value1:"",change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,ls.setStyleAndAttributes)(i,{"data-value1":e.value,"data-value2":T.value})},width:"100%",cssClass:this.parent.cssClass}),T=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&p===e.condition?e.value2:"",change:function(e){var i=m.dialogPopUp.element.querySelector(".e-selected-tab");(0,t.isNullOrUndefined)(i)||(0,ls.setStyleAndAttributes)(i,{"data-value1":w.value,"data-value2":e.value})},width:"100%",cssClass:this.parent.cssClass});w.isStringTemplate=!0,w.appendTo(n),T.isStringTemplate=!0,T.appendTo(s)}},e.prototype.updateInputValues=function(e,i,a,r){var n=(0,t.getInstance)(a,"date"===i?ys.DateTimePicker:"value"===i?ps.NumericTextBox:ps.MaskedTextBox),s=(0,t.getInstance)(r,"date"===i?ys.DateTimePicker:"value"===i?ps.NumericTextBox:ps.MaskedTextBox),o=(0,t.isNullOrUndefined)(n.value)?"":n.value.toString(),l=(0,t.isNullOrUndefined)(s.value)?"":s.value.toString();(0,ls.setStyleAndAttributes)(e,{"data-value1":o,"data-value2":l})},e.prototype.validateTreeNode=function(e){e.node.classList.contains(Ki)&&(e.cancel=!0)},e.prototype.updateCheckedState=function(){var e=this.dialogPopUp.element,i=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),a=e.getAttribute("data-fieldname"),r=this.getUnCheckedNodes(a),n=this.getCheckedNodes(a),s=this.allMemberSelect.element.querySelector("li").querySelector("span."+qa);if(i.length>0)if(n>0){if(r>0)(0,t.removeClass)([s],Ha),(0,t.addClass)([s],Va),this.allMemberSelect.element.querySelector("li").setAttribute("aria-checked","false");else 0===r&&((0,t.removeClass)([s],Va),(0,t.addClass)([s],Ha));this.dialogPopUp.buttons[0].buttonModel.disabled=!1,e.querySelector("."+Ua).removeAttribute("disabled")}else r>0&&0===n&&((0,t.removeClass)([s],[Ha,Va]),this.getCheckedNodes(a)===n&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,e.querySelector("."+Ua).setAttribute("disabled","disabled")));else this.dialogPopUp.buttons[0].buttonModel.disabled=!0,e.querySelector("."+Ua).setAttribute("disabled","disabled")},e.prototype.getCheckedNodes=function(e){var t=this.parent.engineModule,i=[];if("olap"===this.parent.dataType&&t&&!t.fieldList[e].isHierarchy)return this.memberTreeView.getAllCheckedNodes().length;for(var a=0,r=this.parent.searchTreeItems;a<r.length;a++){var n=r[a];n.isSelected&&i.push(n)}return i.length},e.prototype.getUnCheckedNodes=function(e){var t=[],i=[],a=this.parent.engineModule;if("olap"===this.parent.dataType&&a&&!a.fieldList[e].isHierarchy)return i=this.memberTreeView.getAllCheckedNodes(),this.memberTreeView.fields.dataSource.length-i.length;for(var r=0,n=this.parent.searchTreeItems;r<n.length;r++){var s=n[r];s.isSelected||t.push(s)}return t.length},e.prototype.isExcelFilter=function(e){for(var t=!1,i=0,a=this.parent.dataSourceSettings.filters;i<a.length;i++){if(a[i].name===e){t=!0;break}}return!(t||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)},e.prototype.getFilterObject=function(e){var t=r.getFilterItemByName(e,r.cloneFilterSettings(this.parent.dataSourceSettings.filterSettings));if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0&&this.parent.eventBase.isValidFilterItemsAvail(e,t)))return t},e.prototype.wireEvent=function(e,i){t.EventHandler.add(e,"click",this.applySorting.bind(this,i),this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"click",this.applySorting)},e.prototype.closeFilterDialog=function(){this.dialogPopUp.close()},e.prototype.removeFilterDialog=function(){this.editorSearch&&!this.editorSearch.isDestroyed&&(this.editorSearch.destroy(),this.editorSearch=null),this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&(this.tabObj.destroy(),this.tabObj=null),this.dropMenu&&!this.dropMenu.isDestroyed&&(this.dropMenu.destroy(),this.dropMenu=null),this.memberTreeView&&!this.memberTreeView.isDestroyed&&(this.memberTreeView.destroy(),this.memberTreeView=null),this.allMemberSelect&&!this.allMemberSelect.isDestroyed&&(this.allMemberSelect.destroy(),this.allMemberSelect=null),document.getElementById(this.parent.parentID+"_LevelDiv-popup")&&(0,t.remove)(document.getElementById(this.parent.parentID+"_LevelDiv-popup")),this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.dialogPopUp.destroy(),this.dialogPopUp=null,setTimeout(this.setFocus.bind(this))),document.getElementById(this.parent.parentID+"_EditorTreeView")&&(0,t.remove)(document.getElementById(this.parent.parentID+"_EditorTreeView"))},e.prototype.setFocus=function(){if(this.parent.control.pivotButtonModule.parentElement)for(var e=0,t=[].slice.call(this.parent.control.pivotButtonModule.parentElement.querySelectorAll(".e-pivot-button"));e<t.length;e++){var i=t[e];if(i.getAttribute("data-uid")===this.parent.control.pivotButtonModule.fieldName){i.focus();break}}},e}(),ws=function(){function e(e){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=e.element,this.moduleName=e.moduleName,this.dataSourceSettings=e.dataSourceSettings,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.enableHtmlSanitizer=e.enableHtmlSanitizer,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.dataType=e.dataType,this.cssClass=e.cssClass,this.nodeStateModified=new fs(this),this.dataSourceUpdate=new Ss(this),this.eventBase=new ms(this),this.filterDialog=new xs(this),this.errorDialog=new vs(this),this.keyboardModule=new gs(this),this}return e.prototype.destroy=function(){this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null)},e}(),Ts=function(){function e(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"common"},e.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=t.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj,this.parent.pivotCommon.dataType=this.parent.dataType,this.parent.pivotCommon.cssClass=this.parent.cssClass;else{var e={pivotEngine:"olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,isAdaptive:t.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj,dataType:this.parent.dataType,cssClass:this.parent.cssClass};this.parent.pivotCommon=new ws(e)}this.parent.pivotCommon.control=this.parent},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(_e,this.initiateCommonModule,this),this.parent.on(Ge,this.initiateCommonModule,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(_e,this.initiateCommonModule),this.parent.off(Ge,this.initiateCommonModule))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotCommon&&(this.parent.pivotCommon.destroy(),this.parent.pivotCommon=null)},e}(),Ms=(e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)},function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}),Ds=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},Os=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"name",void 0),Ds([(0,t.Property)()],i.prototype,"caption",void 0),Ds([(0,t.Property)("Sum")],i.prototype,"type",void 0),Ds([(0,t.Property)()],i.prototype,"axis",void 0),Ds([(0,t.Property)(!1)],i.prototype,"showNoDataItems",void 0),Ds([(0,t.Property)()],i.prototype,"baseField",void 0),Ds([(0,t.Property)()],i.prototype,"baseItem",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showSubTotals",void 0),Ds([(0,t.Property)(!1)],i.prototype,"isNamedSet",void 0),Ds([(0,t.Property)(!1)],i.prototype,"isCalculatedField",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showFilterIcon",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showSortIcon",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showRemoveIcon",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showValueTypeIcon",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showEditIcon",void 0),Ds([(0,t.Property)(!0)],i.prototype,"allowDragAndDrop",void 0),Ds([(0,t.Property)()],i.prototype,"dataType",void 0),Ds([(0,t.Property)(!1)],i.prototype,"expandAll",void 0),Ds([(0,t.Property)()],i.prototype,"groupName",void 0),i}(t.ChildProperty),Ps=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ms(t,e),t}(Os),Ns=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"backgroundColor",void 0),Ds([(0,t.Property)()],i.prototype,"color",void 0),Ds([(0,t.Property)()],i.prototype,"fontFamily",void 0),Ds([(0,t.Property)()],i.prototype,"fontSize",void 0),i}(t.ChildProperty),Es=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"name",void 0),Ds([(0,t.Property)("Include")],i.prototype,"type",void 0),Ds([(0,t.Property)()],i.prototype,"items",void 0),Ds([(0,t.Property)("DoesNotEquals")],i.prototype,"condition",void 0),Ds([(0,t.Property)()],i.prototype,"value1",void 0),Ds([(0,t.Property)()],i.prototype,"value2",void 0),Ds([(0,t.Property)()],i.prototype,"measure",void 0),Ds([(0,t.Property)(1)],i.prototype,"levelCount",void 0),Ds([(0,t.Property)()],i.prototype,"selectedField",void 0),i}(t.ChildProperty),Is=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"measure",void 0),Ds([(0,t.Property)()],i.prototype,"label",void 0),Ds([(0,t.Property)()],i.prototype,"conditions",void 0),Ds([(0,t.Property)()],i.prototype,"value1",void 0),Ds([(0,t.Property)()],i.prototype,"value2",void 0),Ds([(0,t.Property)()],i.prototype,"style",void 0),Ds([(0,t.Property)(!0)],i.prototype,"applyGrandTotals",void 0),i}(t.ChildProperty),Fs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"name",void 0),Ds([(0,t.Property)("Ascending")],i.prototype,"order",void 0),Ds([(0,t.Property)([])],i.prototype,"membersOrder",void 0),i}(t.ChildProperty),Ls=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"name",void 0),Ds([(0,t.Property)()],i.prototype,"minimumFractionDigits",void 0),Ds([(0,t.Property)()],i.prototype,"maximumFractionDigits",void 0),Ds([(0,t.Property)()],i.prototype,"minimumSignificantDigits",void 0),Ds([(0,t.Property)()],i.prototype,"maximumSignificantDigits",void 0),Ds([(0,t.Property)(!0)],i.prototype,"useGrouping",void 0),Ds([(0,t.Property)()],i.prototype,"skeleton",void 0),Ds([(0,t.Property)()],i.prototype,"type",void 0),Ds([(0,t.Property)()],i.prototype,"currency",void 0),Ds([(0,t.Property)()],i.prototype,"minimumIntegerDigits",void 0),Ds([(0,t.Property)()],i.prototype,"format",void 0),i}(t.ChildProperty),As=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"name",void 0),Ds([(0,t.Property)()],i.prototype,"groupInterval",void 0),Ds([(0,t.Property)()],i.prototype,"startingAt",void 0),Ds([(0,t.Property)()],i.prototype,"endingAt",void 0),Ds([(0,t.Property)("Date")],i.prototype,"type",void 0),Ds([(0,t.Property)()],i.prototype,"rangeInterval",void 0),Ds([(0,t.Property)()],i.prototype,"caption",void 0),Ds([(0,t.Property)()],i.prototype,"customGroups",void 0),i}(t.ChildProperty),Rs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"groupName",void 0),Ds([(0,t.Property)([])],i.prototype,"items",void 0),i}(t.ChildProperty),ks=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"name",void 0),Ds([(0,t.Property)()],i.prototype,"formula",void 0),Ds([(0,t.Property)()],i.prototype,"hierarchyUniqueName",void 0),Ds([(0,t.Property)()],i.prototype,"formatString",void 0),i}(t.ChildProperty),js=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"name",void 0),Ds([(0,t.Property)()],i.prototype,"items",void 0),Ds([(0,t.Property)()],i.prototype,"delimiter",void 0),i}(t.ChildProperty),qs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"headerText",void 0),Ds([(0,t.Property)(".")],i.prototype,"headerDelimiter",void 0),Ds([(0,t.Property)("None")],i.prototype,"sortOrder",void 0),Ds([(0,t.Property)()],i.prototype,"measure",void 0),i}(t.ChildProperty),Hs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)()],i.prototype,"userName",void 0),Ds([(0,t.Property)()],i.prototype,"password",void 0),i}(t.ChildProperty),Vs=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ms(i,e),Ds([(0,t.Property)("Local")],i.prototype,"mode",void 0),Ds([(0,t.Property)()],i.prototype,"catalog",void 0),Ds([(0,t.Property)()],i.prototype,"cube",void 0),Ds([(0,t.Property)()],i.prototype,"roles",void 0),Ds([(0,t.Property)("Relational")],i.prototype,"providerType",void 0),Ds([(0,t.Property)()],i.prototype,"url",void 0),Ds([(0,t.Property)(1033)],i.prototype,"localeIdentifier",void 0),Ds([(0,t.Property)()],i.prototype,"dataSource",void 0),Ds([(0,t.Collection)([],Os)],i.prototype,"rows",void 0),Ds([(0,t.Collection)([],Os)],i.prototype,"columns",void 0),Ds([(0,t.Collection)([],Os)],i.prototype,"values",void 0),Ds([(0,t.Collection)([],Os)],i.prototype,"filters",void 0),Ds([(0,t.Collection)([],Os)],i.prototype,"fieldMapping",void 0),Ds([(0,t.Property)([])],i.prototype,"excludeFields",void 0),Ds([(0,t.Property)(!1)],i.prototype,"expandAll",void 0),Ds([(0,t.Property)("column")],i.prototype,"valueAxis",void 0),Ds([(0,t.Property)(-1)],i.prototype,"valueIndex",void 0),Ds([(0,t.Collection)([],Es)],i.prototype,"filterSettings",void 0),Ds([(0,t.Collection)([],Fs)],i.prototype,"sortSettings",void 0),Ds([(0,t.Property)(!0)],i.prototype,"enableSorting",void 0),Ds([(0,t.Property)("JSON")],i.prototype,"type",void 0),Ds([(0,t.Property)(!0)],i.prototype,"allowMemberFilter",void 0),Ds([(0,t.Property)(!1)],i.prototype,"allowLabelFilter",void 0),Ds([(0,t.Property)(!1)],i.prototype,"allowValueFilter",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showSubTotals",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showRowSubTotals",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showColumnSubTotals",void 0),Ds([(0,t.Property)("Auto")],i.prototype,"subTotalsPosition",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showGrandTotals",void 0),Ds([(0,t.Property)("Bottom")],i.prototype,"grandTotalsPosition",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showRowGrandTotals",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showColumnGrandTotals",void 0),Ds([(0,t.Property)(!1)],i.prototype,"alwaysShowValueHeader",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showHeaderWhenEmpty",void 0),Ds([(0,t.Property)(!0)],i.prototype,"showAggregationOnValueField",void 0),Ds([(0,t.Collection)([],Ls)],i.prototype,"formatSettings",void 0),Ds([(0,t.Collection)([],js)],i.prototype,"drilledMembers",void 0),Ds([(0,t.Complex)({},qs)],i.prototype,"valueSortSettings",void 0),Ds([(0,t.Collection)([],ks)],i.prototype,"calculatedFieldSettings",void 0),Ds([(0,t.Collection)([],Is)],i.prototype,"conditionalFormatSettings",void 0),Ds([(0,t.Property)()],i.prototype,"emptyCellsTextContent",void 0),Ds([(0,t.Collection)([],As)],i.prototype,"groupSettings",void 0),Ds([(0,t.Complex)({},Hs)],i.prototype,"authentication",void 0),i}(t.ChildProperty),Us=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),Bs=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},_s=(function(e){function i(){return null!==e&&e.apply(this,arguments)||this}Us(i,e),Bs([(0,t.Property)("Row")],i.prototype,"mode",void 0),Bs([(0,t.Property)("Flow")],i.prototype,"cellSelectionMode",void 0),Bs([(0,t.Property)("Single")],i.prototype,"type",void 0),Bs([(0,t.Property)(!1)],i.prototype,"checkboxOnly",void 0),Bs([(0,t.Property)(!1)],i.prototype,"persistSelection",void 0),Bs([(0,t.Property)("Default")],i.prototype,"checkboxMode",void 0),Bs([(0,t.Property)(!1)],i.prototype,"enableSimpleMultiRowSelection",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Us(i,e),Bs([(0,t.Property)("auto")],i.prototype,"height",void 0),Bs([(0,t.Property)("auto")],i.prototype,"width",void 0),Bs([(0,t.Property)("Both")],i.prototype,"gridLines",void 0),Bs([(0,t.Property)(!1)],i.prototype,"allowTextWrap",void 0),Bs([(0,t.Property)(!1)],i.prototype,"allowReordering",void 0),Bs([(0,t.Property)(!0)],i.prototype,"allowResizing",void 0),Bs([(0,t.Property)(!0)],i.prototype,"allowAutoResizing",void 0),Bs([(0,t.Property)(null)],i.prototype,"rowHeight",void 0),Bs([(0,t.Property)(110)],i.prototype,"columnWidth",void 0),Bs([(0,t.Property)("Ellipsis")],i.prototype,"clipMode",void 0),Bs([(0,t.Property)(!1)],i.prototype,"allowSelection",void 0),Bs([(0,t.Property)(-1)],i.prototype,"selectedRowIndex",void 0),Bs([(0,t.Property)({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],i.prototype,"selectionSettings",void 0),Bs([(0,t.Property)({wrapMode:"Both"})],i.prototype,"textWrapSettings",void 0),Bs([(0,t.Property)("AllPages")],i.prototype,"printMode",void 0),Bs([(0,t.Property)()],i.prototype,"contextMenuItems",void 0),Bs([(0,t.Event)()],i.prototype,"beforeCopy",void 0),Bs([(0,t.Event)()],i.prototype,"printComplete",void 0),Bs([(0,t.Event)()],i.prototype,"beforePrint",void 0),Bs([(0,t.Event)()],i.prototype,"beforePdfExport",void 0),Bs([(0,t.Event)()],i.prototype,"beforeExcelExport",void 0),Bs([(0,t.Event)()],i.prototype,"contextMenuOpen",void 0),Bs([(0,t.Event)()],i.prototype,"contextMenuClick",void 0),Bs([(0,t.Event)()],i.prototype,"queryCellInfo",void 0),Bs([(0,t.Event)()],i.prototype,"headerCellInfo",void 0),Bs([(0,t.Event)()],i.prototype,"rowSelecting",void 0),Bs([(0,t.Event)()],i.prototype,"rowSelected",void 0),Bs([(0,t.Event)()],i.prototype,"rowDeselecting",void 0),Bs([(0,t.Event)()],i.prototype,"rowDeselected",void 0),Bs([(0,t.Event)()],i.prototype,"cellSelecting",void 0),Bs([(0,t.Event)()],i.prototype,"cellSelected",void 0),Bs([(0,t.Event)()],i.prototype,"cellDeselecting",void 0),Bs([(0,t.Event)()],i.prototype,"cellDeselected",void 0),Bs([(0,t.Event)()],i.prototype,"resizeStart",void 0),Bs([(0,t.Event)()],i.prototype,"resizing",void 0),Bs([(0,t.Event)()],i.prototype,"resizeStop",void 0),Bs([(0,t.Event)()],i.prototype,"pdfHeaderQueryCellInfo",void 0),Bs([(0,t.Event)()],i.prototype,"pdfQueryCellInfo",void 0),Bs([(0,t.Event)()],i.prototype,"excelHeaderQueryCellInfo",void 0),Bs([(0,t.Event)()],i.prototype,"excelQueryCellInfo",void 0),Bs([(0,t.Event)()],i.prototype,"columnDragStart",void 0),Bs([(0,t.Event)()],i.prototype,"columnDrag",void 0),Bs([(0,t.Event)()],i.prototype,"columnDrop",void 0),Bs([(0,t.Event)()],i.prototype,"columnRender",void 0),i}(t.ChildProperty)),Gs=function(){function e(e){this.keyConfigs={tab:"tab",shiftTab:"shift+tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",shiftEnter:"shift+enter",ctrlEnter:"ctrl+enter",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape",ctrlShiftF:"ctrl+shift+f"},this.parent=e,this.event=void 0,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"tab":this.processTab(e);break;case"shiftTab":this.processShiftTab(e);break;case"enter":case"shiftEnter":case"ctrlEnter":this.processEnter(e);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(e);break;case"escape":this.clearSelection();break;case"ctrlShiftF":this.toggleFieldList(e)}},e.prototype.getNextButton=function(e){var i=this.allpivotButtons(e);if((0,t.removeClass)(i,"e-btn-focused"),this.parent.grid.element.querySelector("."+ya))for(var a=i.length,r=0;r<a;r++)if(i[r].getAttribute("data-uid")===e.getAttribute("data-uid"))return i[r+1]?i[r+1]:e;return e},e.prototype.getPrevButton=function(e){var i=this.allpivotButtons(e);if((0,t.removeClass)(i,"e-btn-focused"),this.parent.grid.element.querySelector("."+ya))for(var a=i.length,r=0;r<a;r++)if(i[r].getAttribute("data-uid")===e.getAttribute("data-uid"))return i[r-1]?i[r-1]:e;return e},e.prototype.allpivotButtons=function(e){var i=[];if(e&&this.parent.showGroupingBar){var a=(0,t.closest)(e,"."+Qn),r=(0,t.closest)(e,"."+Xn),n=(0,t.closest)(e,"."+Gn),s=e.classList.contains(Or),o=void 0,l=void 0,d=void 0;if(null!==a?l=a.classList.contains(Qn):null!==r?d=r.classList.contains(Xn):null!==n&&(o=n.classList.contains(Gn)),l||d||s){var p=[].slice.call(this.parent.element.querySelector("."+Qn).querySelectorAll("."+ya)),h=[].slice.call(this.parent.element.querySelector("."+Xn).querySelectorAll("."+ya));i=p.concat(h)}else o&&(i=[].slice.call(this.parent.element.querySelector("."+Gn).querySelectorAll("."+ya)))}return i},e.prototype.processTab=function(e){var i=e.target;if(i&&((0,t.closest)(i,"."+ya)||i.classList.contains("e-group-row"))){if(this.parent.grid){var a=this.parent.grid.serviceLocator.getService("focus");if(i.classList.contains("e-group-row")&&i.querySelector(".e-btn-focused"))i=i.querySelector(".e-btn-focused");else if(i.classList.contains("e-group-row")){a.focus();var r=a.getFocusedElement();return(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),void e.preventDefault()}var n=this.getNextButton(i);if(n.getAttribute("data-uid")!==i.getAttribute("data-uid"))this.parent.element.querySelector(".e-focused")?(this.parent.element.querySelector(".e-focused").setAttribute("tabindex","-1"),(0,t.removeClass)(this.parent.element.querySelectorAll(".e-focus"),"e-focus"),(0,t.removeClass)(this.parent.element.querySelectorAll(".e-focused"),"e-focused"),a.setFocusedElement(this.parent.element.querySelector(".e-headercell")),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","0")):a.currentInfo.skipAction=!0,(0,t.addClass)([n],"e-btn-focused"),n.focus();else{a.focus();r=a.getFocusedElement();(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")}return void e.preventDefault()}}else if(!this.parent.showGroupingBar&&this.parent.showFieldList&&i&&(0,t.closest)(i,"."+aa)){if(this.parent.grid){(a=this.parent.grid.serviceLocator.getService("focus")).focus();r=a.getFocusedElement();return(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),void e.preventDefault()}}else if(this.parent.showGroupingBar||this.parent.showFieldList||!i||!(0,t.closest)(i,"."+tn)||(0,t.closest)(i,".e-popup.e-popup-open")){if(i&&(0,t.closest)(i,"."+kn)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){(0,t.removeClass)((0,t.closest)(i,"."+kn).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&(0,t.addClass)([document.activeElement],"e-focused")}));else if(i.classList.contains("e-numerictextbox")){(a=this.parent.grid.serviceLocator.getService("focus")).focus();r=a.getFocusedElement();(0,t.removeClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),e.preventDefault()}}else if(this.parent.grid){var s=(0,t.closest)(i,"."+tn),a=this.parent.grid.serviceLocator.getService("focus"),o=[].slice.call(s.getElementsByTagName("tr"));if(i.innerHTML!==o[o.length-1].lastChild.innerHTML){a.focus();var r=a.getFocusedElement();return(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0"),void e.preventDefault()}a.currentInfo.skipAction=!0}},e.prototype.processShiftTab=function(e){var i=e.target;if(i&&((0,t.closest)(i,"."+ya)||i.classList.contains("e-group-row"))){if(this.parent.grid){var a=this.parent.grid.serviceLocator.getService("focus");if(i.classList.contains("e-group-row")&&i.querySelector(".e-btn-focused"))i=i.querySelector(".e-btn-focused");else if(i.classList.contains("e-group-row")){i=this.parent.element.querySelector(".e-btn-focused")?this.parent.element.querySelector(".e-btn-focused"):this.parent.element.querySelector("."+Qn);var r=this.allpivotButtons(i);if(r.length>0&&r[r.length-1])return a.currentInfo.skipAction=!0,r[r.length-1].focus(),(0,t.removeClass)(r,"e-btn-focused"),(0,t.addClass)([r[r.length-1]],"e-btn-focused"),void e.preventDefault()}var n=this.getPrevButton(i);if(n.getAttribute("data-uid")!==i.getAttribute("data-uid"))return a.currentInfo.skipAction=!0,n.focus(),void e.preventDefault()}}else if(i&&this.parent.grid&&(i.classList.contains("e-movablefirst")||i.classList.contains("e-rowsheader")&&(0,t.closest)(i,"tr").getAttribute("data-uid")===this.parent.grid.element.querySelector(".e-frozencontent tr").getAttribute("data-uid"))){a=this.parent.grid.serviceLocator.getService("focus");if(i.classList.contains("e-movablefirst")){i=this.parent.element.querySelector("."+Ja+" .e-btn-focused")?this.parent.element.querySelector("."+Ja+" .e-btn-focused"):this.parent.element.querySelector("."+Ja);var s=a.getFocusedElement();(0,t.removeClass)([s],["e-focused","e-focus"])}var o=this.allpivotButtons(i);if(o.length>0)return a.currentInfo.skipAction=!0,setTimeout((function(){o[o.length-1].focus()})),(0,t.removeClass)(o,"e-btn-focused"),(0,t.addClass)([o[o.length-1]],"e-btn-focused"),void e.preventDefault()}else if(i&&(0,t.closest)(i,"."+kn)&&this.parent.toolbar&&this.parent.toolbarModule)clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout((function(){(0,t.removeClass)((0,t.closest)(i,"."+kn).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&(0,t.addClass)([document.activeElement],"e-focused")}));else if(i.classList.contains("e-numerictextbox")){(a=this.parent.grid.serviceLocator.getService("focus")).focus();s=a.getFocusedElement();(0,t.removeClass)([s],["e-focused","e-focus"]),s.setAttribute("tabindex","0"),e.preventDefault()}},e.prototype.processEnter=function(e){var i=e.target;if(i&&(0,t.closest)(i,"."+en)){var a=this.parent.grid.serviceLocator.getService("focus");if(13!==e.keyCode||e.shiftKey||e.ctrlKey)if(13===e.keyCode&&e.shiftKey&&!e.ctrlKey){if(this.parent.enableValueSorting){this.event=e,i.click(),a.focus();r=a.getFocusedElement();(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")}}else 13===e.keyCode&&!e.shiftKey&&e.ctrlKey&&this.parent.hyperlinkSettings&&i.querySelector("a")&&i.querySelector("a").click();else if(i.querySelector("."+Yi)){this.event=e,i.querySelector("."+Yi).click(),a.focus();var r=a.getFocusedElement();(0,t.addClass)([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")}else if(i.classList.contains("e-valuescontent"))i.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),i.querySelector(".e-numerictextbox")&&i.click();else if(i.classList.contains("e-numerictextbox")){a.focus();var r=a.getFocusedElement();(0,t.removeClass)([r],["e-focused","e-focus"])}e.preventDefault()}else;},e.prototype.clearSelection=function(){var e=this.parent;(0,t.removeClass)(e.element.querySelectorAll("."+Cn+",."+xn),[xn,Cn,On]),this.parent.renderModule.selected()},e.prototype.processSelection=function(e){var i=e.target;if(this.parent.grid&&this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode&&!i.classList.contains("e-numerictextbox")){var a,r=this.parent,n=Number(e.target.getAttribute("data-colindex")),s=Number(e.target.getAttribute("index"));if("TH"!==i.nodeName&&"TD"!==i.nodeName||(a="shiftUp"===e.action||"upArrow"===e.action?0===s||0===n||"TH"!==i.nodeName&&r.renderModule.rowStartPos!==s?null:this.getParentElement(r,a,n,s-1):"shiftDown"===e.action||"downArrow"===e.action?r.element.querySelector('th[data-colindex="'+n+'"][index="'+(s+1)+'"]'):"shiftLeft"===e.action||"leftArrow"===e.action?e.target.previousSibling:e.target.nextSibling),(0,t.isNullOrUndefined)(a))"upArrow"===e.action?(a=r.element.querySelector('[data-colindex="'+n+'"][index="'+(s-1)+'"]'),s--):"downArrow"===e.action&&(a=r.element.querySelector('[data-colindex="'+n+'"][index="'+(s+1)+'"]'),s++),(0,t.isNullOrUndefined)(a)||r.clearSelection(a,e);else if("Both"===r.gridSettings.selectionSettings.mode&&a.classList.contains(Dn))r.clearSelection(a,e);else{n=Number(a.getAttribute("data-colindex")),s=Number(a.getAttribute("index"));var o=Number(a.getAttribute("aria-colspan"));r.clearSelection(a,e);var l={cancel:!1,isCellClick:!0,currentCell:a,data:r.pivotValues[s][n]};r.trigger(A,l,(function(t){t.cancel||r.applyColumnSelection(e,a,n,n+(o>0?o-1:0),s)}))}}else if(i&&(37===e.keyCode||38===e.keyCode)&&this.parent&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&!i.classList.contains("e-numerictextbox")){if(this.parent.grid&&this.parent.element.querySelector(".e-frozenheader")&&this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus").length>0)return(0,t.removeClass)(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus"),"e-focus"),(0,t.removeClass)(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focused"),"e-focused"),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","-1"),this.parent.grid.serviceLocator.getService("focus").setFocusedElement(i),(0,t.addClass)([i],["e-focused","e-focus"]),i.setAttribute("tabindex","0"),i.focus(),void e.preventDefault()}else!i.classList.contains("e-numerictextbox")||"rightArrow"!==e.action&&"leftArrow"!==e.action||i.click()},e.prototype.getParentElement=function(e,t,i,a){for(;!t;)t=e.element.querySelector('[data-colindex="'+i+'"][index="'+a+'"]'),i--;return t},e.prototype.toggleFieldList=function(e){if(this.parent&&!this.parent.isDestroyed&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed&&this.parent.element.querySelector("."+aa)){if(!this.parent.element.querySelector("."+aa).classList.contains(Xi))return this.parent.element.querySelector("."+aa).click(),void e.preventDefault();this.parent.element.querySelector("."+aa).classList.contains(Xi)&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog&&!this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.isDestroyed&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.hide()}},e.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},e}(),zs=function(){function e(e){this.parent=e,this.parent.contextMenuModule=this}return e.prototype.render=function(){this.renderContextMenu()},e.prototype.renderContextMenu=function(){var e=[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],i={cssClass:"e-pivot-context-menu"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:e,enableRtl:this.parent.enableRtl,locale:this.parent.locale,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},a=(0,t.createElement)("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(a),this.menuObj=new ds.ContextMenu(i),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(a)},e.prototype.onBeforeMenuOpen=function(e){var i=[].slice.call(e.element.querySelectorAll("li")),a="olap"===this.parent.dataType?this.fieldElement.getAttribute("data-type"):this.fieldElement.querySelector("."+Ca).getAttribute("data-type");if((0,t.removeClass)(i,rn),"CalculatedField"===a||"isMeasureFieldsAvail"===a)for(var r=0,n=i;r<n.length;r++){(p=n[r]).textContent!==this.parent.localeObj.getConstant("addToValue")&&(0,t.addClass)([p],rn)}else if("isMeasureAvail"===a)for(var s=0,o=i;s<o.length;s++){(p=o[s]).textContent!==this.parent.localeObj.getConstant("addToRow")&&p.textContent!==this.parent.localeObj.getConstant("addToColumn")&&(0,t.addClass)([p],rn)}else if("olap"===this.parent.dataType)for(var l=0,d=i;l<d.length;l++){var p;if((p=d[l]).textContent===this.parent.localeObj.getConstant("addToValue")){(0,t.addClass)([p],rn);break}}},e.prototype.onSelectContextMenu=function(e){if(null!==e.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.btnElement=this.fieldElement,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}},e.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),(0,t.select)("#"+this.parent.element.id+"_PivotContextMenu",document)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"_PivotContextMenu",document)))},e}(),Ws=function(){function e(e){this.previousValues={top:0,left:0},this.frozenPreviousValues={top:0,left:0},this.eventType="",this.isFireFox=t.Browser.userAgent.toLowerCase().indexOf("firefox")>-1,this.parent=e,this.addInternalEvents()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.addInternalEvents=function(){this.parent.isDestroyed||this.parent.on(Ye,this.wireEvents,this)},e.prototype.wireEvents=function(){if(this.engineModule="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,"Chart"!==this.parent.displayOption.view){var e=this.parent.element.querySelector("."+vn),i=this.parent.element.querySelector("."+In),a=this.parent.element.querySelector("."+bn),r=i.querySelector("."+Sn);if(t.EventHandler.clearEvents(e),this.isFireFox&&t.EventHandler.clearEvents(a),this.engineModule){var n=this.parent.isAdaptive?e:i.querySelector("."+Sn);t.EventHandler.add(n,"scroll touchmove pointermove",this.onHorizondalScroll(a,e),this),t.EventHandler.add(e.parentElement,"scroll wheel touchmove pointermove keyup keydown",this.onVerticalScroll(e.parentElement,e),this),this.isFireFox?(t.EventHandler.add(n,"mouseup touchend scroll",this.common(a,e,e),this),this.parent.isAdaptive||t.EventHandler.add(e.parentElement,"mouseup touchend scroll",this.common(a,e.parentElement,e),this)):(t.EventHandler.add(n,"mouseup touchend",this.common(a,e,e),this),this.parent.isAdaptive||t.EventHandler.add(e.parentElement,"mouseup touchend",this.common(a,e.parentElement,e),this)),t.EventHandler.add(r,"scroll",this.onCustomScrollbarScroll(e,a),this),t.EventHandler.add(e,"scroll",this.onCustomScrollbarScroll(r,a),this),t.EventHandler.add(a,"scroll",this.onCustomScrollbarScroll(r,e),this),t.EventHandler.add(a,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(a,"touchmove pointermove",this.onTouchScroll(a,e),this),t.EventHandler.add(e,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(e,"touchmove pointermove",this.onTouchScroll(a,e),this)}this.parent.grid.on("check-scroll-reset",(function(e){e.cancel=!0})),this.parent.grid.on("prevent-frozen-scroll-refresh",(function(e){e.cancel=!0})),this.parent.grid.isPreventScrollEvent=!0}},e.prototype.onWheelScroll=function(e){var t=this,i=e;return function(e){var a=i.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);t.frozenPreviousValues.top!==a&&(e.preventDefault(),t.frozenPreviousValues.top=a,t.eventType=e.type)}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.onCustomScrollbarScroll=function(e,t){var i=this,a=e,r=t;return function(e){if(null!==i.parent.element.querySelector("."+ba).querySelector("tbody")){var t=e.target,n=t.scrollLeft;i.previousValues.left===n||i.isFireFox&&t.classList.contains(bn)||(a.scrollLeft=n,r.scrollLeft=n,i.parent.isDestroyed)}}},e.prototype.onTouchScroll=function(e,t){var i=this,a=t;return function(r){if("mouse"!==r.pointerType){var n=i.getPointXY(r),s=i.parent.element.querySelector("."+en+" ."+ba).scrollTop+(i.pageXY.y-n.y),o=i.parent.isAdaptive?t:a.parentElement.parentElement.querySelector("."+Sn),l=o.scrollLeft+(i.pageXY.x-n.x);i.frozenPreviousValues.left===l||l<0||(e.scrollLeft=l,o.scrollLeft=l,i.pageXY.x=n.x,i.frozenPreviousValues.left=l,i.frozenPreviousValues.top===s||s<0||(i.pageXY.y=n.y,i.frozenPreviousValues.top=s,i.eventType=r.type))}}},e.prototype.update=function(e,i,a,n,s,o){var l=this,p=this.parent.element.querySelector("."+vn);this.parent.isScrolling=!0;var h="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,u={dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings)},c=this.parent.virtualScrollSettings&&this.parent.virtualScrollSettings.allowSinglePage&&"pivot"===this.parent.dataType;if(this.parent.pageSettings&&h.pageSettings){if("vertical"===this.direction){var g=o.parentElement.scrollHeight-(e+o.parentElement.offsetHeight),m="pivot"===this.parent.dataType&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,f=this.parent.pageSettings.rowPageSize*m*this.parent.gridSettings.rowHeight,S=Math.ceil(e/f);if(S+=c&&g<=0?1:0,(this.parent.scrollPosObject.vertical===S||h.pageSettings.rowPageSize>=h.rowCount||p&&p.scrollHeight<3*p.parentElement.clientHeight)&&!c)return;this.parent.actionObj.actionName=We,c&&this.parent.grid&&this.parent.grid.element.querySelector(".e-spinner-inner")&&(0,t.addClass)([this.parent.grid.element.querySelector(".e-spinner-inner")],[rs]),this.parent.actionBeginMethod(),c||this.parent.showWaitingPopup(),this.parent.scrollPosObject.vertical=S,this.parent.pageSettings.currentRowPage=h.pageSettings.currentRowPage=S>1?S:1;var v=0;this.parent.trigger(d,u,(function(){"pivot"===l.parent.dataType?"Server"===l.parent.dataSourceSettings.mode?l.parent.getEngine("onScroll",null,null,null,null,null,null):(l.parent.engineModule.generateGridData(l.parent.dataSourceSettings,!0,!1,l.parent.engineModule.headerCollection),v=l.parent.engineModule.rowStartPos):(l.parent.olapEngineModule.scrollPage(),v=l.parent.olapEngineModule.pageRowStartPos),l.enginePopulatedEventMethod(h)}));var y=f*Math.ceil(v/(this.parent.pageSettings.rowPageSize*m))-h.rowFirstLvl*m*this.parent.gridSettings.rowHeight;this.parent.scrollPosObject.verticalSection=y}else{var b=n.scrollWidth-(n.scrollLeft+n.offsetWidth),C="pivot"===this.parent.dataType&&"column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,x=(f=this.parent.pageSettings.columnPageSize*C*this.parent.gridSettings.columnWidth,S=Math.ceil(Math.abs(i)/f),this.parent.virtualScrollSettings&&this.parent.virtualScrollSettings.allowSinglePage&&"pivot"===this.parent.dataType);if(S+=x&&b<=0?1:0,(this.parent.scrollPosObject.horizontal===S||p&&p.scrollWidth<3*p.parentElement.clientWidth)&&!x)return;this.parent.actionObj.actionName=Qe,x&&this.parent.grid&&this.parent.grid.element.querySelector(".e-spinner-inner")&&(0,t.addClass)([this.parent.grid.element.querySelector(".e-spinner-inner")],[rs]),this.parent.actionBeginMethod(),x||this.parent.showWaitingPopup();var w=this.parent;w.scrollPosObject.horizontal=S,this.parent.pageSettings.currentColumnPage=h.pageSettings.currentColumnPage=S>1?S:1;var T=0;this.parent.trigger(d,u,(function(){"pivot"===w.dataType?"Server"===l.parent.dataSourceSettings.mode?l.parent.getEngine("onScroll",null,null,null,null,null,null):(w.engineModule.generateGridData(w.dataSourceSettings,!0,!1,w.engineModule.headerCollection),T=w.engineModule.colStartPos):(w.olapEngineModule.scrollPage(),T=w.olapEngineModule.pageColStartPos),l.enginePopulatedEventMethod(h)}));y=f*Math.ceil(T/(w.pageSettings.columnPageSize*C))-h.colFirstLvl*C*w.gridSettings.columnWidth;w.scrollPosObject.horizontalSection=y}this.parent.actionObj.actionName=this.parent.getActionCompleteName(),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},e.prototype.enginePopulatedEventMethod=function(e,t){var i=this,a=t||this.parent,r={dataSourceSettings:a.dataSourceSettings,pivotValues:e.pivotValues};a.trigger(p,r,(function(e){i.parent.pivotValues=e.pivotValues}))},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.common=function(e,i,a){var r=this;return function(n){var s=r.parent.isAdaptive?i:(0,t.closest)(i,"."+In).querySelector("."+Sn);r.parent.virtualScrollSettings&&r.parent.virtualScrollSettings.allowSinglePage&&"pivot"===r.parent.dataType&&("vertical"===r.direction?r.parent.element.querySelector("."+as)&&((0,t.addClass)([a],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+as)],[rs])):r.parent.element.querySelector("."+as)&&((0,t.addClass)([e,i],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+as)],[rs]))),r.update(r.parent.element.querySelector("."+en+" ."+ba).scrollTop*r.parent.verticalScrollScale,s.scrollLeft*r.parent.horizontalScrollScale,n,s,e,i)}},e.prototype.onHorizondalScroll=function(e,i){var a,r=this,n=this.parent.isAdaptive?i:(0,t.closest)(i,"."+In).querySelector("."+Sn),s=Math.abs(n.scrollLeft),o=s*this.parent.horizontalScrollScale,l=o-this.parent.scrollPosObject.horizontalSection-s;return l=this.parent.enableRtl?l:-l,"none"!==n.style.display&&this.alignFreezedCells(l,!1),function(d){if(s=Math.abs(n.scrollLeft),o=s*r.parent.horizontalScrollScale,"wheel"!==d.type&&"touchmove"!==d.type&&"wheel"!==r.eventType&&"touchmove"!==r.eventType||(clearTimeout(a),a=setTimeout((function(){o="touchmove"===d.type?s:o,r.update(i.parentElement.scrollTop*r.parent.verticalScrollScale,o,d,n,e,i)}),300)),r.previousValues.left!==o){r.parent.scrollDirection=r.direction="horizondal",l=o-r.parent.scrollPosObject.horizontalSection-s,l=r.parent.enableRtl?l:-l;var p=i.querySelector("."+Mr).style.transform.split(",").length>1?i.querySelector("."+Mr).style.transform.split(",")[1].trim():"0px)";s<r.parent.scrollerBrowserLimit&&((0,t.setStyleAttribute)(i.querySelector("."+Mr),{transform:"translate("+l+"px,"+p}),(0,t.setStyleAttribute)(e.querySelector("."+Mr),{transform:"translate("+l+"px,0px)"}),r.alignFreezedCells(l,!1));var h=r.parent.scrollPosObject.horizontalSection>o?-(r.parent.scrollPosObject.horizontalSection-o):o+(e.offsetWidth-e.querySelector(".e-headercell.e-leftfreeze").offsetWidth)-(r.parent.scrollPosObject.horizontalSection+(i.querySelector("."+Mr).offsetWidth-i.querySelector("."+Mr).querySelector(".e-leftfreeze.e-rowsheader").offsetWidth)),u=Math.ceil(r.parent.scrollPosObject.horizontalSection/r.parent.horizontalScrollScale)<r.parent.scrollerBrowserLimit;if(r.parent.scrollPosObject.horizontalSection>o||h>1&&u){r.parent.virtualScrollSettings&&r.parent.virtualScrollSettings.allowSinglePage&&"pivot"===r.parent.dataType&&r.parent.element.querySelector("."+as)&&((0,t.addClass)([e,i],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+as)],[rs])),o>e.clientWidth?(r.parent.scrollPosObject.left<1&&(r.parent.scrollPosObject.left=e.clientWidth),r.parent.scrollPosObject.left=r.parent.scrollPosObject.left-50,h=r.parent.scrollPosObject.horizontalSection>o?h-r.parent.scrollPosObject.left:h+r.parent.scrollPosObject.left):h=-r.parent.scrollPosObject.horizontalSection,l=-(o-(r.parent.scrollPosObject.horizontalSection+h)-(0,t.closest)(i,"."+In).querySelector("."+Sn).scrollLeft);var c=r.parent.gridSettings.columnWidth*r.engineModule.columnCount;c>r.parent.scrollerBrowserLimit&&(r.parent.horizontalScrollScale=c/r.parent.scrollerBrowserLimit,c=r.parent.scrollerBrowserLimit),l>c&&l>o&&(l=o,h=0),(0,t.setStyleAttribute)(i.querySelector("."+Mr),{transform:"translate("+l+"px,"+p}),(0,t.setStyleAttribute)(e.querySelector("."+Mr),{transform:"translate("+l+"px,0px)"}),r.alignFreezedCells(l,!1),r.parent.scrollPosObject.horizontalSection=r.parent.scrollPosObject.horizontalSection+h}var g=n.scrollWidth-(s+(n.offsetWidth-r.parent.element.querySelector("."+en).querySelector("."+Pr+"."+is).offsetWidth));if(g<=0){var m=i.querySelector("."+fn);m.style.display="none";var f=i.scrollWidth-(i.scrollLeft+i.offsetWidth);m.style.display="";var S=i.scrollWidth-(i.scrollLeft+i.offsetWidth);r.parent.scrollPosObject.horizontalSection-=f>g?f:-S,l=s>r.parent.scrollerBrowserLimit?Number(i.querySelector("."+Mr).style.transform.split(",")[0].split("px")[0].trim()):-(s*r.parent.horizontalScrollScale-r.parent.scrollPosObject.horizontalSection-s),(0,t.setStyleAttribute)(i.querySelector("."+Mr),{transform:"translate("+l+"px,"+p}),(0,t.setStyleAttribute)(e.querySelector("."+Mr),{transform:"translate("+l+"px,0px)"}),r.alignFreezedCells(l,!1)}r.previousValues.left=o,r.frozenPreviousValues.left=o,r.eventType="",e.scrollLeft=n.scrollLeft,i.scrollLeft=n.scrollLeft}}},e.prototype.alignFreezedCells=function(e,t){for(var i=0,a=this.parent.element.querySelectorAll("."+is);i<a.length;i++)t?this.parent.enableRtl?a[i].style.right=-e+"px":a[i].style.left=e+"px":this.parent.enableRtl?a[i].style.right=Number(e)+"px":a[i].style.left=Number(-e)+"px"},e.prototype.onVerticalScroll=function(e,i){var a,r=this,n=e.querySelector("."+vn)?e.querySelector("."+vn):e;return function(s){if(r.parent.isAdaptive||n.scrollHeight>3*n.parentElement.clientHeight){var o=e.scrollTop*r.parent.verticalScrollScale;if("wheel"===s.type||"touchmove"===s.type||"wheel"===r.eventType||"touchmove"===r.eventType||"keyup"===s.type||"keydown"===s.type){var l=r.parent.isAdaptive?e:(0,t.closest)(e,"."+In).querySelector("."+Sn);clearTimeout(a),a=setTimeout((function(){var t=0;if(r.parent.isAdaptive){var i=l.querySelector("."+vn);t=l.scrollLeft===i.scrollLeft?l.scrollLeft:i.scrollLeft}else t=l.scrollLeft;r.update(e.scrollTop*r.parent.verticalScrollScale,t*r.parent.horizontalScrollScale,s,l,null,e)}),300)}if(r.previousValues.top===o)return;r.parent.scrollPosObject.horizontalSection<0&&(r.parent.scrollPosObject.horizontalSection=0),r.parent.scrollDirection=r.direction="vertical";var d=-(o-r.parent.scrollPosObject.verticalSection-e.scrollTop),p=e.querySelector("."+Mr).style.transform.split(",")[0].trim();d>r.parent.virtualDiv.clientHeight&&(d=r.parent.virtualDiv.clientHeight),e.scrollTop<r.parent.scrollerBrowserLimit&&((0,t.setStyleAttribute)(e.querySelector("."+Mr),{transform:"translate(0px,"+d+"px)"}),(0,t.setStyleAttribute)(e.querySelector("."+Mr),{transform:p+","+d+"px)"}));var h=r.parent.scrollPosObject.verticalSection>o?-(r.parent.scrollPosObject.verticalSection-o):o+e.clientHeight-(r.parent.scrollPosObject.verticalSection+e.querySelector("."+Mr).offsetHeight),u=Math.ceil(r.parent.scrollPosObject.verticalSection/r.parent.verticalScrollScale)<r.parent.scrollerBrowserLimit;if(r.parent.scrollPosObject.verticalSection>o||h>1&&u){r.parent.virtualScrollSettings&&r.parent.virtualScrollSettings.allowSinglePage&&"pivot"===r.parent.dataType&&r.parent.element.querySelector("."+as)&&((0,t.addClass)([i],["e-virtual-pivot-content"]),(0,t.removeClass)([r.parent.element.querySelector("."+as)],[rs])),o>e.clientHeight?(r.parent.scrollPosObject.top<1&&(r.parent.scrollPosObject.top=e.clientHeight),r.parent.scrollPosObject.top=r.parent.scrollPosObject.top-50,h=r.parent.scrollPosObject.verticalSection>o?h-r.parent.scrollPosObject.top:h+r.parent.scrollPosObject.top):h=-r.parent.scrollPosObject.verticalSection;var c=r.parent.element.querySelector("."+ba).querySelector("."+Mr);d=-(o-(r.parent.scrollPosObject.verticalSection+h)-e.scrollTop);var g=r.parent.gridSettings.rowHeight*r.engineModule.rowCount+.1-c.clientHeight;g>r.parent.scrollerBrowserLimit&&(r.parent.verticalScrollScale=g/r.parent.scrollerBrowserLimit,g=r.parent.scrollerBrowserLimit),d>g&&d>o&&(d=o,h=0),d>r.parent.virtualDiv.clientHeight&&(d=r.parent.virtualDiv.clientHeight),(0,t.setStyleAttribute)(e.querySelector("."+Mr),{transform:"translate(0px,"+d+"px)"}),(0,t.setStyleAttribute)(e.querySelector("."+Mr),{transform:p+","+d+"px)"}),r.parent.scrollPosObject.verticalSection=r.parent.scrollPosObject.verticalSection+h}r.previousValues.top=o,r.frozenPreviousValues.top=o,r.eventType=""}}},e.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(Ye,this.wireEvents)},e.prototype.destroy=function(){this.removeInternalEvents()},e}(),Qs=function(){function e(e){this.indexString=[],this.isUpdated=!1,this.parent=e,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return e.prototype.showDrillThroughDialog=function(e){for(var i=this,a=e.rawData,n=[],s={},l=0;l<e.rawData.length;l++)n.push(r.frameHeaderWithKeys(e.rawData[l]));try{if("Table"===this.parent.currentView&&this.parent.editSettings.allowInlineEditing&&this.parent.editSettings.allowEditing&&1===e.rawData.length){if(this.parent.actionObj.actionName=zt,this.parent.actionBeginMethod())return;this.editCell(e,a)}else{this.removeDrillThroughDialog();var d=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog"});this.parent.element.appendChild(d),this.dialogPopUp=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(e,a),cssClass:this.parent.cssClass,beforeOpen:function(){i.drillThroughGrid.setProperties({dataSource:i.parent.editSettings.allowEditing?i.dataWithPrimarykey(e,a,s):a,height:i.parent.editSettings.allowEditing?220:300},!1)},beforeClose:function(){if(i.parent.editSettings.allowEditing&&i.isUpdated){"CSV"===i.parent.dataSourceSettings.type&&i.updateData(i.drillThroughGrid.dataSource);for(var e=[],r=0,o=Object.keys(s);r<o.length;r++){var l=o[r];e.push(s[l])}for(var d=Object.keys(s).length,p=[],h=[],u=0,c=0,g=i.drillThroughGrid.dataSource;c<g.length;c++){if("0"===(T=g[c]).__index||""===T.__index){for(var m=0,f=i.engine.fields;m<f.length;m++){var S=f[m];(0,t.isNullOrUndefined)(T[S])&&delete T[S]}delete T.__index,p.push(T)}else d>0&&(delete s[T.__index.toString()],h.push(T),d--);"Server"===i.parent.dataSourceSettings.mode&&(T.__index&&delete T.__index,a[u].__index&&delete a[u].__index),u++}if(d=0,"Server"===i.parent.dataSourceSettings.mode){for(var v=[],y=Object.keys(s),b=0;b<y.length;b++)delete i.parent.drillThroughValue.indexObject[s[y[b]]],v.push({Key:y[b],Value:s[y[b]]});i.parent.getEngine("updateRawData",null,null,null,null,null,null,null,{addedData:p,removedData:v,updatedData:h,indexObject:i.parent.drillThroughValue.indexObject})}else{for(var C=[],x=0,w=i.parent.allowDataCompression?i.parent.engineModule.actualData:i.parent.engineModule.data;x<w.length;x++){var T;delete(T=w[x]).__index,void 0===s[d.toString()]&&C.push(T),d++}C=C.concat(p);var M={currentData:i.drillThroughGrid.dataSource,previousData:n,previousPosition:e,cancel:!1};i.parent.trigger(U,M),M.cancel||(i.parent.setProperties({dataSourceSettings:{dataSource:C}},!0),i.engine.updateGridData(i.parent.dataSourceSettings),i.parent.pivotValues=i.engine.pivotValues)}i.parent.actionObj.actionName=qi;var D={editInfo:{type:i.drillThroughGrid.editSettings.mode,action:"Update",currentData:i.drillThroughGrid.dataSource,previousData:n,previousPosition:e}};i.parent.actionObj.actionInfo=D}i.isUpdated=!1,s={}},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!this.parent.editSettings.allowEditing,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(d),(0,t.setStyleAttribute)(this.dialogPopUp.element,{visibility:"visible"});this.parent.editSettings.allowEditing&&(this.drillthroughKeyboardModule=new t.KeyboardEvents(this.dialogPopUp.element,{keyAction:this.drillthroughKeyActionHandler.bind(this),keyConfigs:{escape:"escape"},eventName:"keydown"}))}}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.editCell=function(e,i){var a=this,n=this.parent.gridSettings.allowResizing,s=e.currentCell.actualText.toString(),o=Number(Object.keys(e.currentCell.indexObject));e.currentTarget.firstElementChild.style.display="none";var l=Number(e.rawData[0][s]),d=r.frameHeaderWithKeys(e.rawData[e.rawData.length-1]),p=e.rawData[e.rawData.length-1],h={editInfo:{type:"Inline editing",action:"update",data:i}};this.parent.actionObj.actionInfo=h;var u=new ps.NumericTextBox({value:l,enableRtl:this.parent.enableRtl,enabled:!0,format:"####.##",locale:this.parent.locale,cssClass:this.parent.cssClass,change:function(){var i=(0,t.isNullOrUndefined)(u.value)?0:u.value,r=e.currentCell.indexObject[o];e.rawData[0][s]=i,a.parent.engineModule.data[r]=e.rawData[0]},blur:function(){var e={currentData:[p],previousData:[d],previousPosition:[p.index],cancel:!1};if(a.parent.trigger(U,e),!e.cancel){if("Server"===a.parent.dataSourceSettings.mode){var t={};t[o]=o;var i=[p];a.parent.getEngine("updateRawData",null,null,null,null,null,null,null,{addedData:[],removedData:[],updatedData:i,indexObject:t})}a.parent.setProperties({dataSourceSettings:{dataSource:a.parent.engineModule.data}},!0),a.engine.updateGridData(a.parent.dataSourceSettings),a.parent.pivotValues=a.engine.pivotValues,a.parent.gridSettings.allowResizing=n}}}),c=(0,t.createElement)("input",{id:this.parent.element.id+"_inputbox"});e.currentTarget.appendChild(c),u.appendTo(c),e.currentCell.value=u.value,u.focusIn(),this.parent.gridSettings.allowResizing=!1},e.prototype.updateData=function(e){for(var i=0,a=this.parent.allowDataCompression?this.parent.engineModule.actualData:this.parent.engineModule.data;i<e.length;){for(var r=Object.keys(e[i]),n=0,s=[];n<r.length;)(0,t.isNullOrUndefined)(this.parent.engineModule.fieldKeys[r[n]])||(s[this.parent.engineModule.fieldKeys[r[n]]]=e[i][r[n]]),n++;a[Number(e[i].__index)]=s,i++}this.parent.allowDataCompression?this.parent.engineModule.actualData=a:this.parent.engineModule.data=a},e.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.parent.actionObj.actionName=Hi,this.parent.actionObj.actionName&&this.parent.actionCompleteMethod(),this.dialogPopUp.destroy());var e=document.getElementById(this.parent.element.id+"_drillthrough");e&&(0,t.remove)(e),document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},e.prototype.createDrillThroughGrid=function(e,i){var a=this,r=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),n=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"});if(""!==e.rowHeaders&&(n.innerHTML="<span class="+ka+"><span class="+Ra+">"+this.parent.localeObj.getConstant("row")+"</span> : <span class="+ja+">"+e.rowHeaders+"</span></span>"),""!==e.columnHeaders&&(n.innerHTML=n.innerHTML+"<span class="+ka+"><span class="+Ra+">"+this.parent.localeObj.getConstant("column")+"</span> : <span class="+ja+">"+e.columnHeaders+"</span></span>"),""!==e.value){var s=e.value.split("(")[0],o=e.value.split("(")[1].split(")")[0];"0"!==o&&(n.innerHTML=n.innerHTML+"<span class="+ka+"><span class="+Ra+">"+s+"</span> : <span class="+ja+">"+o+"</span></span>")}var l=["ColumnChooser"];this.parent.editSettings.allowEditing&&(l=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]);var d=(0,t.createElement)("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"});ls.Grid.Inject(ls.Selection,ls.Reorder,ls.Resize,ls.Toolbar,ls.ColumnChooser),this.drillThroughGrid=new ls.Grid({cssClass:this.parent.cssClass,gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,enableHover:!1,toolbar:l,columns:e.gridColumns,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:!this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing,pageSettings:{pageSize:20},rowHeight:this.parent.gridSettings.rowHeight,height:"100%"}),"olap"===this.parent.dataType&&this.formatData(i);var p=this;if(this.parent.trigger(V,{cellInfo:e,gridObj:this.drillThroughGrid,type:"editing"}),this.drillThroughGrid.allowExcelExport&&ls.Grid.Inject(ls.ExcelExport),this.drillThroughGrid.allowPdfExport&&ls.Grid.Inject(ls.PdfExport),this.parent.editSettings.allowEditing){ls.Grid.Inject(ls.Edit,ls.Page);try{this.drillThroughGrid.editSettings=this.parent.editSettings,this.drillThroughGrid.actionBegin=function(e){var t="save"===e.requestType?Wt:"add"===e.requestType?Qt:"delete"===e.requestType?Yt:"";a.parent.actionObj.actionName=t,!a.parent.actionObj.actionName||a.parent.actionBeginMethod()},this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,ls.Grid.Inject(ls.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1,defaultValue:"0",validationRules:{required:!0}})}catch(e){this.parent.actionFailureMethod(e)}this.drillThroughGrid.actionComplete=function(e){"batchsave"!==e.requestType&&"save"!==e.requestType&&"delete"!==e.requestType||(p.isUpdated=!0),a.parent.actionObj.actionName=a.parent.getActionCompleteName();var t={editInfo:{type:a.drillThroughGrid.editSettings.mode,action:e.requestType,data:i}};a.parent.actionObj.actionInfo=t,a.parent.actionObj.actionName&&a.parent.actionCompleteMethod(),("Normal"===p.drillThroughGrid.editSettings.mode&&"save"===e.requestType&&p.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!p.parent.editSettings.allowCommandColumns||"batchsave"===e.requestType)&&p.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=function(){p.isUpdated=!0}}else ls.Grid.Inject(ls.VirtualScroll);return document.body.appendChild(d),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(d),r.appendChild(n),r.appendChild(d),r},e.prototype.frameGridColumns=function(e){var i="olap"===this.parent.dataType?e[0]?Object.keys(e[0]):[]:Object.keys(this.engine.fieldList),a=[],r={};if(this.parent.dataSourceSettings.formatSettings.length>0)for(var n=0;n<this.parent.dataSourceSettings.formatSettings.length;n++)r[this.parent.dataSourceSettings.formatSettings[n].name]=this.parent.dataSourceSettings.formatSettings[n].format;if("olap"===this.parent.dataType)for(var s=0,o=i;s<o.length;s++){var l=o[s];a.push({field:l.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join(""),headerText:l.replace(/_x005B_|_x005D_|_x0024_/g,"").replace(/_x0020_/g," ").replace("].[","").split(".").reverse().join("."),width:120,visible:!0,validationRules:{required:!0},format:(0,t.isNullOrUndefined)(r[l])?null:r[l],type:(0,t.isNullOrUndefined)(r[l])?"string":null})}else for(var d=0,p=i;d<p.length;d++){l=p[d];if("CalculatedField"!==this.engine.fieldList[l].aggregateType){var h="",u=!("date"!==this.engine.fieldList[l].type&&"datetime"!==this.engine.fieldList[l].type||!(this.isDateFieldExist(l)||e[0]&&e[0][l]&&-1===e[0][l].toString().indexOf(" ")));h="number"===this.engine.fieldList[l].type?"numericedit":"date"===this.engine.fieldList[l].type&&u?"datepickeredit":"datetime"===this.engine.fieldList[l].type&&u?"datetimepickeredit":"defaultedit";var c=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(this.engine.fieldList[l].caption):this.engine.fieldList[l].caption;a.push({field:l,headerText:c,width:120,visible:this.engine.fieldList[l].isSelected,validationRules:{required:!0},editType:h,format:(0,t.isNullOrUndefined)(r[l])?void 0:r[l],type:(0,t.isNullOrUndefined)(r[l])?"string":null})}}return a},e.prototype.isDateFieldExist=function(e){for(var t=0;t<this.parent.dataSourceSettings.formatSettings.length;t++)if(this.parent.dataSourceSettings.formatSettings[t].name===e&&this.parent.dataSourceSettings.formatSettings[t].type.indexOf("date")>-1)return!0;for(t=0;t<this.parent.dataSourceSettings.fieldMapping.length;t++)if(this.parent.dataSourceSettings.fieldMapping[t].name===e&&this.parent.dataSourceSettings.fieldMapping[t].dataType&&this.parent.dataSourceSettings.fieldMapping[t].dataType.indexOf("date")>-1)return!0;return!1},e.prototype.formatData=function(e){for(var t=0;t<e.length;){for(var i=e[t],a=Object.keys(e[t]),r={},n=0;n<a.length;){r[a[n].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("")]=i[a[n]],n++}e[t]=r,t++}},e.prototype.dataWithPrimarykey=function(e,t,i){for(var a=this.indexString.length>0?this.indexString:Object.keys(e.currentCell.indexObject),r=t,n=0,s=0,o=r;s<o.length;s++){o[s].__index=a[n],i[a[n].toString()]=Number(a[n]),n++}return r},e.prototype.drillthroughKeyActionHandler=function(e){if("escape"===e.action)this.processClose(e)},e.prototype.processClose=function(e){var i=e.target;if(i&&(0,t.closest)(i,".e-popup.e-popup-open")){var a=(0,t.getInstance)((0,t.closest)(i,".e-popup.e-popup-open"),o.Dialog);if(a&&!a.closeOnEscape){var r=a.element.getAttribute("data-fieldName");if(a.hide(),this.parent.element)for(var n=0,s=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));n<s.length;n++){var l=s[n];if(l.getAttribute("data-uid")===r){l.focus();break}}return void e.preventDefault()}}},e.prototype.destroy=function(){this.parent.isDestroyed||this.drillthroughKeyboardModule&&!this.drillthroughKeyboardModule.isDestroyed&&(this.drillthroughKeyboardModule.destroy(),this.drillthroughKeyboardModule=null)},e}(),Ys=function(){function e(e){this.parent=e,this.drillThroughDialog=new Qs(this.parent),this.addInternalEvents()}return e.prototype.getModuleName=function(){return"drillThrough"},e.prototype.addInternalEvents=function(){this.parent.on(Ye,this.wireEvents,this)},e.prototype.wireEvents=function(){this.unWireEvents(),t.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},e.prototype.unWireEvents=function(){this.parent.isDestroyed||t.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},e.prototype.mouseClickHandler=function(e){var i=e.target,a=null;if(i.classList.contains("e-stackedheadercelldiv")||i.classList.contains("e-headercelldiv")||i.classList.contains("e-stackedheadertext")||i.classList.contains("e-headertext")?a=(0,t.closest)(i.parentElement,"th"):i.classList.contains("e-cellvalue")?a=i.parentElement:(i.classList.contains("e-headercell")||i.classList.contains("e-rowcell"))&&(a=i),a&&(this.parent.allowDrillThrough&&a.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing)){var r=Number(a.getAttribute("data-colindex")),n=Number(a.getAttribute("index"));this.executeDrillThrough(this.parent.pivotValues[n][r],n,r,a)}},e.prototype.executeDrillThrough=function(e,i,a,r){this.parent.drillThroughElement=r,this.parent.drillThroughValue=e;var n="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,s="",o="",l=[];if(!(0,t.isNullOrUndefined)(e.rowHeaders)&&!(0,t.isNullOrUndefined)(e.columnHeaders)){if("olap"===this.parent.dataType){var d=void 0,p=(d="row"===this.parent.dataSourceSettings.valueAxis?n.tupRowInfo[e.rowOrdinal]:n.tupColumnInfo[e.colOrdinal])?n.getUniqueName(d.measureName):e.actualText;if(n.fieldList[p]&&n.fieldList[p].isCalculatedField)return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("drillError"));s=n.fieldList[p||e.actualText].caption,o=n.fieldList[p||e.actualText].aggregateType,this.parent.olapEngineModule.getDrillThroughData(e,this.parent.maxRowsInDrillThrough);try{l=JSON.parse(n.gridJSON)}catch(e){return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),n.gridJSON)}}else if(s=n.fieldList[e.actualText.toString()]?n.fieldList[e.actualText.toString()].caption:e.actualText.toString(),o=n.fieldList[e.actualText]?n.fieldList[e.actualText].aggregateType:"","Server"===this.parent.dataSourceSettings.mode)this.parent.getEngine("fetchRawData",null,null,null,null,null,null,{rowIndex:i,columnIndex:a});else if(this.parent.allowDataCompression){var h=Object.keys(e.indexObject);this.drillThroughDialog.indexString=[];for(var u=0,c=h;u<c.length;u++)for(var g=c[u],m=0,f=this.parent.engineModule.groupRawIndex[Number(g)];m<f.length;m++){var S=f[m];l.push(this.parent.engineModule.actualData[S]),this.drillThroughDialog.indexString.push(S.toString())}}else for(var v=0,y=h=Object.keys(e.indexObject);v<y.length;v++){var b=y[v];l.push(this.parent.engineModule.data[Number(b)])}"Server"!==this.parent.dataSourceSettings.mode&&this.triggerDialog(s,o,l,e,r)}},e.prototype.getCalcualtedFieldValue=function(e,i){for(var a=0;a<e.length;a++){var r={};r[e[a]]=e[a];for(var n=0;n<this.parent.dataSourceSettings.calculatedFieldSettings.length;n++){for(var s=void 0,o=this.parent.engineModule.fields.length-1;o>=0;o--)if(this.parent.engineModule.fields[o]===this.parent.dataSourceSettings.calculatedFieldSettings[n].name){s=o;break}if(!(0,t.isNullOrUndefined)(i[a])){var l=this.parent.engineModule.getAggregateValue([Number(e[a])],r,s,"calculatedfield",!1);i[a][this.parent.dataSourceSettings.calculatedFieldSettings[n].name]=isNaN(l)&&(0,t.isNullOrUndefined)(l)?"#DIV/0!":l}}}return i},e.prototype.frameData=function(e){for(var t=0,i=0,a=[];i<e.rawData.length;){for(var r={};t<e.gridColumns.length;)r[e.gridColumns[t].field]="Server"===this.parent.dataSourceSettings.mode?e.rawData[i][-1!==this.parent.engineModule.fields.indexOf(e.gridColumns[t].field)?this.parent.engineModule.fields.indexOf(e.gridColumns[t].field):0]:e.rawData[i][this.parent.engineModule.fieldKeys[e.gridColumns[t].field]],t++;a.push(r),i++,t=0}return e.rawData=a,e},e.prototype.triggerDialog=function(e,i,a,r,n){var s="CalculatedField"===i?e.toString():""!==i?this.parent.localeObj.getConstant(i)+" "+this.parent.localeObj.getConstant("of")+" "+e:e;s=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s):s;var o="row"===this.parent.dataSourceSettings.valueAxis?this.parent.getRowText(Number(n.getAttribute("index")),0):""===r.rowHeaders?"":r.rowHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),l={currentTarget:n,currentCell:r,rawData:a,rowHeaders:o,columnHeaders:""===r.columnHeaders?"":r.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),value:s+"("+r.formattedText+")",gridColumns:this.drillThroughDialog.frameGridColumns(a),cancel:!1};"CSV"===this.parent.dataSourceSettings.type&&(l=this.frameData(l));var d=this;this.parent.trigger(I,l,(function(e){l.cancel||d.drillThroughDialog.showDrillThroughDialog(e)}))},e.prototype.destroy=function(){this.unWireEvents(),this.drillThroughDialog&&(this.drillThroughDialog.destroy(),this.drillThroughDialog=null)},e}(),Ks=S(60),Xs=function(){function e(){this.headerColl={},this.maxLevel=0,this.columnGroupObject={},this.selectedLegend=0,this.chartSeriesInfo={},this.measurePos=-1,this.measuresNames={},this.accumulationType=["Pie","Pyramid","Doughnut","Funnel"],this.isChartInitial=!0}return e.prototype.getModuleName=function(){return"pivotChart"},e.prototype.loadChart=function(e,a){if(this.parent=e,this.measuresNames={},this.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=a,!("olap"===e.dataType?""!==e.dataSourceSettings.url&&!e.olapEngineModule.isEmptyData&&e.olapEngineModule.tupColumnInfo.length>0&&e.olapEngineModule.tupRowInfo.length>0&&(!(0,t.isNullOrUndefined)(e.olapEngineModule.colMeasurePos)||!(0,t.isNullOrUndefined)(e.olapEngineModule.rowMeasurePos)):"Server"===this.parent.dataSourceSettings.mode?!(0,t.isNullOrUndefined)(e.dataSourceSettings.url)&&""!==e.dataSourceSettings.url&&e.dataSourceSettings.values.length>0&&!e.engineModule.isEmptyData:e.dataSourceSettings.values.length>0&&e.dataSourceSettings.dataSource&&(e.dataSourceSettings.dataSource.length>0||e.dataSourceSettings.dataSource instanceof i.DataManager)&&!e.engineModule.isEmptyData)){if(this.parent.chart)return this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=[],this.parent.chart.rows=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor):this.parent.element.querySelector(".e-accumulationchart")&&(this.parent.chart.series[0].dataSource=[{}],this.parent.chart.series[0].dataLabel={}),void this.parent.chart.refresh();if(!(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)){"Both"===this.parent.displayOption.view&&"Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore((0,t.createElement)("div",{className:qn,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector("."+en)):this.parent.element.appendChild((0,t.createElement)("div",{className:qn,id:this.parent.element.id+"_chart"}));var n=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(n=this.parent.getGridWidthAsNumber().toString());var s=this.getChartHeight();(this.chartSettings&&this.chartSettings.chartSeries&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)>-1?new Ks.AccumulationChart({width:n,height:s}):new Ks.Chart({width:n,height:s})).appendTo((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)),this.parent.showToolbar&&("Both"===this.parent.displayOption.view&&"Chart"===this.parent.currentView&&(this.parent.grid.element.style.display="none"),"Chart"!==this.parent.currentView&&((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).style.display="none"))}return this.parent.enableVirtualization&&this.isChartInitial&&(this.isChartInitial=!1,this.parent.onContentReady()),void this.parent.notify(Ye,{})}this.parent.chart||!this.parent.element.querySelector(".e-chart")&&!this.parent.element.querySelector(".e-accumulationchart")||(0,t.remove)((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)),this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?this.measureList=this.dataSourceSettings.values.map((function(e){return e.name})):this.measureList=[""===a.value?this.dataSourceSettings.values[0].name:a.value];for(var o=0,l=this.dataSourceSettings.values;o<l.length;o++){var d=(E=l[o]).name.replace(/[^A-Z0-9]+/gi,"_");this.measuresNames[E.name]=d,this.measuresNames[d]=E.name,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type||(this.measuresNames[E.caption?E.caption:E.name]=E.name)}this.columnGroupObject={},this.accEmptyPoint=!1;var p=this.engineModule.pivotValues;this.currentMeasure=a.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?this.measureList[0]:(""===a.value||0===this.dataSourceSettings.values.filter((function(e){return e.name===a.value})).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:a.value;var h,u,c,g=this.getColumnTotalIndex(p),m=Object.keys(p),f={},S=0,v=-.5;this.headerColl={},this.maxLevel=0;var y,b={},C="",x="",w="";this.chartSeriesInfo={},this.selectedLegend=0;for(var T=!1,M={},D=!1,O=this.parent.dataSourceSettings.valueSortSettings.headerDelimiter,P=0,N=this.dataSourceSettings.values;P<N.length;P++){var E;M[d=(E=N[P]).name]=E.caption?E.caption:d,M[E.caption?E.caption:d]=d}if("olap"===this.parent.dataType){var I=[];b=this.groupHierarchyWithLevels(p,I),C=I[I.length-1],w=x=this.measurePos===I.length-1&&I.length>1?I[I.length-2]:C}for(var F=0,L=m;F<L.length;F++){var A=L[F],R=Number(A);if(!(0,t.isNullOrUndefined)(p[R])){var k=p[R][0],j=k&&k.valueSort&&!(0,t.isNullOrUndefined)(k.valueSort.levelName)?k.valueSort.levelName.toString().split(O):void 0;if(D=!1,j&&"Grand Total"!==j[0]&&((a.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type||j.indexOf(M[this.currentMeasure])>-1)&&(D=!0),!D)){for(var q=0,H=j;q<H.length;q++){if(M[Y=H[q]]){D=!0;break}}D=!D}if(k&&"row"===k.axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==k.type&&D)){var V=p[R][0];if(V.isSum)continue;var U="olap"===this.parent.dataType?this.engineModule.tupRowInfo[V.ordinal]:void 0,B=-1,_=V.level;"olap"===this.parent.dataType?(T="[Measures]"===V.hierarchy?T:this.isAttributeDrill(V.hierarchy,U.drillInfo),w=w===x||"[Measures]"===V.hierarchy||V.isNamedSet||this.engineModule.fieldList[V.hierarchy]&&!this.engineModule.fieldList[V.hierarchy].hasAllMember?x:w,B=U.drillInfo.length-1,3===V.memberType||U.measureName&&U.measureName!==this.dataSourceSettings.values[0].name||(f=0===(S=(u=void 0===u?V.levelUniqueName:u)===V.levelUniqueName?0:S)?{}:f,S=c&&u!==V.levelUniqueName?c.hierarchy===V.hierarchy?S+(V.level-c.level):(0,t.isNullOrUndefined)(f[V.levelUniqueName])?b[V.hierarchy].start:f[V.levelUniqueName]:S,f[V.levelUniqueName]=S,_=S,v+=!c||w!==c.hierarchy||c.isDrilled&&c.hasChild?0:1,w=T?V.hierarchy:x,h=S,c=V)):"value"!==V.type&&(void 0===h||h<_||v++,h=_),this.maxLevel=_>this.maxLevel?_:this.maxLevel;var G="olap"===this.parent.dataType?V.formattedText:V.actualText?V.actualText.toString():V.formattedText.toString(),z=this.engineModule.fieldList[this.currentMeasure],W=0===this.parent.dataSourceSettings.rows.length?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(z.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(z.caption)?z.name:z.caption):V.formattedText?V.formattedText.toString():G,Q=V.hasChild&&!V.isNamedSet?(V.isDrilled?" - ":" + ")+W:W,Y=U?U.uNameCollection:V.valueSort.levelName.toString(),K={name:G,text:Q,hasChild:V.hasChild,isDrilled:V.isDrilled,levelName:Y,level:_,fieldName:V.valueSort.axis?V.valueSort.axis.toString():"",rowIndex:R,colIndex:0,cell:V};("olap"===this.parent.dataType?3!==V.memberType:"value"!==V.type)&&(this.headerColl[v]||(this.headerColl[v]={}),this.headerColl[v][_]=K);var X=p[R],J=Object.keys(X),Z=void 0;if("olap"===this.parent.dataType)y=3!==V.memberType?V:y;else if(y="value"!==V.type?V:y,"value"!==V.type)y=V;else{var $=V&&V.valueSort&&V.valueSort.levelName&&V.valueSort.levelName.toString().split(O),ee=void 0;if($&&$.length>0&&($.splice($.length-1,1),ee=$.join(O)),this.parent.dataSourceSettings.valueIndex<=0||this.engineModule.valueAxis&&this.dataSourceSettings.rows.length===this.engineModule.measureIndex||(0,t.isNullOrUndefined)(y.valueSort)||ee===y.valueSort.levelName);else for(var te=R;te>-1;)p[te]&&p[te][0]&&p[te][0].valueSort&&p[te][0].valueSort.levelName===ee&&(y=p[te][0],te=0),te--}for(var ie=0,ae=J;ie<ae.length;ie++){var re=ae[ie],ne=Number(re),se=p[R][ne],oe=!(0,t.isNullOrUndefined)(se.rowHeaders)||0===this.dataSourceSettings.rows.length,le="olap"===this.parent.dataType&&U&&U.measureName?U.measureName:se.actualText;if(("olap"!==this.parent.dataType||!se.isGrandSum)&&!g[se.colIndex]&&"value"===se.axis&&"header"!==V.type&&""!==le&&(a.enableMultipleAxis&&this.accumulationType.indexOf(a.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type||le===this.currentMeasure)){if((0,t.isNullOrUndefined)(V.members)&&(V.members=[]),"olap"===this.parent.dataType?C!==V.hierarchy&&!T||(3===V.memberType&&Z?B!==this.measurePos||Z.isDrilled&&Z.hasChild:V.isDrilled&&V.hasChild):("value"===V.type&&Z?!(0,t.isNullOrUndefined)(Z.members)&&Z.hasChild&&Z.isDrilled:V.hasChild&&V.isDrilled)||!oe)break;if("olap"===this.parent.dataType&&!0===se.isSum&&"row"===this.parent.dataSourceSettings.valueAxis)continue;var de="";if("olap"===this.parent.dataType)de=se.columnHeaders.toString().split(/~~|::/).join(" - ");else{var pe=se.columnHeaders.toString().split(O);de=r.formatChartHeaders(pe,this,!0)}var he="";if("olap"===this.parent.dataType)he=se.rowHeaders.toString().split(/~~|::/).join(" - ");else{var ue=se.rowHeaders.toString().split(O);he=r.formatChartHeaders(ue,this,!1)}var ce=de+" | "+le;this.chartSeriesInfo[de]={uniqueName:de,caption:se.hierarchyName&&se.hierarchyName.toString().split(O).join(" - "),colorIndex:[]},this.chartSeriesInfo[this.chartSeriesInfo[de].caption]=this.chartSeriesInfo[de];var ge="pivot"===this.parent.dataType&&this.engineModule.aggregatedValueMatrix[R]&&!(0,t.isNullOrUndefined)(this.engineModule.aggregatedValueMatrix[R][ne])?Number(this.engineModule.aggregatedValueMatrix[R][ne]):(0,t.isNullOrUndefined)(se.value)?se.value:Number(se.value);0===(ge=ge===1/0?null:ge)&&(this.accEmptyPoint=!0),this.columnGroupObject[ce]?this.columnGroupObject[ce].push({x:0===this.dataSourceSettings.rows.length?V.formattedText:he,y:ge,rIndex:R,cIndex:ne}):this.columnGroupObject[ce]=[{x:0===this.dataSourceSettings.rows.length?V.formattedText:he,y:ge,rIndex:R,cIndex:ne}]}Z=y}}}}this.refreshChart()},e.prototype.refreshChart=function(){this.chartSeries=[];var e=0,i={},a=Object.keys(this.columnGroupObject);this.persistSettings=JSON.parse(this.parent.getChartSettings()).chartSettings;for(var r=this.persistSettings.palettes&&this.persistSettings.palettes.length>0?this.persistSettings.palettes:(0,Ks.getSeriesColor)(this.chartSettings.theme),n=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",s=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(n).join(" - "):"",o=this.chartSettings.chartSeries?this.chartSettings.chartSeries.type:void 0,l={},d=0;d<this.parent.dataSourceSettings.values.length;d++)l[this.parent.dataSourceSettings.values[d].name]=(0,t.isNullOrUndefined)(this.parent.dataSourceSettings.values[d].caption)?void 0:this.parent.dataSourceSettings.values[d].caption;if(this.accumulationType.indexOf(o)>-1&&a.length>0){this.currentColumn=a.indexOf(s+" | "+this.currentMeasure)>-1&&void 0!==s?s+" | "+this.currentMeasure:a[0];var p={};p=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):p,((0,t.isNullOrUndefined)(p.palettes)||0===p.palettes.length)&&!(0,t.isNullOrUndefined)(this.persistSettings.palettes)&&this.persistSettings.palettes.length>0&&(p.palettes=this.persistSettings.palettes),p.dataSource=this.columnGroupObject[this.currentColumn],p.xName="x",p.yName="y",this.persistSettings.chartSeries&&this.persistSettings.chartSeries.dataLabel?(p.dataLabel=this.persistSettings.chartSeries.dataLabel,p.dataLabel.name="x"):(p.dataLabel={visible:!0,position:"Outside",name:"x"},this.parent.setProperties({chartSettings:{chartSeries:{dataLabel:{visible:!0,position:"Outside"}}}},!0)),this.accEmptyPoint&&p.emptyPointSettings?p.emptyPointSettings.mode="Zero":this.accEmptyPoint&&(p.emptyPointSettings={mode:"Zero"}),p.name=this.currentColumn,"Doughnut"===o?(p.type="Pie",p.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"40%"):"Pie"===o&&(p.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"0"),this.chartSeries=this.chartSeries.concat(p)}else for(var h=0,u=a;h<u.length;h++){var c=u[h];p={};p=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):p,!(0,t.isNullOrUndefined)(p.palettes)&&p.palettes.length>0&&((0,t.isNullOrUndefined)(this.persistSettings.palettes)||0===this.persistSettings.palettes.length)&&(this.chartSettings.palettes=p.palettes);for(d=0;d<this.columnGroupObject[c].length;d++){var g=this.engineModule.fieldList[this.currentMeasure];this.columnGroupObject[c][d].x=0!==this.parent.dataSourceSettings.rows.length||this.chartSettings.showMultiLevelLabels?""===this.columnGroupObject[c][d].x?this.parent.localeObj.getConstant("blank"):this.columnGroupObject[c][d].x:this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(g.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(g.caption)?g.name:g.caption)}p.dataSource=this.columnGroupObject[c],p.xName="x",p.yName="y",p.visible=!0;for(var m=void 0,f=void 0,S=void 0,v=(d=0,c.split(" | "));d<v.length;d++)this.measuresNames&&this.measuresNames[v[d]]&&(f=v[d],S=c.split(" | "+f)[0]);if(this.chartSettings.enableMultipleAxis){var y=f;m=S+" | "+(y=(0,t.isNullOrUndefined)(l[y])?y:l[y])}if(p.name=this.chartSettings.enableMultipleAxis?m:S,this.chartSettings.showPointColorByMembers&&this.chartSettings.enableMultipleAxis){p.name=S;var b=this.chartSeriesInfo[p.name].caption;p.name=null!=b?b:p.name,i[p.name]?(p.fill=i[p.name].color,this.chartSeriesInfo[p.name].colorIndex.push(this.selectedLegend++),p.name=void 0):(e=r[e]?e:0,i[p.name]={name:p.name,color:r[e]},p.fill=r[e++],this.chartSeriesInfo[p.name].colorIndex.push(this.selectedLegend++))}if(["Radar","Polar"].indexOf(o)<0){var C=f;p.tooltipMappingName=this.measuresNames[C],p.yAxisName=this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.measureList.join("_"):this.measuresNames[C]?this.measuresNames[C]:C}this.persistSettings.chartSeries&&this.persistSettings.chartSeries.emptyPointSettings&&(p.emptyPointSettings=this.persistSettings.chartSeries.emptyPointSettings),p.emptyPointSettings||(p.emptyPointSettings={mode:"Zero"}),this.chartSeries=this.chartSeries.concat(p)}var x={series:this.chartSeries,cancel:!1},w=this;this.parent.trigger(Ce,x,(function(e){e.cancel?(w.element&&(0,t.remove)(w.element),w.parent.notify(Ye,{})):w.bindChart()}))},e.prototype.frameObjectWithKeys=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)a[t[i]]=e[t[i]],i++;return a},e.prototype.frameChartSeries=function(e){for(var t=Object.keys(e),i=0,a={};i<t.length;)this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)>-1&&["fill","dashArray","width","segmentAxis","drawType","isClosed","segments","stackingGroup","marker","errorBar","trendlines","minRadius","splineType","maxRadius","cardinalSplineTension","columnWidth","columnSpacing","cornerRadius"].indexOf(t[i])>-1||this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)<0&&["endAngle","explode","explodeAll","explodeIndex","explodeOffset","gapRatio","groupMode","groupTo","neckHeight","neckWidth","pyramidMode","startAngle","dataLabel","innerRadius"].indexOf(t[i])>-1||(a[t[i]]=e[t[i]]),i++;return a},e.prototype.bindChart=function(){this.parent.showWaitingPopup();var e=this.configXAxis(),i=this.configTooltipSettings(),a=this.configLegendSettings(),r=this.configZoomSettings(),n=this.frameAxesWithRows(),s=this.chartSettings.chartSeries.type;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:(0,t.createElement)("div",{className:qn,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector("."+en)):this.parent.element.appendChild(this.element?this.element:(0,t.createElement)("div",{className:qn,id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild((0,t.createElement)("div",{className:qn,id:this.parent.element.id+"_chart"}))),!this.chartElement&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&"Pareto"!==this.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+qn).innerHTML="",this.chartElement=this.parent.element.querySelector("."+qn).appendChild((0,t.createElement)("div",{className:Kn,id:this.parent.element.id+"_chartInner"}))),this.parent.element.querySelector("."+Kn)&&(this.parent.element.querySelector("."+Kn).innerHTML=""),this.parent.showGroupingBar?this.element.style.minWidth="400px !important":this.element.style.minWidth="310px !important";var l=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(l=this.parent.getGridWidthAsNumber().toString());var d=this.getChartHeight();this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(s)<0&&"Pareto"!==this.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+qn).style.height=("auto"===d?this.getChartAutoHeight():d)+"px",this.parent.element.querySelector("."+qn).style.width=l+"px","Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+qn).style.overflow="auto",this.parent.element.querySelector("."+qn).style.overflowX="hidden")),this.parent.chart&&("accumulationchart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(s)<0||"chart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(s)>-1&&"Pareto"!==this.chartSettings.chartSeries.type)&&(this.parent.chart.destroy(),(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)&&((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).appendChild((0,t.createElement)("div",{className:Kn,id:this.parent.element.id+"_chartInner"})))),!(this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")||this.parent.element.querySelector(".e-accumulationchart"))||this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange?(this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange&&this.parent.chart&&(this.parent.chart.isDestroyed||this.parent.chart.destroy(),this.parent.chart=void 0,(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element).appendChild((0,t.createElement)("div",{className:Kn,id:this.parent.element.id+"_chartInner"})),this.parent.toolbarModule.isMultiAxisChange=!1),Ks.Chart.Inject(Ks.ColumnSeries,Ks.StackingColumnSeries,Ks.RangeColumnSeries,Ks.BarSeries,Ks.StackingBarSeries,Ks.ScatterSeries,Ks.BubbleSeries,Ks.LineSeries,Ks.StepLineSeries,Ks.SplineSeries,Ks.SplineAreaSeries,Ks.MultiColoredLineSeries,Ks.PolarSeries,Ks.RadarSeries,Ks.AreaSeries,Ks.RangeAreaSeries,Ks.StackingAreaSeries,Ks.StepAreaSeries,Ks.StackingLineSeries,Ks.MultiColoredAreaSeries,Ks.ParetoSeries,Ks.Legend,Ks.Tooltip,Ks.Category,Ks.MultiLevelLabel,Ks.ScrollBar,Ks.Zoom,Ks.Export,Ks.Crosshair,Ks.Selection,Ks.StripLine,Ks.DataLabel),Ks.AccumulationChart.Inject(Ks.PieSeries,Ks.FunnelSeries,Ks.PyramidSeries,Ks.AccumulationDataLabel,Ks.AccumulationLegend,Ks.AccumulationTooltip,Ks.Export),this.accumulationType.indexOf(s)>-1?this.parent.chart=new Ks.AccumulationChart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:a,tooltip:i,width:l,height:d.toString(),title:this.chartSettings.title,enableSmartLabels:this.chartSettings.enableSmartLabels,center:this.chartSettings.pieCenter,enableBorderOnMouseMove:this.chartSettings.enableBorderOnMouseMove,highlightMode:this.chartSettings.highlightMode,highlightPattern:this.chartSettings.highlightPattern,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,theme:this.chartSettings.theme,selectionMode:this.chartSettings.accumulationSelectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,locale:this.parent.locale,enableRtl:this.parent.enableRtl,beforePrint:this.beforePrint.bind(this),animationComplete:this.animationComplete.bind(this),legendRender:this.legendRender.bind(this),textRender:this.textRender.bind(this),pointRender:this.pointRender.bind(this),seriesRender:this.seriesRender.bind(this),chartMouseMove:this.chartMouseMove.bind(this),chartMouseClick:this.chartMouseClick.bind(this),pointMove:this.pointMove.bind(this),pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartMouseLeave.bind(this),chartMouseDown:this.chartMouseDown.bind(this),chartMouseUp:this.chartMouseUp.bind(this),tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this)}):this.parent.chart=new Ks.Chart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:a,tooltip:i,zoomSettings:r,axes:"Polar"===s||"Radar"===s?[]:n.axes,rows:"Polar"===s||"Radar"===s?[{}]:"Bar"===s||"StackingBar"===s||"StackingBar100"===s||"Pareto"===s&&this.chartSettings.enableMultipleAxis?[{height:"100%"}]:n.rows,columns:"Polar"===s||"Radar"===s?[{}]:"Bar"===s||"StackingBar"===s||"StackingBar100"===s&&this.chartSettings.enableMultipleAxis?n.columns:[{width:"100%"}],primaryYAxis:"Polar"===s||"Radar"===s?n.axes[0]:{visible:!1},primaryXAxis:e,width:l,height:"Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&"Pareto"!==this.parent.chartSettings.chartSeries.type&&this.parent.dataSourceSettings.values.length>0?Number(d)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(d))?d.toString():(Number(d)-5).toString():!isNaN(Number(d))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():d.toString():d.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:(0,t.isNullOrUndefined)(this.persistSettings.chartArea)?this.chartSettings.chartArea:this.persistSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,enableCanvas:this.chartSettings.enableCanvas,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.beforePrint.bind(this),animationComplete:this.animationComplete.bind(this),legendRender:this.legendRender.bind(this),textRender:this.textRender.bind(this),pointRender:this.pointRender.bind(this),seriesRender:this.seriesRender.bind(this),chartMouseMove:this.chartMouseMove.bind(this),chartMouseClick:this.chartMouseClick.bind(this),pointMove:this.pointMove.bind(this),pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartMouseLeave.bind(this),chartMouseDown:this.chartMouseDown.bind(this),chartMouseUp:this.chartMouseUp.bind(this),dragComplete:this.dragComplete.bind(this),zoomComplete:this.zoomComplete.bind(this),scrollStart:this.scrollStart.bind(this),scrollEnd:this.scrollEnd.bind(this),scrollChanged:this.scrollChanged.bind(this),tooltipRender:this.tooltipRender.bind(this),legendClick:this.legendClick.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this),axisMultiLabelRender:this.multiLevelLabelRender.bind(this)}),this.parent.chart.isStringTemplate=!0):(this.parent.chart.series=this.chartSeries,this.parent.chart.title=this.parent.chartSettings.title,this.parent.chart.subTitle=this.parent.chartSettings.subTitle,this.parent.chart.background=this.parent.chartSettings.background,this.parent.chart.theme=this.parent.chartSettings.theme,this.parent.chart.legendSettings=a,this.parent.chart.selectionMode=this.parent.chartSettings.selectionMode,this.parent.chart.enableExport=this.parent.chartSettings.enableExport,this.parent.chart.isMultiSelect=this.parent.chartSettings.isMultiSelect,this.parent.chart.enableAnimation=this.parent.chartSettings.enableAnimation,this.parent.chart.useGroupingSeparator=this.parent.chartSettings.useGroupingSeparator,this.parent.chart.highlightPattern=this.parent.chartSettings.highlightPattern,this.accumulationType.indexOf(s)>-1?(this.parent.chart.enableBorderOnMouseMove=this.parent.chartSettings.enableBorderOnMouseMove,this.parent.chart.highlightMode=this.parent.chartSettings.highlightMode,this.parent.chart.enableSmartLabels=this.parent.chartSettings.enableSmartLabels):(this.parent.chart.palettes=this.parent.chartSettings.palettes,this.parent.chart.isTransposed=this.parent.chartSettings.isTransposed,this.parent.chart.enableSideBySidePlacement=this.parent.chartSettings.enableSideBySidePlacement,this.parent.chart.tabIndex=this.parent.chartSettings.tabIndex,this.parent.chart.description=this.parent.chartSettings.description,this.parent.chart.enableCanvas=this.parent.chartSettings.enableCanvas),"Polar"===s||"Radar"===s?(this.parent.chart.primaryXAxis=e,this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=n.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):this.accumulationType.indexOf(s)<0&&"chart"===this.parent.chart.getModuleName()&&(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.primaryXAxis=e,this.parent.chart.axes=n.axes,"Bar"===s||"StackingBar"===s||"StackingBar100"===s&&this.chartSettings.enableMultipleAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=n.columns):"Pareto"===s&&this.chartSettings.enableMultipleAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=[{width:"100%"}]):(this.parent.chart.rows=n.rows,this.parent.chart.columns=[{width:"100%"}])),this.parent.chart.refresh(),this.accumulationType.indexOf(s)>-1&&"accumulationchart"===this.parent.chart.getModuleName()&&(0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length)&&(this.parent.hideWaitingPopup(),this.parent.pivotFieldListModule&&(0,o.hideSpinner)(this.parent.pivotFieldListModule.fieldListSpinnerElement))),this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis?this.parent.chart.appendTo((0,t.select)("#"+this.parent.element.id+"_chartInner",this.parent.element)):this.parent.chart.appendTo((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element))},e.prototype.legendClick=function(e){if(this.chartSettings.showPointColorByMembers&&this.chartSettings.enableMultipleAxis)for(var t=this.chartSeriesInfo[e.legendText].colorIndex,i=1;i<t.length;i++)e.chart.series[t[i]].visible=!e.chart.series[t[i]].visible;this.parent.trigger(Z,e)},e.prototype.pointClick=function(e){var t=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.seriesIndex].dataSource;if((["Pie","Funnel","Doughnut","Pyramid","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)>-1||!this.parent.chartSettings.showMultiLevelLabels)&&("olap"===this.parent.dataType||this.parent.dataSourceSettings.rows.length>1)){this.pivotIndex={rIndex:t?t[e.pointIndex].rIndex:void 0,cIndex:t?t[e.pointIndex].cIndex:void 0},this.creatMenu();var i=this.parent.element.getBoundingClientRect(),a=(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:0)+(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:0)+(window.scrollY||document.documentElement.scrollTop)+i.top;this.accumulationMenu.open(a+e.y,e.x+i.left+(window.scrollX||document.documentElement.scrollLeft))}else if((this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule){var r=t[e.pointIndex].rIndex,n=t[e.pointIndex].cIndex;this.parent.drillThroughModule.executeDrillThrough(this.parent.pivotValues[r][n],r,n)}this.parent.trigger(je,e)},e.prototype.frameAxesWithRows=function(){var e=[],i=[],a=[],n=[],s=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type||"StackingLine100"===this.persistSettings.chartSeries.type),o=["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"];if(this.chartSettings.enableMultipleAxis)for(var l=0,d=100/this.dataSourceSettings.values.length+"%",p=0,h=this.dataSourceSettings.values;p<h.length;p++){var u=h[p],c=this.engineModule.fieldList[u.name],g=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(c.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+c.caption;n.push(g);for(var m=void 0,f=0,S=this.dataSourceSettings.formatSettings;f<S.length;f++){var v=S[f];if(v.name===u.name){m=v;break}}var y=-1!==r.inArray(c.aggregateType,o)?"P2":m?null===m.format.toLowerCase().match(/n|p|c/)?"N":m.format:"olap"===this.parent.dataType?this.getFormat(c.formatString):"N",b="Polar"===this.chartSettings.chartSeries.type||"Radar"===this.chartSettings.chartSeries.type,C={};(C=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):C).labelFormat=C.labelFormat?C.labelFormat:s?"":b?"N":y,C.title="Combined"===this.chartSettings.multipleAxisMode?n.join(" - "):C.title?C.title:g,C.zoomFactor=(0,t.isNullOrUndefined)(this.chartSettings.primaryYAxis.zoomFactor)?1:this.chartSettings.primaryYAxis.zoomFactor,C.edgeLabelPlacement=this.chartSettings.primaryYAxis.edgeLabelPlacement?this.chartSettings.primaryYAxis.edgeLabelPlacement:this.persistSettings.primaryYAxis.edgeLabelPlacement,"Bar"===this.chartSettings.chartSeries.type||"StackingBar"===this.chartSettings.chartSeries.type||"StackingBar100"===this.chartSettings.chartSeries.type?C.plotOffsetRight=C.plotOffsetRight?C.plotOffsetRight:30:C.plotOffsetTop=C.plotOffsetTop?C.plotOffsetTop:30,b||(C.name="Combined"===this.chartSettings.multipleAxisMode?this.measureList.join("_"):this.measuresNames[u.name]?this.measuresNames[u.name]:u.name),e=e.concat(C),"Combined"===this.chartSettings.multipleAxisMode&&(e=[e[e.length-1]]),"Stacked"===this.chartSettings.multipleAxisMode?(C.rowIndex=l,C.columnIndex=l,i.push({height:d}),a.push({width:d})):(C.rowIndex=0,C.columnIndex=0,i=[{height:"100%"}],a=[{width:"100%"}]),l++}else{c=this.engineModule.fieldList[this.currentMeasure],g=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(c.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+c.caption,m=void 0;for(var x=0,w=this.dataSourceSettings.formatSettings;x<w.length;x++){if((u=w[x]).name===this.currentMeasure){m=u;break}}var T=void 0;m&&(T=m.format.length);C={},y=-1!==r.inArray(c.aggregateType,o)?"P2":m?null===m.format.toLowerCase().match(/n[0-10]|p[0-10]|c[0-10]/)||T>3?"N":m.format:"olap"===this.parent.dataType?this.getFormat(c.formatString):"N";(C=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):C).zoomFactor=(0,t.isNullOrUndefined)(this.chartSettings.primaryYAxis.zoomFactor)?1:this.chartSettings.primaryYAxis.zoomFactor,C.rowIndex=0,C.columnIndex=0,C.edgeLabelPlacement=this.chartSettings.primaryYAxis.edgeLabelPlacement?this.chartSettings.primaryYAxis.edgeLabelPlacement:this.persistSettings.primaryYAxis.edgeLabelPlacement,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(C.name=this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure),C.labelFormat=C.labelFormat?C.labelFormat:s?"":y,C.title=C.title?C.title:g,e=e.concat(C),i.push({height:"100%"}),a.push({width:"100%"})}return{axes:e,rows:i,columns:a}},e.prototype.getFormat=function(e){return e="Currency"===e?"C":"Percent"===e?"P":"N"},e.prototype.getColumnTotalIndex=function(e){for(var i={},a=0,r=Object.keys(e);a<r.length;a++){var n=r[a],s=e[Number(n)];if(!(0,t.isNullOrUndefined)(s))for(var o=0,l=Object.keys(s);o<l.length;o++){var d=l[o],p=s[Number(d)];if(!(0,t.isNullOrUndefined)(p)){if("column"!==p.axis)return i;("sum"===p.type||0!==this.dataSourceSettings.columns.length&&"grand sum"===p.type)&&-1!==p.rowSpan&&(i[p.colIndex]=p.colIndex)}}}return i},e.prototype.groupHierarchyWithLevels=function(e,i){var a,r,n={},s=0,o={};this.measurePos=this.engineModule.tupRowInfo[0].measurePosition;for(var l=0;l<e.length;l++){var d=e[l][0];d&&"row"===d.axis&&"grand sum"!==d.type&&((0,t.isNullOrUndefined)(n[d.hierarchy])?(3===d.memberType?s===this.measurePos?(i[this.measurePos]=d.hierarchy,n[d.hierarchy]=((a={})[d.levelUniqueName]=d.levelUniqueName,a)):s--:(i[s]=d.hierarchy,n[d.hierarchy]=((r={})[d.levelUniqueName]=d.levelUniqueName,r)),s++):n[d.hierarchy][d.levelUniqueName]=d.levelUniqueName)}for(var p=-1,h=0;h<i.length;h++)this.measurePos!==h&&(o[i[h]]={start:p+1,end:p+Object.keys(n[i[h]]).length},p=o[i[h]].end);return o},e.prototype.frameMultiLevelLabels=function(){for(var e=Object.keys(this.headerColl),t=this.headerColl[-.5],i=0,a=e;i<a.length;i++){for(var r=a[i],n=Number(r),s=this.headerColl[n],o=0,l=!1;o<=this.maxLevel;)l?s[o]||(s[o]={name:s[o-1].name,text:"",hasChild:s[o-1].hasChild,isDrilled:s[o-1].isDrilled,levelName:s[o-1].levelName,level:s[o-1].level,fieldName:s[o-1].fieldName,rowIndex:s[o-1].rowIndex,colIndex:s[o-1].colIndex,span:-1}):s[o]?l=!0:s[o]=t[o],o++;t=this.headerColl[n]}for(var d={},p=0,h=e;p<h.length;p++){r=h[p],n=Number(r),s=this.headerColl[n];for(var u=0,c=Object.keys(s);u<c.length;u++){var g=c[u],m=Number(g);if(d[m]){var f=d[m].length;s[m].levelName===t[m].levelName?d[m][f-1].end=d[m][f-1].end+1:d[m].push({start:n,end:n+1,text:s[m].text,type:-1===s[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:s[m]})}else d[m]=[{start:n,end:n+1,text:s[m].text,type:-1===s[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:s[m]}]}t=s}for(var S=[],v=Object.keys(d).length-1;v>-1;v--)S.push({categories:d[v],border:{width:1},overflow:"Trim"});return S},e.prototype.getZoomFactor=function(){this.calculatedWidth=this.getCalulatedWidth();var e=10*this.chartSeries.length>120?10*this.chartSeries.length:120,t=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*e):1;return t=t<1&&t>0?t:1},e.prototype.getCalulatedWidth=function(){return isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.calculatedWidth=this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?this.calculatedWidth=Number(this.parent.width.toString().split("px")[0]):this.calculatedWidth=this.parent.element.clientWidth:this.calculatedWidth=Number(this.parent.width),this.calculatedWidth},e.prototype.configTooltipSettings=function(){var e=this.persistSettings.tooltip?this.persistSettings.tooltip:this.chartSettings.tooltip;return e.enable=void 0===e.enable||e.enable,e.enable&&e.template&&(this.templateFn=this.parent.templateParser(e.template)),this.parent.tooltipTemplate&&(e.template=e.template?e.template:this.parent.tooltipTemplate),e.header=e.header?e.header:"",e.enableMarker=void 0===e.enableMarker||e.enableMarker,e},e.prototype.configLegendSettings=function(){var e={};if(this.chartSettings.legendSettings)for(var t=0,i=Object.keys(this.chartSettings.legendSettings);t<i.length;)e[i[t]]=this.chartSettings.legendSettings[i[t]],t++;return e.visible=!1!==e.visible,e.padding=e.padding?e.padding:25,e.shapePadding=e.shapePadding?e.shapePadding:10,e},e.prototype.configXAxis=function(){var e={};return(e=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):e).valueType="Category",e.labelIntersectAction=e.labelIntersectAction?e.labelIntersectAction:"Rotate45",e.title=e.title?e.title:this.dataSourceSettings.rows.map((function(e){return e.caption||e.name})).join(" / "),e.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(e.zoomFactor=1),this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type?(e.multiLevelLabels=this.frameMultiLevelLabels(),e.border={width:1,type:"WithoutTopandBottomBorder"},e.majorTickLines={width:0,height:-10}):(e.multiLevelLabels=[],e.border={width:1,type:"Rectangle"},e.majorTickLines={width:0,height:5}),e},e.prototype.configZoomSettings=function(){var e=this.chartSettings.zoomSettings;return e.enableSelectionZooming=void 0===e.enableSelectionZooming||e.enableSelectionZooming,e.enableScrollbar=void 0===e.enableScrollbar||e.enableScrollbar,e},e.prototype.tooltipRender=function(e){var i=this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&"Radar"!==this.chartSettings.chartSeries.type&&"Polar"!==this.chartSettings.chartSeries.type?e.series.tooltipMappingName:e.series.yAxisName?e.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?e.series.name?e.series.name.split(" | ")[1]:e.data.seriesName?e.data.seriesName.split(" | ")[1]:this.currentMeasure:this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure,a=e.series.dataSource?e.series.dataSource:this.parent.chart.series[e.data.seriesIndex].dataSource,n=a?a[e.data.pointIndex].rIndex:void 0,s=a?a[e.data.pointIndex].cIndex:void 0,o=this.engineModule.fieldList[this.measuresNames[i]?this.measuresNames[i]:i],l="olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(o.aggregateType),d=("olap"===this.parent.dataType?"":l+" "+this.parent.localeObj.getConstant("of")+" ")+o.caption,p=this.engineModule.pivotValues[n][s].formattedText,h=this.engineModule.formatFields[o.id],u=this.engineModule.getFormattedValue(e.point.y,o.id,p),c=h&&h.format&&null!==h.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?u.toString():u.formattedText:p,g=this.parent.pivotValues[n][s].columnHeaders,m="";if((0,t.isNullOrUndefined)(g))m=void 0;else if("olap"===this.parent.dataType)m=this.chartSeriesInfo[g.toString().split(/~~|::/).join(" - ")].uniqueName;else{var f=g.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter);g=r.formatChartHeaders(f,this,!0),m=this.chartSeriesInfo[g.toString()].uniqueName}var S=e.point.x;if(this.parent.tooltipTemplate&&void 0!==this.parent.getTooltipTemplate()||this.chartSettings.tooltip.template){var v=a?this.parent.getHeaderField(n,s,"row"):"",y=a?this.parent.getHeaderField(n,s,"Column"):"",b={rowHeaders:S,columnHeaders:m,aggregateType:l,value:c,valueField:o.caption,rowFields:v,columnFields:y},C=void 0;C=this.parent.chartSettings&&this.parent.chartSettings.tooltip&&this.parent.chartSettings.tooltip.enable&&this.parent.chartSettings.tooltip.template?this.tooltipTemplateFn()(b,this,"tooltipTemplate",this.element.id+"1tooltipTemplate")[0].outerHTML:this.parent.getTooltipTemplate()(b,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML,e.template=C}else e.text=d+": "+c+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+m)+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+S),this.parent.trigger(J,e)},e.prototype.tooltipTemplateFn=function(){return this.templateFn},e.prototype.loaded=function(e){this.parent.isChartLoaded=!0;var i=this.parent.grid?this.parent.getGridWidthAsNumber().toString():this.parent.getWidthAsNumber().toString();if(this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels){var a=r.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0";(0,t.isNullOrUndefined)((0,t.select)("#"+this.parent.element.id+a,this.parent.element))||this.parent.element.querySelector("#"+this.parent.element.id+a).setAttribute("cursor","pointer")}this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&(["Pie","Funnel","Pyramid","Doughnut","Radar","Polar","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)>=0?this.parent.element.querySelector("."+qn).style.overflow="visible":(this.parent.element.querySelector("."+qn).style.overflow="auto",this.parent.element.querySelector("."+qn).style.overflowX="hidden"),this.parent.element.querySelector("."+qn).style.width=i+"px"),this.updateView(),"Chart"!==this.parent.displayOption.primary&&"Chart"!==this.parent.displayOption.view||this.parent.notify(Ye,{}),this.parent.trigger($,e),("Server"===this.parent.dataSourceSettings.mode&&this.parent.isServerWaitingPopup||"Local"===this.parent.dataSourceSettings.mode)&&this.parent.hideWaitingPopup()},e.prototype.updateView=function(){if(this.parent.grid&&this.parent.chart&&this.parent.showToolbar)if("Table"===this.parent.currentView){if(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar")){var e=this.parent.element.querySelector(".e-pivot-grouping-bar");e.style.display="",e&&e.querySelector("."+ga)&&null!=this.parent.groupingBarModule.gridPanel&&!this.parent.groupingBarModule.gridPanel.isDestroyed&&this.parent.groupingBarModule.gridPanel.refreshOverflow(),this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"}this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none")}else{if(this.parent.grid.element.style.display="none",this.parent.chart.element.style.display="",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar")){this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none";var t=this.parent.element.querySelector(".e-chart-grouping-bar");t.style.display="",t&&t.querySelector("."+ga)&&null!=this.parent.groupingBarModule.chartPanel&&!this.parent.groupingBarModule.chartPanel.isDestroyed&&this.parent.groupingBarModule.chartPanel.refreshOverflow()}this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="")}},e.prototype.creatMenu=function(){this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&this.accumulationMenu.destroy();for(var e=(this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule?["expand","collapse","drillThrough","exit"]:["expand","collapse","exit"],i=[],a=0;a<e.length;a++)i.push({id:this.parent.element.id+"_DrillMenuChart_"+e[a],text:this.parent.localeObj.getConstant(e[a]),items:[]});var r=this.getMenuItems(),n=[],s=[];for(a=0;a<r.length;a++)"expand"===r[a].type?n.push({id:this.element.id+"drillExpand_"+r[a].key,text:r[a].value}):s.push({id:this.element.id+"drillCollapse_"+r[a].key,text:r[a].value});n.length>0&&(i[0].items=n),s.length>0&&(i[1].items=s);var o,l={cssClass:this.parent.element.id+"_accumulationChart"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:i,enableRtl:this.parent.enableRtl,beforeOpen:this.drillMenuOpen.bind(this),select:this.drillMenuSelect.bind(this),locale:this.parent.locale};this.accumulationMenu=new ds.ContextMenu(l),(0,t.select)("#"+this.parent.element.id+"_accumulationChart",this.parent.element)?(o=(0,t.select)("#"+this.parent.element.id+"_accumulationChart",this.parent.element)).innerHTML="":(o=(0,t.createElement)("ul",{id:this.parent.element.id+"_accumulationChart"}),this.parent.element.appendChild(o)),this.accumulationMenu.isStringTemplate=!0,this.accumulationMenu.appendTo(o)},e.prototype.drillMenuOpen=function(e){e.items[0]&&e.items[0].text===this.parent.localeObj.getConstant("expand")&&e.items[0].items&&0===e.items[0].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("expand")],!1),e.items[1]&&e.items[1].text===this.parent.localeObj.getConstant("collapse")&&e.items[1].items&&0===e.items[1].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("collapse")],!1)},e.prototype.getMenuItems=function(){for(var e=this.pivotIndex.rIndex,t=[],i=this.engineModule.pivotValues,a=[],r=i[e][this.pivotIndex.cIndex],n=!i[e][0].isNamedSet&&i[e][0].hasChild?i[e][0].level:void 0,s="olap"===this.parent.dataType?r.rowHeaders.toString().split(/~~|::/):r.rowHeaders.toString().split(this.engineModule.valueSortSettings.headerDelimiter);i[e][0];){if(r=i[e][0],0!==s.length&&s.indexOf(r.formattedText.toString())===s.length-1){r.hasChild&&!r.isNamedSet&&a.indexOf(r.level)<0&&(n?n>=r.level:0!==n||0===r.level)&&(r.isDrilled&&r.hasChild?t.push({key:e,type:"collapse",value:r.formattedText}):t.push({key:e,type:"expand",value:r.formattedText}),a.push(r.level),n=n?n-1:r.level-1);var o=s.indexOf(r.formattedText.toString());s.splice(o,1)}0===r.level&&r.hasChild&&!r.isNamedSet&&(n=void 0,a=[]),e--}return t},e.prototype.drillMenuSelect=function(e){var t="olap"===this.parent.dataType?this.parent.olapEngineModule.pivotValues:this.parent.engineModule.pivotValues,i=e.element.id.split("_DrillMenuChart_")[1];if(0===e.element.id.indexOf(this.element.id+"drill")){var a=e.element.id.split(this.element.id+"drill")[1].indexOf("Expand")>=0?"drillExpand":"drillCollapse",r=Number(e.element.id.split(this.element.id+a+"_")[1]),n=t[r][0],s="olap"===this.parent.dataType?n.formattedText:n.actualText?n.actualText.toString():n.formattedText.toString(),o=n.formattedText?n.formattedText.toString():s,l=n.hasChild&&!n.isNamedSet?(n.isDrilled?" - ":" + ")+o:o,d="olap"===this.parent.dataType?this.engineModule.tupRowInfo[n.ordinal]:void 0,p=d?d.uNameCollection:n.valueSort.levelName.toString(),h={fieldName:n.valueSort.axis,level:n.level,hasChild:n.hasChild,levelName:p,name:s,text:l,rowIndex:r,colIndex:0,isDrilled:n.isDrilled,cell:n};"olap"===this.parent.dataType?this.parent.onDrill(void 0,h):this.onDrill({customAttributes:h})}else"drillThrough"===i?this.parent.drillThroughModule.executeDrillThrough(t[this.pivotIndex.rIndex][this.pivotIndex.cIndex],this.pivotIndex.rIndex,this.pivotIndex.rIndex):"exit"===i&&this.accumulationMenu.close()},e.prototype.getChartHeight=function(){var e,i;if((0,t.isNullOrUndefined)(this.parent.getHeightAsNumber()))e="auto";else{var a=this.parent.showToolbar?6:5;e=(this.parent.getHeightAsNumber()-a).toString(),i=this.parent.getHeightAsNumber()-a}if((0,t.isNullOrUndefined)(this.parent.getHeightAsNumber()))e="auto";else{var r=!1;null!==this.parent.element.querySelector(".e-chart-grouping-bar")&&"none"===this.parent.element.querySelector(".e-chart-grouping-bar").style.display.toLowerCase()&&(r=!0,this.parent.element.querySelector(".e-chart-grouping-bar").style.display="block"),this.parent.showToolbar&&this.parent.showGroupingBar?e=(i-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():this.parent.showToolbar?e=(i-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)).toString():this.parent.showGroupingBar?e=(i-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():(this.parent.chart&&parseInt(this.parent.chart.height,10)<200||i<200)&&(e="200"),r&&(this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none")}return e},e.prototype.getChartAutoHeight=function(){var e=this.parent.element.offsetHeight<this.parent.minHeight?this.parent.minHeight:this.parent.element.offsetHeight;return this.parent.showToolbar&&this.parent.showGroupingBar?e=e-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62):this.parent.showToolbar?e-=this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42:this.parent.showGroupingBar&&(e-=this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62),e},e.prototype.axisLabelRender=function(e){if(this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type&&"primaryXAxis"===e.axis.name&&(e.text=""),"primaryXAxis"!==e.axis.name){var t=this.engineModule.formatFields[this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.currentMeasure:e.axis.name],i=this.engineModule.getFormattedValue(e.value,this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.currentMeasure:e.axis.name,e.text),a=t&&t.format&&null!==t.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?i.toString():i.formattedText:e.value.toString();e.text=a}this.parent.trigger(be,e)},e.prototype.multiLevelLabelClick=function(e){var i={axis:e.axis,text:e.text,cell:(0,t.isNullOrUndefined)(e.customAttributes)?void 0:e.customAttributes.cell,cancel:!1};this.parent.trigger(B,i),!i.cancel&&e.customAttributes&&e.customAttributes.hasChild&&!e.customAttributes.cell.isNamedSet&&("olap"===this.parent.dataType?this.parent.onDrill(void 0,e.customAttributes):this.onDrill(e))},e.prototype.onDrill=function(e){var t=e.customAttributes,i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",a=t.fieldName,n=this.engineModule.pivotValues[t.rowIndex][t.colIndex],s=n.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),o=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:a,items:[s],delimiter:i}]}},!0);else{for(var l=0;l<this.dataSourceSettings.drilledMembers.length;l++){var h=this.dataSourceSettings.drilledMembers[l];if(s=s.split(i).join(h.delimiter?h.delimiter:i),i=h.delimiter=h.delimiter?h.delimiter:i,h.name===a){o=!0;var u=h.items.indexOf(s);u>-1?h.items.splice(u,1):h.items.push(s)}}o||this.dataSourceSettings.drilledMembers.push({name:a,items:[s],delimiter:i})}this.parent.showWaitingPopup();var c=this,g={fieldName:a,memberName:s,delimiter:i,axis:"row",action:t.isDrilled?"up":"down",currentCell:n},m={drillInfo:g,pivotview:c.parent};c.parent.trigger(R,m);var f={dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings)};this.parent.trigger(d,f),this.parent.setProperties({dataSourceSettings:f.dataSourceSettings},!0),c.parent.enableVirtualization||c.parent.enablePaging?"Server"===c.parent.dataSourceSettings.mode?c.parent.getEngine("onDrill",g,null,null,null,null,null):(c.engineModule.drilledMembers=c.dataSourceSettings.drilledMembers,c.engineModule.onDrill(g)):"Server"===c.parent.dataSourceSettings.mode?c.parent.getEngine("onDrill",g,null,null,null,null,null):c.engineModule.generateGridData(c.dataSourceSettings,!0),c.parent.allowServerDataBinding=!1,c.parent.setProperties({pivotValues:c.engineModule.pivotValues},!0),c.parent.allowServerDataBinding=!0;var S={dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),pivotValues:this.parent.pivotValues};this.parent.trigger(p,S),c.engineModule.pivotValues=S.pivotValues,c.parent.renderPivotGrid()},e.prototype.isAttributeDrill=function(e,t){for(var i=!1,a=0;a<this.dataSourceSettings.drilledMembers.length;a++)if(this.dataSourceSettings.drilledMembers[a].name===e)for(var r=0;r<this.dataSourceSettings.drilledMembers[a].items.length;r++){for(var n=this.dataSourceSettings.drilledMembers[a].items[r].split(this.dataSourceSettings.drilledMembers[a].delimiter),s="",o=0;o<n.length;o++)t[o]&&t[o].uName&&(s=s+(""===s?"":this.dataSourceSettings.drilledMembers[a].delimiter)+(t[o].uName.indexOf("[Measures]")>-1?"[Measures]":t[o].uName));if(s===this.dataSourceSettings.drilledMembers[a].items[r]){i=!0;break}}return i},e.prototype.load=function(e){e.chart.zoomModule&&(e.chart.zoomModule.isZoomed=!0),this.parent.trigger(ve,e)},e.prototype.beforePrint=function(e){this.parent.trigger(te,e)},e.prototype.animationComplete=function(e){this.parent.trigger(ie,e)},e.prototype.legendRender=function(e){this.parent.trigger(ae,e)},e.prototype.textRender=function(e){this.parent.trigger(re,e)},e.prototype.pointRender=function(e){this.parent.trigger(ne,e)},e.prototype.seriesRender=function(e){this.parent.trigger(se,e)},e.prototype.chartMouseMove=function(e){this.parent.trigger(oe,e)},e.prototype.chartMouseClick=function(e){this.parent.trigger(le,e)},e.prototype.pointMove=function(e){this.parent.trigger(de,e)},e.prototype.chartMouseLeave=function(e){this.parent.trigger(pe,e)},e.prototype.chartMouseDown=function(e){this.parent.trigger(he,e)},e.prototype.chartMouseUp=function(e){this.parent.trigger(ue,e)},e.prototype.dragComplete=function(e){this.parent.trigger(ce,e)},e.prototype.zoomComplete=function(e){this.parent.trigger(ge,e)},e.prototype.scrollStart=function(e){this.parent.trigger(me,e)},e.prototype.scrollEnd=function(e){this.parent.trigger(fe,e)},e.prototype.scrollChanged=function(e){this.parent.trigger(Se,e)},e.prototype.multiLevelLabelRender=function(e){this.parent.trigger(ee,e)},e.prototype.resized=function(e){this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&(e.chart.primaryXAxis.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(e.chart.primaryXAxis.zoomFactor=(0,t.isNullOrUndefined)(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor)),this.parent.trigger(ye,e)},e.prototype.getResizedChartHeight=function(){return["Pie","Funnel","Pyramid","Doughnut","Radar","Polar","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.parent.dataSourceSettings.values.length>0?Number(this.parent.chart.height)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(this.getChartHeight()))?this.getChartHeight().toString():(Number(this.getChartHeight())-5).toString():!isNaN(Number(this.getChartHeight()))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():this.getChartHeight().toString():this.getChartHeight().toString()},e.prototype.destroy=function(){this.parent&&this.parent.isDestroyed||(this.engineModule&&!this.parent.destroyEngine&&(this.engineModule.fieldList={},this.engineModule={}),this.chartSeries&&(this.chartSeries=null),this.columnGroupObject&&(this.columnGroupObject=null),this.chartSeriesInfo&&(this.chartSeriesInfo={},this.selectedLegend=null),this.chartSettings&&(this.chartSettings=null),this.dataSourceSettings&&(this.dataSourceSettings=null),this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&(this.accumulationMenu.destroy(),this.accumulationMenu=null),this.parent&&this.parent.chart&&!this.parent.chart.isDestroyed&&(this.parent.chart.destroy(),this.parent.chart=null))},e}(),Js={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},Zs={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},$s={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},eo={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},to={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},io={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},ao={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},ro={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},no={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},so=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),oo=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},lo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!0)],i.prototype,"enable",void 0),oo([(0,t.Property)(1e3)],i.prototype,"duration",void 0),oo([(0,t.Property)(0)],i.prototype,"delay",void 0),i}(t.ChildProperty),po=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(null)],i.prototype,"value",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),oo([(0,t.Property)("0")],i.prototype,"dashArray",void 0),i}(t.ChildProperty),ho=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)("Normal")],i.prototype,"fontStyle",void 0),oo([(0,t.Property)("16px")],i.prototype,"size",void 0),oo([(0,t.Property)("Normal")],i.prototype,"fontWeight",void 0),oo([(0,t.Property)("")],i.prototype,"color",void 0),oo([(0,t.Property)("Center")],i.prototype,"textAlignment",void 0),oo([(0,t.Property)("Segoe UI")],i.prototype,"fontFamily",void 0),oo([(0,t.Property)(1)],i.prototype,"opacity",void 0),oo([(0,t.Property)("Trim")],i.prototype,"textOverflow",void 0),i}(t.ChildProperty),uo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(10)],i.prototype,"left",void 0),oo([(0,t.Property)(10)],i.prototype,"right",void 0),oo([(0,t.Property)(10)],i.prototype,"top",void 0),oo([(0,t.Property)(10)],i.prototype,"bottom",void 0),i}(t.ChildProperty),co=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)("")],i.prototype,"color",void 0),oo([(0,t.Property)(1)],i.prototype,"width",void 0),i}(t.ChildProperty),go=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(0)],i.prototype,"x",void 0),oo([(0,t.Property)(0)],i.prototype,"y",void 0),i}(t.ChildProperty),mo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(0)],i.prototype,"series",void 0),oo([(0,t.Property)(0)],i.prototype,"point",void 0),i}(t.ChildProperty),fo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Complex)({},co)],i.prototype,"border",void 0),oo([(0,t.Property)("transparent")],i.prototype,"background",void 0),oo([(0,t.Property)(1)],i.prototype,"opacity",void 0),oo([(0,t.Property)(null)],i.prototype,"backgroundImage",void 0),i}(t.ChildProperty),So=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!1)],i.prototype,"enable",void 0),oo([(0,t.Property)("")],i.prototype,"dashArray",void 0),oo([(0,t.Complex)({color:null,width:1},co)],i.prototype,"line",void 0),oo([(0,t.Property)("Both")],i.prototype,"lineType",void 0),i}(t.ChildProperty),vo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!1)],i.prototype,"visible",void 0),oo([(0,t.Property)(null)],i.prototype,"name",void 0),oo([(0,t.Property)("transparent")],i.prototype,"fill",void 0),oo([(0,t.Property)(1)],i.prototype,"opacity",void 0),oo([(0,t.Property)(0)],i.prototype,"angle",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableRotation",void 0),oo([(0,t.Property)("Auto")],i.prototype,"position",void 0),oo([(0,t.Property)(5)],i.prototype,"rx",void 0),oo([(0,t.Property)(5)],i.prototype,"ry",void 0),oo([(0,t.Property)("Center")],i.prototype,"alignment",void 0),oo([(0,t.Complex)({width:null,color:null},co)],i.prototype,"border",void 0),oo([(0,t.Complex)({left:5,right:5,top:5,bottom:5},uo)],i.prototype,"margin",void 0),oo([(0,t.Complex)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},ho)],i.prototype,"font",void 0),oo([(0,t.Property)(null)],i.prototype,"template",void 0),i}(t.ChildProperty),yo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)("Line")],i.prototype,"type",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)(null)],i.prototype,"length",void 0),oo([(0,t.Property)("")],i.prototype,"dashArray",void 0),i}(t.ChildProperty),bo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!0)],i.prototype,"visible",void 0),oo([(0,t.Complex)({width:null,color:null},co)],i.prototype,"border",void 0),oo([(0,t.Complex)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},ho)],i.prototype,"font",void 0),oo([(0,t.Property)("transparent")],i.prototype,"fill",void 0),oo([(0,t.Property)(0)],i.prototype,"angle",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableRotation",void 0),oo([(0,t.Property)("Outside")],i.prototype,"position",void 0),oo([(0,t.Property)(5)],i.prototype,"rx",void 0),oo([(0,t.Property)(5)],i.prototype,"ry",void 0),oo([(0,t.Property)(null)],i.prototype,"template",void 0),oo([(0,t.Complex)({},yo)],i.prototype,"connectorStyle",void 0),i}(t.ChildProperty),Co=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!1)],i.prototype,"visible",void 0),oo([(0,t.Property)("Circle")],i.prototype,"shape",void 0),oo([(0,t.Property)("")],i.prototype,"imageUrl",void 0),oo([(0,t.Property)(5)],i.prototype,"width",void 0),oo([(0,t.Property)(5)],i.prototype,"height",void 0),oo([(0,t.Complex)({width:2,color:null},co)],i.prototype,"border",void 0),oo([(0,t.Complex)({x:0,y:0},go)],i.prototype,"offset",void 0),oo([(0,t.Property)(null)],i.prototype,"fill",void 0),oo([(0,t.Property)(1)],i.prototype,"opacity",void 0),oo([(0,t.Complex)({},vo)],i.prototype,"dataLabel",void 0),i}(t.ChildProperty),xo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)(10)],i.prototype,"length",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),oo([(0,t.Property)(1)],i.prototype,"opacity",void 0),i}(t.ChildProperty),wo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!1)],i.prototype,"visible",void 0),oo([(0,t.Property)("Fixed")],i.prototype,"type",void 0),oo([(0,t.Property)("Both")],i.prototype,"direction",void 0),oo([(0,t.Property)("Vertical")],i.prototype,"mode",void 0),oo([(0,t.Property)(1)],i.prototype,"verticalError",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)(1)],i.prototype,"horizontalError",void 0),oo([(0,t.Property)(3)],i.prototype,"verticalNegativeError",void 0),oo([(0,t.Property)(3)],i.prototype,"verticalPositiveError",void 0),oo([(0,t.Property)(1)],i.prototype,"horizontalNegativeError",void 0),oo([(0,t.Property)(1)],i.prototype,"horizontalPositiveError",void 0),oo([(0,t.Complex)(null,xo)],i.prototype,"errorBarCap",void 0),i}(t.ChildProperty),To=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)("")],i.prototype,"name",void 0),oo([(0,t.Property)("0")],i.prototype,"dashArray",void 0),oo([(0,t.Property)(!0)],i.prototype,"visible",void 0),oo([(0,t.Property)(2)],i.prototype,"period",void 0),oo([(0,t.Property)("Linear")],i.prototype,"type",void 0),oo([(0,t.Property)(0)],i.prototype,"backwardForecast",void 0),oo([(0,t.Property)(0)],i.prototype,"forwardForecast",void 0),oo([(0,t.Property)(2)],i.prototype,"polynomialOrder",void 0),oo([(0,t.Complex)({},Co)],i.prototype,"marker",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableTooltip",void 0),oo([(0,t.Complex)({},lo)],i.prototype,"animation",void 0),oo([(0,t.Property)("")],i.prototype,"fill",void 0),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)(null)],i.prototype,"intercept",void 0),oo([(0,t.Property)("SeriesType")],i.prototype,"legendShape",void 0),i}(t.ChildProperty),Mo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(null)],i.prototype,"fill",void 0),oo([(0,t.Complex)({color:"transparent",width:0},co)],i.prototype,"border",void 0),oo([(0,t.Property)("Zero")],i.prototype,"mode",void 0),i}(t.ChildProperty),Do=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(0)],i.prototype,"topLeft",void 0),oo([(0,t.Property)(0)],i.prototype,"topRight",void 0),oo([(0,t.Property)(0)],i.prototype,"bottomLeft",void 0),oo([(0,t.Property)(0)],i.prototype,"bottomRight",void 0),i}(t.ChildProperty),Oo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!1)],i.prototype,"enable",void 0),oo([(0,t.Property)(null)],i.prototype,"fill",void 0),oo([(0,t.Complex)(to,ho)],i.prototype,"textStyle",void 0),i}(t.ChildProperty),Po=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!0)],i.prototype,"visible",void 0),oo([(0,t.Property)(!1)],i.prototype,"startFromAxis",void 0),oo([(0,t.Property)(null)],i.prototype,"start",void 0),oo([(0,t.Property)(null)],i.prototype,"end",void 0),oo([(0,t.Property)(null)],i.prototype,"size",void 0),oo([(0,t.Property)("#808080")],i.prototype,"color",void 0),oo([(0,t.Property)(null)],i.prototype,"dashArray",void 0),oo([(0,t.Property)("Auto")],i.prototype,"sizeType",void 0),oo([(0,t.Property)(!1)],i.prototype,"isRepeat",void 0),oo([(0,t.Property)(null)],i.prototype,"repeatEvery",void 0),oo([(0,t.Property)(null)],i.prototype,"repeatUntil",void 0),oo([(0,t.Property)(!1)],i.prototype,"isSegmented",void 0),oo([(0,t.Property)(null)],i.prototype,"segmentStart",void 0),oo([(0,t.Property)(null)],i.prototype,"segmentEnd",void 0),oo([(0,t.Property)(null)],i.prototype,"segmentAxisName",void 0),oo([(0,t.Complex)({color:"transparent",width:1},co)],i.prototype,"border",void 0),oo([(0,t.Property)("")],i.prototype,"text",void 0),oo([(0,t.Property)(null)],i.prototype,"rotation",void 0),oo([(0,t.Property)("Middle")],i.prototype,"horizontalAlignment",void 0),oo([(0,t.Property)("Middle")],i.prototype,"verticalAlignment",void 0),oo([(0,t.Complex)(ro,ho)],i.prototype,"textStyle",void 0),oo([(0,t.Property)("Behind")],i.prototype,"zIndex",void 0),oo([(0,t.Property)(1)],i.prototype,"opacity",void 0),i}(t.ChildProperty),No=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)("")],i.prototype,"color",void 0),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)("Rectangle")],i.prototype,"type",void 0),i}(t.ChildProperty),Eo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)("")],i.prototype,"dashArray",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Io=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(.7)],i.prototype,"width",void 0),oo([(0,t.Property)("")],i.prototype,"dashArray",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Fo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)("")],i.prototype,"dashArray",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Lo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)(5)],i.prototype,"height",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Ao=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(.7)],i.prototype,"width",void 0),oo([(0,t.Property)(5)],i.prototype,"height",void 0),oo([(0,t.Property)(null)],i.prototype,"color",void 0),i}(t.ChildProperty),Ro=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(0)],i.prototype,"x",void 0),oo([(0,t.Property)(0)],i.prototype,"y",void 0),i}(t.ChildProperty),ko=(function(){function e(){}oo([(0,t.Property)("")],e.prototype,"color",void 0),oo([(0,t.Property)(1)],e.prototype,"width",void 0)}(),function(){function e(){}oo([(0,t.Property)(!0)],e.prototype,"enable",void 0),oo([(0,t.Property)(1e3)],e.prototype,"duration",void 0),oo([(0,t.Property)(0)],e.prototype,"delay",void 0)}(),function(){function e(){}oo([(0,t.Property)(null)],e.prototype,"value",void 0),oo([(0,t.Property)(null)],e.prototype,"color",void 0),oo([(0,t.Property)("0")],e.prototype,"dashArray",void 0)}(),function(){function e(){}oo([(0,t.Property)(!1)],e.prototype,"visible",void 0),oo([(0,t.Property)("Circle")],e.prototype,"shape",void 0),oo([(0,t.Property)("")],e.prototype,"imageUrl",void 0),oo([(0,t.Property)(5)],e.prototype,"height",void 0),oo([(0,t.Property)(5)],e.prototype,"width",void 0),oo([(0,t.Complex)({width:2,color:null},co)],e.prototype,"border",void 0),oo([(0,t.Property)(null)],e.prototype,"fill",void 0),oo([(0,t.Property)(1)],e.prototype,"opacity",void 0),oo([(0,t.Complex)({},vo)],e.prototype,"dataLabel",void 0)}(),function(){function e(){}oo([(0,t.Property)(!1)],e.prototype,"visible",void 0),oo([(0,t.Property)("Fixed")],e.prototype,"type",void 0),oo([(0,t.Property)("Both")],e.prototype,"direction",void 0),oo([(0,t.Property)("Vertical")],e.prototype,"mode",void 0),oo([(0,t.Property)(null)],e.prototype,"color",void 0),oo([(0,t.Property)(1)],e.prototype,"verticalError",void 0),oo([(0,t.Property)(1)],e.prototype,"width",void 0),oo([(0,t.Property)(1)],e.prototype,"horizontalError",void 0),oo([(0,t.Property)(3)],e.prototype,"verticalPositiveError",void 0),oo([(0,t.Property)(3)],e.prototype,"verticalNegativeError",void 0),oo([(0,t.Property)(1)],e.prototype,"horizontalPositiveError",void 0),oo([(0,t.Property)(1)],e.prototype,"horizontalNegativeError",void 0),oo([(0,t.Complex)(null,xo)],e.prototype,"errorBarCap",void 0)}(),function(){function e(){}oo([(0,t.Property)("")],e.prototype,"name",void 0),oo([(0,t.Property)("Linear")],e.prototype,"type",void 0),oo([(0,t.Property)(2)],e.prototype,"period",void 0),oo([(0,t.Property)(2)],e.prototype,"polynomialOrder",void 0),oo([(0,t.Property)(0)],e.prototype,"backwardForecast",void 0),oo([(0,t.Property)(0)],e.prototype,"forwardForecast",void 0),oo([(0,t.Complex)({},lo)],e.prototype,"animation",void 0),oo([(0,t.Complex)({},Co)],e.prototype,"marker",void 0),oo([(0,t.Property)(!0)],e.prototype,"enableTooltip",void 0),oo([(0,t.Property)(null)],e.prototype,"intercept",void 0),oo([(0,t.Property)("")],e.prototype,"fill",void 0),oo([(0,t.Property)(1)],e.prototype,"width",void 0),oo([(0,t.Property)("SeriesType")],e.prototype,"legendShape",void 0)}(),function(){function e(){}oo([(0,t.Property)(null)],e.prototype,"fill",void 0),oo([(0,t.Complex)({color:"transparent",width:0},co)],e.prototype,"border",void 0),oo([(0,t.Property)("Zero")],e.prototype,"mode",void 0)}(),function(){function e(){}oo([(0,t.Property)(0)],e.prototype,"topLeft",void 0),oo([(0,t.Property)(0)],e.prototype,"topRight",void 0),oo([(0,t.Property)(0)],e.prototype,"bottomLeft",void 0),oo([(0,t.Property)(0)],e.prototype,"bottomRight",void 0)}(),function(){function e(){}oo([(0,t.Property)("Normal")],e.prototype,"fontStyle",void 0),oo([(0,t.Property)("16px")],e.prototype,"size",void 0),oo([(0,t.Property)("Normal")],e.prototype,"fontWeight",void 0),oo([(0,t.Property)("")],e.prototype,"color",void 0),oo([(0,t.Property)("Center")],e.prototype,"textAlignment",void 0),oo([(0,t.Property)("Segoe UI")],e.prototype,"fontFamily",void 0),oo([(0,t.Property)(1)],e.prototype,"opacity",void 0),oo([(0,t.Property)("Trim")],e.prototype,"textOverflow",void 0)}(),function(){function e(){}oo([(0,t.Property)(!1)],e.prototype,"enable",void 0),oo([(0,t.Property)(null)],e.prototype,"fill",void 0),oo([(0,t.Complex)(to,ho)],e.prototype,"textStyle",void 0)}(),function(){function e(){}oo([(0,t.Property)(1)],e.prototype,"width",void 0),oo([(0,t.Property)(5)],e.prototype,"height",void 0),oo([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}oo([(0,t.Property)(1)],e.prototype,"width",void 0),oo([(0,t.Property)("")],e.prototype,"dashArray",void 0),oo([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}oo([(0,t.Property)(.7)],e.prototype,"width",void 0),oo([(0,t.Property)(5)],e.prototype,"height",void 0),oo([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}oo([(0,t.Property)(.7)],e.prototype,"width",void 0),oo([(0,t.Property)("")],e.prototype,"dashArray",void 0),oo([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}oo([(0,t.Property)(1)],e.prototype,"width",void 0),oo([(0,t.Property)("")],e.prototype,"dashArray",void 0),oo([(0,t.Property)(null)],e.prototype,"color",void 0)}(),function(){function e(){}oo([(0,t.Property)(!0)],e.prototype,"visible",void 0),oo([(0,t.Property)(!1)],e.prototype,"startFromAxis",void 0),oo([(0,t.Property)(null)],e.prototype,"start",void 0),oo([(0,t.Property)(null)],e.prototype,"end",void 0),oo([(0,t.Property)(null)],e.prototype,"size",void 0),oo([(0,t.Property)("#808080")],e.prototype,"color",void 0),oo([(0,t.Property)(null)],e.prototype,"dashArray",void 0),oo([(0,t.Property)("Auto")],e.prototype,"sizeType",void 0),oo([(0,t.Property)(!1)],e.prototype,"isRepeat",void 0),oo([(0,t.Property)(null)],e.prototype,"repeatEvery",void 0),oo([(0,t.Property)(null)],e.prototype,"repeatUntil",void 0),oo([(0,t.Property)(!1)],e.prototype,"isSegmented",void 0),oo([(0,t.Property)(null)],e.prototype,"segmentStart",void 0),oo([(0,t.Property)(null)],e.prototype,"segmentEnd",void 0),oo([(0,t.Property)(null)],e.prototype,"segmentAxisName",void 0),oo([(0,t.Complex)({color:"transparent",width:1},co)],e.prototype,"border",void 0),oo([(0,t.Property)("")],e.prototype,"text",void 0),oo([(0,t.Property)(null)],e.prototype,"rotation",void 0),oo([(0,t.Property)("Middle")],e.prototype,"horizontalAlignment",void 0),oo([(0,t.Property)("Middle")],e.prototype,"verticalAlignment",void 0),oo([(0,t.Complex)(ro,ho)],e.prototype,"textStyle",void 0),oo([(0,t.Property)("Behind")],e.prototype,"zIndex",void 0),oo([(0,t.Property)(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}oo([(0,t.Property)("")],e.prototype,"color",void 0),oo([(0,t.Property)(1)],e.prototype,"width",void 0),oo([(0,t.Property)("Rectangle")],e.prototype,"type",void 0)}(),function(){function e(){}oo([(0,t.Complex)({},co)],e.prototype,"border",void 0),oo([(0,t.Property)("transparent")],e.prototype,"background",void 0),oo([(0,t.Property)(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}oo([(0,t.Property)(!1)],e.prototype,"enable",void 0),oo([(0,t.Property)("")],e.prototype,"dashArray",void 0),oo([(0,t.Complex)({color:null,width:1},co)],e.prototype,"line",void 0),oo([(0,t.Property)("Both")],e.prototype,"lineType",void 0)}(),function(){function e(){}oo([(0,t.Property)(!0)],e.prototype,"visible",void 0),oo([(0,t.Property)(null)],e.prototype,"height",void 0),oo([(0,t.Property)(null)],e.prototype,"width",void 0),oo([(0,t.Complex)({x:0,y:0},Ro)],e.prototype,"location",void 0),oo([(0,t.Property)("Auto")],e.prototype,"position",void 0),oo([(0,t.Property)(8)],e.prototype,"padding",void 0),oo([(0,t.Property)("Center")],e.prototype,"alignment",void 0),oo([(0,t.Complex)(ao,ho)],e.prototype,"textStyle",void 0),oo([(0,t.Property)(10)],e.prototype,"shapeHeight",void 0),oo([(0,t.Property)(10)],e.prototype,"shapeWidth",void 0),oo([(0,t.Complex)({},co)],e.prototype,"border",void 0),oo([(0,t.Complex)({left:0,right:0,top:0,bottom:0},uo)],e.prototype,"margin",void 0),oo([(0,t.Property)(5)],e.prototype,"shapePadding",void 0),oo([(0,t.Property)("transparent")],e.prototype,"background",void 0),oo([(0,t.Property)(1)],e.prototype,"opacity",void 0),oo([(0,t.Property)(!0)],e.prototype,"toggleVisibility",void 0),oo([(0,t.Property)(null)],e.prototype,"description",void 0),oo([(0,t.Property)(3)],e.prototype,"tabIndex",void 0)}(),function(){function e(){}oo([(0,t.Property)(0)],e.prototype,"series",void 0),oo([(0,t.Property)(0)],e.prototype,"point",void 0)}(),function(){function e(){}oo([(0,t.Property)(10)],e.prototype,"left",void 0),oo([(0,t.Property)(10)],e.prototype,"right",void 0),oo([(0,t.Property)(10)],e.prototype,"top",void 0),oo([(0,t.Property)(10)],e.prototype,"bottom",void 0)}(),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(null)],i.prototype,"fill",void 0),oo([(0,t.Property)(null)],i.prototype,"endAngle",void 0),oo([(0,t.Property)(!1)],i.prototype,"explode",void 0),oo([(0,t.Property)(!1)],i.prototype,"explodeAll",void 0),oo([(0,t.Property)(null)],i.prototype,"explodeIndex",void 0),oo([(0,t.Property)(null)],i.prototype,"innerRadius",void 0),oo([(0,t.Property)("30%")],i.prototype,"explodeOffset",void 0),oo([(0,t.Property)(0)],i.prototype,"gapRatio",void 0),oo([(0,t.Property)("Value")],i.prototype,"groupMode",void 0),oo([(0,t.Property)(null)],i.prototype,"groupTo",void 0),oo([(0,t.Property)("20%")],i.prototype,"neckHeight",void 0),oo([(0,t.Property)("20%")],i.prototype,"neckWidth",void 0),oo([(0,t.Property)("Linear")],i.prototype,"pyramidMode",void 0),oo([(0,t.Property)([])],i.prototype,"palettes",void 0),oo([(0,t.Property)(0)],i.prototype,"startAngle",void 0),oo([(0,t.Complex)(null,lo)],i.prototype,"animation",void 0),oo([(0,t.Complex)(null,bo)],i.prototype,"dataLabel",void 0),oo([(0,t.Property)("0")],i.prototype,"dashArray",void 0),oo([(0,t.Property)(1)],i.prototype,"width",void 0),oo([(0,t.Property)("X")],i.prototype,"segmentAxis",void 0),oo([(0,t.Property)("Line")],i.prototype,"drawType",void 0),oo([(0,t.Property)(!0)],i.prototype,"isClosed",void 0),oo([(0,t.Collection)([],po)],i.prototype,"segments",void 0),oo([(0,t.Property)("")],i.prototype,"stackingGroup",void 0),oo([(0,t.Complex)({color:"transparent",width:0},co)],i.prototype,"border",void 0),oo([(0,t.Property)(!0)],i.prototype,"visible",void 0),oo([(0,t.Property)(1)],i.prototype,"opacity",void 0),oo([(0,t.Property)("Line")],i.prototype,"type",void 0),oo([(0,t.Complex)(null,Co)],i.prototype,"marker",void 0),oo([(0,t.Complex)(null,wo)],i.prototype,"errorBar",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableTooltip",void 0),oo([(0,t.Collection)([],To)],i.prototype,"trendlines",void 0),oo([(0,t.Property)("")],i.prototype,"tooltipMappingName",void 0),oo([(0,t.Property)("SeriesType")],i.prototype,"legendShape",void 0),oo([(0,t.Property)(1)],i.prototype,"minRadius",void 0),oo([(0,t.Property)(null)],i.prototype,"selectionStyle",void 0),oo([(0,t.Property)("Natural")],i.prototype,"splineType",void 0),oo([(0,t.Property)(3)],i.prototype,"maxRadius",void 0),oo([(0,t.Property)(.5)],i.prototype,"cardinalSplineTension",void 0),oo([(0,t.Property)(null)],i.prototype,"columnWidth",void 0),oo([(0,t.Complex)(null,Mo)],i.prototype,"emptyPointSettings",void 0),oo([(0,t.Complex)(null,Do)],i.prototype,"cornerRadius",void 0),oo([(0,t.Property)(0)],i.prototype,"columnSpacing",void 0),i}(t.ChildProperty)),jo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)("Rotate45")],i.prototype,"labelIntersectAction",void 0),oo([(0,t.Complex)(Js,ho)],i.prototype,"labelStyle",void 0),oo([(0,t.Property)("")],i.prototype,"title",void 0),oo([(0,t.Property)(null)],i.prototype,"zoomFactor",void 0),oo([(0,t.Complex)({},Oo)],i.prototype,"crosshairTooltip",void 0),oo([(0,t.Property)("")],i.prototype,"labelFormat",void 0),oo([(0,t.Complex)(Zs,ho)],i.prototype,"titleStyle",void 0),oo([(0,t.Property)(!1)],i.prototype,"isIndexed",void 0),oo([(0,t.Property)(0)],i.prototype,"plotOffset",void 0),oo([(0,t.Property)("Shift")],i.prototype,"edgeLabelPlacement",void 0),oo([(0,t.Property)("BetweenTicks")],i.prototype,"labelPlacement",void 0),oo([(0,t.Property)("Outside")],i.prototype,"tickPosition",void 0),oo([(0,t.Property)(!1)],i.prototype,"opposedPosition",void 0),oo([(0,t.Property)(!0)],i.prototype,"visible",void 0),oo([(0,t.Property)("Outside")],i.prototype,"labelPosition",void 0),oo([(0,t.Property)(0)],i.prototype,"labelRotation",void 0),oo([(0,t.Property)(0)],i.prototype,"minorTicksPerInterval",void 0),oo([(0,t.Property)(null)],i.prototype,"maximum",void 0),oo([(0,t.Property)(null)],i.prototype,"minimum",void 0),oo([(0,t.Property)(34)],i.prototype,"maximumLabelWidth",void 0),oo([(0,t.Property)(null)],i.prototype,"interval",void 0),oo([(0,t.Complex)({},Lo)],i.prototype,"majorTickLines",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableTrim",void 0),oo([(0,t.Complex)({},Eo)],i.prototype,"majorGridLines",void 0),oo([(0,t.Complex)({},Ao)],i.prototype,"minorTickLines",void 0),oo([(0,t.Complex)({},Fo)],i.prototype,"lineStyle",void 0),oo([(0,t.Complex)({},Io)],i.prototype,"minorGridLines",void 0),oo([(0,t.Property)(!1)],i.prototype,"isInversed",void 0),oo([(0,t.Property)(null)],i.prototype,"description",void 0),oo([(0,t.Property)(0)],i.prototype,"startAngle",void 0),oo([(0,t.Property)(100)],i.prototype,"coefficient",void 0),oo([(0,t.Collection)([],Po)],i.prototype,"stripLines",void 0),oo([(0,t.Property)(2)],i.prototype,"tabIndex",void 0),oo([(0,t.Complex)({color:null,width:0,type:"Rectangle"},No)],i.prototype,"border",void 0),i}(t.ChildProperty),qo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!1)],i.prototype,"enableMarker",void 0),oo([(0,t.Property)(!0)],i.prototype,"enable",void 0),oo([(0,t.Property)(null)],i.prototype,"fill",void 0),oo([(0,t.Property)(!1)],i.prototype,"shared",void 0),oo([(0,t.Property)(.75)],i.prototype,"opacity",void 0),oo([(0,t.Property)(null)],i.prototype,"header",void 0),oo([(0,t.Property)(null)],i.prototype,"format",void 0),oo([(0,t.Complex)(io,ho)],i.prototype,"textStyle",void 0),oo([(0,t.Property)(null)],i.prototype,"template",void 0),oo([(0,t.Complex)({color:"#cccccc",width:.5},co)],i.prototype,"border",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableAnimation",void 0),i}(t.ChildProperty),Ho=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)("50%")],i.prototype,"x",void 0),oo([(0,t.Property)("50%")],i.prototype,"y",void 0),i}(t.ChildProperty),Vo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Property)(!1)],i.prototype,"enablePinchZooming",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableSelectionZooming",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableDeferredZooming",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableMouseWheelZooming",void 0),oo([(0,t.Property)("XY")],i.prototype,"mode",void 0),oo([(0,t.Property)(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],i.prototype,"toolbarItems",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableScrollbar",void 0),oo([(0,t.Property)(!1)],i.prototype,"enablePan",void 0),i}(t.ChildProperty),Uo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return so(i,e),oo([(0,t.Complex)({},ko)],i.prototype,"chartSeries",void 0),oo([(0,t.Complex)({},jo)],i.prototype,"primaryXAxis",void 0),oo([(0,t.Complex)({},jo)],i.prototype,"primaryYAxis",void 0),oo([(0,t.Property)("")],i.prototype,"value",void 0),oo([(0,t.Property)("")],i.prototype,"columnHeader",void 0),oo([(0,t.Property)("-")],i.prototype,"columnDelimiter",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableMultipleAxis",void 0),oo([(0,t.Property)("Stacked")],i.prototype,"multipleAxisMode",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableScrollOnMultiAxis",void 0),oo([(0,t.Property)(!1)],i.prototype,"showMemberSeries",void 0),oo([(0,t.Property)(!1)],i.prototype,"showPointColorByMembers",void 0),oo([(0,t.Complex)($s,ho)],i.prototype,"titleStyle",void 0),oo([(0,t.Property)("")],i.prototype,"title",void 0),oo([(0,t.Complex)(eo,ho)],i.prototype,"subTitleStyle",void 0),oo([(0,t.Property)("")],i.prototype,"subTitle",void 0),oo([(0,t.Complex)({color:"#DDDDDD",width:0},co)],i.prototype,"border",void 0),oo([(0,t.Complex)({},uo)],i.prototype,"margin",void 0),oo([(0,t.Complex)({border:{color:null,width:.5},background:"transparent"},fo)],i.prototype,"chartArea",void 0),oo([(0,t.Property)(null)],i.prototype,"background",void 0),oo([(0,t.Property)("Material")],i.prototype,"theme",void 0),oo([(0,t.Property)([])],i.prototype,"palettes",void 0),oo([(0,t.Complex)({},So)],i.prototype,"crosshair",void 0),oo([(0,t.Complex)({},qo)],i.prototype,"tooltip",void 0),oo([(0,t.Complex)(null,Ho)],i.prototype,"pieCenter",void 0),oo([(0,t.Complex)({},Vo)],i.prototype,"zoomSettings",void 0),oo([(0,t.Property)()],i.prototype,"legendSettings",void 0),oo([(0,t.Property)("None")],i.prototype,"selectionMode",void 0),oo([(0,t.Property)("None")],i.prototype,"accumulationSelectionMode",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableSmartLabels",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableBorderOnMouseMove",void 0),oo([(0,t.Property)("None")],i.prototype,"highlightMode",void 0),oo([(0,t.Property)("None")],i.prototype,"highlightPattern",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableExport",void 0),oo([(0,t.Property)(!1)],i.prototype,"isMultiSelect",void 0),oo([(0,t.Collection)([],mo)],i.prototype,"selectedDataIndexes",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableAnimation",void 0),oo([(0,t.Property)(!1)],i.prototype,"enableCanvas",void 0),oo([(0,t.Property)(!0)],i.prototype,"useGroupingSeparator",void 0),oo([(0,t.Property)(!1)],i.prototype,"isTransposed",void 0),oo([(0,t.Property)(1)],i.prototype,"tabIndex",void 0),oo([(0,t.Property)(null)],i.prototype,"description",void 0),oo([(0,t.Event)()],i.prototype,"resized",void 0),oo([(0,t.Property)(!0)],i.prototype,"enableSideBySidePlacement",void 0),oo([(0,t.Event)()],i.prototype,"loaded",void 0),oo([(0,t.Event)()],i.prototype,"beforePrint",void 0),oo([(0,t.Event)()],i.prototype,"animationComplete",void 0),oo([(0,t.Event)()],i.prototype,"load",void 0),oo([(0,t.Event)()],i.prototype,"textRender",void 0),oo([(0,t.Event)()],i.prototype,"legendRender",void 0),oo([(0,t.Event)()],i.prototype,"seriesRender",void 0),oo([(0,t.Event)()],i.prototype,"multiLevelLabelRender",void 0),oo([(0,t.Event)()],i.prototype,"pointRender",void 0),oo([(0,t.Event)()],i.prototype,"tooltipRender",void 0),oo([(0,t.Event)()],i.prototype,"legendClick",void 0),oo([(0,t.Event)()],i.prototype,"axisLabelRender",void 0),oo([(0,t.Event)()],i.prototype,"multiLevelLabelClick",void 0),oo([(0,t.Event)()],i.prototype,"chartMouseClick",void 0),oo([(0,t.Event)()],i.prototype,"chartMouseMove",void 0),oo([(0,t.Event)()],i.prototype,"pointMove",void 0),oo([(0,t.Event)()],i.prototype,"pointClick",void 0),oo([(0,t.Event)()],i.prototype,"chartMouseDown",void 0),oo([(0,t.Event)()],i.prototype,"chartMouseLeave",void 0),oo([(0,t.Event)()],i.prototype,"dragComplete",void 0),oo([(0,t.Event)()],i.prototype,"chartMouseUp",void 0),oo([(0,t.Event)()],i.prototype,"scrollStart",void 0),oo([(0,t.Event)()],i.prototype,"zoomComplete",void 0),oo([(0,t.Event)()],i.prototype,"scrollChanged",void 0),oo([(0,t.Event)()],i.prototype,"scrollEnd",void 0),oo([(0,t.Property)(!0)],i.prototype,"showMultiLevelLabels",void 0),i}(t.ChildProperty),Bo=function(){function e(){}return e.getCellSets=function(e,i,a,r,n){this.engine=i,this.isMondrian=i.isMondrian,this.isMeasureAvail=i.isMeasureAvail,this.isPaging=i.isPaging,this.pageSettings=i.pageSettings,this.rows=i.rows,this.columns=i.columns,this.values=i.values,this.filters=i.filters,this.allowLabelFilter=i.allowLabelFilter,this.allowValueFilter=i.allowValueFilter,this.drilledMembers=i.updateDrilledItems(e.drilledMembers),this.calculatedFieldSettings=i.calculatedFieldSettings,this.valueAxis="row"===e.valueAxis?"rows":"columns",r&&(r.axis="row"===r.axis?"rows":"columns"),this.filterMembers=(0,t.extend)({},i.filterMembers,null,!0),this.fieldDataObj=i.fieldListObj,this.fieldList=i.fieldList,this.cellSetInfo="\nDIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE";var s=this.getMeasuresQuery(this.values),o=this.getDimensionsQuery(this.rows,s,"rows",r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),l=this.getDimensionsQuery(this.columns,s,"columns",r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;");if(this.isPaging&&a&&void 0!==this.pageSettings)o=(d=this.getPagingQuery(o,l)).rowQuery,l=d.columnQuery;else if(this.isPaging&&!a&&void 0!==this.pageSettings){var d;o=(d=this.getPagingCountQuery(o,l)).rowQuery,l=d.columnQuery}o=o.length>0?o+(this.isPaging&&!a?"":this.cellSetInfo+" ON ROWS"):"",l=l.length>0?l+(this.isPaging&&!a?"":this.cellSetInfo+" ON COLUMNS"):"";var p=this.getSlicersQuery(this.filters,"filters").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),h=this.getfilterQuery(this.filterMembers,e.cube).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),u=this.getCalculatedFieldQuery(this.calculatedFieldSettings).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),c=this.frameMDXQuery(o,l,p,h,u,a),g={catalog:e.catalog,cube:e.cube,url:e.url,request:c,LCID:e.localeIdentifier.toString(),roles:e.roles};i.mdxQuery=c.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/%280/g,'"').replace(/&apos;/g,"'"),r&&(r.axis="rows"===r.axis?"row":"column"),n||this.getTableCellData(g,this.isPaging&&!a?this.engine.generatePagingData.bind(this.engine):this.engine.generateEngine.bind(this.engine),r?{action:r.action,drillInfo:r}:{dataSourceSettings:e,action:"loadTableElements"})},e.getTableCellData=function(e,t,i){var a=this.engine.getConnectionInfo(e.url,e.LCID),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement>'+e.request+"</Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList> </Properties></Execute> </Body> </Envelope>";if(this.engine.doAjaxPost("POST",a.url,r,t,i),this.engine.errorInfo)throw this.engine.errorInfo},e.frameMDXQuery=function(e,t,i,a,r,n){var s=this.isPaging&&!n?""!==r?"":"\nWITH":"\nSelect ";return t.length>0&&(s+=t),e.length>0&&(s=s+(t.length>0?this.isPaging&&!n?"":", ":"")+e),s=r+s+(this.isPaging&&!n?"\nMEMBER [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] AS Count([e16a30d0-2174-4874-8dae-a5085a75a3e2]) MEMBER [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] AS Count ([d1876d2b-e50e-4547-85fe-5b8ed9d629de])\nSELECT { [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] , [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] } ON AXIS(0)":"")+" "+a+i+"\nCELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE\n"},e.getPagingQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e,a=(this.pageSettings.currentRowPage-1)*this.pageSettings.rowPageSize,r=(this.pageSettings.currentColumnPage-1)*this.pageSettings.columnPageSize,n=this.engine.isExporting&&this.engine.exportSpeciedPages&&this.engine.exportSpeciedPages.rowSize?this.engine.exportSpeciedPages.rowSize:3*this.pageSettings.rowPageSize,s=this.engine.isExporting&&this.engine.exportSpeciedPages&&this.engine.exportSpeciedPages.columnSize?this.engine.exportSpeciedPages.columnSize:3*this.pageSettings.columnPageSize;return a=this.engine.rowCount<a+n?this.engine.rowCount>n?this.engine.rowCount-n:0:a,this.engine.pageRowStartPos=a,r=this.engine.columnCount<r+s?this.engine.columnCount>s?this.engine.columnCount-s:0:r,this.engine.pageColStartPos=r,{rowQuery:""!==e?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")},"+a+","+n+")":"",columnQuery:""!==t?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")},"+r+","+s+")":""}},e.getPagingCountQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e;return{rowQuery:""!==e?"SET [d1876d2b-e50e-4547-85fe-5b8ed9d629de] as "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")\n":"",columnQuery:""!==t?"\nSET [e16a30d0-2174-4874-8dae-a5085a75a3e2] as "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")\n":""}},e.getDimensionsQuery=function(e,t,i,a){var r="";if(e.length>0){r="\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"");for(var n=0;n<e.length;){0===n?"[measures]"===e[n].name.toLowerCase()?""!==t&&(r+=t):r+="({"+this.getDimensionQuery(e[n],i)+"})":"[measures]"===e[n].name.toLowerCase()?""!==t&&(r=r+" * "+t):r=r+" * "+("({"+this.getDimensionQuery(e[n],i)+"})"),n++}var s=this.getDrillQuery(e,t,i,a);r=a&&a.axis===i?"\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"")+s.query:r+(""!==s.query?",":"")+s.query;var o=this.getAttributeDrillQuery(e,t,i,a);r=r+(this.isPaging?(""!==o?"-":"")+o:"")+(this.drilledMembers.length>0?"})":"")+(this.isPaging?"":(""!==o?"-":"")+o)+")"}return r},e.getAttributeDrillQuery=function(e,t,i,a){var r="",n=[];n=a&&a.axis===i&&"down"===a.action.toLowerCase()?[{name:a.fieldName,items:[a.memberName],delimiter:"~~"}]:this.drilledMembers;for(var s=i===this.valueAxis?this.getMeasurePos(i):0,o=0,l=n;o<l.length;o++){var d=l[o];if(!!this.engine.fieldList[d.name]&&this.engine.fieldList[d.name].isHierarchy)for(var p=0,h=d.items;p<h.length;p++){for(var u=h[p],c=[],g=u.split(d.delimiter?d.delimiter:"~~"),m=this.getDrillLevel(e,g),f=this.getDimensionPos(i,d.name),S=e.length-(s>f?1:0),v=!!this.isPaging&&this.isAttributeMemberExist(d.name,u.split(d.delimiter?d.delimiter:"~~"),d.delimiter,g,i);m.level>0&&m.isDrill&&f+1!==s&&!v;){for(var y=[],b=0;b<e.length;){if("[measures]"===e[b].name.toLowerCase())""!==t&&y.push(g[b]?"({{"+g[b]+"}})":"("+t+")");else if(g[b]&&(-1!==g[b].indexOf(e[b].name)||e[b].isNamedSet&&this.fieldList[e[b].name]&&-1!==g[b].indexOf(this.fieldList[e[b].name].pid.split("Sets_")[1])))y.push(this.getHierarchyQuery(g[b],!1,!1,!1,m.level,!0));else{if(g[b]||!e[b]){y=[];break}y.push(this.getHierarchyQuery(e[b].name,!!(this.isPaging&&2===m.level||!this.isPaging&&S>b),e[b].isNamedSet,e[b].isCalculatedField,m.level,!1))}b++}y.length>0&&c.push("("+y.join("*")+")"),m.level--,S--}c.length>0&&(r=r+(""!==r?"-":"")+c.join(this.isPaging?"+":"-"))}}return r},e.getDimensionPos=function(e,t){for(var i=0,a="rows"===e?this.rows:this.columns,r=0;r<a.length;r++)if(a[r].name===t){i=r;break}return i},e.getMeasurePos=function(e){for(var t=0,i="rows"===e?this.rows:this.columns,a=0;a<i.length;a++)if(0===i[a].name.indexOf("[Measures]")){t=a;break}return t},e.getDrillLevel=function(e,t){for(var i=e.length,a=!1,r=0;r<e.length;)t[r]&&-1!==t[r].indexOf(e[r].name)?(i-=1,e[r+1]&&!(e[r+1].isNamedSet||0===e[r+1].name.indexOf("[Measures]")||this.fieldList[e[r+1].name]&&!this.fieldList[e[r+1].name].hasAllMember)&&(a=!0)):(e[r].isNamedSet||0===e[r].name.indexOf("[Measures]")||this.fieldList[e[r].name]&&!this.fieldList[e[r].name].hasAllMember)&&(i-=1),r++;return{level:this.isPaging?2:i,isDrill:a}},e.getHierarchyQuery=function(e,t,i,a,r,n){return e=a?this.fieldList[e].tag:e,!this.fieldList[e]||this.fieldList[e].hasAllMember||i||a?i||a?"({"+e+"})":this.isPaging?"({"+e+(t?".CHILDREN})":n||1!==r?"})":".[All]})"):"({DrilldownLevel({"+e+(t?".CHILDREN":"")+"},,,INCLUDE_CALC_MEMBERS)})":"(("+e+").levels(0).AllMembers)"},e.isAttributeMemberExist=function(e,t,i,a,r){t.splice(a.length-1,1);var n=!1;if(""!==t.join(i)&&(!this.isPaging||1!==t.length||"[Measures]"!==t.join(i))&&this.engine.fieldList[e]&&this.engine.fieldList[e].hasAllMember)for(var s=this.getDimensionPos(r,e),o=0;o<this.drilledMembers.length;o++){if(e!==this.drilledMembers[o].name)if(!!this.engine.fieldList[this.drilledMembers[o].name]&&this.engine.fieldList[this.drilledMembers[o].name].isHierarchy)for(var l=this.getDimensionPos(r,this.drilledMembers[o].name),d=0;d<this.drilledMembers[o].items.length;d++){var p=this.getDrillLevel("rows"===r?this.rows:this.columns,this.drilledMembers[o].items[d].split(this.drilledMembers[o].delimiter?this.drilledMembers[o].delimiter:"~~"));if((!this.isPaging||l<s&&p.isDrill)&&(0===this.drilledMembers[o].items[d].indexOf(t.join(i))||0===t.join(i).indexOf(this.drilledMembers[o].items[d]))){n=!0;break}}}return n},e.getDrillQuery=function(e,t,i,a){var r="",n=[],s=[],o=!1,l="";a&&a.axis===i&&"down"===a.action.toLowerCase()?(o=!0,s=[{name:a.fieldName,items:[a.memberName],delimiter:"~~"}]):s=this.drilledMembers;for(var d=0,p=s;d<p.length;d++){var h=p[d];if(!(!!this.engine.fieldList[h.name]&&this.engine.fieldList[h.name].isHierarchy))for(var u=0,c=h.items;u<c.length;u++){for(var g=c[u],m=[],f=[],S=0,v=g.split(h.delimiter?h.delimiter:"~~"),y=this.isAttributeMemberExist(h.name,g.split(h.delimiter?h.delimiter:"~~"),h.delimiter?h.delimiter:"~~",v,i);S<e.length&&!y;){if(v[S]&&-1!==v[S].indexOf(e[S].name))-1!==v[v.length-1].indexOf(e[S].name)?o?l=l+(""!==l?" * ":"")+"({"+v[S]+".CHILDREN})":(m.push("("+v[S]+".CHILDREN)"),f.push("("+v[S]+")")):"[measures]"===v[S].toLowerCase()&&""!==t?o?l=l+(""!==l?" * ":"")+"("+t+")":(m.push("("+t+")"),f.push("("+t+")")):-1!==v[S].toLowerCase().indexOf("[measures]")?o?l=l+(""!==l?" * ":"")+"({"+v[S]+"})":(m.push("({"+v[S]+"})"),f.push("({"+v[S]+"})")):o?l=l+(""!==l?" * ":"")+"({"+v[S]+"})":(m.push("("+v[S]+")"),f.push("("+v[S]+")"));else{if(v[S]||!e[S]){m=[];break}if("[measures]"===e[S].name.toLowerCase()&&""!==t)o?l=l+(""!==l?" * ":"")+"("+t+")":(m.push("("+t+")"),f.push("("+t+")"));else{var b=this.getDimensionQuery(e[S],i);o?l=l+(""!==l?" * ":"")+"({"+b+"})":(m.push("("+b+")"),f.push("("+b+")"))}}S++}m.length>0&&m.length<v.length&&(m=[],f=[]),r=r+(""!==r&&m.length>0?",":"")+(m.length>0?"("+m.toString()+")":""),f.length>0&&n.push("("+f.toString()+")")}}return{query:o?l:r,collection:o?[l]:n}},e.getSlicersQuery=function(e,i){var a=this,r="",n=(0,t.extend)([],this.rows,null,!0);if(n=n.concat(this.columns),e.length>0){for(var s=0;s<e.length;){n.filter((function(t){var i=a.getDimensionUniqueName(t.name),r=a.getDimensionUniqueName(e[s].name);return i===r&&!(a.isMondrian&&""===r&&""===i)})).length>0||(void 0===e[s].name||this.filterMembers[e[s].name]?this.filterMembers[e[s].name]&&(r=r+(""!==r?" * ":"")+"{"+this.filterMembers[e[s].name].toString()+"}"):r=r+(""!==r?" * ":"")+"{"+this.getDimensionQuery(e[s],i)+"}"),s++}r=""===r?"":"\nWHERE ("+r.replace(/DrilldownLevel/g,"")+")"}return r},e.getDimensionQuery=function(e,t){var i=e.isCalculatedField?this.fieldList[e.name].tag:e.name;return this.fieldList[e.name]&&this.fieldList[e.name].hasAllMember||e.isNamedSet||e.isCalculatedField?e.isNamedSet||e.isCalculatedField?"{"+i+"}":this.isPaging?i+".CHILDREN":"DrilldownLevel({"+i+"}"+("rows"===t||"columns"===t?",,,INCLUDE_CALC_MEMBERS":"")+")":"(("+i+").levels(0).AllMembers)"},e.getDimensionUniqueName=function(e){var t=this.fieldDataObj.hierarchy,i=[];if(t){for(var a=0,r=t;a<r.length;a++){var n=r[a];n.id.toLowerCase()===e.toLowerCase()&&i.push(n)}return i.length>0?i[0].pid:""}return e.split(".")[0]},e.getMeasuresQuery=function(e){var t="";if(e.length>0){t="{{";for(var i="",a=0,r=e;a<r.length;a++){var n=r[a],s=n.isCalculatedField?this.fieldList[n.name].tag:n.name;i=i.length>0?i+", "+s:s}t=t+i+"}}"}return t},e.getfilterQuery=function(e,t){for(var i="\nFROM ["+t+"]",a="\nFROM( SELECT (",r=[],n=[],s=[],o=[],l=0,d=this.rows;l<d.length;l++){e[(m=d[l]).name]&&e[m.name].length>0&&("string"==typeof e[m.name][0]?s.push(e[m.name]):(e[m.name][1]=e[m.name][0].type,r.push(e[m.name]),delete e[m.name]))}for(var p=0,h=this.columns;p<h.length;p++){if(e[(m=h[p]).name]&&e[m.name].length>0)if("string"==typeof e[m.name][0])o.push(e[m.name]);else{var u=e[m.name];u[1]=u[0].type,r.push(e[m.name]),delete e[m.name]}}for(var c=0,g=this.filters;c<g.length;c++){for(var m=g[c],f=!1,S=0,v=this.columns;S<v.length;S++){var y=v[S];f||this.getDimensionUniqueName(y.name)!==this.getDimensionUniqueName(m.name)||e[m.name]&&(o.push(e[m.name]),f=!0)}if(!f)for(var b=0,C=this.rows;b<C.length;b++){var x=C[b];f||this.getDimensionUniqueName(x.name)!==this.getDimensionUniqueName(m.name)||e[m.name]&&(s.push(e[m.name]),f=!0)}}if((this.allowLabelFilter||this.allowValueFilter)&&r.length>0)for(var w=0,T=["Value","Label"];w<T.length;w++)for(var M=T[w],D=0,O=r;D<O.length;D++){var P=O[D];P&&2===P.length&&"string"==typeof P[1]&&P[1]===M&&n.push(this.getAdvancedFilterQuery(P[0],a,"COLUMNS"))}for(var N=0,E=o.length;N<E;N++)a=0===N?a+"{"+o[N].toString()+"}":a+",{"+o[N].toString()+"}";o.length>0&&(a=s.length>0?a+" ) ON COLUMNS ,(":a+" ) ON COLUMNS");for(N=0,E=s.length;N<E;N++)a=N>0?a+",{"+s[N].toString()+"}":a+"{"+s[N].toString()+"}";a=o.length>0&&s.length>0?a+=") ON ROWS ":0===o.length&&s.length>0?a+") ON COLUMNS ":a;var I="";return n.length>0&&(I=n.join(" ")+" "+(o.length>0||s.length>0?a:"")+" "+i+Array(n.length+1+(o.length>0||s.length>0?1:0)).join(")")),i=0===o.length&&0===s.length?i:a+i+")",I.length>0?I:i},e.getAdvancedFilterQuery=function(e,t,i){return"\nFROM (SELECT Filter("+e.selectedField+".AllMembers, "+this.getAdvancedFilterCondtions(e.name,e.condition,e.value1,e.value2,e.type,e.measure)+")) on "+i},e.getAdvancedFilterCondtions=function(e,t,i,a,r,n){var s="";switch(t){case"Equals":s="("+("Value"!==r?e+'.CurrentMember.member_caption ="'+i+'"':n+" = "+i);break;case"DoesNotEquals":s="("+("Value"!==r?e+'.CurrentMember.member_caption <>"'+i+'"':n+" <>"+i);break;case"Contains":default:s="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0';break;case"DoesNotContains":s="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'")=0';break;case"BeginWith":s="( Left ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotBeginWith":s="( Left ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"EndsWith":s="( Right ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotEndsWith":s="( Right ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"GreaterThan":s="("+("Value"!==r?e+'.CurrentMember.member_caption >"'+i+'"':n+" >"+i);break;case"GreaterThanOrEqualTo":s="("+("Value"!==r?e+'.CurrentMember.member_caption >="'+i+'"':n+" >="+i);break;case"LessThan":s="("+("Value"!==r?e+'.CurrentMember.member_caption <"'+i+'"':n+" <"+i);break;case"LessThanOrEqualTo":s="("+("Value"!==r?e+'.CurrentMember.member_caption <="'+i+'"':n+" <="+i);break;case"Between":s="("+("Value"!==r?e+'.CurrentMember.member_caption >="'+i+'"AND '+e+'.CurrentMember.member_caption <="'+a+'"':n+" >="+i+" AND "+n+" <="+a);break;case"NotBetween":s="("+("Value"!==r?e+'.CurrentMember.member_caption >="'+i+'"OR '+e+'.CurrentMember.member_caption <="'+a+'"':n+" >="+i+" OR "+n+" <="+a)}return s},e.getCalculatedFieldQuery=function(e){var i="";if(e.length>0){i="\nWITH";for(var a=0,r=e;a<r.length;a++){var n=r[a],s=(n.formula.indexOf("Measure")>-1?"[Measures].":n.hierarchyUniqueName+".")+"["+n.name+"]",o=(0,t.isNullOrUndefined)(n.formatString)?null:n.formatString;i+="\nMEMBER "+s+"as ("+n.formula+") "+((0,t.isNullOrUndefined)(o)?"":', FORMAT_STRING ="'+o.trim()+'"')}}return i},e}(),_o=function(){function e(){this.fieldList={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.enableSort=!1,this.enableValueSorting=!1,this.dataFields={},this.formatFields={},this.filterMembers={},this.drilledSets={},this.isExporting=!1,this.aggregatedValueMatrix=[],this.mappingFields={},this.formatRegex=/^(?:[ncpae])(?:([0-9]|1[0-9]|20))?$/i,this.clonedValTuple=[],this.clonedColumnTuple=[],this.clonedRowTuple=[],this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.rowStartPos=0,this.pageRowStartPos=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.gridJSON="",this.namedSetsPosition={},this.colDepth=0,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.headerGrouping={},this.lastLevel=[],this.showRowSubTotals=!0,this.showColumnSubTotals=!0,this.hideRowTotalsObject={},this.hideColumnTotalsObject={},this.sortObject={},this.isColDrill=!1}return e.prototype.renderEngine=function(e,i,a){if(this.isEmptyData=!1,this.getHeaderSortInfo=a,this.mdxQuery="",this.isMeasureAvail=!1,this.allowMemberFilter=!1,this.allowLabelFilter=!1,this.allowValueFilter=!1,this.isMondrian=!1,this.aggregatedValueMatrix=[],this.measureReportItems=[],this.calcChildMembers=[],this.selectedItems=[],this.savedFieldList=void 0,this.savedFieldListData=void 0,this.formatFields={},this.filterMembers={},this.dataFields={},this.valueAxis="",this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.pageColStartPos=0,this.sortObject={},this.globalize=new t.Internationalization,this.locale=this.globalize.culture?this.globalize.culture:"en-US",this.localeObj=i?i.localeObj:void 0,this.enableValueSorting=!!i&&i.enableValueSorting,e.url){this.dataSourceSettings=e,this.measureIndex=(0,t.isNullOrUndefined)(e.valueIndex)?-1:e.valueIndex,this.valueAxis="row"===e.valueAxis?"row":"column",this.getAxisFields(),this.formats=e.formatSettings?e.formatSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.filterSettings=e.filterSettings?e.filterSettings:[],this.sortSettings=e.sortSettings?e.sortSettings:[],this.allowMemberFilter=!!e.allowMemberFilter,this.allowLabelFilter=!!e.allowLabelFilter,this.allowValueFilter=!!e.allowValueFilter,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.pageSettings=i?i.pageSettings?i.pageSettings:this.pageSettings:void 0,this.isPaging=!(!this.pageSettings||!i.enablePaging&&!i.enableVirtualization),this.frameSortObject(),this.getFormattedFields(this.formats),this.savedFieldList=i?i.savedFieldList:void 0,this.savedFieldListData=i?i.savedFieldListData:void 0,this.fieldListData=[],this.fieldListObj={},this.setNamedSetsPosition(),this.savedFieldList&&this.savedFieldListData?this.updateFieldlist(!0):(this.getCubes(e),this.getFieldList(e)),this.loadCalculatedMemberElements(this.calculatedFieldSettings);var r=this.getMeasureInfo();this.olapVirtualization=this.isPaging&&e.showSubTotals&&r.measureIndex===("column"===r.measureAxis?e.columns.length-1:e.rows.length-1)&&!(0,t.isNullOrUndefined)(this.pageSettings)&&e.showGrandTotals,this.isPaging=this.isPaging?!this.olapVirtualization:this.isPaging,this.measureReportItems=[],this.updateFilterItems(this.filterSettings),this.generateGridData(e)}},e.prototype.generateGridData=function(e,t){var i=!(!t||"navPaging"!==t||!this.isPaging||void 0===this.pageSettings);this.rows.length>0||this.columns.length>0||this.values.length>0||this.filters.length>0?Bo.getCellSets(e,this,i):(Bo.getCellSets(e,this,!0,void 0,!0),this.generateEngine(void 0,void 0,{dataSourceSettings:e,action:"loadTableElements"}))},e.prototype.generatePagingData=function(e,t,i){var a=[].slice.call(e.querySelectorAll("Axes, CellData")),r=a[1]?a[1].querySelectorAll("FmtValue"):null;r&&r.length>0&&(this.columnCount=Number(r[0].textContent),this.rowCount=Number(r[1].textContent));var n=i.dataSourceSettings;Bo.getCellSets(n,this,!0)},e.prototype.scrollPage=function(){if(this.olapVirtualization){var e=this.getVirtualScrollingData(this.clonedColumnTuple,this.clonedRowTuple);e.isCalculated&&(this.pivotValues=[],this.clearEngineProperties(),this.performEngine(e.columnTuple,e.rowTuple,e.valueTuple)),this.pivotValues=this.pivotValues.slice()}else Bo.getCellSets(this.dataSourceSettings,this,!0)},e.prototype.getVirtualScrollingData=function(e,i){var a=this.clonedValTuple.slice(),r=!1,n=(this.pageSettings.currentColumnPage-1)*this.pageSettings.columnPageSize,s=(this.pageSettings.currentRowPage-1)*this.pageSettings.rowPageSize,o=3*this.pageSettings.columnPageSize,l=3*this.pageSettings.rowPageSize;if(n=this.columnCount<n+o?this.columnCount>o?this.columnCount-o:0:n,s=this.rowCount<s+l?this.rowCount>l?this.rowCount-l:0:s,n!==this.pageColStartPos||s!==this.pageRowStartPos||!(e.length<=o&&i.length<=l)){r=!0;var d=this.getMeasureInfo(),p=!(0,t.isNullOrUndefined)(e[0])&&0===Number(e[0].querySelectorAll("Member")[0].querySelector("LNum").textContent),h=!(0,t.isNullOrUndefined)(i[0])&&0===Number(i[0].querySelectorAll("Member")[0].querySelector("LNum").textContent),u=!!p&&n+o>=e.length-1,c=!!h&&s+l>=i.length-1,g=p?this.getAxisdepth(e):"column"===d.measureAxis?d.valueInfo.length:1,m=h?this.getAxisdepth(i):"row"===d.measureAxis?d.valueInfo.length:1,f=(p?g:0)+n,S=(h?m:0)+s,v=e.slice(f,f+o),y=i.slice(S,S+l),b=v[0]?Number(v[0].querySelectorAll("Member")[0].querySelector("LNum").textContent):0,C=y[0]?Number(y[0].querySelectorAll("Member")[0].querySelector("LNum").textContent):0,x=this.getVirtualTotals(e.slice(0,f),b,u,"column",g),w=this.getVirtualTotals(i.slice(0,S),C,c,"row",m);f=v.length+x.totalsCollection.length>o?Math.max(v.length+x.totalsCollection.length-o):0,S=y.length+w.totalsCollection.length>l?Math.max(y.length+w.totalsCollection.length-l):0,v=x.totalsCollection.concat(v.slice(f,v.length)),y=w.totalsCollection.concat(y.slice(S,y.length));var T=this.getVirtualValues(a,n+f,s+S,o,l,x.indexCollection,w.indexCollection,e.length,i.length,g,m,h);e=v.slice(),i=y.slice(),a=T.slice()}return this.pageColStartPos=n,this.pageRowStartPos=s,{columnTuple:e,rowTuple:i,valueTuple:a,isCalculated:r}},e.prototype.getAxisdepth=function(e){for(var t=0,i=0;i<e.length;i++){if(0!==Number(e[i].querySelectorAll("Member")[0].querySelector("LNum").textContent))break;t++}return t},e.prototype.getVirtualTotals=function(e,t,i,a,r){var n=[],s=[];if(1!==t)for(var o=e.length-1;o>0;o--){var l=Number(e[o].querySelectorAll("Member")[0].querySelector("LNum").textContent);if(0===l)break;if(t>l)if(t=l,Number(e[o-1].querySelectorAll("Member")[0].querySelector("LNum").textContent)===l){for(var d=0;d<r;d++)n[n.length]=e[o-d],s[s.length]=o-d;o=r>1?o-(r-1):o}else n[n.length]=e[o],s[s.length]=o;else if(1===l)break}if(i)for(o=r;o>0;o--)n=n.concat([e[o-1]]),s=s.concat([o-1]);return{totalsCollection:n.reverse(),indexCollection:s.reverse()}},e.prototype.getVirtualValues=function(e,t,i,a,r,n,s,o,l,d,p,h){var u=[],c=e;if(l>r){var g=((h?p:0)+i)*o;c=e.slice(g,g+r*o);for(var m=[],f=0;f<s.length;f++)m=m.concat(e.slice(s[f]*o,s[f]*o+o));c=m.concat(c)}f=0;for(var S=c.length/o;f<S;f++){for(var v=c.slice(f*o,f*o+o),y=v.slice(t+d,t+d+a),b=[],C=0;C<n.length;C++)b[b.length]=v[n[C]];u=u.concat(b.concat(y))}return u},e.prototype.generateEngine=function(e,i,a){"down"!==a.action&&this.clearEngineProperties(),this.xmlDoc=e?e.cloneNode(!0):void 0,this.request=i,this.customArgs=a,this.parentObjCollection={},this.curDrillEndPos=-1,this.onDemandDrillEngine=[],this.getSubTotalsVisibility(),this.xmlaCellSet=e?e.querySelectorAll("Axes, CellData"):void 0;var r=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis0"] Tuple')):[],n=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis1"] Tuple')):[],s=this.xmlaCellSet&&this.xmlaCellSet.length>1?[].slice.call(this.xmlaCellSet[1].querySelectorAll("Cell")):[];if(this.olapVirtualization&&!(0,t.isNullOrUndefined)(this.pageSettings)){if(r.length*n.length!==s.length){for(var o=[],l=0;l<s.length;l++)(0,t.isNullOrUndefined)(s[l])||(o[Number(s[l].getAttribute("CellOrdinal"))]=s[l]);s=o}this.clonedValTuple=s;var d=this.getDrillInfo("columns"),p=this.getActualTuples(r,d);d=this.getDrillInfo("rows");var h=this.getActualTuples(n,d,p.indexColls,r.length);this.clonedColumnTuple=p.tupColls,this.clonedRowTuple=h.tupColls,this.columnCount=this.clonedColumnTuple.length,this.rowCount=this.clonedRowTuple.length,p=h=void 0;var u=this.getVirtualScrollingData(this.clonedColumnTuple,this.clonedRowTuple);this.performEngine(u.columnTuple,u.rowTuple,u.valueTuple)}else this.performEngine(r,n,s)},e.prototype.getDrillInfo=function(e){var t={},i=[];if("columns"===e?i=this.dataSourceSettings.columns.map((function(e){return e.name})):"rows"===e&&(i=this.dataSourceSettings.rows.map((function(e){return e.name}))),i.length>0)for(var a=0,r=this.drilledMembers.length;a<r;a++){var n=this.drilledMembers[a],s=i.indexOf(n.name);s>-1&&(t[s]||(t[s]=[]),t[s]=t[s].concat(n.items))}return t},e.prototype.getActualTuples=function(e,t,i,a){var r=[],n=[],s=[];if(e.length>0)for(var o=function(o,d){for(var p=e[o],h=!0,u=!1,c=!1,g=p.getElementsByTagName("MEMBER_TYPE"),m=p.getElementsByTagName("UName"),f=0,S=g.length;f<S;f++){var v=Number(g[f].textContent),y=m[f].textContent;if(c&&v<2?h=!1:2===v?u=!0:u&&v<2&&(h=!1),t[f]&&t[f].indexOf(y)>-1&&(c=!0),!h)break}if(h)if(r[r.length]=p,i){var b=l.clonedValTuple.slice(o*a,o*a+a);s=s.concat(i.map((function(e){return b[e]})))}else n[n.length]=o},l=this,d=0,p=e.length;d<p;d++)o(d);else if(i){var h=this.clonedValTuple.slice(0,a);s=s.concat(i.map((function(e){return h[e]})))}return s.length>0&&(this.clonedValTuple=s),{tupColls:r,indexColls:n}},e.prototype.clearEngineProperties=function(){this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.colDepth=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.colMeasures={},this.colMeasurePos=void 0,this.rowMeasurePos=void 0,this.rowStartPos=-1},e.prototype.performEngine=function(e,i,a){this.totalCollection=[];var r=this.getMeasureInfo();if(this.drilledMembers.length>0){var n=void 0;e=(n=this.frameMeasureOrder(r,"column",e,a,e.length,e.length*i.length)).orderedHeaderTuples,a=n.orderedValueTuples,i=(n=this.frameMeasureOrder(r,"row",i,a,e.length,e.length*i.length)).orderedHeaderTuples,a=n.orderedValueTuples}"down"===this.customArgs.action&&this.updateTupCollection("row"===this.customArgs.drillInfo.axis?i.length:e.length);for(var s,o={},l=0;l<a.length;l++)(0,t.isNullOrUndefined)(a[l])||(o[this.olapVirtualization?l:Number(a[l].getAttribute("CellOrdinal"))]=a[l]);if(this.valueSortSettings.columnIndex=void 0,this.enableValueSorting&&this.valueSortSettings&&!this.isPaging&&!this.olapVirtualization&&(s=this.getValueSortInfo(e,i,r)),"down"===this.customArgs.action&&"column"!==this.customArgs.drillInfo.axis||(this.frameColumnHeader(e),this.isPaging||this.olapVirtualization||this.performColumnSorting(o,s)),"down"===this.customArgs.action&&"row"!==this.customArgs.drillInfo.axis||(this.frameRowHeader(i),this.isPaging||this.olapVirtualization||this.performRowSorting(o,s)),this.frameValues(o,e.length),this.performColumnSpanning(),!this.isPaging&&!this.olapVirtualization&&this.enableSort)for(var d=0;d<this.headerContent.length;d++)this.headerContent[d]=this.pivotValues[d];this.isEngineUpdated=!0,this.isEmptyData=0===e.length},e.prototype.getValueSortInfo=function(e,t,i){var a;if(this.valueSortSettings.headerText){var r=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),n=r.indexOf("Grand Total");if(n>-1){var s=r.join("").split(r[n]).join("");(r=[])[i.measureIndex]=s}for(var o="",l=i.measureIndex,d=0;d<this.dataSourceSettings.values.length;d++)if(l=r.indexOf(this.dataSourceSettings.values[d].caption),this.dataSourceSettings.values[d].caption===r[l]){r[l]=this.fieldList[this.dataSourceSettings.values[d].name].name,o=r[l];break}if(-1!==l){l<i.measureIndex&&(r=this.reArrangeHeaders(r,i.measureIndex,o));var p="column"===this.olapValueAxis?e:t;if(p.length>0){var h=p[0].getElementsByTagName("Member").length-(n>-1?l:0),u=this.getParentElement(p,r,h,i.measureIndex,o,n>-1)[0];a=p.indexOf(u)}}}return{memberIndex:a,columnLength:e.length,rowLength:t.length,isValueSorting:a>-1}},e.prototype.getParentElement=function(e,i,a,r,n,s){for(var o=[],l=0,d=!1,p=!1,h=e[0].getElementsByTagName("Member").length-a,u=0;u<e.length;u++){if((0,t.isNullOrUndefined)(e[u].getElementsByTagName("Member")[h])){o=[];break}var c=e[u].getElementsByTagName("UName")[h].textContent,g=e[u].getElementsByTagName("Caption")[h].textContent,m=Number(e[u].getElementsByTagName("LNum")[h].textContent),f=c===i[h]||g===i[h]||(0,t.isNullOrUndefined)(i[h])&&0===m;if(f){if(o[o.length]=e[u],d=!0,l=m,s)break}else{if(d&&l<m){for(var S=[],v=u;v<e.length;v++){var y=e[v].getElementsByTagName("UName")[h].textContent,b=e[v].getElementsByTagName("Caption")[h].textContent,C=Number(e[v].getElementsByTagName("LNum")[h].textContent),x=y===i[h+1]||b===i[h+1]||(0,t.isNullOrUndefined)(i[h+1])&&0===C;if(l+1===C&&x)S[S.length]=e[v],p=!0;else if(l+1<C){if(!p)break;S[S.length]=e[v]}else if(l+1>C)break}if(p){var w=i.slice(0,h).concat(i.slice(h+1,i.length));w.indexOf(n)<r&&(w=this.reArrangeHeaders(w,r,n)),o=this.getParentElement(S,w,S[0].getElementsByTagName("Member").length,r,n)}break}if(d&&!f)break}}return s||h<i.length-1&&o.length>0&&!p&&(o=this.getParentElement(o,i,a-1,r,n)),o},e.prototype.reArrangeHeaders=function(e,t,i){var a=e.indexOf(i),r=e.slice(0,a),n=e.slice(a+1,e.length);return r[t]=e[a],r.concat(n)},e.prototype.getSubTotalsVisibility=function(){this.showRowSubTotals=this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals,this.showColumnSubTotals=this.dataSourceSettings.showColumnSubTotals&&this.dataSourceSettings.showSubTotals,this.showSubTotalsAtTop=this.showColumnSubTotals&&"Top"===this.dataSourceSettings.subTotalsPosition,this.showSubTotalsAtBottom=this.showRowSubTotals&&"Bottom"===this.dataSourceSettings.subTotalsPosition,this.hideRowTotalsObject={},this.hideColumnTotalsObject={};var e=1;do{if(1===e){if(this.showColumnSubTotals)for(var t=0;t<this.dataSourceSettings.columns.length;t++)!1===this.dataSourceSettings.columns[t].showSubTotals&&(this.hideColumnTotalsObject[this.dataSourceSettings.columns[t].name]=t)}else if(this.showRowSubTotals)for(var i=0;i<this.dataSourceSettings.rows.length;i++)!1===this.dataSourceSettings.rows[i].showSubTotals&&(this.hideRowTotalsObject[this.dataSourceSettings.rows[i].name]=i);e++}while(e<3)},e.prototype.frameRowHeader=function(e){var t=this;this.headerGrouping={},this.lastLevel=[];var i=!0,a=this.pivotValues.length,r=[],n=[];"down"!==this.customArgs.action?(r=this.pivotValues,n=this.valueContent):a=this.customArgs.drillInfo.currentCell.rowIndex+1,this.rowStartPos=this.rowStartPos>0?this.rowStartPos:a;for(var s,o,l,d,p=0,h=[],u={},c=[],g=!1,m=-1,f=-1,S=[],v=[{actualText:"Grand Total",axis:"row",colIndex:0,formattedText:"Grand Total",hasChild:!1,level:-1,rowIndex:0,index:[],type:"grand sum",ordinal:0,colSpan:1,rowSpan:1,memberType:2,isDrilled:!1,valueSort:{"Grand Total":1,levelName:"Grand Total"}}],y=[],b=this.customArgs.drillInfo&&"row"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;p<e.length;){var C=e[p].querySelectorAll("Member");y=this.frameTupCollection(C,y,p+b,this.tupRowInfo,this.showRowSubTotals,this.hideRowTotalsObject,"row"),p++}p=0;var x=e.length;if("down"===this.customArgs.action){var w=this.customArgs.drillInfo.currentCell.ordinal+1;p=w,x+=w,o=this.tupRowInfo[w-1].allCount,s=this.tupRowInfo[w-1].allStartPos,d=this.tupRowInfo[w-1]}for(var T=p,M=0,D=!1,O=[];p<x;){C=e["down"===this.customArgs.action?p-(this.customArgs.drillInfo.currentCell.ordinal+1):p].querySelectorAll("Member");var P=0,N=void 0,E=this.tupRowInfo[p].allCount,I=this.tupRowInfo[p].allStartPos,F=this.tupRowInfo[p].measure,L=this.tupRowInfo[p].typeCollection,A=this.tupRowInfo[p].drillStartPos,R=this.tupRowInfo[p].startDrillUniquename;if(0===p||p===T){for(var k="down"===this.customArgs.action?this.tupRowInfo[0].members:C;P<k.length;)"1"===k[P].querySelector("MEMBER_TYPE").textContent&&0===Number(k[P].querySelector("LNum").textContent)?S[P]=0:S[P]=Number(k[P].querySelector("LNum").textContent),"1"===k[P].querySelector("MEMBER_TYPE").textContent?(u[P]=0,m=-1===m?P:m,f=P):(u[P]=1,g="3"!==k[P].querySelector("MEMBER_TYPE").textContent||g),P++;l=L.indexOf("3")}if(P=0,0===p&&(C.length>E+(F?1:0)||1===C.length&&F)&&v.pop(),0===p&&this.isPaging?0===v.length:!g||E===o||I!==s||1===C.length&&F){var j=this.checkAttributeDrill(this.tupRowInfo[p].drillInfo,"rows"),q=!(A>-1)||(!(E>0)||(j||I>A));q=d&&q&&A>-1?d.startDrillUniquename!==R||!(f>d.measurePosition||d.measureName===this.tupRowInfo[p].measureName||I!==A+1&&this.tupRowInfo[p].measurePosition!==A+1):q;var H=!(m>-1&&E>0)||(j||I>f);if((D="Top"===this.dataSourceSettings.grandTotalsPosition&&0===this.olapRowValueIndex&&"row"===this.olapValueAxis&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&("row"!==this.olapValueAxis||this.dataSourceSettings.rows.length>1))&&1===v.length&&(v=this.frameGrandTotalValues(e,v,L,l)),C.length===E+(F?1:0)&&F&&!D){var V="Grand Total"+this.valueSortSettings.headerDelimiter+this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption:0,U="3"===L[l]&&this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(C[l].querySelector("UName").textContent)].caption:C[l].querySelector("Caption").textContent;(v=this.frameGrandTotalAxisSet(v,this.getUniqueName(C[l].querySelector("UName").textContent),U,a,p,Number(L[l]),C[l].querySelector("PARENT_UNIQUE_NAME")?C[l].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,C[l].querySelector("LName").textContent,C[l].getAttribute("Hierarchy"),{levelName:V,axis:C[l].getAttribute("Hierarchy")}))[v.length-1].valueSort[V]=1}else if(0!==I&&(0!==l||1!==I)&&q&&H){"Top"===this.dataSourceSettings.grandTotalsPosition&&i&&this.dataSourceSettings.showGrandTotals&&("row"!==this.olapValueAxis||this.dataSourceSettings.rows.length>1)&&(this.insertRowGrandTotal(v,n,r,e,a),a=this.pivotValues.length,i=!1),d=this.tupRowInfo[p];var B=a,_=P;N={};for(var G=!1;P<C.length;){var z=C[P];if(z.querySelector("UName").textContent!==h[P]&&"2"!==L[P]&&(!(Object.keys(N).length>0?N.isDrilled&&!this.fieldList[N.hierarchy].isHierarchy:G)||"3"===L[P]&&u[P-1]&&0!==u[P+1])){var W=Number(z.querySelector("LNum").textContent)-(u[P]&&"3"!==L[P]?1:S[P]),Q=!!this.namedSetsPosition.row[P],Y=this.getUniqueName(z.querySelector("UName").textContent),K=this.getDepth(this.tupRowInfo[p],Y,Number(L[P]));V=this.getCaptionCollectionWithMeasure(this.tupRowInfo[p],P);if(this.showSubTotalsAtBottom&&a>this.rowStartPos&&(B=a=this.insertRowSubTotal(r,n,O,a,W,V)),!(this.isPaging&&r[M][0]&&this.fieldList[r[M][0].hierarchy]&&this.fieldList[r[M][0].hierarchy].isHierarchy&&r[M][0].hasChild&&!r[M][0].isDrilled&&!this.rows[P].isNamedSet&&(0===this.rows[P].name.indexOf("[Measures]")||this.fieldList[z.getAttribute("Hierarchy")]&&(this.fieldList[z.getAttribute("Hierarchy")].isHierarchy||this.fieldList[z.getAttribute("Hierarchy")].hasAllMember))&&r[M][0].depth<K)){r[a]=[{axis:"row",actualText:Y,colIndex:0,formattedText:"3"===L[P]&&this.dataFields[Y]&&this.dataFields[Y].caption?this.dataFields[Y].caption:z.querySelector("Caption").textContent,hasChild:!!(this.fieldList[z.getAttribute("Hierarchy")]&&this.fieldList[z.getAttribute("Hierarchy")].isHierarchy&&P<this.rows.length-1&&!this.rows[P+1].isNamedSet&&this.rows[P+1].name.indexOf("[Measures]")<0&&this.fieldList[this.rows[P+1].name]&&this.fieldList[this.rows[P+1].name].hasAllMember)||Number(z.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:W,depth:K,rowIndex:a,index:[],ordinal:p,type:"header",colSpan:1,rowSpan:1,memberType:Number(L[P]),isDrilled:!(!this.fieldList[z.getAttribute("Hierarchy")]||!this.fieldList[z.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(z.getAttribute("Hierarchy"),this.tupRowInfo[p].drillInfo,"rows"))||this.tupRowInfo[p].drillInfo[P].isDrilled,parentUniqueName:z.querySelector("PARENT_UNIQUE_NAME")?z.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:z.querySelector("LName").textContent,hierarchy:z.getAttribute("Hierarchy"),isNamedSet:Q,valueSort:{levelName:"",axis:z.getAttribute("Hierarchy")}}],this.olapVirtualization&&"header"===r[a][0].type&&delete r[a][0].type,(N="3"!==L[P]?r[a][0]:N)||c.push(z.querySelector("Caption").textContent),r[a][0].valueSort.levelName=V,r[a][0].valueSort[V]=1,n[a-this.rowStartPos]={},n[a-this.rowStartPos][0]=r[a][0],F&&l>P&&(h[l]="");for(var X=P+1;X<C.length;X++)h[X]="";h[P]=z.querySelector("UName").textContent,M=3!==Number(L[P])?a:M,a++,_=P}}else"2"===L[P]?_=P:this.tupRowInfo[p].drillInfo[P].isDrilled&&0===u[P]&&(G=!0);this.tupRowInfo[p].drillInfo[P].isDrilled&&this.tupRowInfo[p].showTotals&&(this.tupRowInfo[p].showTotals=!!this.showRowSubTotals&&void 0===this.hideRowTotalsObject[this.tupRowInfo[p].drillInfo[P].hierarchy]),P++}B<a&&_>=C.length-1&&(r[a-1][0].ordinal=p,"header"===r[a-1][0].type&&delete r[a-1][0].type)}o=E,s=I}p++}this.showSubTotalsAtBottom&&O.length>0&&(O.reverse(),O.forEach((function(e){r[a]=[e],n[a-t.rowStartPos]={},n[a-t.rowStartPos][0]=r[a][0],a++}))),("Top"!==this.dataSourceSettings.grandTotalsPosition||"row"===this.olapValueAxis&&1===this.dataSourceSettings.rows.length&&"Top"===this.dataSourceSettings.grandTotalsPosition||0===this.dataSourceSettings.rows.length)&&this.insertRowGrandTotal(v,n,r,e,a)},e.prototype.insertRowSubTotal=function(e,t,i,a,n,s){var o=r.frameHeaderWithKeys(e[a-1][0]);if(o.level<n&&"grand sum"!==o.type&&(o.isDrilled||3===o.memberType))if(3===o.memberType){for(var l=[],d=1;3===e[a-d][0].memberType;)l[l.length]=e[a-d][0],d++;if(e[a-d][0].isDrilled&&0!==l.length){for(var p=0,h=l.length;p<h;p++)l[p].formattedText=e[a-d][0].formattedText+" "+l[p].formattedText,l[p].isSum=!0,l[p].type="sum",l[p].parentUniqueName=e[a-d][0].levelUniqueName,i[i.length]=l[p];a-=--d}}else o.hasChild=!1,o.isDrilled=!1,o.isSum=!0,o.type="sum",o.formattedText=o.formattedText+" Total",i[Object.keys(i).length]=o;if(i.length>0)for(var u=i.length-1,c=i[u].valueSort.levelName.split(".").length,g=s.split(".").length;c>=g&&(e[a]=[i[u]],t[a-this.rowStartPos]={},t[a-this.rowStartPos][0]=e[a][0],a++,i.splice(i.length-1,1),Object.keys(i).length>0);)c=i[--u].valueSort.levelName.split(".").length;return a},e.prototype.insertRowGrandTotal=function(e,t,i,a,r){if(e.length>1&&3!==e[0].memberType&&(e[0].ordinal=-1),"down"!==this.customArgs.action){var n=0===this.dataSourceSettings.rows.length||1===this.dataSourceSettings.rows.length&&"[Measures]"===this.dataSourceSettings.rows[0].name;if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals||n)for(var s=0;s<e.length;s++)e[s].rowIndex=r,i[r]=[e[s]],t[r-this.rowStartPos]={},t[r-this.rowStartPos][0]=i[r][0],r++}else this.updateRowEngine(i,t,a.length),this.onDemandDrillEngine=i;return e},e.prototype.frameGrandTotalAxisSet=function(e,t,i,a,r,n,s,o,l,d){return e.push({axis:"row",actualText:t,colIndex:0,formattedText:i,hasChild:!1,level:-1,rowIndex:a,index:[],ordinal:r,colSpan:1,rowSpan:1,memberType:n,isDrilled:!1,parentUniqueName:s,levelUniqueName:o,hierarchy:l,valueSort:d}),e},e.prototype.getDepth=function(e,t,i){var a=e.uNameCollection.indexOf(t),r=(e.uNameCollection.substring(0,a)+(3===i?"":t)).split("::[").map((function(e){return"["===e[0]?e:"["+e}));3===i&&this.rowMeasurePos===r.length&&r.push(t);for(var n=-1,s=0;s<r.length;s++){n+=r[s].split("~~").length}return n},e.prototype.checkAttributeDrill=function(e,t){for(var i=!1,a=0;a<e.length&&!(i=this.isAttributeDrill(e[a].hierarchy,e,t));a++);return i},e.prototype.frameTupCollection=function(e,i,a,r,n,s,o){for(var l,d,p,h,u,c,g=0,m=0,f=[],S=[],v=[],y="",b="",C=!0,x=-1;g<e.length;){var w=e[g],T=Number(w.querySelector("LNum").textContent),M=w.querySelector("UName").textContent;Number(w.querySelector("MEMBER_TYPE").textContent)>3&&(w.querySelector("MEMBER_TYPE").textContent=0===M.indexOf("[Measures]")?"3":"1");var D=0===M.indexOf("[Measures]")?"3":Number(w.querySelector("MEMBER_TYPE").textContent)>3?"1":w.querySelector("MEMBER_TYPE").textContent,O=w.querySelector("Caption").textContent;this.fieldList[O]&&"CalculatedField"===this.fieldList[O].type&&(O=this.fieldList[O].caption,w.querySelector("Caption").textContent=O);var P=w.getAttribute("Hierarchy"),N=w.querySelector("PARENT_UNIQUE_NAME")?w.querySelector("PARENT_UNIQUE_NAME").textContent:"";if("2"===D?(this.isPaging||m++,p=(0,t.isNullOrUndefined)(p)?g:p):"3"===D?(h=w,u=M,c=g,"column"===o?(this.colMeasures[M]=w,this.colMeasurePos=g):this.rowMeasurePos=g):x=s[P],"2"!==D){if(this.headerGrouping[g]){if(T>this.lastLevel[g])this.lastLevel[g]=T;else if(T<this.lastLevel[g]){for(var E=this.lastLevel[g];E>=T;)delete this.headerGrouping[g].UName[E],delete this.headerGrouping[g].Caption[E],E--;this.lastLevel[g]=T}this.headerGrouping[g].UName[T]=M,this.headerGrouping[g].Caption[T]=O}else this.lastLevel[g]=T,this.headerGrouping[g]={UName:(l={},l[T]=M,l),Caption:(d={},d[T]=O,d)};if(this.isPaging)for(var I=N;this.drilledSets[I];){var F=this.drilledSets[I].querySelector("Caption").textContent,L=Number(this.drilledSets[I].querySelector("LNum").textContent);this.headerGrouping[g].UName[L]=I,this.headerGrouping[g].Caption[L]=F,I=null===this.drilledSets[I].querySelector("PARENT_UNIQUE_NAME")?"":this.drilledSets[I].querySelector("PARENT_UNIQUE_NAME").textContent}for(var A="",R=Object.keys(this.headerGrouping[g].UName),k=0;k<R.length;k++){var j=R[k];A=0===k?this.headerGrouping[g].UName[Number(j)]:A+"~~"+this.headerGrouping[g].UName[Number(j)]}y=""===y?A:y+"::"+A;var q="",H=Object.keys(this.headerGrouping[g].Caption);for(k=0;k<H.length;k++){j=H[k];q=0===k?this.headerGrouping[g].Caption[Number(j)]:q+"~~"+this.headerGrouping[g].Caption[Number(j)]}g!==c&&(b=""===b?q:b+"::"+q)}if(f.push(D),S.push(T),((0,t.isNullOrUndefined)(i[g])||i[g]<T)&&(i[g]=T),v.push({level:T,uName:M,hierarchy:P,isDrilled:!1}),r[a-1]&&"1"===r[a-1].typeCollection[g]&&v[g].level>r[a-1].drillInfo[g].level){var V=y.split(/~~|::\[/).map((function(e){return"["===e[0]?e:"["+e}));V.pop();var U=V.join("~~");this.setDrillInfo(N,U,g,a,r)}g++}return x>-1&&(C="2"!==f[x+1]),r[a]={allCount:m,allStartPos:p,measure:h,measureName:u,measurePosition:c,members:e,typeCollection:f,uNameCollection:y,captionCollection:b,levelCollection:S,drillInfo:v,drillStartPos:-1,drillEndPos:-1,showTotals:!(!n&&m>0&&p>(0===c?1:0))&&C},i},e.prototype.getCaptionCollectionWithMeasure=function(e,t){var i=e.captionCollection,a=!0;if("3"!==e.typeCollection[t])for(var r=0;r<this.measurePosition;r++)if(e.drillInfo[t].hierarchy===this.dataSourceSettings.rows[r].name){a=!1;break}if(e.measure&&a){var n=this.getUniqueName(e.measure.querySelector("UName").textContent),s=this.dataFields[n]&&this.dataFields[n].caption?this.dataFields[n].caption:e.measure.querySelector("Caption").textContent,o=e.uNameCollection.split(/[~~::]+/g).indexOf(e.measureName);(l=e.captionCollection.split(/[~~::]+/g)).splice(o,0,s),i=l.join(this.valueSortSettings.headerDelimiter)}else{var l;i=(l=e.captionCollection.split(/[~~::]+/g)).join(this.valueSortSettings.headerDelimiter)}return i},e.prototype.setNamedSetsPosition=function(){this.namedSetsPosition={};var e=0;do{for(var t={},i=e?this.dataSourceSettings.rows:this.dataSourceSettings.columns,a=0;a<i.length;a++)i[a].isNamedSet&&(t[a]=i[a].name);this.namedSetsPosition[e?"row":"column"]=t,e++}while(e<2)},e.prototype.updateRowEngine=function(e,t,i){for(var a=this.pivotValues.length-1,r=Object.keys(e).length;a>this.customArgs.drillInfo.currentCell.rowIndex;)this.pivotValues[a+r]=this.pivotValues[a],this.pivotValues[a+r][0].ordinal+=i,this.pivotValues[a+r][0].rowIndex+=r,this.valueContent[a+r-this.rowStartPos]=this.valueContent[a-this.rowStartPos],a--;for(var n=0;n<e.length;n++)this.pivotValues[n]=e[n],this.valueContent[Number(n)-this.rowStartPos]=t[Number(n)-this.rowStartPos];this.pivotValues[this.customArgs.drillInfo.currentCell.rowIndex][0].isDrilled=!0},e.prototype.updateTupCollection=function(e){for(var t="row"===this.customArgs.drillInfo.axis?this.tupRowInfo:this.tupColumnInfo,i=t.length-1;i>this.customArgs.drillInfo.currentCell.ordinal;)t[i+e]=t[i],i--},e.prototype.frameGrandTotalValues=function(e,t,i,a){for(var r=0,n=!1;r<e.length&&!n;){var s=e["down"===this.customArgs.action?r-(this.customArgs.drillInfo.currentCell.ordinal+1):r].querySelectorAll("Member"),o=this.tupRowInfo[r].allCount,l=this.tupRowInfo[r].allStartPos,d=this.tupRowInfo[r].measure,p=this.tupRowInfo[r].typeCollection;this.tupRowInfo[r].drillStartPos,this.tupRowInfo[r].startDrillUniquename;if(0===r&&(s.length>o+(d?1:0)||1===s.length&&d)&&t.pop(),0!==r||!this.isPaging||0===t.length){this.checkAttributeDrill(this.tupRowInfo[r].drillInfo,"rows");if(s.length===o+(d?1:0)&&d){var h="Grand Total"+this.valueSortSettings.headerDelimiter+s[a].querySelector("Caption").textContent,u="3"===p[a]&&this.dataFields[this.getUniqueName(s[a].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(s[a].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(s[a].querySelector("UName").textContent)].caption:s[a].querySelector("Caption").textContent;(t=this.frameGrandTotalAxisSet(t,this.getUniqueName(s[a].querySelector("UName").textContent),u,this.pivotValues.length,r,Number(p[a]),s[a].querySelector("PARENT_UNIQUE_NAME")?s[a].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,s[a].querySelector("LName").textContent,s[a].getAttribute("Hierarchy"),{levelName:h,axis:s[a].getAttribute("Hierarchy")}))[t.length-1].valueSort["Grand Total"+this.valueSortSettings.headerDelimiter+s[a].querySelector("Caption").textContent]=1}l}n=this.dataSourceSettings.values.length+1===t.length,r++}return t},e.prototype.frameColumnHeader=function(e){var t=this;this.headerGrouping={},this.lastLevel=[];for(var i=0,a=[],r=[],n=[],s=-1,o=-1,l=this.customArgs.drillInfo&&"column"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;i<e.length;){var d=e[i].querySelectorAll("Member");a=this.frameTupCollection(d,a,i+l,this.tupColumnInfo,this.showColumnSubTotals,this.hideColumnTotalsObject,"column"),i++}if(this.olapVirtualization&&(a=a.slice(0,a.length-1).map((function(e){return 0===e?1:e})).concat(a.slice(a.length-1))),e.length>0){d=e[0].querySelectorAll("Member");for(var p=0;p<d.length;)n[p]="1"===d[p].querySelector("MEMBER_TYPE").textContent&&0===Number(d[p].querySelector("LNum").textContent)?0:Number(d[p].querySelector("LNum").textContent),"1"!==d[p].querySelector("MEMBER_TYPE").textContent||!this.isPaging&&0!==Number(d[p].querySelector("LNum").textContent)?r[p]=1:(r[p]=0,s=-1===s?p:s,o=p),p++}i=0;for(var h,u=1,c={},g=!0,m=!1,f=function(){var l=e[i].querySelectorAll("Member"),d=S.tupColumnInfo[i].allCount,p=S.tupColumnInfo[i].allStartPos,f=S.tupColumnInfo[i].measure,v=S.tupColumnInfo[i].typeCollection,y=S.tupColumnInfo[i].drillInfo,b=S.tupColumnInfo[i].drillStartPos,C=S.tupColumnInfo[i].startDrillUniquename,x=S.tupColumnInfo[i].endDrillUniquename,w=S.tupColumnInfo[i].drillEndPos,T=S.tupColumnInfo[i].levelCollection,M="2"!==v[0]&&("3"!==v[0]||"2"!==v[1]),D=0;a.map((function(e,i){D+=0===r[i]?e+(1-(n[i]>1?1:n[i])):0===e?t.isPaging&&"2"===v[i]?0:1:e})),S.colDepth=S.colDepth>D?S.colDepth:D,0===i&&l.length>d+(f?1:0)&&(m=!0,M=d>0&&M?p>s:M);var O=!1;if("Top"===S.dataSourceSettings.grandTotalsPosition&&S.dataSourceSettings.showGrandTotals&&S.dataSourceSettings.showColumnGrandTotals){for(var P=0,N=0;N<l.length;N++)0===l[N].querySelector("Caption").textContent.indexOf("All")&&P++;O=P===("column"===S.olapValueAxis?S.dataSourceSettings.columns.length-1:S.dataSourceSettings.columns.length)}if((M||O)&&(0===d||O)){var E=[-1,-1,-1];S.tupColumnInfo[i-1]&&0===S.tupColumnInfo[i-1].allCount?E=S.levelCompare(T,S.tupColumnInfo[i-1].levelCollection):m&&h&&(E=S.levelCompare(T,h.levelCollection)),S.tupColumnInfo[i].drillStartPos<0||S.showSubTotalsAtTop?(!g&&E[0]>-1&&E[2]>-1&&(u=S.mergeTotCollection(u,d,a,n,r,p,y,E)),S.setParentCollection(l),S.frameCommonColumnLoop(l,i,u,a,r,n),S.tupColumnInfo[i].showTotals||u--,!g&&E[0]>-1&&E[2]>-1&&(u=S.mergeTotCollection(u,d,a,n,r,p,y,E)),g=!1,S.isColDrill?S.isColDrill=!1:u++):c.drillStartPos===b&&c.startDrillUniquename===C&&c.allCount!==d||(!g&&E[0]>-1&&E[2]>-1&&(u=S.mergeTotCollection(u,d,a,n,r,p,y,E),g=!0),S.setParentCollection(l),(!m||o<=b)&&(O||(S.totalCollection[S.totalCollection.length]={allCount:d,ordinal:i,members:l,drillInfo:y}),c.allCount=d,c.allStartPos=p,c.drillStartPos=b,c.startDrillUniquename=C,c.endDrillUniquename=x)),h=S.tupColumnInfo[i]}var I=S.checkAttributeDrill(S.tupColumnInfo[i].drillInfo,"columns");if(d>0&&(!m||M&&(I||o<p))&&(d===c.allCount||p!==c.allStartPos)){var F=w===b||c.endDrillUniquename===x,L=p!==c.allStartPos?c.startDrillUniquename!==C:F;b>-1&&!L||(g||(u=S.mergeTotCollection(u,d,a,n,r,p,y),g=!0),S.setParentCollection(l),m&&b>-1&&!(o<=b)||(O||(S.totalCollection[S.totalCollection.length]={allCount:d,ordinal:i,members:l,allStartPos:p,drillInfo:y}),c.allCount=d,c.allStartPos=p,c.drillStartPos=b,c.startDrillUniquename=C,c.endDrillUniquename=x))}i++},S=this;i<e.length;)f();if(this.totalCollection.length>0)if(Object.keys(this.colMeasures).length>1)this.orderTotals(u,a,r,n);else{this.totalCollection=this.totalCollection.reverse();for(var v=0,y=this.totalCollection;v<y.length;v++){var b=y[v];if(!(0===this.tupColumnInfo[b.ordinal].measurePosition?1===this.tupColumnInfo[b.ordinal].allStartPos:0===this.tupColumnInfo[b.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){this.frameCommonColumnLoop(b.members,b.ordinal,u,a,n,r);var C=this.checkAttributeDrill(this.tupColumnInfo[b.ordinal].drillInfo,"columns");(this.tupColumnInfo[b.ordinal].showTotals||C)&&u++}}}},e.prototype.orderTotals=function(e,t,i,a){for(var r={},n=1,s=0,o=this.totalCollection;s<o.length;s++){var l=o[s];if(!(0===this.tupColumnInfo[l.ordinal].measurePosition?1===this.tupColumnInfo[l.ordinal].allStartPos:0===this.tupColumnInfo[l.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){var d=this.tupColumnInfo[l.ordinal].measure.querySelector("UName").textContent;r[d]?(r[d].coll.push(l),r[d].count++,n=n<r[d].count?r[d].count:n):r[d]={coll:[l],count:1}}}for(var p=Object.keys(r),h=n-1;h>-1;){for(var u=0,c=p;u<c.length;u++){(l=r[c[u]].coll[h])&&(this.frameCommonColumnLoop(l.members,l.ordinal,e,t,i,a),this.tupColumnInfo[l.ordinal].showTotals&&e++)}h--}},e.prototype.setParentCollection=function(e){for(var t=0;e.length>t;){var i=e[t],a=Number(i.querySelector("MEMBER_TYPE").textContent)>2?"3":i.querySelector("MEMBER_TYPE").textContent,r=Number(i.querySelector("LNum").textContent),n=i.querySelector("UName").textContent,s=i.querySelector("PARENT_UNIQUE_NAME")?i.querySelector("PARENT_UNIQUE_NAME").textContent:"",o=!0,l=!1;if(this.parentObjCollection[t]){var d=Object.keys(this.parentObjCollection[t]),p=this.parentObjCollection[t][r-1];o=p?s===p.querySelector("UName").textContent:0===d.length,l="1"===this.tupColumnInfo[0].typeCollection[t]}"2"===a?delete this.parentObjCollection[t]:(!this.isPaging&&!l||o||delete this.parentObjCollection[t],this.parentObjCollection[t]?this.parentObjCollection[t][r]&&this.parentObjCollection[t][r].querySelector("UName").textContent===n||(this.parentObjCollection[t][r]=i):(this.parentObjCollection[t]={},this.parentObjCollection[t][r]=i)),t++}},e.prototype.setDrillInfo=function(e,t,i,a,r){for(a--;r[a]&&r[a].drillInfo[i].uName===e;){if(r[a].uNameCollection.split(/~~|::\[/).map((function(e){return"["===e[0]?e:"["+e})).join("~~").indexOf(t)<0)break;r[a].drillInfo[i].isDrilled=!0,this.curDrillEndPos<=i&&(r[a].drillEndPos=this.curDrillEndPos=i,r[a].endDrillUniquename=e),(r[a].drillStartPos>i||-1===r[a].drillStartPos)&&(r[a].drillStartPos=i),r[a].startDrillUniquename=e,a--}},e.prototype.levelCompare=function(e,t){for(var i=[-1,0],a=0;a<t.length;a++)if(e[a]!==t[a]){i=[a,e[a],t[a]-e[a]];break}return i},e.prototype.mergeTotCollection=function(e,i,a,r,n,s,o,l){for(var d=(0,t.isNullOrUndefined)(s)?l[0]:s-(this.colMeasurePos===s-1?2:1),p=o[d]&&o[d].level,h=this.getLevelsAsString(d-1,o),u={},c=1,g=!1,m=0,f=this.totalCollection;m<f.length;m++){var S=f[m];if(g||S.allCount<=i&&(!(p>-1&&S.drillInfo[d])||S.drillInfo[d].level>=p&&this.getLevelsAsString(d-1,S.drillInfo)===h)){var v=this.tupColumnInfo[S.ordinal].measure?this.tupColumnInfo[S.ordinal].measure.querySelector("UName").textContent:"measure";u[v]?(u[v].coll.push(S),u[v].count++,c=c<u[v].count?u[v].count:c):u[v]={coll:[S],count:1},g=!1}}for(var y=Object.keys(u),b=c-1;b>-1;){for(var C=0,x=y;C<x.length;C++){var w=u[x[C]].coll[b];if(w)(!(0===this.tupColumnInfo[w.ordinal].measurePosition?1===this.tupColumnInfo[w.ordinal].allStartPos:0===this.tupColumnInfo[w.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals)&&(this.frameCommonColumnLoop(w.members,w.ordinal,e,a,n,r),this.tupColumnInfo[w.ordinal].showTotals&&e++),this.totalCollection.pop()}b--}return e},e.prototype.getLevelsAsString=function(e,t){for(var i=[],a=0;a<e;a++)i[a]=t[a].level;return i.length>0?i.toString():""},e.prototype.frameCommonColumnLoop=function(e,t,i,a,r,n){var s,o=-1;if(this.tupColumnInfo[t].showTotals)for(var l=0,d=0;l<e.length;)d+=n[l]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==l?a[l]:a[l]+(1-r[l]),this.tupColumnInfo[t].drillInfo[l].isDrilled&&this.tupColumnInfo[t].showTotals&&(this.tupColumnInfo[t].showTotals=!!this.showColumnSubTotals&&void 0===this.hideColumnTotalsObject[this.tupColumnInfo[t].drillInfo[l].hierarchy],d-=a[l]-this.tupColumnInfo[t].levelCollection[l],o=this.tupColumnInfo[t].showTotals?-1:d-1),l++;var p=this.checkAttributeDrill(this.tupColumnInfo[t].drillInfo,"columns");if(this.tupColumnInfo[t].showTotals||p)for(var h=0,u=0,c={},g="0"===e[0].querySelector("LNum").textContent;h<e.length;){for(var m=e[h],f=Number(m.querySelector("MEMBER_TYPE").textContent)>2?"3":m.querySelector("MEMBER_TYPE").textContent,S=0,v=m.querySelector("LNum").textContent,y="2"!==f?n[h]?1:r[h]:1;y<=("3"===f?1:a[h]);y++){var b=!1;this.pivotValues[u]||(this.pivotValues[u]=[]),Number(e[h].querySelector("LNum").textContent)>y&&"2"!==f?(this.parentObjCollection[h][y]||this.getDrilledParent(e[h],y,this.parentObjCollection[h]),this.parentObjCollection[h][y]&&(m=this.parentObjCollection[h][y]),b=!0):(m=e[h],S++);var C=this.getUniqueName(m.querySelector("UName").textContent);"2"!==f?c[C]="3"===f&&this.dataFields[C]&&this.dataFields[C].caption?this.dataFields[C].caption:m.querySelector("Caption").textContent:"2"===f&&"0"===v&&g&&(c[C]="Grand Total",g=!1);for(var x=Object.keys(c),w=h>=this.measurePosition&&0===Number(m.getElementsByTagName("LNum")[0].textContent)&&1===x.length?"Grand Total"+this.valueSortSettings.headerDelimiter:"",T=0;T<x.length;T++){var M=x[T];0===T?w+=c[M]:w=w+this.valueSortSettings.headerDelimiter+c[M]}var D=!!this.namedSetsPosition.column[h],O=this.getDepth(this.tupColumnInfo[t],C,Number(f));if(this.isPaging&&this.pivotValues[u-1]&&this.pivotValues[u-1][i]&&this.fieldList[this.pivotValues[u-1][i].hierarchy]&&this.fieldList[this.pivotValues[u-1][i].hierarchy].isHierarchy&&this.pivotValues[u-1][i].hasChild&&!this.pivotValues[u-1][i].isDrilled&&!this.columns[h].isNamedSet&&this.fieldList[m.getAttribute("Hierarchy")]&&(this.fieldList[m.getAttribute("Hierarchy")].isHierarchy||this.fieldList[m.getAttribute("Hierarchy")].hasAllMember)&&this.pivotValues[u-1][i].depth<O){this.isColDrill=!0;break}this.pivotValues[u][i]={axis:"column",actualText:C,colIndex:i,formattedText:"3"===f&&this.dataFields[C]&&this.dataFields[C].caption?this.dataFields[C].caption:m.querySelector("Caption").textContent,hasChild:!!(this.fieldList[m.getAttribute("Hierarchy")]&&this.fieldList[m.getAttribute("Hierarchy")].isHierarchy&&h<this.columns.length-1&&!this.columns[h+1].isNamedSet&&this.columns[h+1].name.indexOf("[Measures]")<0&&this.fieldList[this.columns[h+1].name]&&this.fieldList[this.columns[h+1].name].hasAllMember)||Number(m.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:S>1?-1:Number(m.querySelector("LNum").textContent)-(n[h]&&"3"!==f?1:0),rowIndex:u,ordinal:t,memberType:Number(f),depth:O,isDrilled:!(!this.fieldList[m.getAttribute("Hierarchy")]||!this.fieldList[m.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(m.getAttribute("Hierarchy"),this.tupColumnInfo[t].drillInfo,"columns"))||(b||this.tupColumnInfo[t].drillInfo[h].isDrilled),parentUniqueName:m.querySelector("PARENT_UNIQUE_NAME")?m.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:m.querySelector("LName").textContent,hierarchy:m.getAttribute("Hierarchy"),isNamedSet:D,valueSort:(s={levelName:w},s[w]=1,s.axis=m.getAttribute("Hierarchy"),s)},this.headerContent[u]||(this.headerContent[u]={}),this.headerContent[u][i]=this.pivotValues[u][i],u++}h++}else if(o>-1)this.pivotValues[o][i-1].ordinal=t;else if(this.tupColumnInfo[t].allCount>0){for(l=0,d=0;l<this.tupColumnInfo[t].allStartPos;)d+=n[l]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==l?a[l]:a[l]+(1-r[l]),l++;this.tupColumnInfo[t].allStartPos===this.tupColumnInfo[t].measurePosition+1?d-=a[this.tupColumnInfo[t].allStartPos-2]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-2]+1:d-=a[this.tupColumnInfo[t].allStartPos-1]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-1],this.pivotValues[d-1]&&(this.pivotValues[d-1][i-1].ordinal=t)}},e.prototype.isAttributeDrill=function(e,t,i){var a=!1;if(!this.isAdjacentToMeasure(e,i))for(var r=0;r<this.drilledMembers.length;r++)if(this.drilledMembers[r].name===e)for(var n=0;n<this.drilledMembers[r].items.length;n++){for(var s=this.drilledMembers[r].delimiter,o=this.drilledMembers[r].items[n].split(s),l="",d=0;d<o.length;d++)t[d]&&t[d].uName&&(l=l+(""===l?"":this.drilledMembers[r].delimiter)+t[d].uName);if(l===this.drilledMembers[r].items[n]){a=!0;break}}return a},e.prototype.isAdjacentToMeasure=function(e,t){for(var i=!1,a="rows"===t?this.rows:this.columns,r=0;r<a.length;r++)if(a[r].name===e&&a[r+1]&&("[Measures]"===a[r+1].name||a[r+1].isNamedSet||this.fieldList[a[r+1].name]&&!this.fieldList[a[r+1].name].hasAllMember)){i=!0;break}return i},e.prototype.getDrilledParent=function(e,t,i){for(var a=Number(e.querySelector("LNum").textContent),r=e,n=a-1;n>=t;n--){var s=this.drilledSets[r.querySelector("PARENT_UNIQUE_NAME").textContent];if(!s)break;i[n]=s,r=s}},e.prototype.performRowSorting=function(e,t){var i;if((this.enableSort||this.enableValueSorting)&&this.tupRowInfo.length>0){for(var a=this.pivotValues.length,n={},s={},o=[],l=!1,d=this.tupRowInfo[0].typeCollection.lastIndexOf("1"),p=void 0,h=this.colDepth;h<a;h++){var u=this.pivotValues[h][0];if(!this.showSubTotalsAtBottom||!u.isSum||3===u.memberType){var c=this.tupRowInfo[u.ordinal],g=c?0===c.measurePosition&&3===u.memberType?c.measureName:c.uNameCollection:"";if(""!==g){d>-1&&(g=this.frameUniqueName(g,u,c));var m=g.split(/~~|::\[/).length;if(3===u.memberType&&this.tupRowInfo[0].measurePosition>0)s[B=this.getParentUname(g,u,!0,!0)]?s[B].push(u):s[B]=[u];else n[m]?n[m][g]=[u]:n[m]=((i={})[g]=[u],i)}l&&o.push(u),"grand sum"===u.type&&(l=!0)}}for(var f=Object.keys(s).length>0&&this.tupRowInfo[0].measurePosition>0,S=Object.keys(n).map((function(e){return Number(e)})).sort((function(e,t){return e>t?1:t>e?-1:0})),v={},y=S.length-1;y>=0;y--){for(var b={},C=n[S[y]],x=Object.keys(C),w=0;w<x.length;w++){b[B=0===y?"parent":this.getParentUname(x[w],C[x[w]][0],f,!1)]?b[B].push(C[x[w]][0]):b[B]=C[x[w]]}for(var T=Object.keys(b),M=0;M<T.length;M++)b[T[M]]=this.sortRowHeaders(b[T[M]],e,t);if(v[S[y+1]])for(M=0;M<T.length;M++){for(var D=[],O=b[T[M]],P=0;P<O.length;P++){var N=this.tupRowInfo[O[P].ordinal],E=0===N.measurePosition&&3===O[P].memberType?N.measureName:N.uNameCollection;D.push(O[P]),d>-1&&(E=this.frameUniqueName(E,O[P],N));var I=!1;if(f)if(s[B=this.getParentUname(E,O[P],f,!0)]){s[B]=this.sortRowHeaders(s[B],e,t);var F=E.lastIndexOf("::[")===E.indexOf("::[Measures]"),L=E.split("::[").length-1===N.measurePosition,A=!N.drillInfo[N.measurePosition-1].isDrilled,R=N.members.length>N.measurePosition+1;if(F&&L&&A&&R){I=!0;for(var k=0;k<s[B].length;k++){D.push(s[B][k]);var j=E.substring(0,E.indexOf("::[Measures]"))+"::"+s[B][k].actualText;v[S[y+1]][j]&&(D=D.concat(v[S[y+1]][j]))}}else p=this.showSubTotalsAtBottom&&D[D.length-1].isDrilled,D=D.concat(s[B])}if(!I&&v[S[y+1]][E])if(this.showSubTotalsAtBottom&&3===D[D.length-1].memberType&&D[D.length-1].level>-1&&p){for(var q=[],H=0,V=D.length-1;V>=0;V--){if(3!==D[V].memberType){q=q.reverse(),H=V+1;break}q[q.length]=D[V]}D=D.slice(0,H).concat(v[S[y+1]][E]).concat(q)}else{u=D[D.length-1];var U=void 0;this.showSubTotalsAtBottom&&u.isDrilled&&((U=r.frameHeaderWithKeys(u)).hasChild=!1,U.isDrilled=!1,U.isSum=!0,U.formattedText=U.formattedText+" Total"),D=D.concat(v[S[y+1]][E]),U&&(D[D.length]=U)}}b[T[M]]=D}else if(f)for(M=0;M<T.length;M++){for(O=b[T[M]],D=[],P=0;P<O.length;P++){D.push(O[P]);var B;E=this.tupRowInfo[O[P].ordinal].uNameCollection;d>-1&&(E=this.frameUniqueName(E,O[P],this.tupRowInfo[O[P].ordinal])),s[B=this.getParentUname(E,O[P],!0,!0)]&&(s[B]=this.sortRowHeaders(s[B],e,t),D=D.concat(s[B]))}b[T[M]]=D}v[S[y]]=b}var _=0,G=0,z=0;l=!1,o=this.sortRowHeaders(o,e,t);for(h=this.colDepth;h<a;h++){"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&("column"===this.olapValueAxis&&this.colDepth+1===h||"row"===this.olapValueAxis&&this.colDepth+this.dataSourceSettings.values.length+1===h)&&(_=0,l=!1);var W=l?o:v[S[0]].parent,Q="Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&this.colDepth===h?W.length:l?_-G:_;W[Q]&&(this.pivotValues[h]=[W[Q]],this.pivotValues[h][0].rowIndex=h,this.valueContent[z][0]=this.pivotValues[h][0]),_++,z++,"grand sum"===this.pivotValues[h][0].type&&(l=!0,G=_)}}},e.prototype.performColumnSorting=function(e,i){if(this.enableSort||this.enableValueSorting)for(var a=0;a<this.dataSourceSettings.columns.length;a++){for(var r=[],n=0,s=[],o=0;o<this.pivotValues.length;o++){var l=this.pivotValues[o],d=void 0,p={},h=[],u=1;s[n]=[],r[n]=[];for(var c=1,g=l[c].hierarchy,m=l[c].levelUniqueName;c<l.length;c++)if(!l[c].isNamedSet){if(2!==l[c].memberType&&"[Measures]"!==l[c].hierarchy&&-1!==l[c].level){if((0,t.isNullOrUndefined)(p[l[c].formattedText])||(0,t.isNullOrUndefined)(this.pivotValues[o-1]))p[l[c].formattedText]||(p[l[c].formattedText]=[]),l[c+1]&&l[c].formattedText===l[c+1].formattedText||(h[h.length]=l[c]),p[l[c].formattedText][l[c].colIndex]=l[c];else if(p[l[c].formattedText]&&this.pivotValues[o-1]){var f=this.pivotValues[o-1][l[c].colIndex],S=Number(Object.keys(p[l[c].formattedText])[0]),v=p[l[c].formattedText][S].colIndex,y=this.pivotValues[o-1][v];if(f.formattedText!==y.formattedText){d=this.sortColumnHeaders(p,h,this.sortObject[l[c-1].levelUniqueName]||this.sortObject[l[c].hierarchy],e,i,g,m),r[n]=(0,t.isNullOrUndefined)(r[n])?[]:r[n];for(var b=0;b<d.length;b++)for(var C=Object.keys(p[d[b]]).length,x=0;x<C;x++)u=0===r[n].length?1:0,r[n][r[n].length+u]=p[d[b]][Number(Object.keys(p[d[b]])[x])];h=[],(p={})[l[c].formattedText]=[],h[h.length]=l[c],p[l[c].formattedText][l[c].colIndex]=l[c]}else p[l[c].formattedText][l[c].colIndex]=l[c]}}else if(Object.keys(p).length>0){s[n][s[n].length+u]=l[c],d=this.sortColumnHeaders(p,h,this.sortObject[l[c-1].levelUniqueName]||this.sortObject[l[c].hierarchy],e,i,g,m),r[n]=(0,t.isNullOrUndefined)(r[n])?[]:r[n];for(var w=0;w<d.length;w++)for(var T=Object.keys(p[d[w]]).length,M=0;M<T;M++)u=0===r[n].length?1:0,r[n][r[n].length+u]=p[d[w]][Number(Object.keys(p[d[w]])[M])]}else(-1===l[c].level||0===l[c].level)&&Object.keys(p).length>=0&&"[Measures]"!==l[c].hierarchy&&(s[n][s[n].length+u]=l[c]);if(-1!==l[c].level&&1===Object.keys(p).length&&"[Measures]"!==l[c].hierarchy&&!(0,t.isNullOrUndefined)(l[c+1])&&-1===l[c+1].level){var D=Object.keys(p[l[c].formattedText]).length,O=Object.keys(p[l[c].formattedText]);if(D>1)for(var P=0;P<D;P++)u=0===s[n].length?1:0,s[n][s[n].length+u]=p[l[c].formattedText][Number(O[P])];else s[n][s[n].length+u]=l[c]}if(Object.keys(s[n]).length>0){u=0===r[n].length?1:0;var N=s[n].length;if(N>2)for(var E=1;E<N;E++)u=0===r[n].length?1:0,r[n][r[n].length+u]=s[n][E];else r[n][r[n].length+u]=s[n][1]||s[n][0];p={},h=[],s[n]=[]}}if(Object.keys(p).length>0){s[n][s[n].length+u]=l[c];var I=this.sortObject[l[c-1].levelUniqueName]||this.sortObject[l[c-1].hierarchy];d=this.sortColumnHeaders(p,h,I,e,i,g,m),r[n]=(0,t.isNullOrUndefined)(r[n])?[]:r[n];for(var F=0;F<d.length;F++){var L=Object.keys(p[d[F]]).length;for(M=0;M<L;M++)u=0===r[n].length?1:0,r[n][r[n].length+u]=p[d[F]][Number(Object.keys(p[d[F]])[M])]}}for(var A=1;A<r[n].length;A++)this.pivotValues[n][A]=r[n][A];for(var R=o;R<this.pivotValues.length;R++){var k=(0,t.extend)({},this.pivotValues[R+1],null,!0),j=(0,t.extend)({},this.pivotValues[R],null,!0);if(Object.keys(k).length===Object.keys(j).length&&Object.keys(k).length>2){for(var q=1;q<this.pivotValues[o].length;q++)Object.keys(k).length>0&&j[q].colIndex!==k[q].colIndex&&(this.pivotValues[R+1][q]=k[j[q].colIndex]);break}}n++,p={}}for(var H=0;H<this.pivotValues.length;H++)for(l=this.pivotValues[H],o=1;o<l.length;o++)l[o].colIndex=o}},e.prototype.frameUniqueName=function(e,t,i){var a=e.indexOf(t.actualText.toString()+"::[Measures]")>-1,r=(e=e.substring(0,e.indexOf(t.actualText.toString()))+t.actualText.toString()).split("::[").length<=this.getMeasurePosition(e,i.measurePosition);return e+=a||r?"::"+i.measureName:""},e.prototype.getMeasurePosition=function(e,t){for(var i=t,a=e.split("::["),r=0;r<a.length;r++)if(a[r]&&a[r].indexOf("Measures")>-1){i=r;break}return i},e.prototype.sortRowHeaders=function(e,i,a){if(this.enableValueSorting&&"column"===this.olapValueAxis&&a.isValueSorting&&!(0,t.isNullOrUndefined)(this.valueSortSettings)){for(var n=[],s=0;s<e.length;s++){var o=e[s],l=i[o.ordinal*a.columnLength+a.memberIndex],d=l?l.getElementsByTagName("Value"):void 0,p=l&&d.length>0?Number(d[0].textContent):0;n.push({header:o,value:p})}e=r.getSortedValue(n,this.valueSortSettings.sortOrder)}else if(this.enableSort&&e.length>0&&3!==e[0].memberType&&!e[0].isNamedSet){var h=[];for(s=0;s<e.length;s++)h[s]=e[s].actualText;var u=!1,c="Grand Total"!==e[0].actualText?e[0].hierarchy:e[1].hierarchy,g=this.fieldList[c]&&this.fieldList[c].membersOrder?this.fieldList[c].membersOrder.slice():[],m={fieldName:c,levelName:e[0].levelUniqueName,sortOrder:this.sortObject[e[0].hierarchy]||this.sortObject[e[0].levelUniqueName],members:g&&g.length>0?g:h,IsOrderChanged:!1};if(g&&g.length>0?r.applyCustomSort(m,e,"string",!1,!0):("Ascending"===m.sortOrder||void 0===m.sortOrder?e.sort((function(e,t){return e.formattedText>t.formattedText?1:t.formattedText>e.formattedText?-1:0})):"Descending"===m.sortOrder&&e.sort((function(e,t){return e.formattedText<t.formattedText?1:t.formattedText<e.formattedText?-1:0})),u=!0),u&&this.getHeaderSortInfo){for(var f=[],S=0,v=0;S<e.length;S++)"Grand Total"!==e[S].actualText&&(f[v++]=e[S].formattedText);m.members=f}this.getHeaderSortInfo&&this.getHeaderSortInfo(m),m.IsOrderChanged&&r.applyCustomSort(m,e,"string",!0,!0)}return e},e.prototype.sortColumnHeaders=function(e,i,a,n,s,o,l){var d=Object.keys(e);if(this.enableValueSorting&&"row"===this.olapValueAxis&&s.isValueSorting&&!(0,t.isNullOrUndefined)(this.valueSortSettings)){for(var p=[],h=0;h<d.length;h++){var u=e[d[h]],c=this.showSubTotalsAtTop?u[0]:u[u.length-1],g=n[s.memberIndex*s.columnLength+c.ordinal],m=g?g.getElementsByTagName("Value"):void 0,f=g&&m.length>0?Number(m[0].textContent):0;p.push({header:c,value:f})}d=r.getSortedValue(p,this.valueSortSettings.sortOrder).map((function(e){return e.formattedText}))}else if(this.enableSort){var S=!1,v=this.fieldList[o]&&this.fieldList[o].membersOrder?this.fieldList[o].membersOrder.slice():[],y={fieldName:o,levelName:l,sortOrder:a,members:v&&v.length>0?v:d,IsOrderChanged:!1};if(v&&v.length>0?this.applyCustomSort(d,y):("Ascending"===y.sortOrder||void 0===y.sortOrder?d.sort((function(e,t){return e>t?1:t>e?-1:0})):"Descending"===y.sortOrder&&d.sort((function(e,t){return e<t?1:t<e?-1:0})),S=!0),S&&this.getHeaderSortInfo){for(var b=[],C=0,x=0;C<d.length;C++)"Grand Total"!==d[C]&&(b[x++]=d[C]);y.members=b}this.getHeaderSortInfo&&this.getHeaderSortInfo(y),y.IsOrderChanged&&this.applyCustomSort(d,y,!0)}return d},e.prototype.applyCustomSort=function(e,t,i){var a,r=[],n=[];r=t.IsOrderChanged?t.members:"Ascending"===t.sortOrder||"None"===t.sortOrder||void 0===t.sortOrder?[].concat(t.members):[].concat(t.members).reverse(),"Grand Total"===e[0]&&(a=e[0],e.shift());for(var s=0,o=0;s<e.length;s++){var l=e[s];if(r[o]===l){if(e.splice(o++,0,l),e.splice(++s,1),!(o<r.length)){i||n.splice(--o,0,l);break}s=-1}s>=0&&!i&&(n[s]=e[s])}if(!i){for(s=n.length;s<e.length;s++)n[s]=e[s];"Grand Total"===n[n.length-1]&&n.pop(),t.members=n}return a&&e.splice(0,0,a),e},e.prototype.frameSortObject=function(){if(this.enableSort)for(var e=0;e<this.sortSettings.length;e++)this.sortObject[this.sortSettings[e].name]=this.sortSettings[e].order},e.prototype.getParentUname=function(e,t,i,a){var r="";if(i&&!a){for(var n=this.tupRowInfo[t.ordinal],s=[],o={},l=0;l<e.length;l++)"~"!==e[l]&&":"!==e[l]||(s.push(l),o[l]=e[l]+e[l],l++);if(this.getMeasurePosition(e,n.measurePosition)>=e.split("::[").length-1)r=s[s.length-2]>-1?e.substring(0,s[s.length-2])+o[s[s.length-1]]+n.measureName:"parent";else r=(d=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::["))>-1?e.substring(0,d):"parent"}else{var d;r=(d=e.lastIndexOf("~~")>e.lastIndexOf("::[")?e.lastIndexOf("~~"):e.lastIndexOf("::["))>-1?e.substring(0,d):"parent"}return r},e.prototype.performColumnSpanning=function(){for(var e={},t=this.rowStartPos-1,i=Object.keys(this.colMeasures).length,a=this.tupColumnInfo[0]?this.tupColumnInfo[0].measurePosition:this.measureIndex,r=t;r>-1;r--)if(3===this.pivotValues[r][1].memberType){a=r;break}for(;t>-1;){e[t]={};for(var n=this.pivotValues[t].length-1;n>0;){e[t][n]=1;var s=this.pivotValues[t][n+1],o=this.pivotValues[t+1]&&this.rowStartPos-t>1?this.pivotValues[t+1][n]:void 0,l=this.pivotValues[t][n],d=!1,p=!1,h=this.tupColumnInfo[l.ordinal],u=h.allStartPos>("3"===h.typeCollection[0]?1:0),c=this.checkAttributeDrill(h.drillInfo,"columns");if(this.showSubTotalsAtTop&&l.isDrilled&&s&&s.actualText!==l.actualText&&l.level>-1&&(l.ordinal=this.getOrdinal(l,this.pivotValues[t+1])),o&&s&&(2===l.memberType||-1===l.level?s.actualText===l.actualText:3===l.memberType&&l.actualText===s.actualText||s.valueSort.levelName===l.valueSort.levelName)&&(2===l.memberType?u&&"sum"!==s.type?l.colSpan=1:l.colSpan=s.colSpan+1>(a>t?i:0)?1:s.colSpan+1:(l.colSpan=s.colSpan+1,l.ordinal=s.ordinal),d=!0),2===l.memberType){if(u)c||(l.type="sum"),l.formattedText="Total",l.valueSort[l.valueSort.levelName.toString()]=1;else if(l.type="grand sum",l.formattedText="Grand Total",t<this.measureIndex){var g="Grand Total";l.valueSort.levelName=g,l.valueSort[g.toString()]=1}l.hasChild=!1}else-1===l.level&&(l.type="sum",l.formattedText="Total",l.hasChild=!1,l.valueSort[l.valueSort.levelName.toString()]=1);o?2===l.memberType&&2===o.memberType||o.actualText===l.actualText?(e[t][n]=e[t+1]?e[t+1][n]+1:1,0===t||1===l.memberType&&l.level>-1&&1===o.memberType&&-1===o.level?(l.rowSpan=!l.isDrilled||this.fieldList[l.hierarchy]&&this.fieldList[l.hierarchy].isHierarchy&&!l.hasChild?e[t+1][n]+1:1,o.rowSpan=!o.isDrilled||this.fieldList[o.hierarchy]&&this.fieldList[o.hierarchy].isHierarchy&&!o.hasChild||-1!==o.level?o.rowSpan:e[t+1][n]):3===l.memberType?l.rowSpan=1:l.rowSpan=-1,p=!0):!l.isDrilled||this.fieldList[l.hierarchy]&&this.fieldList[l.hierarchy].isHierarchy&&!l.hasChild||-1!==l.level||2!==o.memberType?(l.rowSpan=0===t?e[t][n]:-1,o.rowSpan=o.level>-1&&(!o.isDrilled||this.fieldList[o.hierarchy]&&this.fieldList[o.hierarchy].isHierarchy&&!o.hasChild)||2!==l.memberType&&2===o.memberType?e[t+1][n]:1):(e[t][n]=e[t+1]?e[t+1][n]+1:1,l.rowSpan=-1,p=!0):l.rowSpan=l.level>-1||1===this.rowStartPos?e[t][n]:-1,d||(l.colSpan=1),p||(e[t][n]=1),n--}t--}},e.prototype.getOrdinal=function(e,t){for(var i=0,a=e.colIndex;a>0;a--)if(-1===t[a].level){i=t[a].ordinal;break}return i},e.prototype.frameValues=function(e,i){var a=this.colDepth,r=this.pivotValues.length,n=0;if("down"===this.customArgs.action){var s=Object.keys(this.onDemandDrillEngine);a=Number(s[0]),r=Number(s[s.length-1])+1,n=this.onDemandDrillEngine[a][0].ordinal}for(var o=a;o<r;o++)for(var l=this.pivotValues[o],d=l[0].ordinal,p=1;p<this.pivotValues[0].length;p++)if(this.pivotValues[this.colDepth-1][p]){var h=this.pivotValues[this.colDepth-1][p].ordinal,u=this.pivotValues[this.colDepth-1][p],c=3===l[0].memberType?l[0].actualText.toString():this.tupColumnInfo[u.ordinal]&&this.tupColumnInfo[u.ordinal].measure?this.tupColumnInfo[u.ordinal].measure.querySelector("UName").textContent:l[0].actualText;if("header"===l[0].type)l[p]={axis:"value",actualText:this.getUniqueName(c),formattedText:"",value:0,colIndex:p,rowIndex:o};else{var g,m=void 0,f=this.getUniqueName(c),S=!0,v=!this.fieldList[l[0].hierarchy]||!this.fieldList[l[0].hierarchy].isHierarchy||l[0].isDrilled;if(this.tupRowInfo[d])S=this.tupRowInfo[d].showTotals;else{var y=0===this.dataSourceSettings.rows.length||1===this.dataSourceSettings.rows.length&&"[Measures]"===this.dataSourceSettings.rows[0].name;S=this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals||y}var b=e[(d-n)*i+h];m=this.showSubTotalsAtBottom&&l[0].isDrilled||!S&&v?"":(0,t.isNullOrUndefined)(b)||(0,t.isNullOrUndefined)(b.querySelector("FmtValue"))?this.emptyCellTextContent:b.querySelector("FmtValue").textContent,g=!S&&v?"0":(0,t.isNullOrUndefined)(b)||(0,t.isNullOrUndefined)(b.querySelector("Value"))?null:b.querySelector("Value").textContent,m=this.showSubTotalsAtBottom&&l[0].isDrilled?"":S&&!(0,t.isNullOrUndefined)(g)?this.getFormattedValue(Number(g),f,""!==m?m:g):m;var C=!this.tupColumnInfo[h]||(this.tupColumnInfo[h].allCount>0||this.tupColumnInfo[h].drillStartPos>-1)||!this.tupRowInfo[d]||this.tupRowInfo[d].allCount>0||this.tupRowInfo[d].drillStartPos>-1,x=!!this.tupRowInfo[d]&&(0===this.tupRowInfo[d].measurePosition?1===this.tupRowInfo[d].allStartPos:0===this.tupRowInfo[d].allStartPos)||!!this.tupColumnInfo[h]&&(0===this.tupColumnInfo[h].measurePosition?1===this.tupColumnInfo[h].allStartPos:0===this.tupColumnInfo[h].allStartPos);l[p]={axis:"value",actualText:f,formattedText:m,colOrdinal:h,rowOrdinal:d,columnHeaders:this.tupColumnInfo[h]?this.tupColumnInfo[h].captionCollection:"",rowHeaders:this.tupRowInfo[d]?this.tupRowInfo[d].captionCollection:"",value:(0,t.isNullOrUndefined)(g)?null:Number(g),colIndex:p,rowIndex:o,isSum:C,isGrandSum:x}}this.valueContent[o-this.rowStartPos][p]=l[p]}},e.prototype.getFormattedValue=function(e,i,a){var r=a;if(this.formatFields[i]&&!(0,t.isNullOrUndefined)(e)){var n=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i],s=(0,t.extend)({},n,null,!0);delete s.name,!s.minimumSignificantDigits&&s.minimumSignificantDigits<1&&delete s.minimumSignificantDigits,!s.maximumSignificantDigits&&s.maximumSignificantDigits<1&&delete s.maximumSignificantDigits,s.type?r=this.globalize.formatDate(new Date(e.toString()),s):(delete s.type,r=this.globalize.formatNumber(e,s))}return r},e.prototype.getMeasureInfo=function(){this.olapValueAxis=void 0,this.olapRowValueIndex=void 0;for(var e,t="column",i=[],a=0,r=this.values;a<r.length;a++){var n=r[a];i[i.length]=n.isCalculatedField?this.fieldList[n.name].tag:n.name}if(i.length>0){if(this.isMeasureAvail){for(var s=!1,o=0,l=0,d=this.rows.length;l<d;l++)if("[measures]"===this.rows[l].name.toLowerCase()){t="row",e=l,s=!0,o=this.dataSourceSettings.rows.length,this.olapRowValueIndex=e;break}if(!s)for(l=0,d=this.columns.length;l<d;l++)if("[measures]"===this.columns[l].name.toLowerCase()){t="column",e=l,s=!0,o=this.dataSourceSettings.columns.length;break}this.olapValueAxis=t,this.measurePosition=e,this.measureIndex=e===o-1?-1:e}else e="row"===(t=this.valueAxis)?this.rows.length-1:this.columns.length-1;return{measureAxis:t,measureIndex:e,valueInfo:i}}return{measureAxis:t,measureIndex:-1,valueInfo:[]}},e.prototype.frameMeasureOrder=function(e,i,a,r,n,s){var o=[],l=[],d=[],p={},h=[],u=e.measureAxis,c=e.measureIndex,g=e.valueInfo;if(u===i&&g.length>0){for(var m={},f=[],S=0,v=a.length;S<v;S++){for(var y=a[S],b=[].slice.call(y.querySelectorAll("Member")),C="",x="",w=0;w<b.length;)C=C+(""!==C?"~~":"")+b[w].querySelector("UName").textContent,(w===c&&0===c||w===c-1)&&(x=C),w++;m[x]?m[x][m[x].length]=C:(m[x]=[C],f[f.length]=x),p[C]={index:S,node:y},h[h.length]=C}if(h.length>0&&f.length>0)if(0===c)for(var T=0,M=g;T<M.length;T++)for(var D=M[T],O=0,P=f;O<P.length;O++){if((L=P[O])===D)for(var N=0,E=m[L];N<E.length;N++){C=E[N];d[d.length]=p[C].index,o[o.length]=p[C].node}}else for(var I=0,F=f;I<F.length;I++)for(var L=F[I],A=0,R=g;A<R.length;A++)for(var k=R[A],j=0,q=m[L];j<q.length;j++){(C=q[j]).split("~~")[c]===k&&(d[d.length]=p[C].index,o[o.length]=p[C].node)}var H=[];if(r.length>0){for(var V=[],U=[],B=0,_=0,G=0,z=(S=0,s);S<z;S++){_>n-1?(_=0,V[++G]||(V[G]=[]),V[G][_]=S,_++):(V[G]||(V[G]=[]),V[G][_]=S,_++);var W=void 0;r[B]?W=this.olapVirtualization?S:Number(r[B].getAttribute("CellOrdinal")):B++,W===S&&(U[S]=W,H[W]=r[B],B++)}if(r=H,"column"===u){if(V.length>0&&V[0].length===d.length)for(w=0,z=d.length;w<z;w++)for(S=0;S<V.length;){var Q=S*n+w;if(!(0,t.isNullOrUndefined)(V[S])&&!(0,t.isNullOrUndefined)(d[w])){var Y=U[Q]?U[Q].toString():Q.toString();(K=r[Number(V[S][d[w]])])&&(K.setAttribute("CellOrdinal",Y.toString()),l[Q]=K)}S++}}else if(V.length===d.length)for(w=0,z=d.length;w<z;w++)for(S=0;S<V[d[w]].length;){var K;Y=U[Q=w*n+S]?U[Q].toString():Q.toString();(K=r[Number(V[d[w]][S])])&&(K.setAttribute("CellOrdinal",Y.toString()),l[l.length]=K),S++}}return{orderedHeaderTuples:o,orderedValueTuples:l}}return{orderedHeaderTuples:a,orderedValueTuples:r}},e.prototype.getDrilledSets=function(e,i,a,r){for(var n=[],s=i.actualText.toString(),o="row"===r?this.tupRowInfo:this.tupColumnInfo,l=o[i.ordinal],d=0===o[0].typeCollection.indexOf("3")?1:0,p=0,h="1"===o[0].typeCollection[a];p<o.length;)((0,t.isNullOrUndefined)(o[p].allStartPos)||o[p].allStartPos>d)&&(n[n.length]=o[p].uNameCollection),p++;for(var u=e.split("::[").map((function(e){return"["===e[0]?e:"["+e})),c=[],g=0;g<=a;g++)if(u[g])if((h||this.isPaging)&&g===a){for(var m=u[g].split("~~"),f=m.indexOf(s),S=[],v=0;v<=f;v++)S.push(m[v]);c[c.length]=S.length>0?S.join("~~"):u[g]}else c[c.length]=u[g];e=c.join("::");for(var y=[],b={},C=0,x=n;C<x.length;C++){var w=x[C];if(0===w.indexOf(e)&&(y.push(w),this.isPaging))for(var T=w.split("::[")[a],M=(P=(T="["===T[0]?T:"["+T).split("~~")).indexOf(s);M<P.length;M++)b[P[M]]=P[M]}if(this.isPaging){var D=l.uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})),O=[];for(M=0;M<D.length;M++)M!==a&&(O[M]=D[M]);var P=Object.keys(b);for(M=0;M<P.length;M++)O[a]=P[M],y.push(O.join("::"))}for(var N={},E=0,I=y;E<I.length;E++){for(var F=I[E].split("::[").map((function(e){return"["===e[0]?e:"["+e})),L="",A=0;A<=a;A++){var R=F[A];if(R){var k=R.split("~~");L=L+(""!==L?"~~":"")+k[k.length-1]}}N[L]=L}return N},e.prototype.updateDrilledInfo=function(e){this.dataSourceSettings=e,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.generateGridData(e)},e.prototype.updateCalcFields=function(e,t){this.dataSourceSettings=e,this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.getAxisFields(),this.updateFieldlist(),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.dataFields[t.name]?this.generateGridData(e):Bo.getCellSets(e,this,!0,void 0,!0)},e.prototype.onSort=function(e,t){this.dataSourceSettings=e,t||(this.sortSettings=e.sortSettings?e.sortSettings:[],this.getAxisFields(),this.frameSortObject(),this.updateFieldlist()),this.xmlaCellSet.length>0&&this.xmlDoc?this.generateEngine(this.xmlDoc,this.request,this.customArgs):this.generateGridData(e)},e.prototype.updateFieldlist=function(e){for(var t=0;t<this.savedFieldListData.length;){var i=this.savedFieldListData[t].id,a=this.savedFieldListData[t].pid;if(this.savedFieldList[i]){var r=this.enableSort?this.sortObject[i]?this.sortObject[i]:"Ascending":"None";this.savedFieldList[i].isSelected=!1,this.savedFieldList[i].isExcelFilter=!1,this.savedFieldList[i].sort=r,this.savedFieldList[i].allowDragAndDrop=!0,this.savedFieldList[i].showFilterIcon=!0,this.savedFieldList[i].showSortIcon=!0,this.savedFieldList[i].showEditIcon=!0,this.savedFieldList[i].showRemoveIcon=!0,this.savedFieldList[i].showValueTypeIcon=!0,this.savedFieldList[i].showSubTotals=!0,this.savedFieldListData[t].sort=r,this.savedFieldListData[t].allowDragAndDrop=!0,this.savedFieldListData[t].showFilterIcon=!0,this.savedFieldListData[t].showSortIcon=!0,this.savedFieldListData[t].showEditIcon=!0,this.savedFieldListData[t].showRemoveIcon=!0,this.savedFieldListData[t].showValueTypeIcon=!0,this.savedFieldListData[t].showSubTotals=!0,e&&(this.savedFieldList[i].filter=[],this.savedFieldList[i].actualFilter=[])}if(this.dataFields[i]&&this.savedFieldList[i]&&this.selectedItems.indexOf(i)>-1?(this.savedFieldList[i].isSelected=!0,this.savedFieldList[i].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldList[i].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldList[i].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldList[i].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldList[i].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldList[i].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldList[i].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals,this.savedFieldListData[t].isSelected=!0,this.savedFieldListData[t].allowDragAndDrop=!this.dataFields[i]||this.dataFields[i].allowDragAndDrop,this.savedFieldListData[t].showFilterIcon=!this.dataFields[i]||this.dataFields[i].showFilterIcon,this.savedFieldListData[t].showSortIcon=!this.dataFields[i]||this.dataFields[i].showSortIcon,this.savedFieldListData[t].showEditIcon=!this.dataFields[i]||this.dataFields[i].showEditIcon,this.savedFieldListData[t].showRemoveIcon=!this.dataFields[i]||this.dataFields[i].showRemoveIcon,this.savedFieldListData[t].showValueTypeIcon=!this.dataFields[i]||this.dataFields[i].showValueTypeIcon,this.savedFieldListData[t].showSubTotals=!this.dataFields[i]||this.dataFields[i].showSubTotals):this.dataFields[a]&&this.savedFieldList[a]&&this.selectedItems.indexOf(a)>-1?this.savedFieldListData[t].isSelected=!0:this.savedFieldListData[t].isSelected=!1,this.savedFieldList[i]&&this.savedFieldList[i].isCalculatedField||"[calculated members].[_0]"===i.toLowerCase()){for(var n=!1,s=0,o=this.calculatedFieldSettings;s<o.length;s++){var l=o[s];if(i===l.name){var d=l.formula,p=l.formatString;this.savedFieldListData[t].formula=d,this.savedFieldListData[t].formatString=p,this.savedFieldListData[t].parentHierarchy=d.toLowerCase().indexOf("measure")>-1?void 0:l.hierarchyUniqueName,this.savedFieldList[i].formula=d,this.savedFieldList[i].formatString=p,this.savedFieldList[i].parentHierarchy=this.savedFieldListData[t].parentHierarchy,n=!0}}(!n&&"[calculated members].[_0]"!==i.toLowerCase()||"[calculated members].[_0]"===i.toLowerCase()&&0===this.calculatedFieldSettings.length)&&(this.savedFieldListData.splice(t,1),t--,this.savedFieldList[i]&&delete this.savedFieldList[i])}t++}this.fieldList=this.savedFieldList,this.fieldListData=this.savedFieldListData},e.prototype.updateFieldlistData=function(e,t){for(var i=0,a=this.fieldListData;i<a.length;i++){var r=a[i];if(r.id===e){r.isSelected=!!t;break}}},e.prototype.getFormattedFields=function(e){this.formatFields={};for(var t=e.length;t--;)this.formatFields[e[t].name]=e[t]},e.prototype.getCubes=function(e){var t=this.getConnectionInfo(e.url,e.localeIdentifier.toString()),i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_CUBES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.catalog+"</CATALOG_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+t.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList></Properties></Discover></Body></Envelope>";if(this.doAjaxPost("POST",t.url,i,this.validateCube.bind(this),{dataSourceSettings:e,action:"getCubes"}),this.errorInfo)throw this.errorInfo},e.prototype.validateCube=function(e,t,i){for(var a=[].slice.call(e.querySelectorAll("row")),r=!1,n=0,s=a;n<s.length;n++){if(s[n].querySelector("CUBE_NAME").textContent===i.dataSourceSettings.cube){r=!0;break}}!r&&a.length>0&&(this.errorInfo="Invalid cube name "+this.dataSourceSettings.cube)},e.prototype.getFieldList=function(e){var t={catalog:e.catalog,cube:e.cube,url:e.url,LCID:e.localeIdentifier.toString(),request:"MDSCHEMA_HIERARCHIES",roles:e.roles};this.getTreeData(t,this.getFieldListItems.bind(this),{dataSourceSettings:e,action:"loadFieldElements"})},e.prototype.getTreeData=function(e,t,i){var a=this.getConnectionInfo(e.url,e.LCID),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList></Properties></Discover></Body></Envelope>";if(this.doAjaxPost("POST",a.url,r,t,i),this.errorInfo)throw this.errorInfo},e.prototype.getAxisFields=function(){this.rows=this.dataSourceSettings.rows?this.dataSourceSettings.rows:[],this.columns=this.dataSourceSettings.columns?this.dataSourceSettings.columns:[],this.filters=this.dataSourceSettings.filters?this.dataSourceSettings.filters:[],this.values=this.dataSourceSettings.values?this.dataSourceSettings.values:[];for(var e=(0,t.extend)([],this.rows,null,!0),i=(e=e.concat(this.columns,this.values,this.filters)).length;i--;)this.dataFields[e[i].name]=e[i],"[measures]"===e[i].name.toLowerCase()?this.isMeasureAvail=!0:this.selectedItems.push(e[i].name);if(this.mappingFields={},this.dataSourceSettings.fieldMapping)for(var a=0,r=this.dataSourceSettings.fieldMapping;a<r.length;a++){var n=r[a];this.mappingFields[n.name]=n}if(!this.isMeasureAvail&&this.values.length>0){var s={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0};"row"===this.valueAxis?this.rows.push(s):this.columns.push(s),this.isMeasureAvail=!0}},e.prototype.getAggregateType=function(e,t){var i;switch(t){case"1":i="Sum";break;case"2":i="Count";break;case"3":i="Min";break;case"4":i="Max";break;case"5":i="Avg";break;case"8":i="DistinctCount";break;case"127":i="CalculatedField";break;default:i=void 0}return i||void 0},e.prototype.getUniqueName=function(e){for(var t=e,i=0,a=this.calculatedFieldSettings;i<a.length;i++){var r=a[i];if(e===(r.formula.toLowerCase().indexOf("measure")>-1?"[Measures].":r.hierarchyUniqueName+".")+"["+r.name+"]"){t=r.name;break}}return t},e.prototype.updateFilterItems=function(e){var i=(0,t.extend)([],this.rows,null,!0);i=i.concat(this.columns);for(var a=0,n=e;a<n.length;a++){var s=n[a];if("Include"===s.type&&this.allowMemberFilter&&this.fieldList[s.name]){var o=this.fieldList[s.name].members,l=o&&Object.keys(o).length>0;this.fieldList[s.name].actualFilter=s.items.slice();var d=(0,t.extend)([],s.items,null,!0);if(l)for(var p=0;p<d.length;){for(var h=[],u=0,c=h=this.getParentNode(d[p],o,h);u<c.length;u++){var g=c[u],m=r.inArray(g,s.items);-1!==m&&s.items.splice(m,1)}p++}for(var f=[],S=0,v=s.items;S<v.length;S++){var y=v[S],b=void 0;l||1!==s.items.length||(this.getMembers(this.dataSourceSettings,s.name,void 0,void 0,void 0,s.items[0]),b=this.fieldList[s.name].actualFilter[0]),f.push(y),l?this.fieldList[s.name].filter.push(o[y].caption):this.fieldList[s.name].filter.push(b||y)}this.filterMembers[s.name]=f,this.fieldList[s.name].isExcelFilter=!1}else if((this.allowValueFilter||this.allowLabelFilter)&&-1!==["Date","Label","Number","Value"].indexOf(s.type))for(var C=0,x=i;C<x.length;C++){if(x[C].name===s.name){var w=this.filterMembers[s.name];w&&"object"==typeof w[0]&&w[0].type===s.type?w[w.length]=s:this.filterMembers[s.name]=[s],this.fieldList[s.name].isExcelFilter=!0;break}}}},e.prototype.getParentNode=function(e,t,i){if(t[e].parent&&e!==t[e].parent){var a=t[e].parent;i.push(a),this.getParentNode(a,t,i)}return i},e.prototype.updateDrilledItems=function(e){var i=[],a=(0,t.extend)([],this.rows,null,!0);a=a.concat(this.columns);for(var r=0,n=e;r<n.length;r++)for(var s=n[r],o=0,l=a;o<l.length;o++){var d=l[o];if(s.name===d.name){i.push(s);break}}return i},e.prototype.getDrillThroughData=function(e,t){for(var i,a=this.tupColumnInfo[e.colOrdinal]&&this.tupColumnInfo[e.colOrdinal].uNameCollection&&""!==this.tupColumnInfo[e.colOrdinal].uNameCollection?this.tupColumnInfo[e.colOrdinal].uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})):[],r=this.tupRowInfo[e.rowOrdinal]&&this.tupRowInfo[e.rowOrdinal].uNameCollection&&""!==this.tupRowInfo[e.rowOrdinal].uNameCollection?this.tupRowInfo[e.rowOrdinal].uNameCollection.split("::[").map((function(e){return"["===e[0]?e:"["+e})):[],n=[],s="",o=0;o<this.filters.length;o++)if(i=this.filterMembers[this.filters[o].name]){for(var l=0;l<i.length;l++)s+=i[l],s=l<i.length-1?s+",":s+"";n[o]=s,s=""}for(o=0;o<n.length;o++)s=""===s?"{"+n[o]+"}":s+",{"+n[o]+"}";var d="",p="";for(o=0;o<a.length;o++)d=(d.length>0?d+",":"")+(a[o].split("~~").length>1?a[o].split("~~")[a[o].split("~~").length-1]:a[o]);for(o=0;o<r.length;o++)p=(p.length>0?p+",":"")+(r[o].split("~~").length>1?r[o].split("~~")[r[o].split("~~").length-1]:r[o]);var h="DRILLTHROUGH MAXROWS "+t+" Select("+(d.length>0?d:"")+(d.length>0&&p.length>0?",":"")+(p.length>0?p:"")+") on 0 from "+(""===s?"["+this.dataSourceSettings.cube+"]":"(SELECT ("+s+") ON COLUMNS FROM ["+this.dataSourceSettings.cube+"])");h=h.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;");var u=this.getSoapMsg(this.dataSourceSettings,h),c=this.getConnectionInfo(this.dataSourceSettings.url,this.dataSourceSettings.localeIdentifier);if(this.doAjaxPost("POST",c.url,u,this.drillThroughSuccess.bind(this),{dataSourceSettings:this.dataSourceSettings,action:"drillThrough"}),this.errorInfo)throw this.errorInfo},e.prototype.drillThroughSuccess=function(e){var t=[].slice.call(e.querySelectorAll("row")),i="";if(t.length>0){for(var a=[],r=0;r<t.length;){for(var n=[].slice.call(t[r].children),s=0;s<n.length;)a.push('"'+n[s].tagName+'":"'+n[s].textContent+'"'),s++;r++}for(var o=a[0],l=0;l<a.length;)Object.keys(JSON.parse("[{"+a[l]+"}]")[0])[0]!==Object.keys(JSON.parse("[{"+o+"}]")[0])[0]?(i+=","+a[l],l++):(i+=""===i?"[{"+a[l]:"}, {"+a[l],l++);i+="}]"}else{var d=[].slice.call(e.querySelectorAll("faultstring"));for(r=0;r<d.length;)i+=d[r].textContent,r++}this.gridJSON=i},e.prototype.getFilterMembers=function(e,t,i,a,r){var n,s=this.fieldList[t].levels,o=this.fieldList[t].levelCount;return n=r?"Descendants({"+s[o].id+"}, "+s[i-1].id+", "+(i-o==1?"SELF)":"SELF_AND_BEFORE)"):t+", Descendants({"+s[0].id+"}, "+s[i-1].id+", SELF_AND_BEFORE)",this.fieldList[t].levelCount=i,a||this.getMembers(e,t,!1,n,r),n},e.prototype.getMembers=function(e,t,i,a,r,n){var s,o="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE",l=this.fieldList[t].hasAllMember,d=(l?t:t+".LEVELS(0)").replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;");s=i||n?n?"SELECT {"+(n=n.replace(/&/g,"&amp;"))+"} ON 0 FROM ["+e.cube+"] WHERE {}":"SELECT ({"+d+".ALLMEMBERS})"+o+" ON 0 FROM ["+e.cube+"]":"SELECT ({"+(a||(l?d+", "+d+".CHILDREN":d+".ALLMEMBERS"))+"})"+o+" ON 0 FROM ["+e.cube+"]";var p=this.getSoapMsg(e,s),h=this.getConnectionInfo(e.url,e.localeIdentifier);if(r||(this.fieldList[t].filterMembers=[],this.fieldList[t].childMembers=[],this.fieldList[t].searchMembers=[],this.fieldList[t].members={},this.fieldList[t].currrentMembers={}),this.doAjaxPost("POST",h.url,p,n?this.getOlapFilterText.bind(this):this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,loadLevelMembers:r,action:"fetchMembers"}),this.errorInfo)throw this.errorInfo},e.prototype.getOlapFilterText=function(e,t,i){var a=[].slice.call(e.querySelectorAll('Axis[name="Axis0"] Tuple'));a.length>0&&this.fieldList[i.fieldName]&&a[a.length-1].getElementsByTagName("Caption")&&a[a.length-1].getElementsByTagName("Caption")[0]&&(this.fieldList[i.fieldName].actualFilter[0]=a[a.length-1].getElementsByTagName("Caption")[0].textContent)},e.prototype.getChildMembers=function(e,t,i){var a="SELECT ({"+t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")+".CHILDREN})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",r=this.getSoapMsg(e,a),n=this.getConnectionInfo(e.url,e.localeIdentifier);if(this.doAjaxPost("POST",n.url,r,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:i,action:"fetchChildMembers"}),this.errorInfo)throw this.errorInfo},e.prototype.getCalcChildMembers=function(e,t){this.calcChildMembers=[];var i="SELECT ({"+t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")+".MEMBERS})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",a=this.getConnectionInfo(e.url,e.localeIdentifier),r=this.getSoapMsg(e,i);if(this.doAjaxPost("POST",a.url,r,this.generateMembers.bind(this),{dataSourceSettings:e,action:"fetchCalcChildMembers"}),this.errorInfo)throw this.errorInfo},e.prototype.getSearchMembers=function(e,t,i,a,r,n){if(this.fieldList[t].searchMembers=[],this.fieldList[t].currrentMembers={},""!==i){var s=t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),o="WITH SET [SearchMembersSet] AS &#39;FILTER("+(r?s+".ALLMEMBERS, ":"{"+(n>1?this.getFilterMembers(e,t,n,!0):s+", "+s+".CHILDREN")+"},")+"(INSTR(1, "+s+'.CurrentMember.member_caption, "'+i+'") > 0))&#39;SET [SearchParentsSet] AS &#39;GENERATE([SearchMembersSet], ASCENDANTS([SearchMembersSet].Current))&#39;SET [SearchSet] AS &#39;HIERARCHIZE(DISTINCT({[SearchMembersSet], [SearchParentsSet]}))&#39;SELECT SUBSET([SearchSet], 0, '+a+")DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+e.cube+"]",l=this.getSoapMsg(e,o),d=this.getConnectionInfo(e.url,e.localeIdentifier);if(this.doAjaxPost("POST",d.url,l,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,action:"fetchSearchMembers"}),this.errorInfo)throw this.errorInfo}},e.prototype.generateMembers=function(e,t,i){for(var a,r=[].slice.call(e.querySelectorAll('Axis[name="Axis0"] Tuple')),n=i.fieldName,s={},o=0,l=r;o<l.length;o++){var d=l[o],p=d.querySelector("Member"),h=p.querySelector("MEMBER_TYPE").textContent,u=p.querySelector("UName").textContent,c=p.querySelector("Caption").textContent,g=p.querySelector("PARENT_UNIQUE_NAME")?p.querySelector("PARENT_UNIQUE_NAME").textContent:"",m={"data-fieldName":n,"data-memberId":u};if(""===g&&"1"===h)s={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,isSelected:!1,id:u,tag:u,name:c,caption:c,htmlAttributes:m},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[n].filterMembers.push(s),this.fieldList[n].childMembers.push(s)):"fetchSearchMembers"===i.action?(this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[n].searchMembers.push(s),s.expanded=!0):this.calcChildMembers.push(s);else if(""!==g&&"1"===h)if(g===a&&"1"===h)s={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,id:u,name:c,isSelected:!1,caption:c,htmlAttributes:m,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].filterMembers.push(s),this.fieldList[n].childMembers.push(s),this.fieldList[n].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):"fetchSearchMembers"===i.action?(s.expanded=!0,this.fieldList[n].searchMembers.push(s),this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(s);else{if("fetchMembers"===i.action&&this.fieldList[n].members[u])continue;var f=!!i.loadLevelMembers&&this.fieldList[n].members[g].isSelected;s={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,htmlAttributes:m,isSelected:!1,id:u,pid:g,name:c,caption:c,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].isHierarchy=!1,this.fieldList[n].filterMembers.push(s),this.fieldList[n].childMembers.push(s),this.fieldList[n].members[u]={name:u,caption:c,parent:g,isNodeExpand:!1,isSelected:f}):"fetchSearchMembers"===i.action?(this.fieldList[n].searchMembers.push(s),s.expanded=!0,this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:g,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(s)}else"2"===h&&(a=u)}},e.prototype.getFieldListItems=function(e,t,i){for(var a,r=[],n=0,s=[].slice.call(e.querySelectorAll("row"));n<s.length;n++){var o=s[n],l=[].slice.call(o.querySelectorAll("ALL_MEMBER")).length>0,d=o.querySelector("DIMENSION_UNIQUE_NAME").textContent,p=o.querySelector("HIERARCHY_UNIQUE_NAME").textContent,h=d===p&&"[measures]"!==d.toLowerCase()&&"[measures]"!==p.toLowerCase();r.push({pid:this.isMondrian||h?d+"~#^Dim":d,id:p,name:o.querySelector("HIERARCHY_CAPTION").textContent,caption:o.querySelector("HIERARCHY_CAPTION").textContent,tag:p,hasAllMember:l,allMember:l?o.querySelectorAll("ALL_MEMBER")[0].textContent:void 0,type:"string"})}a={hierarchy:r,hierarchySuccess:e,measures:[]},this.fieldListObj=a;var u={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_DIMENSIONS",roles:i.dataSourceSettings.roles};this.getTreeData(u,this.loadDimensionElements.bind(this),i)},e.prototype.loadCalculatedMemberElements=function(e){if(e.length>0){var t=this.fieldListData,i={hasChildren:!0,isSelected:!1,id:"[Calculated Members].[_0]",name:"[Calculated Members].[_0]",caption:"Calculated Members",spriteCssClass:"e-calcMemberGroupCDB "+Yi,tag:"[Calculated Members].[_0]",type:"string"};t.length>0&&"[measures]"===t[0].id.toLowerCase()&&t.splice(0,0,i);for(var a=0,r=e;a<r.length;a++){var n=r[a];if(!this.fieldList[n.name]){var s=n.formula,o=(s.toLowerCase().indexOf("measure")>-1?"[Measures].":n.hierarchyUniqueName+".")+"["+n.name+"]",l=this.dataFields[n.name]&&this.dataFields[n.name].caption?this.dataFields[n.name].caption:this.mappingFields[n.name]&&this.mappingFields[n.name].caption?this.mappingFields[n.name].caption:n.name,d=n.formatString,p={hasChildren:!1,isSelected:!1,id:n.name,pid:"[Calculated Members].[_0]",name:n.name,caption:l,spriteCssClass:"e-calc-member "+(s.toLowerCase().indexOf("measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+Yi,tag:o,formula:s,formatString:d,aggregateType:void 0,type:"CalculatedField",filter:[],dateMember:[],sort:"Ascending",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,isCalculatedField:!0,allowDragAndDrop:this.dataFields[n.name]?this.dataFields[n.name].allowDragAndDrop:!this.mappingFields[n.name]||this.mappingFields[n.name].allowDragAndDrop,showFilterIcon:this.dataFields[n.name]?this.dataFields[n.name].showFilterIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showFilterIcon,showSortIcon:this.dataFields[n.name]?this.dataFields[n.name].showSortIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showSortIcon,showEditIcon:this.dataFields[n.name]?this.dataFields[n.name].showEditIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showEditIcon,showRemoveIcon:this.dataFields[n.name]?this.dataFields[n.name].showRemoveIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showRemoveIcon,showValueTypeIcon:this.dataFields[n.name]?this.dataFields[n.name].showValueTypeIcon:!this.mappingFields[n.name]||this.mappingFields[n.name].showValueTypeIcon,showSubTotals:this.dataFields[n.name]?this.dataFields[n.name].showSubTotals:!this.mappingFields[n.name]||this.mappingFields[n.name].showSubTotals,fieldType:s.toLowerCase().indexOf("measure")>-1?"Measure":"Dimension",parentHierarchy:s.toLowerCase().indexOf("measure")>-1?void 0:n.hierarchyUniqueName};t.push(p),this.fieldList[p.id]=p,this.updateMembersOrder(n.name)}}}},e.prototype.loadDimensionElements=function(e,i,a){for(var r=[],n=[].slice.call(e.querySelectorAll("row")),s={},o=0,l=n;o<l.length;o++){var d=l[o],p=d.querySelector("DIMENSION_UNIQUE_NAME").textContent,h=d.querySelector("DEFAULT_HIERARCHY").textContent,u=d.querySelector("DIMENSION_CAPTION").textContent,c=p===h;p.toLowerCase().indexOf("[measure")>=0?s={hasChildren:!0,isSelected:!1,id:p,name:p,caption:u,spriteCssClass:"[measures]"===p.toLowerCase()?"e-measureGroupCDB-icon "+Yi:"e-dimensionCDB-icon "+Yi,tag:p,type:"string"}:(0,t.isNullOrUndefined)(n[0].querySelector("HIERARCHY_CAPTION"))&&r.push({hasChildren:!0,isSelected:!1,id:this.isMondrian||c?p+"~#^Dim":p,name:p,caption:u,spriteCssClass:"e-dimensionCDB-icon "+Yi,tag:p,defaultHierarchy:d.querySelector("DEFAULT_HIERARCHY").textContent,type:"string"})}r.splice(0,0,s),this.fieldListData=r;var g={catalog:a.dataSourceSettings.catalog,cube:a.dataSourceSettings.cube,url:a.dataSourceSettings.url,LCID:a.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_SETS",roles:a.dataSourceSettings.roles};this.getTreeData(g,this.loadNamedSetElements.bind(this),a)},e.prototype.loadNamedSetElements=function(e,i,a){var r=(0,t.extend)([],this.rows,null,!0);r=r.concat(this.columns,this.filters);for(var n=this.fieldListData,s=[],o=0,l=r;o<l.length;o++){var d=l[o];s.push(d.name)}for(var p=[],h=0,u=[].slice.call(e.querySelectorAll("row"));h<u.length;h++){d=u[h];p.indexOf(d.querySelector("DIMENSIONS").textContent.split(".")[0])>=0||(n.push({hasChildren:!0,isSelected:!1,pid:d.querySelector("DIMENSIONS").textContent.split(".")[0],id:d.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+d.querySelector("DIMENSIONS").textContent.split(".")[0],name:d.querySelector("SET_DISPLAY_FOLDER").textContent,spriteCssClass:"e-folderCDB-icon "+Yi+" namedSets",caption:d.querySelector("SET_DISPLAY_FOLDER").textContent,type:"string"}),p.push(d.querySelector("DIMENSIONS").textContent.split(".")[0]));var c="["+d.querySelector("SET_NAME").textContent.trim()+"]",g={hasChildren:!0,isNamedSets:!0,isSelected:s.indexOf("["+d.querySelector("SET_NAME").textContent+"]")>=0,pid:d.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+d.querySelector("DIMENSIONS").textContent.split(".")[0],id:c,name:d.querySelector("SET_CAPTION").textContent,caption:this.dataFields[c]&&this.dataFields[c].caption?this.dataFields[c].caption:this.mappingFields[c]&&this.mappingFields[c].caption?this.mappingFields[c].caption:d.querySelector("SET_CAPTION").textContent,spriteCssClass:"e-namedSetCDB-icon "+Yi,tag:d.querySelector("EXPRESSION").textContent,type:"string",filter:[],dateMember:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,allowDragAndDrop:this.dataFields[c]?this.dataFields[c].allowDragAndDrop:!this.mappingFields[c]||this.mappingFields[c].allowDragAndDrop,showFilterIcon:this.dataFields[c]?this.dataFields[c].showFilterIcon:!this.mappingFields[c]||this.mappingFields[c].showFilterIcon,showSortIcon:this.dataFields[c]?this.dataFields[c].showSortIcon:!this.mappingFields[c]||this.mappingFields[c].showSortIcon,showEditIcon:this.dataFields[c]?this.dataFields[c].showEditIcon:!this.mappingFields[c]||this.mappingFields[c].showEditIcon,showRemoveIcon:this.dataFields[c]?this.dataFields[c].showRemoveIcon:!this.mappingFields[c]||this.mappingFields[c].showRemoveIcon,showValueTypeIcon:this.dataFields[c]?this.dataFields[c].showValueTypeIcon:!this.mappingFields[c]||this.mappingFields[c].showValueTypeIcon,showSubTotals:this.dataFields[c]?this.dataFields[c].showSubTotals:!this.mappingFields[c]||this.mappingFields[c].showSubTotals};n.push(g),this.fieldList[c]=g,this.updateMembersOrder(c)}a.hierarchy=this.fieldListData,a.hierarchySuccess=this.fieldListObj.hierarchySuccess,this.loadHierarchyElements(a)},e.prototype.loadHierarchyElements=function(e){for(var i=e.hierarchySuccess,a=e.hierarchy,r=(0,t.extend)([],this.rows,null,!0),n=[],s=0,o=r=r.concat(this.columns,this.filters);s<o.length;s++){var l=o[s];n.push(l.name)}for(var d=0,p=[].slice.call(i.querySelectorAll("row"));d<p.length;d++){var h=(l=p[d]).querySelector("DIMENSION_UNIQUE_NAME").textContent,u=l.querySelector("HIERARCHY_UNIQUE_NAME").textContent,c=[].slice.call(l.querySelectorAll("ALL_MEMBER")).length>0,g=void 0;if(c){var m=l.querySelectorAll("ALL_MEMBER")[0].textContent.replace(/[\]']+/g,"").split(".");g=m[m.length-1].trim()}else g=void 0;for(var f=l.querySelector("HIERARCHY_DISPLAY_FOLDER")?l.querySelector("HIERARCHY_DISPLAY_FOLDER").textContent:"",S=[],v=0,y=a;v<y.length;v++){(D=y[v]).tag===h&&S.push(D)}if(S.length>0){var b=h===u&&"[measures]"!==h.toLowerCase()&&"[measures]"!==u.toLowerCase();if("[measures]"!==h.toLowerCase()&&"[measures]"!==u.toLowerCase()){var C=h+(this.isMondrian||b?"~#^Dim":"");if(""!==f){for(var x=h+(this.isMondrian||b?"~#^Dim":"")+"_"+f,w=[],T=0,M=a;T<M.length;T++){var D;(D=M[T]).tag===x&&D.pid===C&&w.push(D)}if(0===w.length){var O={hasChildren:!0,isSelected:!1,pid:h+(this.isMondrian||b?"~#^Dim":""),id:x,name:f,spriteCssClass:"e-folderCDB-icon "+Yi,tag:x,caption:f,type:"string"};a.push(O)}C=x}var P={hasChildren:!l.querySelector("HIERARCHY_ORIGIN")||"2"!==l.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==l.querySelector("HIERARCHY_ORIGIN").textContent,isSelected:n.indexOf(u)>=0,pid:C,id:u,name:l.querySelector("HIERARCHY_CAPTION").textContent,spriteCssClass:(l.querySelector("HIERARCHY_ORIGIN")?"2"!==l.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==l.querySelector("HIERARCHY_ORIGIN").textContent?"e-hierarchyCDB-icon":"e-attributeCDB-icon":"e-hierarchyCDB-icon")+" "+Yi,hasAllMember:c,allMember:g,tag:u,caption:this.dataFields[u]&&this.dataFields[u].caption?this.dataFields[u].caption:this.mappingFields[u]&&this.mappingFields[u].caption?this.mappingFields[u].caption:l.querySelector("HIERARCHY_CAPTION").textContent,type:"string",filter:[],dateMember:[],sort:this.enableSort?this.sortObject[u]?this.sortObject[u]:"Ascending":"None",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},levels:[],levelCount:1,isHierarchy:!!l.querySelector("HIERARCHY_ORIGIN")&&("2"===l.querySelector("HIERARCHY_ORIGIN").textContent||"6"===l.querySelector("HIERARCHY_ORIGIN").textContent),isExcelFilter:!1,allowDragAndDrop:this.dataFields[u]?this.dataFields[u].allowDragAndDrop:!this.mappingFields[u]||this.mappingFields[u].allowDragAndDrop,showFilterIcon:this.dataFields[u]?this.dataFields[u].showFilterIcon:!this.mappingFields[u]||this.mappingFields[u].showFilterIcon,showSortIcon:this.dataFields[u]?this.dataFields[u].showSortIcon:!this.mappingFields[u]||this.mappingFields[u].showSortIcon,showEditIcon:this.dataFields[u]?this.dataFields[u].showEditIcon:!this.mappingFields[u]||this.mappingFields[u].showEditIcon,showRemoveIcon:this.dataFields[u]?this.dataFields[u].showRemoveIcon:!this.mappingFields[u]||this.mappingFields[u].showRemoveIcon,showValueTypeIcon:this.dataFields[u]?this.dataFields[u].showValueTypeIcon:!this.mappingFields[u]||this.mappingFields[u].showValueTypeIcon,showSubTotals:this.dataFields[u]?this.dataFields[u].showSubTotals:!this.mappingFields[u]||this.mappingFields[u].showSubTotals};a.push(P),this.fieldList[u]=P,this.updateMembersOrder(u)}}}var N={catalog:e.dataSourceSettings.catalog,cube:e.dataSourceSettings.cube,url:e.dataSourceSettings.url,LCID:e.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_LEVELS",roles:e.dataSourceSettings.roles};this.getTreeData(N,this.loadLevelElements.bind(this),e)},e.prototype.updateMembersOrder=function(e){for(var t=0,i=this.sortSettings;t<i.length;t++){var a=i[t];if(e===a.name&&a.membersOrder){this.fieldList[e].membersOrder=a.membersOrder;break}}},e.prototype.loadLevelElements=function(e,t,i){var a=[],r=this.fieldListData;a=[];for(var n=0,s=[].slice.call(e.querySelectorAll("row"));n<s.length;n++){var o=s[n];if(1!==parseInt(o.querySelector("LEVEL_TYPE").textContent,10)&&"[measures]"!==o.querySelector("HIERARCHY_UNIQUE_NAME").textContent.toLowerCase()){var l=o.querySelector("HIERARCHY_UNIQUE_NAME").textContent,d=o.querySelector("LEVEL_UNIQUE_NAME").textContent,p=o.querySelector("LEVEL_CAPTION").textContent,h={hasChildren:!1,isChecked:!1,isSelected:this.fieldList[l].isSelected,pid:l,id:d,name:p,tag:d,spriteCssClass:"e-level-members e-hierarchy-level-"+parseInt(o.querySelector("LEVEL_NUMBER").textContent,10)+"-icon "+Yi,caption:p,type:"string"};a.push(h),this.fieldList[l]&&this.fieldList[l].spriteCssClass&&-1===this.fieldList[l].spriteCssClass.indexOf("e-attributeCDB-icon")?(this.fieldList[l].levels.push(h),this.fieldList[l].isHierarchy=!1):this.fieldList[l].isHierarchy=!0}}this.fieldListData=r=r.concat(a);var u={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASURES",roles:i.dataSourceSettings.roles};this.getTreeData(u,this.loadMeasureElements.bind(this),i)},e.prototype.loadMeasureElements=function(e,i,a){for(var r,n=this.fieldListData,s=[],o=[],l=0,d=(0,t.extend)([],this.values,null,!0);l<d.length;l++){var p=d[l];o.push(p.name)}if("en-US"!==this.locale){var h={catalog:a.dataSourceSettings.catalog,cube:a.dataSourceSettings.cube,url:a.dataSourceSettings.url,LCID:a.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASUREGROUPS",roles:a.dataSourceSettings.roles};this.getTreeData(h,this.loadMeasureGroups.bind(this),a)}for(var u=0,c=[].slice.call(e.querySelectorAll("row"));u<c.length;u++){p=c[u];var g=(0,t.isNullOrUndefined)(p.querySelector("MEASUREGROUP_NAME"))?"":p.querySelector("MEASUREGROUP_NAME").textContent,m=p.querySelector("MEASURE_UNIQUE_NAME").textContent,f=p.querySelector("DEFAULT_FORMAT_STRING")?p.querySelector("DEFAULT_FORMAT_STRING").textContent:"#,#",S=p.querySelector("MEASURE_AGGREGATOR")?p.querySelector("MEASURE_AGGREGATOR").textContent:"1";if(!(s.indexOf(g)>=0)){if("en-US"!==this.locale){for(var v=[],y=0,b=this.fieldListObj.measuresGroups;y<b.length;y++){var C=b[y];C.querySelector("MEASUREGROUP_NAME").textContent===g&&v.push(C)}r=v.length>0?v[0].querySelector("MEASUREGROUP_CAPTION").textContent:g}else r=g;""!==g&&(n.push({hasChildren:!0,isChecked:!1,isSelected:!1,pid:"[Measures]",id:g,name:r,spriteCssClass:"e-measureCDB e-folderCDB-icon "+Yi,tag:g,caption:r,aggregateType:this.getAggregateType(g,S),type:"string"}),s.push(g))}var x={hasChildren:!1,isSelected:o.indexOf(m)>=0,pid:""===g?"[Measures]":g,id:m,name:p.querySelector("MEASURE_CAPTION").textContent,spriteCssClass:"e-measure-icon "+Yi,tag:m,caption:this.dataFields[m]&&this.dataFields[m].caption?this.dataFields[m].caption:this.mappingFields[m]&&this.mappingFields[m].caption?this.mappingFields[m].caption:p.querySelector("MEASURE_CAPTION").textContent,aggregateType:this.getAggregateType(m,S),type:"number",filter:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},formatString:f,allowDragAndDrop:this.dataFields[m]?this.dataFields[m].allowDragAndDrop:!this.mappingFields[m]||this.mappingFields[m].allowDragAndDrop,showFilterIcon:this.dataFields[m]?this.dataFields[m].showFilterIcon:!this.mappingFields[m]||this.mappingFields[m].showFilterIcon,showSortIcon:this.dataFields[m]?this.dataFields[m].showSortIcon:!this.mappingFields[m]||this.mappingFields[m].showSortIcon,showEditIcon:this.dataFields[m]?this.dataFields[m].showEditIcon:!this.mappingFields[m]||this.mappingFields[m].showEditIcon,showRemoveIcon:this.dataFields[m]?this.dataFields[m].showRemoveIcon:!this.mappingFields[m]||this.mappingFields[m].showRemoveIcon,showValueTypeIcon:this.dataFields[m]?this.dataFields[m].showValueTypeIcon:!this.mappingFields[m]||this.mappingFields[m].showValueTypeIcon,showSubTotals:this.dataFields[m]?this.dataFields[m].showSubTotals:!this.mappingFields[m]||this.mappingFields[m].showSubTotals};n.push(x),this.fieldList[m]=x,o.indexOf(m)>=0&&o.splice(o.indexOf(m),1)}this.measureReportItems=o},e.prototype.loadMeasureGroups=function(e){(0,t.isNullOrUndefined)(this.fieldListObj)&&(this.fieldListObj={}),this.fieldListObj.measuresGroups=[].slice.call(e.querySelectorAll("row"))},e.prototype.doAjaxPost=function(e,i,a,r,n){var s=this;new t.Ajax({mode:!1,contentType:"text/xml",url:i,data:a,dataType:"xml",type:e,beforeSend:this.beforeSend.bind(this),onSuccess:function(e,t){var i=(new DOMParser).parseFromString(e,"text/xml"),a=i.querySelector("Body");a.querySelector("OlapInfo")||a.querySelector("DiscoverResponse")||(a.querySelector("Fault")?s.errorInfo=a.querySelector("Fault").querySelector("faultstring").innerHTML:s.errorInfo=a.querySelector("return").querySelector("Error").getAttribute("Description")),r(i,t,n)},onFailure:function(e){s.errorInfo=e}}).send()},e.prototype.beforeSend=function(e){this.dataSourceSettings.authentication.userName&&this.dataSourceSettings.authentication.password&&e.httpRequest.setRequestHeader("Authorization","Basic "+btoa(this.dataSourceSettings.authentication.userName+":"+this.dataSourceSettings.authentication.password))},e.prototype.getSoapMsg=function(e,t){var i=this.getConnectionInfo(e.url,e.localeIdentifier);return this.isMondrian?'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+t+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+""+"</DataSourceInfo><Catalog>"+e.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>":'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+t+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+i.LCID+"</LocaleIdentifier>"+(e.roles?"<Roles>"+e.roles+"</Roles>":"")+"</PropertyList> </Properties> </Execute> </Body> </Envelope>"},e.prototype.getConnectionInfo=function(e,i){var a={url:"",LCID:(0,t.isNullOrUndefined)(i)?"1033":i.toString()};if(""!==e)for(var r=0,n=e.split(";");r<n.length;r++){var s=n[r];s.toLowerCase().indexOf("locale")<0&&0===a.url.length?a.url=s:s.toLowerCase().indexOf("locale")>=0&&(a.LCID=s.replace(/ /g,"").split("=")[1])}return a},e.prototype.getMDXQuery=function(e){return Bo.getCellSets(e,this,!0,void 0,!0),this.mdxQuery},e}(),Go=S(727),zo=function(){function e(){}return e.prototype.drawHeader=function(e,t){var i=t.pageSettings.size,r=e.header,n=new a.PointF(0,r&&r.fromTop?r.fromTop:0),s=new a.SizeF(i.width-80,r&&r.height?.75*r.height:50),o=new a.RectangleF(n,s);t.template.top=this.drawPageTemplate(new a.PdfPageTemplateElement(o),r)},e.prototype.drawFooter=function(e,t){var i=t.pageSettings.size,r=e.footer,n=new a.PointF(0,i.width-80-(r&&r.fromBottom?.75*r.fromBottom:0)),s=new a.SizeF(i.width-80,r&&r.height?.75*r.height:50),o=new a.RectangleF(n,s);t.template.bottom=this.drawPageTemplate(new a.PdfPageTemplateElement(o),r)},e.prototype.drawPageTemplate=function(e,i){for(var a=0,r=i.contents;a<r.length;a++){var n=r[a];switch(this.processContentValidation(n),n.type){case"Text":if(""===n.value||(0,t.isNullOrUndefined)(n.value)||"string"!=typeof n.value)throw new Error("please enter the valid input value in text content...");this.drawText(e,n);break;case"PageNumber":this.drawPageNumber(e,n);break;case"Image":if((0,t.isNullOrUndefined)(n.src)||""===n.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(e,n);break;case"Line":this.drawLine(e,n)}}return e},e.prototype.processContentValidation=function(e){if((0,t.isNullOrUndefined)(e.type))throw new Error("please set valid content type...");if("Line"===e.type){if((0,t.isNullOrUndefined)(e.points))throw new Error("please enter valid points in "+e.type+" content...");if((0,t.isNullOrUndefined)(e.points.x1)||"number"!=typeof e.points.x1)throw new Error("please enter valid x1 co-ordinate in "+e.type+" points...");if((0,t.isNullOrUndefined)(e.points.y1)||"number"!=typeof e.points.y1)throw new Error("please enter valid y1 co-ordinate in "+e.type+" points...");if((0,t.isNullOrUndefined)(e.points.x2)||"number"!=typeof e.points.x2)throw new Error("please enter valid x2 co-ordinate in "+e.type+" points...");if((0,t.isNullOrUndefined)(e.points.y2)||"number"!=typeof e.points.y2)throw new Error("please enter valid y2 co-ordinate in "+e.type+" points...")}else{if((0,t.isNullOrUndefined)(e.position))throw new Error("please enter valid position in "+e.type+" content...");if((0,t.isNullOrUndefined)(e.position.x)||"number"!=typeof e.position.x)throw new Error("please enter valid x co-ordinate in "+e.type+" position...");if((0,t.isNullOrUndefined)(e.position.y)||"number"!=typeof e.position.y)throw new Error("please enter valid y co-ordinate in "+e.type+" position...")}},e.prototype.drawText=function(e,i){var r=this.getFontFromContent(i),n=this.getBrushFromContent(i),s=null;if(!(0,t.isNullOrUndefined)(i.style)&&!(0,t.isNullOrUndefined)(i.style.textPenColor)){var o=this.hexDecToRgb(i.style.textPenColor);s=new a.PdfPen(new a.PdfColor(o.r,o.g,o.b))}null==n&&null==s&&(n=new a.PdfSolidBrush(new a.PdfColor(0,0,0)));var l=i.value.toString(),d=.75*i.position.x,p=.75*i.position.y,h=new a.PdfStringFormat;(0,t.isNullOrUndefined)(i.stringFormat)||(h=i.stringFormat);var u=this.setContentFormat(i,h);null===u||(0,t.isNullOrUndefined)(u.format)||(0,t.isNullOrUndefined)(u.size)?e.graphics.drawString(l,r,s,n,d,p,h):e.graphics.drawString(l,r,s,n,d,p,u.size.width,u.size.height,u.format)},e.prototype.drawPageNumber=function(e,i){var r=this.getFontFromContent(i),n=null;if((0,t.isNullOrUndefined)(i.style)||(0,t.isNullOrUndefined)(i.style.textBrushColor))n=new a.PdfSolidBrush(new a.PdfColor(0,0,0));else{var s=this.hexDecToRgb(i.style.textBrushColor);n=new a.PdfSolidBrush(new a.PdfColor(s.r,s.g,s.b))}var o,l,d=new a.PdfPageNumberField(r,n);if(d.numberStyle=this.getPageNumberStyle(i.pageNumberType),(0,t.isNullOrUndefined)(i.format))l="{0}",o=new a.PdfCompositeField(r,n,l,d);else{var p="$total",h="$current";if(-1!==i.format.indexOf(p)&&-1!==i.format.indexOf(h))(u=new a.PdfPageCountField(r)).numberStyle=this.getPageNumberStyle(i.pageNumberType),l=i.format.indexOf(p)>i.format.indexOf(h)?(l=i.format.replace(h,"0")).replace(p,"1"):(l=i.format.replace(h,"1")).replace(p,"0"),o=new a.PdfCompositeField(r,n,l,d,u);else if(-1!==i.format.indexOf(h)&&-1===i.format.indexOf(p))l=i.format.replace(h,"0"),o=new a.PdfCompositeField(r,n,l,d);else{var u=new a.PdfPageCountField(r);l=i.format.replace(p,"0"),o=new a.PdfCompositeField(r,n,l,u)}}var c=.75*i.position.x,g=.75*i.position.y,m=this.setContentFormat(i,o.stringFormat);null===m||(0,t.isNullOrUndefined)(m.format)||(0,t.isNullOrUndefined)(m.size)||(o.stringFormat=m.format,o.bounds=new a.RectangleF(c,g,m.size.width,m.size.height)),o.draw(e.graphics,c,g)},e.prototype.drawImage=function(e,i){var r=.75*i.position.x,n=.75*i.position.y,s=(0,t.isNullOrUndefined)(i.size)||(0,t.isNullOrUndefined)(i.size.width)?void 0:.75*i.size.width,o=(0,t.isNullOrUndefined)(i.size)||(0,t.isNullOrUndefined)(i.size.height)?void 0:.75*i.size.height,l=new a.PdfBitmap(i.src);(0,t.isNullOrUndefined)(s)?e.graphics.drawImage(l,r,n):e.graphics.drawImage(l,r,n,s,o)},e.prototype.drawLine=function(e,i){var a=.75*i.points.x1,r=.75*i.points.y1,n=.75*i.points.x2,s=.75*i.points.y2,o=this.getPenFromContent(i);(0,t.isNullOrUndefined)(i.style)||((0,t.isNullOrUndefined)(i.style.penSize)||"number"!=typeof i.style.penSize||(o.width=.75*i.style.penSize),o.dashStyle=this.getDashStyle(i.style.dashStyle)),e.graphics.drawLine(o,a,r,n,s)},e.prototype.getFontFromContent=function(e){var i=(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.fontSize)?(0,t.isNullOrUndefined)(e.style)||(0,t.isNullOrUndefined)(e.style.fontSize)?9.75:.75*e.style.fontSize:.75*e.font.fontSize,r=(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.pdfFontFamily)?a.PdfFontFamily.TimesRoman:e.font.pdfFontFamily,n=a.PdfFontStyle.Regular;return(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.bold)||(n|=a.PdfFontStyle.Bold),(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.italic)||(n|=a.PdfFontStyle.Italic),(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.underline)||(n|=a.PdfFontStyle.Underline),(0,t.isNullOrUndefined)(e.font)||(0,t.isNullOrUndefined)(e.font.strikeout)||(n|=a.PdfFontStyle.Strikeout),new a.PdfStandardFont(r,i,n)},e.prototype.getPenFromContent=function(e){var i=new a.PdfPen(new a.PdfColor(0,0,0));if(!(0,t.isNullOrUndefined)(e.style)&&null!==e.style&&!(0,t.isNullOrUndefined)(e.style.penColor)){var r=this.hexDecToRgb(e.style.penColor);i=new a.PdfPen(new a.PdfColor(r.r,r.g,r.b))}return i},e.prototype.getBrushFromContent=function(e){var i=null;if(!(0,t.isNullOrUndefined)(e.style)&&!(0,t.isNullOrUndefined)(e.style.textBrushColor)){var r=this.hexDecToRgb(e.style.textBrushColor);i=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b))}return i},e.prototype.setContentFormat=function(e,i){if(!(0,t.isNullOrUndefined)(e.size)){var r=.75*e.size.width,n=.75*e.size.height;if(i=new a.PdfStringFormat(a.PdfTextAlignment.Left,a.PdfVerticalAlignment.Middle),!(0,t.isNullOrUndefined)(e.style)&&!(0,t.isNullOrUndefined)(e.style.hAlign))switch(e.style.hAlign){case"Right":i.alignment=a.PdfTextAlignment.Right;break;case"Center":i.alignment=a.PdfTextAlignment.Center;break;case"Justify":i.alignment=a.PdfTextAlignment.Justify}if(!(0,t.isNullOrUndefined)(e.style)&&!(0,t.isNullOrUndefined)(e.style.vAlign))switch(e.style.vAlign){case"Bottom":i.lineAlignment=a.PdfVerticalAlignment.Bottom;break;case"Top":i.lineAlignment=a.PdfVerticalAlignment.Top}return{format:i,size:new a.SizeF(r,n)}}return null},e.prototype.getPageNumberStyle=function(e){switch(e){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}},e.prototype.getDashStyle=function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},e.prototype.hexDecToRgb=function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color..");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},e}(),Wo=function(){function e(e){this.parent=e,this.pdfExportHelper=new zo}return e.prototype.getModuleName=function(){return"chartExport"},e.prototype.pdfChartExport=function(e,i,r,n){var s=this,o=[this.parent.chart],l=this.getChartInfo(o),d=l.width,p=l.height,h=this.parent.chart.svgObject;this.parent.chart.enableCanvas||(h=(0,t.createElement)("canvas",{id:"ej2-canvas",attrs:{width:d.toString(),height:p.toString()}}));var u=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(l.svg)],{type:"image/svg+xml"})),c=new Image,g=h.getContext("2d");return c.src=u,new Promise((function(o){c.onload=function(){var l;l=(0,t.isNullOrUndefined)(i)?new a.PdfDocument:i,g.drawImage(c,0,0),window.URL.revokeObjectURL(u),s.exportPdf(h,l,r,n,d,p,e),o(l)}}))},e.prototype.getChartInfo=function(e,i){var a,r=0,n=0,s=this.parent.chart.enableCanvas,o=new Go.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200});return e.map((function(e){var l=e.svgObject.cloneNode(!0),d=e.renderer.createGroup({style:(0,t.isNullOrUndefined)(i)||i?"transform: translateY("+n+"px)":"transform: translateX("+r+"px)"});"transparent"===(a=l.childNodes[0]?l.childNodes[0].getAttribute("fill"):"transparent")&&(a=e.theme.indexOf("Dark")>-1||"HighContrast"===e.theme?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)"),s||d.appendChild(l),r=e.availableSize.width,n=e.availableSize.height,s||o.appendChild(d)})),s||(o.setAttribute("width",r+""),o.setAttribute("height",n+""),o.setAttribute("style","background-color: "+a+";")),{width:r,height:n,svg:o}},e.prototype.exportPdf=function(e,i,n,s,o,l,d){var p=i.sections.add(),h=i.pageSettings.width,u=i.pageSettings.height,c=i.pageSettings.margins,g=o+c.left+c.right;i.pageSettings.size=new a.SizeF(g,u);var m=this.exportProperties.fileName?this.exportProperties.fileName:(0,t.isNullOrUndefined)(d)||(0,t.isNullOrUndefined)(d.fileName)?"default":d.fileName;if(this.exportProperties.width||this.exportProperties.height?(i.pageSettings.orientation=this.exportProperties.width>this.exportProperties.height||!this.exportProperties.height&&this.exportProperties.width>u||!this.exportProperties.width&&h>this.exportProperties.height?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,i.pageSettings.size=new a.SizeF(this.exportProperties.width?this.exportProperties.width:h,this.exportProperties.height?this.exportProperties.height:u)):(i.pageSettings.orientation=0===this.exportProperties.orientation||this.exportProperties.orientation?this.exportProperties.orientation:(0,t.isNullOrUndefined)(d)||(0,t.isNullOrUndefined)(d.pageOrientation)||"Landscape"===d.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,(0,t.isNullOrUndefined)(d)||(0,t.isNullOrUndefined)(d.pageSize)||(i.pageSettings.size=r.getPageSize(d.pageSize))),!(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins)){var S=i.pageSettings.margins;S.top=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.top)?S.top:this.exportProperties.pdfMargins.top,S.bottom=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.bottom)?S.bottom:this.exportProperties.pdfMargins.bottom,S.left=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.left)?S.left:this.exportProperties.pdfMargins.left,S.right=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.right)?S.right:this.exportProperties.pdfMargins.right}p.setPageSettings(i.pageSettings),u=i.pageSettings.height;var v=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");v=v.slice(v.indexOf(",")+1);var y,b=new a.PdfBitmap(v),C=p.pages.add();(0,t.isNullOrUndefined)(d)||(0,t.isNullOrUndefined)(d.header)||this.pdfExportHelper.drawHeader(d,i),(0,t.isNullOrUndefined)(d)||(0,t.isNullOrUndefined)(d.footer)||this.pdfExportHelper.drawFooter(d,i),C.graphics.drawImage(b,0,0,u<l||this.exportProperties.width||i.pageSettings.size?C.getClientSize().width:g,u<l?C.getClientSize().height:l),s||n?s&&(y=i.save()):(i.save(m+".pdf"),i.destroy());var x={type:"PDF",promise:s?y:null};return this.parent.trigger(f,x),new Promise((function(){}))},e.prototype.destroy=function(){this.exportProperties&&(this.exportProperties=null),this.pdfExportHelper&&(this.pdfExportHelper=null)},e}(),Qo=S(115),Yo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ko=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},Xo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)(!0)],i.prototype,"showFilterIcon",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showSortIcon",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showRemoveIcon",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showValueTypeIcon",void 0),Ko([(0,t.Property)("Both")],i.prototype,"displayMode",void 0),Ko([(0,t.Property)(!0)],i.prototype,"allowDragAndDrop",void 0),Ko([(0,t.Property)(!1)],i.prototype,"showFieldsPanel",void 0),i}(t.ChildProperty),Jo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)(!1)],i.prototype,"allowAdding",void 0),Ko([(0,t.Property)(!1)],i.prototype,"allowEditing",void 0),Ko([(0,t.Property)(!1)],i.prototype,"allowDeleting",void 0),Ko([(0,t.Property)(!1)],i.prototype,"allowCommandColumns",void 0),Ko([(0,t.Property)(!1)],i.prototype,"allowInlineEditing",void 0),Ko([(0,t.Property)("Normal")],i.prototype,"mode",void 0),Ko([(0,t.Property)(!0)],i.prototype,"allowEditOnDblClick",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showConfirmDialog",void 0),Ko([(0,t.Property)(!1)],i.prototype,"showDeleteConfirmDialog",void 0),i}(t.ChildProperty),Zo=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)()],i.prototype,"measure",void 0),Ko([(0,t.Property)()],i.prototype,"label",void 0),Ko([(0,t.Property)("NotEquals")],i.prototype,"conditions",void 0),Ko([(0,t.Property)()],i.prototype,"value1",void 0),Ko([(0,t.Property)()],i.prototype,"value2",void 0),i}(t.ChildProperty),$o=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)(!1)],i.prototype,"showHyperlink",void 0),Ko([(0,t.Property)(!1)],i.prototype,"showRowHeaderHyperlink",void 0),Ko([(0,t.Property)(!1)],i.prototype,"showColumnHeaderHyperlink",void 0),Ko([(0,t.Property)(!1)],i.prototype,"showValueCellHyperlink",void 0),Ko([(0,t.Property)(!1)],i.prototype,"showSummaryCellHyperlink",void 0),Ko([(0,t.Collection)([],Zo)],i.prototype,"conditionalSettings",void 0),Ko([(0,t.Property)()],i.prototype,"headerText",void 0),Ko([(0,t.Property)("")],i.prototype,"cssClass",void 0),i}(t.ChildProperty),el=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)(5)],i.prototype,"columnPageSize",void 0),Ko([(0,t.Property)(5)],i.prototype,"rowPageSize",void 0),Ko([(0,t.Property)(1)],i.prototype,"currentColumnPage",void 0),Ko([(0,t.Property)(1)],i.prototype,"currentRowPage",void 0),i}(t.ChildProperty),tl=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)("Bottom")],i.prototype,"position",void 0),Ko([(0,t.Property)(!1)],i.prototype,"isInversed",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showRowPager",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showColumnPager",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showRowPageSize",void 0),Ko([(0,t.Property)(!0)],i.prototype,"showColumnPageSize",void 0),Ko([(0,t.Property)([10,50,100,200])],i.prototype,"rowPageSizes",void 0),Ko([(0,t.Property)([5,10,20,50,100])],i.prototype,"columnPageSizes",void 0),Ko([(0,t.Property)(!1)],i.prototype,"enableCompactView",void 0),Ko([(0,t.Property)()],i.prototype,"template",void 0),i}(t.ChildProperty),il=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)("Table")],i.prototype,"view",void 0),Ko([(0,t.Property)("Table")],i.prototype,"primary",void 0),i}(t.ChildProperty),al=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Yo(i,e),Ko([(0,t.Property)(!1)],i.prototype,"allowSinglePage",void 0),i}(t.ChildProperty),rl=function(e){function n(i,a){var r=e.call(this,i,a)||this;return r.verticalScrollScale=1,r.horizontalScrollScale=1,r.scrollerBrowserLimit=8e6,r.lastSortInfo={},r.lastFilterInfo={},r.lastAggregationInfo={},r.lastCalcFieldInfo={},r.isScrolling=!1,r.allowEngineExport=!1,r.isInitial=!0,r.shiftLockedPos=[],r.savedSelectedCellsPos=[],r.cellSelectionPos=[],r.isPopupClicked=!1,r.isMouseDown=!1,r.isMouseUp=!1,r.fieldsType={},r.remoteData=[],r.defaultItems={},r.isCellBoxMultiSelection=!1,r.gridCellCollection={},r.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},r.isStaticRefresh=!1,r.resizeInfo={},r.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},r.pivotColumns=[],r.totColWidth=0,r.posCount=0,r.isModified=!1,r.isInitialRendering=!1,r.needsID=!0,r.pivotRefresh=t.Component.prototype.refresh,r.request="undefined"!=typeof window?new XMLHttpRequest:null,r.isServerWaitingPopup=!1,r.actionObj={},r.defaultFieldListOrder="None",r.destroyEngine=!1,r.pivotView=r,(0,t.setValue)("mergePersistData",r.mergePersistPivotData,r),r}return Yo(n,e),n.prototype.requiredModules=function(){var e=[];return this.showGroupingBar&&e.push({args:[this],member:"groupingBar"}),this.allowConditionalFormatting&&e.push({args:[this],member:"conditionalFormatting"}),this.allowNumberFormatting&&e.push({args:[this],member:"numberFormatting"}),this.allowCalculatedField&&e.push({args:[this],member:"calculatedField"}),this.showToolbar&&(this.toolbar.length>0||this.toolbarTemplate)&&e.push({args:[this],member:"toolbar"}),this.showFieldList&&e.push({args:[this],member:"fieldList"}),this.allowExcelExport&&e.push({args:[this],member:"excelExport"}),this.allowPdfExport&&e.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&e.push({args:[this],member:"virtualscroll"}),this.allowGrouping&&e.push({args:[this],member:"grouping"}),(this.allowDrillThrough||this.editSettings&&this.editSettings.allowEditing)&&e.push({args:[this],member:"drillThrough"}),this.enablePaging&&e.push({args:[this],member:"pager"}),e},n.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.dataType="olap",this.olapEngineModule=new _o):(this.dataType="pivot",this.engineModule=new s),this.isAdaptive=t.Browser.isDevice,t.Browser.isIE||"edge"===t.Browser.info.name?this.scrollerBrowserLimit=15e5:"chrome"===t.Browser.info.name&&(this.scrollerBrowserLimit=15e6),this.isTouchMode=!!(0,t.closest)(this.element,"e-bigger"),this.initProperties(),this.renderToolTip(),this.keyboardModule=new Gs(this),this.contextMenuModule=new zs(this),this.globalize=new t.Internationalization(this.locale),(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.commonModule=new Ts(this)),!this.allowPdfExport||"Both"!==this.displayOption.view&&"Chart"!==this.displayOption.view||(this.chartExportModule=new Wo(this)),this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormatting:"Conditional Formatting",apply:"Apply",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field",baseItem:"Base item",summarizeValuesBy:"Summarize values by",sourceName:"Field name :",sourceCaption:"Field caption",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report",new:"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report",export:"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",png:"PNG",jpeg:"JPEG",svg:"SVG",mdxQuery:"MDX Query",showSubTotals:"Show subtotals",doNotShowSubTotals:"Do not show subtotals",showSubTotalsRowsOnly:"Show subtotals rows only",showSubTotalsColumnsOnly:"Show subtotals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter valid report name!!!",reportList:"Report list",removeConfirm:"Are you sure you want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",pie:"Pie",funnel:"Funnel",doughnut:"Doughnut",pyramid:"Pyramid",stackingcolumn:"Stacked Column",stackingarea:"Stacked Area",stackingbar:"Stacked Bar",stackingline:"Stacked Line",stepline:"Step Line",steparea:"Step Area",splinearea:"Spline Area",spline:"Spline",stackingcolumn100:"100% Stacked Column",stackingbar100:"100% Stacked Bar",stackingarea100:"100% Stacked Area",stackingline100:"100% Stacked Line",bubble:"Bubble",pareto:"Pareto",radar:"Radar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Do you want to save the changes to this report?",emptyReportName:"Enter a report name",qtr:"Qtr",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping",true:"True",false:"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting",memberType:"Field Type",formatString:"Format",expressionField:"Expression",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",selectedHierarchy:"Parent Hierarchy",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",Percent:"Percent",Currency:"Currency",Custom:"Custom",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",drillError:"Cannot show the raw items of calculated fields.",caption:"Field Caption",copy:"Copy",defaultReport:"Sample Report",customFormatString:"Custom Format",invalidFormat:"Invalid Format.",group:"Group",unGroup:"Ungroup",invalidSelection:"Cannot group that selection.",groupName:"Enter the caption to display in header",captionName:"Enter the caption for group field",selectedItems:"Selected items",groupFieldCaption:"Field caption",groupTitle:"Group name",startAt:"Starting at",endAt:"Ending at",groupBy:"Interval by",selectGroup:"Select groups",multipleAxes:"Multiple Axis",showLegend:"Show Legend",exit:"Exit",chartTypeSettings:"Chart Type Settings",ChartType:"Chart Type",yes:"Yes",no:"No",numberFormatMenu:"Number Formatting...",conditionalFormattingMenu:"Conditional Formatting...",removeCalculatedField:"Are you sure you want to delete this calculated field?",replaceConfirmBefore:"A report named ",replaceConfirmAfter:" already exists. Do you want to replace it?",invalidJSON:"Invalid JSON data",invalidCSV:"Invalid CSV data",stacked:"Stacked",single:"Single",combined:"Combined",multipleAxisMode:"Multiple Axis Mode",grandTotalPosition:"Grand totals position",top:"Top",bottom:"Bottom",None:"None",rowPage:"Row pager",rowPerPage:"Rows per page",columnPage:"Column pager",columnPerPage:"Columns per page",goToFirstPage:"Go to first page",goToPreviousPage:"Go to previous page",goToNextPage:"Go to next page",goToLastPage:"Go to last page",subTotalPosition:"Subtotals position",auto:"Auto",loading:"Loading...",add:"Add"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.renderContextMenu(),this.isDragging=!1,this.pivotDeferLayoutUpdate=(0,t.isNullOrUndefined)(this.pivotDeferLayoutUpdate)?this.allowDeferLayoutUpdate:this.pivotDeferLayoutUpdate,this.addInternalEvents()},n.prototype.onBeforeTooltipOpen=function(e){e.element.classList.add("e-pivottooltipwrap")},n.prototype.renderToolTip=function(){this.showTooltip?(this.tooltipTemplate?this.tooltip=new o.Tooltip({target:"td.e-valuescontent",cssClass:"e-pivottooltiptemplate"+(this.cssClass?" "+this.cssClass:""),showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,enableHtmlSanitizer:this.enableHtmlSanitizer,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}):this.tooltip=new o.Tooltip({target:"td.e-valuescontent",cssClass:this.cssClass,showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,enableHtmlSanitizer:this.enableHtmlSanitizer,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()},n.prototype.renderContextMenu=function(){if(this.gridSettings.contextMenuItems||this.allowGrouping&&"pivot"===this.dataType){var e=[],t=[],i=[],a=[],r=[],n=[],s=[];if(this.gridSettings.contextMenuItems)for(var o=0,l=this.gridSettings.contextMenuItems;o<l.length;o++){var d=l[o];if("string"==typeof d&&-1!==this.getDefaultItems().indexOf(d))if(-1!==d.toString().toLowerCase().indexOf("aggregate")&&"pivot"===this.dataType){s=[{text:this.localeObj.getConstant("Sum")}];var p=this.buildDefaultItems("Aggregate");p.items=s,r.push(p)}else-1!==d.toString().toLowerCase().indexOf("export")?a.push(this.buildDefaultItems(d)):e.push(this.buildDefaultItems(d));else"string"!=typeof d&&i.push(d)}if(this.allowGrouping&&"pivot"===this.dataType&&(this.getFieldByID(this.element.id+"_custom_group",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Group")),this.getFieldByID(this.element.id+"_custom_ungroup",this.gridSettings.contextMenuItems)||t.push(this.buildDefaultItems("Ungroup"))),a.length>0){var h=this.buildDefaultItems("export");h.items=a,n.push(h)}var u=[];Array.prototype.push.apply(u,r),Array.prototype.push.apply(u,e),Array.prototype.push.apply(u,t),Array.prototype.push.apply(u,n),Array.prototype.push.apply(u,i),this.setProperties({gridSettings:{contextMenuItems:u}},!0)}},n.prototype.getFieldByID=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("id","equal",e))[0]},n.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},n.prototype.getDefaultItems=function(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]},n.prototype.buildDefaultItems=function(e){var t;switch(e){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot.e-rowsheader",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("CalculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+Yi};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+Yi};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:Fn+" "+Yi};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:Ln+" "+Yi};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:An+" "+Yi};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+Yi};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+Yi};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+Yi};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+Yi};break;case"Group":t={text:this.localeObj.getConstant("group"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_group",iconCss:"e-pivotview-group "+Yi};break;case"Ungroup":t={text:this.localeObj.getConstant("unGroup"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_ungroup",iconCss:"e-pivotview-ungroup "+Yi}}return this.defaultItems[e]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[e]},n.prototype.initProperties=function(){this.pivotRefresh=t.Component.prototype.refresh,this.minHeight=(0,t.isNullOrUndefined)(this.minHeight)?300:this.minHeight<10?10:this.minHeight,this.isScrolling=!1,this.allowServerDataBinding=!1,this.isStaticRefresh=!1,this.setProperties({pivotValues:[]},!0),this.allowServerDataBinding=!0,this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo:void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo:void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo:void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo:void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0,this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0,this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0,this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0,this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0,this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0,this.chartLegendClick=this.chartSettings.legendClick?this.chartSettings.legendClick:void 0,this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0,this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0,this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0,this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0,this.multiLevelLabelClick=this.chartSettings.multiLevelLabelClick?this.chartSettings.multiLevelLabelClick:void 0,this.chartPointClick=this.chartSettings.pointClick?this.chartSettings.pointClick:void 0,this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0,this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0,this.beforePdfExport=this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,this.beforeExcelExport=this.gridSettings.beforeExcelExport?this.gridSettings.beforeExcelExport.bind(this):void 0,this.beforePrint=this.chartSettings.beforePrint?this.chartSettings.beforePrint:void 0,this.animationComplete=this.chartSettings.animationComplete?this.chartSettings.animationComplete:void 0,this.legendRender=this.chartSettings.legendRender?this.chartSettings.legendRender:void 0,this.textRender=this.chartSettings.textRender?this.chartSettings.textRender:void 0,this.pointRender=this.chartSettings.pointRender?this.chartSettings.pointRender:void 0,this.seriesRender=this.chartSettings.seriesRender?this.chartSettings.seriesRender:void 0,this.chartMouseMove=this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove:void 0,this.chartMouseClick=this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick:void 0,this.pointMove=this.chartSettings.pointMove?this.chartSettings.pointMove:void 0,this.chartMouseLeave=this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave:void 0,this.chartMouseDown=this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown:void 0,this.chartMouseUp=this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp:void 0,this.dragComplete=this.chartSettings.dragComplete?this.chartSettings.dragComplete:void 0,this.zoomComplete=this.chartSettings.zoomComplete?this.chartSettings.zoomComplete:void 0,this.scrollStart=this.chartSettings.scrollStart?this.chartSettings.scrollStart:void 0,this.scrollEnd=this.chartSettings.scrollEnd?this.chartSettings.scrollEnd:void 0,this.scrollChanged=this.chartSettings.scrollChanged?this.chartSettings.scrollChanged:void 0,this.multiLevelLabelRender=this.chartSettings.multiLevelLabelRender?this.chartSettings.multiLevelLabelRender:void 0,null===this.gridSettings.rowHeight&&(this.isTouchMode?this.setProperties({gridSettings:{rowHeight:36}},!0):this.setProperties({gridSettings:{rowHeight:this.isAdaptive?36:30}},!0)),this.chartSettings&&this.chartSettings.showMemberSeries&&!this.chartSettings.showPointColorByMembers&&this.setProperties({chartSettings:{showPointColorByMembers:!0}},!0),this.element.style.height="100%",this.enableVirtualization&&this.updatePageSettings(!0),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&!this.isCellBoxMultiSelection&&(this.isCellBoxMultiSelection=!0,this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0)),"Table"!==this.displayOption.view&&(this.pivotChartModule=new Xs),this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view},n.prototype.updatePageSettings=function(e){if(this.enableVirtualization){var t=1,i=1;this.dataSourceSettings.values.length>1&&"pivot"===this.dataType&&("row"===this.dataSourceSettings.valueAxis?i=this.dataSourceSettings.values.length:t=this.dataSourceSettings.values.length);var a=this.getHeightAsNumber();isNaN(a)&&(a=this.element.offsetHeight),this.pageSettings={currentColumnPage:e?1:this.pageSettings.currentColumnPage,currentRowPage:e?1:this.pageSettings.currentRowPage,columnPageSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/t),rowPageSize:Math.ceil(Math.floor(a/this.gridSettings.rowHeight)/i)}}},n.prototype.render=function(){this.loadData()},n.prototype.loadData=function(){if(this.dataSourceSettings.formatSettings.length>0)for(var e=this.dataSourceSettings.formatSettings,i=0;i<e.length;i++)(0,t.isNullOrUndefined)(e[i].maximumFractionDigits)&&(0,t.isNullOrUndefined)(e[i].minimumFractionDigits)||null!==e[i].format.match(/^(P|N|C|P[0-9]|C[0-9]|N[0-9])$/g)||(e[i].maximumFractionDigits=void 0,e[i].minimumIntegerDigits=void 0);"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=r.generateUUID(),this.initialLoad(),"Chart"!==this.displayOption.view&&this.renderEmptyGrid(),this.showWaitingPopup()):new t.Fetch(this.dataSourceSettings.url,"GET").send().then((function(e){return"string"==typeof e?e:e.text()})).then(this.onReadyStateChange.bind(this)):this.initialLoad()},n.prototype.onSuccess=function(e){if(this.request.readyState===XMLHttpRequest.DONE)if("onExcelExport"===this.currentAction||"onCsvExport"===this.currentAction){if(200===this.request.status){var i=this.request.response,a=(0,t.isNullOrUndefined)(e.fileName)?"onExcelExport"===this.currentAction?"default.xlsx":"default.csv":e.fileName;Qo.Save.save(a,i)}}else{this.isServerWaitingPopup=!0;try{var n={action:this.currentAction,response:this.request.responseText};this.trigger(He,n);var s=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){var o=JSON.parse(s.members),l=[],d={};this.engineModule.globalize=(0,t.isNullOrUndefined)(this.globalize)?new t.Internationalization:this.globalize,this.engineModule.formatFields=this.engineModule.setFormattedFields(this.dataSourceSettings.formatSettings);for(var p=r.isDateField(s.memberName,this.engineModule),h="number"===this.engineModule.fieldList[s.memberName].type,u=Object.keys(o),c=0,g=u.length;c<g;c++){var m=o[u[c]],f=p?this.engineModule.getFormattedValue(m.Name,s.memberName):{formattedText:m.Caption};d[u[c]]={index:m.Index,ordinal:m.Ordinal,isDrilled:m.IsDrilled,caption:f.formattedText},l.push({formattedText:f.formattedText,actualText:p?f.dateText:h?isNaN(Number(m.Name))?m.Name:Number(m.Name):m.Name})}this.engineModule.fieldList[s.memberName].members=d,this.engineModule.fieldList[s.memberName].dateMember=l,this.showGroupingBar?this.pivotButtonModule.updateFilterEvents():this.pivotFieldListModule.pivotButtonModule.updateFilterEvents()}else if("fetchRawData"===this.currentAction){for(var S=this.engineModule.fieldList[this.drillThroughValue.actualText.toString()]?this.engineModule.fieldList[this.drillThroughValue.actualText.toString()].caption:this.drillThroughValue.actualText.toString(),v=this.engineModule.fieldList[this.drillThroughValue.actualText]?this.engineModule.fieldList[this.drillThroughValue.actualText].aggregateType:"",y=JSON.parse(s.rawData),b=JSON.parse(s.indexObject),C={},x=0;x<b.length;x++)C[b[x].Key]=b[x].Value;this.drillThroughValue.indexObject=C,this.drillThroughModule.triggerDialog(S,v,y,this.drillThroughValue,this.drillThroughElement),this.hideWaitingPopup()}else{var w=r.formatFieldList(JSON.parse(s.fieldList));if(this.engineModule.fieldList)for(u=Object.keys(this.engineModule.fieldList),c=0;c<u.length;c++)this.engineModule.fieldList[u[c]]&&w[u[c]]&&(w[u[c]].dateMember=this.engineModule.fieldList[u[c]].dateMember,w[u[c]].formattedMembers=this.engineModule.fieldList[u[c]].formattedMembers,w[u[c]].members=this.engineModule.fieldList[u[c]].members);this.engineModule.fieldList=w,this.engineModule.fields=JSON.parse(s.fields),this.engineModule.rowCount=JSON.parse(s.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(s.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(s.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(s.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(s.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(s.pivotCount).ColumnFirstLevel,this.engineModule.columnPageCount=JSON.parse(s.pivotCount).ColumnPageCount,this.engineModule.rowPageCount=JSON.parse(s.pivotCount).RowPageCount;for(var T=void 0,M=r.formatPivotValues(JSON.parse(s.pivotValue)),D=0;D<M.length;D++)if(M[D]&&M[D][0]&&"row"===M[D][0].axis){T=D;break}this.engineModule.headerContent=r.frameContent(M,"header",T,this),this.engineModule.pageSettings=this.pageSettings,this.dataSourceSettings.groupSettings.length>0&&r.updateReport(this,JSON.parse(s.dataSourceSettings));var O=JSON.parse(s.dataSourceSettings).ValueSortSettings;this.engineModule.valueSortSettings={headerText:O.HeaderText,headerDelimiter:O.HeaderDelimiter,sortOrder:O.SortOrder,columnIndex:O.ColumnIndex},this.engineModule.pivotValues=M,this.engineModule.isEmptyData=0===this.dataSourceSettings.values.length;for(var P=0,N=this.dataSourceSettings.values;P<N.length;P++){var E=N[P];this.engineModule.valueAxisFields[E.name]=E}}}catch(e){this.engineModule.pivotValues=[]}if("onScroll"===this.currentAction)if("vertical"===this.scrollDirection){var I="row"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,F=this.pageSettings.rowPageSize*I*this.gridSettings.rowHeight*Math.ceil(this.engineModule.rowStartPos/(this.pageSettings.rowPageSize*I))-this.engineModule.rowFirstLvl*I*this.gridSettings.rowHeight;this.scrollPosObject.verticalSection=F}else if("horizondal"===this.scrollDirection){var L="column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1;F=this.pageSettings.columnPageSize*L*this.gridSettings.columnWidth*Math.ceil(this.engineModule.colStartPos/(this.pageSettings.columnPageSize*L))-this.engineModule.colFirstLvl*L*this.gridSettings.columnWidth;this.scrollPosObject.horizontalSection=F}"fetchFieldMembers"!==this.currentAction&&"fetchRawData"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotFieldListModule&&this.pivotFieldListModule.calculatedFieldModule&&this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate&&(this.pivotFieldListModule.calculatedFieldModule.endDialog(),this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate=!1))}},n.prototype.getEngine=function(e,t,i,a,n,s,o,l,d,p){var h=this;this.engineModule.isEmptyData=!1,this.element.querySelector(".e-spin-hide")&&"onExcelExport"!==e&&"onCsvExport"!==e&&this.showWaitingPopup(),this.currentAction=e,this.isServerWaitingPopup=!1;var u={pageSettings:JSON.parse(this.getPageSettings()).pageSettings,enableValueSorting:this.enableValueSorting,enablePaging:this.enablePaging,enableVirtualization:this.enableVirtualization,allowDataCompression:this.allowDataCompression,enableDrillThrough:this.allowDrillThrough||this.editSettings.allowEditing,locale:JSON.stringify(r.getLocalizedObject(this)),enableOptimizedRendering:this.enableVirtualization&&this.virtualScrollSettings&&this.virtualScrollSettings.allowSinglePage,requestType:"string",headers:{"Content-type":"application/json"}};this.request.readyState!==XMLHttpRequest.UNSENT&&this.request.readyState!==XMLHttpRequest.OPENED||(this.request.withCredentials=!1);var c={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:u,drillItem:t,sortItem:i,aggregatedItem:a,calculatedItem:n,filterItem:s,memberName:o,fetchRawDataArgs:l,editArgs:d,hash:this.guid,excelExportProperties:p,exportAllPages:this.exportAllPages,isGroupingUpdated:"onRefresh"===this.currentAction&&this.dataSourceSettings.groupSettings.length>0||!!this.groupingModule&&this.groupingModule.isUpdate};this.trigger(qe,c,(function(e){h.request=e.request,c.internalProperties=e.internalProperties,c.customProperties=e.customProperties,c.dataSourceSettings=e.dataSourceSettings,c.calculatedItem=e.calculatedItem,c.drillItem=e.drillItem,c.editArgs=e.editArgs,c.fetchRawDataArgs=e.fetchRawDataArgs,c.filterItem=e.filterItem,c.hash=e.hash,c.memberName=e.memberName,c.sortItem=e.sortItem,c.excelExportProperties=e.excelExportProperties,c.exportAllPages=e.exportAllPages})),this.request.open("POST",this.dataSourceSettings.url,!0),this.request.onreadystatechange=this.onSuccess.bind(this,c.excelExportProperties),"onExcelExport"===c.action||"onCsvExport"===c.action?this.request.responseType="blob":this.request.responseType="";for(var g=Object.keys(c.internalProperties.headers),m=0;m<g.length;m++){var f=g[m],S=String(c.internalProperties.headers[f]);this.request.setRequestHeader(f,S)}"string"===c.internalProperties.requestType?this.request.send(JSON.stringify(c)):"base64"===c.internalProperties.requestType&&this.request.send(btoa(JSON.stringify(c)))},n.prototype.getChartSettings=function(){var e=this.chartSettings.load,t=this.chartSettings.loaded,i=this.chartSettings.textRender,a=this.chartSettings.pointRender,r=this.chartSettings.seriesRender,n=this.chartSettings.legendRender,s=this.chartSettings.pointClick,o=this.chartSettings.tooltipRender,l=this.chartSettings.legendClick,d=this.chartSettings.multiLevelLabelRender,p=this.chartSettings.beforePrint,h=this.chartSettings.animationComplete,u=this.chartSettings.chartMouseMove,c=this.chartSettings.chartMouseClick,g=this.chartSettings.pointMove,m=this.chartSettings.chartMouseLeave,f=this.chartSettings.chartMouseDown,S=this.chartSettings.chartMouseUp,v=this.chartSettings.dragComplete,y=this.chartSettings.zoomComplete,b=this.chartSettings.scrollStart,C=this.chartSettings.scrollEnd,x=this.chartSettings.scrollChanged;this.chartSettings.load=void 0,this.chartSettings.loaded=void 0,this.chartSettings.textRender=void 0,this.chartSettings.pointRender=void 0,this.chartSettings.seriesRender=void 0,this.chartSettings.legendRender=void 0,this.chartSettings.pointClick=void 0,this.chartSettings.tooltipRender=void 0,this.chartSettings.legendClick=void 0,this.chartSettings.multiLevelLabelRender=void 0,this.chartSettings.beforePrint=void 0,this.chartSettings.animationComplete=void 0,this.chartSettings.chartMouseMove=void 0,this.chartSettings.chartMouseClick=void 0,this.chartSettings.pointMove=void 0,this.chartSettings.chartMouseLeave=void 0,this.chartSettings.chartMouseDown=void 0,this.chartSettings.chartMouseUp=void 0,this.chartSettings.dragComplete=void 0,this.chartSettings.zoomComplete=void 0,this.chartSettings.scrollStart=void 0,this.chartSettings.scrollEnd=void 0,this.chartSettings.scrollChanged=void 0;var w=this.addOnPersist(["chartSettings"]);return this.chartSettings.load=e,this.chartSettings.loaded=t,this.chartSettings.textRender=i,this.chartSettings.pointRender=a,this.chartSettings.seriesRender=r,this.chartSettings.legendRender=n,this.chartSettings.pointClick=s,this.chartSettings.tooltipRender=o,this.chartSettings.legendClick=l,this.chartSettings.multiLevelLabelRender=d,this.chartSettings.beforePrint=p,this.chartSettings.animationComplete=h,this.chartSettings.chartMouseMove=u,this.chartSettings.chartMouseClick=c,this.chartSettings.pointMove=g,this.chartSettings.chartMouseLeave=m,this.chartSettings.chartMouseDown=f,this.chartSettings.chartMouseUp=S,this.chartSettings.dragComplete=v,this.chartSettings.zoomComplete=y,this.chartSettings.scrollStart=b,this.chartSettings.scrollEnd=C,this.chartSettings.scrollChanged=x,w},n.prototype.getPageSettings=function(){return this.addOnPersist(["pageSettings"])},n.prototype.onReadyStateChange=function(e){var i=[];if("CSV"===this.dataSourceSettings.type)for(var a=e.split(/\r?\n|\r/),r=0;r<a.length;r++)(0,t.isNullOrUndefined)(a[r])||""===a[r]||i.push(a[r].split(","));else try{i=JSON.parse(e)}catch(e){i=[]}i&&i.length>0&&this.setProperties({dataSourceSettings:{dataSource:i}},!0),this.initialLoad()},n.prototype.initialLoad=function(){var e=this;try{this.cellTemplateFn=this.templateParser(this.cellTemplate),this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate),this.spinnerTemplate?(0,o.createSpinner)({target:this.element,template:this.spinnerTemplate,cssClass:this.cssClass?this.cssClass:void 0},this.createElement):(0,o.createSpinner)({target:this.element,cssClass:this.cssClass?this.cssClass:void 0},this.createElement);var t={dataSourceSettings:this.dataSourceSettings,pivotview:this,fieldsType:{},defaultFieldListOrder:this.defaultFieldListOrder};this.trigger(l,t,(function(i){e.dataSourceSettings=i.dataSourceSettings,e.fieldsType=i.fieldsType,e.defaultFieldListOrder=t.defaultFieldListOrder,e.updateClass(),e.notify(Xe,{}),"Server"!==e.dataSourceSettings.mode&&e.notify(_e,{}),e.isAdaptive&&e.contextMenuModule.render(),e.notify(tt,{}),e.notify(it,{})}))}catch(e){this.actionFailureMethod(e)}},n.prototype.addInternalEvents=function(){this.on(_e,this.generateData,this),this.on(Ke,this.renderPivotGrid,this),this.on(Ye,this.onContentReady,this)},n.prototype.removeInternalEvents=function(){this.off(_e,this.generateData),this.off(Ke,this.renderPivotGrid),this.off(Ye,this.onContentReady)},n.prototype.getPersistData=function(e){var t=this.gridSettings.columnRender,a=this.gridSettings.excelQueryCellInfo,r=this.gridSettings.excelHeaderQueryCellInfo,n=this.gridSettings.pdfQueryCellInfo,s=this.gridSettings.pdfHeaderQueryCellInfo,o=this.chartSettings.load,l=this.chartSettings.loaded,d=this.chartSettings.textRender,p=this.chartSettings.pointRender,h=this.chartSettings.seriesRender,u=this.chartSettings.legendRender,c=this.chartSettings.pointClick,g=this.chartSettings.tooltipRender,m=this.chartSettings.legendClick,f=this.chartSettings.multiLevelLabelRender,S=this.chartSettings.beforePrint,v=this.chartSettings.animationComplete,y=this.chartSettings.chartMouseMove,b=this.chartSettings.chartMouseClick,C=this.chartSettings.pointMove,x=this.chartSettings.chartMouseLeave,w=this.chartSettings.chartMouseDown,T=this.chartSettings.chartMouseUp,M=this.chartSettings.dragComplete,D=this.chartSettings.zoomComplete,O=this.chartSettings.scrollStart,P=this.chartSettings.scrollEnd,N=this.chartSettings.scrollChanged;this.gridSettings.columnRender=void 0,this.gridSettings.excelQueryCellInfo=void 0,this.gridSettings.excelHeaderQueryCellInfo=void 0,this.gridSettings.pdfQueryCellInfo=void 0,this.gridSettings.pdfHeaderQueryCellInfo=void 0,this.chartSettings.tooltipRender=void 0,this.chartSettings.legendClick=void 0,this.chartSettings.multiLevelLabelRender=void 0,this.chartSettings.load=void 0,this.chartSettings.loaded=void 0,this.chartSettings.textRender=void 0,this.chartSettings.pointRender=void 0,this.chartSettings.seriesRender=void 0,this.chartSettings.legendRender=void 0,this.chartSettings.pointClick=void 0,this.chartSettings.beforePrint=void 0,this.chartSettings.animationComplete=void 0,this.chartSettings.chartMouseMove=void 0,this.chartSettings.chartMouseClick=void 0,this.chartSettings.pointMove=void 0,this.chartSettings.chartMouseLeave=void 0,this.chartSettings.chartMouseDown=void 0,this.chartSettings.chartMouseUp=void 0,this.chartSettings.dragComplete=void 0,this.chartSettings.zoomComplete=void 0,this.chartSettings.scrollStart=void 0,this.chartSettings.scrollEnd=void 0,this.chartSettings.scrollChanged=void 0;var E=[];e&&(E=!this.dataSourceSettings.dataSource||this.dataSourceSettings.dataSource instanceof i.DataManager?this.dataSourceSettings.dataSource:this.dataSourceSettings.dataSource.slice(),this.setProperties({dataSourceSettings:{dataSource:[]}},!0));var I=this.addOnPersist(["dataSourceSettings","pivotValues","gridSettings","chartSettings","displayOption","pageSettings"]);return this.gridSettings.columnRender=t,this.gridSettings.excelQueryCellInfo=a,this.gridSettings.excelHeaderQueryCellInfo=r,this.gridSettings.pdfQueryCellInfo=n,this.gridSettings.pdfHeaderQueryCellInfo=s,this.chartSettings.load=o,this.chartSettings.loaded=l,this.chartSettings.textRender=d,this.chartSettings.pointRender=p,this.chartSettings.seriesRender=h,this.chartSettings.legendRender=u,this.chartSettings.pointClick=c,this.chartSettings.tooltipRender=g,this.chartSettings.legendClick=m,this.chartSettings.multiLevelLabelRender=f,this.chartSettings.beforePrint=S,this.chartSettings.animationComplete=v,this.chartSettings.chartMouseMove=y,this.chartSettings.chartMouseClick=b,this.chartSettings.pointMove=C,this.chartSettings.chartMouseLeave=x,this.chartSettings.chartMouseDown=w,this.chartSettings.chartMouseUp=T,this.chartSettings.dragComplete=M,this.chartSettings.zoomComplete=D,this.chartSettings.scrollStart=O,this.chartSettings.scrollEnd=P,this.chartSettings.scrollChanged=N,e&&this.setProperties({dataSourceSettings:{dataSource:E}},!0),I},n.prototype.loadPersistData=function(e){var t=JSON.parse(e);this.allowServerDataBinding=!1,this.setProperties({gridSettings:t.gridSettings,pivotValues:t.pivotValues,chartSettings:t.chartSettings,displayOption:t.displayOption},!0),"Chart"===t.displayOption.primary?this.currentView="Chart":this.currentView="Table",this.allowServerDataBinding=!0,this.dataSourceSettings&&this.dataSourceSettings.dataSource&&this.dataSourceSettings.dataSource instanceof i.DataManager&&t.dataSourceSettings&&t.dataSourceSettings.dataSource&&t.dataSourceSettings.dataSource.dataSource&&this.dataSourceSettings.dataSource.dataSource&&t.dataSourceSettings.dataSource.dataSource.url===this.dataSourceSettings.dataSource.dataSource.url&&(t.dataSourceSettings.dataSource=this.dataSourceSettings.dataSource),this.dataSourceSettings=t.dataSourceSettings},n.prototype.mergePersistPivotData=function(){var e=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!(0,t.isNullOrUndefined)(e)&&""!==e){var a=JSON.parse(e);this.dataSourceSettings&&this.dataSourceSettings.dataSource&&this.dataSourceSettings.dataSource instanceof i.DataManager&&a.dataSourceSettings&&a.dataSourceSettings.dataSource&&a.dataSourceSettings.dataSource.dataSource&&this.dataSourceSettings.dataSource.dataSource&&a.dataSourceSettings.dataSource.dataSource.url===this.dataSourceSettings.dataSource.dataSource.url&&(a.dataSourceSettings.dataSource=this.dataSourceSettings.dataSource),this.setProperties(a,!0)}},n.prototype.showConditionalFormattingDialog=function(){this.conditionalFormattingModule&&this.conditionalFormattingModule.showConditionalFormattingDialog()},n.prototype.createCalculatedFieldDialog=function(){this.calculatedFieldModule&&this.calculatedFieldModule.createCalculatedFieldDialog()},n.prototype.getModuleName=function(){return"pivotview"},n.prototype.copy=function(e){this.grid.copy(e)},n.prototype.onPropertyChanged=function(i,a){for(var n=!1,s=0,o=Object.keys(i);s<o.length;s++){var l=o[s];switch(l){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":case"allowDataCompression":if(i.dataSourceSettings&&(!(0,t.isNullOrUndefined)(i.dataSourceSettings.dataSource)&&!(0,t.isNullOrUndefined)(this.clonedDataSet)&&this.clonedDataSet!==i.dataSourceSettings.dataSource&&!(0,t.isNullOrUndefined)(i.dataSourceSettings.groupSettings)&&i.dataSourceSettings.groupSettings.length>0||1===Object.keys(i.dataSourceSettings).length&&"dataSource"===Object.keys(i.dataSourceSettings)[0]&&this.dataSourceSettings.groupSettings.length>0)&&(this.clonedDataSet=i.dataSourceSettings.dataSource,this.engineModule.groupingFields={}),i.dataSourceSettings&&1===Object.keys(i.dataSourceSettings).length&&i.dataSourceSettings.groupSettings&&"pivot"===this.dataType&&this.updateGroupingReport(i.dataSourceSettings.groupSettings,"Date"),((0,t.isNullOrUndefined)(i.dataSourceSettings)?[]:Object.keys(i.dataSourceSettings)).indexOf("dataSource")>-1&&"CSV"!==i.dataSourceSettings.type)!(0,t.isNullOrUndefined)(this.savedDataSourceSettings)&&this.dataSourceSettings.dataSource.length>0&&(r.updateDataSourceSettings(this,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),i.dataSourceSettings.dataSource&&0===i.dataSourceSettings.dataSource.length&&(this.savedDataSourceSettings=r.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{rows:[]}},!0),this.setProperties({dataSourceSettings:{columns:[]}},!0),this.setProperties({dataSourceSettings:{values:[]}},!0),this.setProperties({dataSourceSettings:{filters:[]}},!0)),this.isStaticRefresh||(this.pivotValues=[],"pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[],this.engineModule.groupingFieldsInfo={}):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0)),this.showWaitingPopup(),this.notify(_e,{});else if(r.isButtonIconRefesh(l,a,i)){if(this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule){var d=r.cloneFieldSettings(this.dataSourceSettings.rows),p=r.cloneFieldSettings(this.dataSourceSettings.columns),h=r.cloneFieldSettings(this.dataSourceSettings.values),u=r.cloneFieldSettings(this.dataSourceSettings.filters);this.pivotFieldListModule.setProperties({dataSourceSettings:{rows:d,columns:p,values:h,filters:u}},!0),this.pivotFieldListModule.axisFieldModule.render(),this.pivotFieldListModule.treeViewModule.fieldTable&&!this.isAdaptive&&this.pivotFieldListModule.notify(Je,{})}}else this.remoteData=[],"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url&&("type"in i.dataSourceSettings||"url"in i.dataSourceSettings)?(this.engineModule.fieldList=null,this.loadData()):(i.dataSourceSettings&&("pivot"===this.dataType&&"dataSource"in i.dataSourceSettings||"olap"===this.dataType&&"url"in i.dataSourceSettings)&&(this.isStaticRefresh||("pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[],this.engineModule.groupingFieldsInfo={}):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0),this.pivotValues=[])),this.notify(_e,{}));break;case"height":case"width":this.layoutRefresh();break;case"pivotValues":case"displayOption":!this.showToolbar&&i.displayOption&&1===Object.keys(i.displayOption).length&&i.displayOption.view?(this.currentView="Both"===i.displayOption.view?this.displayOption.primary:i.displayOption.view,(this.showGroupingBar||this.showFieldList)&&(this.showFieldList&&this.pivotFieldListModule&&(this.pivotFieldListModule.destroyEngine=!0,this.pivotFieldListModule.destroy(),null!==(0,t.select)("#"+this.element.id+"_PivotFieldList",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_PivotFieldList",this.element)),this.pivotFieldListModule.destroyEngine=!1),this.notify(Xe,this)),this.grid||"Chart"===i.displayOption.view?"Table"!==this.displayOption.view&&(this.grid&&(this.grid.destroy(),this.grid=void 0),this.pivotChartModule||(this.pivotChartModule=new Xs)):(this.renderEmptyGrid(),"Table"===i.displayOption.view&&this.pivotChartModule&&(this.destroyEngine=!0,this.pivotChartModule.destroy(),this.destroyEngine=!1,this.chart=void 0,this.pivotChartModule=void 0))):this.showToolbar&&!(0,t.isNullOrUndefined)(i.displayOption)&&i.displayOption.view&&(this.currentView="Both"===i.displayOption.view?this.displayOption.primary:i.displayOption.view);var c="pivot"===this.dataType?this.engineModule:this.olapEngineModule;(0,t.isNullOrUndefined)(c.fieldList)&&(0,t.isNullOrUndefined)(c.pivotValues)||this.notify(Ke,{});break;case"gridSettings":this.lastGridSettings=i.gridSettings,this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,this.allowGrouping&&this.groupingModule&&!this.isCellBoxMultiSelection&&(this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0),this.isCellBoxMultiSelection=!0),this.renderModule.updateGridSettings();break;case"chartSettings":this.showGroupingBar&&this.groupingBarModule&&(-1!==Object.keys(i.chartSettings).indexOf("enableMultipleAxis")||i.chartSettings.chartSeries&&-1!==Object.keys(i.chartSettings.chartSeries).indexOf("type"))&&this.groupingBarModule.renderLayout(),(0,t.isNullOrUndefined)(this.pivotChartModule)&&"Table"!==this.displayOption.view&&(this.pivotChartModule=new Xs);var g="pivot"===this.dataType?this.engineModule:this.olapEngineModule;(0,t.isNullOrUndefined)(this.pivotChartModule)||(0,t.isNullOrUndefined)(g.pivotValues)||this.pivotChartModule.loadChart(this,this.chartSettings),(0,t.isNullOrUndefined)(g.pivotValues)||(0,t.isNullOrUndefined)(g.fieldList)||this.notify(Ge,this);break;case"locale":case"currencyCode":case"enableRtl":if(this.tooltip&&this.tooltip.destroy(),this.dataSourceSettings.groupSettings&&this.dataSourceSettings.groupSettings.length>0&&this.clonedDataSet){var m="CSV"===this.dataSourceSettings.type?r.getClonedCSVData(this.clonedDataSet):r.getClonedData(this.clonedDataSet);this.setProperties({dataSourceSettings:{dataSource:m}},!0)}e.prototype.refresh.call(this),this.updateClass();break;case"enableValueSorting":this.enableValueSorting=i.enableValueSorting,this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")?this.element.querySelector(".e-grouping-bar").remove():this.groupingBarModule&&this.groupingBarModule.renderLayout(),(0,t.isNullOrUndefined)(i.showFieldList)&&this.renderPivotGrid();break;case"showFieldList":this.initialLoad();break;case"groupingBarSettings":this.showGroupingBar&&this.groupingBarModule&&(i.groupingBarSettings&&Object.keys(i.groupingBarSettings).indexOf("showFieldsPanel")>-1?(this.groupingBarModule.RefreshFieldsPanel(),this.layoutRefresh()):this.axisFieldModule.render());break;case"showValuesButton":this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({showValuesButton:i.showValuesButton},!0),this.pivotFieldListModule.axisFieldModule.render());break;case"showTooltip":this.renderToolTip();break;case"toolbar":this.toolbarModule&&this.toolbarModule.refreshToolbar();break;case"chartTypes":this.toolbarModule&&this.toolbarModule.createChartMenu();break;case"aggregateTypes":this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({aggregateTypes:i.aggregateTypes},!0),this.pivotFieldListModule.axisFieldModule.render());break;case"enableFieldSearching":this.pivotFieldListModule&&(this.pivotFieldListModule.enableFieldSearching=this.enableFieldSearching);break;case"pageSettings":this.enableVirtualization||(this.engineModule.pageSettings=this.pageSettings,this.refreshPageData());break;case"pagerSettings":case"enablePaging":this.notify(it,this);break;case"cellTemplate":this.cellTemplateFn=this.templateParser(this.cellTemplate),n=!0;break;case"tooltipTemplate":this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate),n=!0}}n&&this.grid&&this.grid.refreshColumns()},n.prototype.templateParser=function(e){if(e)try{return"function"!=typeof e&&document.querySelectorAll(e).length?(0,t.compile)(document.querySelector(e).innerHTML.trim()):(0,t.compile)(e)}catch(i){return(0,t.compile)(e)}},n.prototype.getCellTemplate=function(){return this.cellTemplateFn},n.prototype.appendHtml=function(e,i){var a=document.createElement("div");return a.innerHTML=i,(0,t.isNullOrUndefined)(a.firstChild)||e.appendChild(a.firstChild),e},n.prototype.renderPivotGrid=function(){this.isEmptyGrid=!1,this.notEmpty=!0,this.clearTemplate(),this.pivotChartModule&&(this.pivotChartModule.engineModule=this.engineModule,this.pivotChartModule.loadChart(this,this.chartSettings),this.enableRtl&&this.chart&&"rtl"!==document.body.getAttribute("dir")&&(0,t.addClass)([this.chart.element],"e-ltr")),this.enableVirtualization&&(this.virtualscrollModule=new Ws(this)),(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new Ys(this)),this.enablePaging&&this.notify(it,this),"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),this.renderModule=this.renderModule?this.renderModule:new cs(this),this.renderModule.render(!0)):this.grid&&(0,t.remove)(this.grid.element),(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.notify(Ge,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=(0,t.extend)({},this.dataSourceSettings,null,!0))),this.allowConditionalFormatting&&this.applyFormatting(this.pivotValues),this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&(this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+Ka)&&this.groupingBarModule.refreshUI(),this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.getGridWidthAsNumber()),this.chartSettings.enableScrollOnMultiAxis&&this.chartSettings.enableMultipleAxis&&(this.element.querySelector("."+qn).style.width=(0,t.formatUnit)(this.getGridWidthAsNumber())),this.chart.width=(0,t.formatUnit)(this.getGridWidthAsNumber()),"Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display="none")):(this.grid.element.style.display="none",this.chart.element.style.display="",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display=""))),this.toolbarModule&&(this.showFieldList&&(0,t.select)("#"+this.element.id+"_PivotFieldList",this.element)&&(this.toolbar&&-1!==this.toolbar.indexOf("FieldList")?(0,t.select)("#"+this.element.id+"_PivotFieldList",this.element).style.display="none":((0,t.select)("#"+this.element.id+"_PivotFieldList",this.element).style.top=this.element.querySelector("."+kn).offsetHeight.toString()+"px",(0,t.select)("#"+this.element.id+"_PivotFieldList",this.element).style.position="relative")),this.toolbar&&-1!==this.toolbar.indexOf("FieldList")&&this.showToolbar&&this.element.querySelector(".e-toggle-field-list")&&(this.element.querySelector(".e-toggle-field-list").style.display="none"),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action&&(this.isModified=!0),this.isInitialRendering||(this.isModified=!1,this.isInitialRendering=!this.isInitialRendering),this.toolbarModule.action="")},n.prototype.showWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?(0,o.showSpinner)(this.grid.element):(0,o.showSpinner)(this.element)},n.prototype.hideWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?(0,o.hideSpinner)(this.grid.element):(0,o.hideSpinner)(this.element)},n.prototype.updateDataSource=function(){var e=this;this.showWaitingPopup();var i=this,a=!(0,t.isNullOrUndefined)(i.lastSortInfo)&&Object.keys(i.lastSortInfo).length>0,n=!(0,t.isNullOrUndefined)(i.lastFilterInfo)&&Object.keys(i.lastFilterInfo).length>0,s=!(0,t.isNullOrUndefined)(i.lastAggregationInfo)&&Object.keys(i.lastAggregationInfo).length>0,o=!(0,t.isNullOrUndefined)(i.lastCalcFieldInfo)&&Object.keys(i.lastCalcFieldInfo).length>0,l={dataSourceSettings:r.getClonedDataSourceSettings(i.dataSourceSettings)};i.trigger(d,l,(function(t){if((i.enableVirtualization||i.enablePaging)&&(a||n||s||o)||r.updateDataSourceSettings(i,t.dataSourceSettings),i.updatePageSettings(!1),a&&""!==i.dataSourceSettings.valueSortSettings.headerText&&i.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),"pivot"===i.dataType&&(i.enableVirtualization||i.enablePaging)&&(a||n||s||o))a&&("Server"===e.dataSourceSettings.mode?i.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):i.engineModule.onSort(i.lastSortInfo),i.lastSortInfo={}),s&&("Server"===e.dataSourceSettings.mode?i.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):i.engineModule.onAggregation(i.lastAggregationInfo),i.lastAggregationInfo={}),o&&("Server"===e.dataSourceSettings.mode?i.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):i.engineModule.onCalcOperation(i.lastCalcFieldInfo,i.dataSourceSettings),i.lastCalcFieldInfo={}),n&&("Server"===e.dataSourceSettings.mode?i.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):i.engineModule.onFilter(i.lastFilterInfo,i.dataSourceSettings),i.lastFilterInfo={}),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),i.allowServerDataBinding=!0,"Server"!==i.dataSourceSettings.mode&&i.enginePopulatedEventMethod("updateDataSource");else if("olap"===i.dataType){var l={mode:"",savedFieldList:i.olapEngineModule.fieldList,savedFieldListData:i.olapEngineModule.fieldListData,pageSettings:i.pageSettings,enableValueSorting:i.enableValueSorting,isDrillThrough:i.allowDrillThrough||i.editSettings.allowEditing,localeObj:i.localeObj,enableVirtualization:e.enableVirtualization};o||a?(i.olapEngineModule.savedFieldList=i.olapEngineModule.fieldList,i.olapEngineModule.savedFieldListData=i.olapEngineModule.fieldListData,o?(i.olapEngineModule.updateCalcFields(i.dataSourceSettings,i.lastCalcFieldInfo),i.lastCalcFieldInfo={}):(i.olapEngineModule.onSort(i.dataSourceSettings),i.lastSortInfo={})):r.renderOlapEngine(i,l),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.olapEngineModule.pivotValues},!0),i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource")}else{l={mode:"",savedFieldList:i.engineModule.fieldList,pageSettings:i.pageSettings,enableValueSorting:i.enableValueSorting,isDrillThrough:i.allowDrillThrough||i.editSettings.allowEditing,localeObj:i.localeObj,fieldsType:i.fieldsType,clonedReport:i.clonedReport,globalize:i.globalize,currenyCode:i.currencyCode,enablePaging:e.enablePaging,enableVirtualization:e.enableVirtualization,allowDataCompression:e.allowDataCompression,enableHtmlSanitizer:e.enableHtmlSanitizer,enableOptimizedRendering:e.enableVirtualization&&e.virtualscrollModule&&e.virtualScrollSettings.allowSinglePage};"Server"===i.dataSourceSettings.mode?a?i.getEngine("onSort",null,i.lastSortInfo,null,null,null,null):s?i.getEngine("onAggregation",null,null,i.lastAggregationInfo,null,null,null):o?i.getEngine("onCalcOperation",null,null,null,i.lastCalcFieldInfo,null,null):n?i.getEngine("onFilter",null,null,null,null,i.lastFilterInfo,null):i.getEngine("onDrop",null,null,null,null,null,null):(i.engineModule.renderEngine(i.dataSourceSettings,l,i.aggregateCellInfo?i.getValueCellInfo.bind(i):void 0,i.onHeadersSort?i.getHeaderSortInfo.bind(i):void 0),i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),i.allowServerDataBinding=!0,i.enginePopulatedEventMethod("updateDataSource")),i.lastSortInfo={},i.lastAggregationInfo={},i.lastCalcFieldInfo={},i.lastFilterInfo={}}}))},n.prototype.refreshPageData=function(){var e={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)};this.actionBeginMethod(),this.showWaitingPopup(),this.trigger(d,e),"pivot"===this.dataType&&("Server"===this.dataSourceSettings.mode?this.getEngine("onPageChange",null,null,null,null,null,null):this.engineModule.generateGridData(this.dataSourceSettings,!0,!1,this.engineModule.headerCollection),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.enginePopulatedEventMethod("updateDataSource")),this.actionObj.actionName=this.getActionCompleteName(),this.actionObj.actionName&&this.actionCompleteMethod()},n.prototype.excelExport=function(e,t,i,a){(this.enableVirtualization||this.enablePaging||this.allowEngineExport||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0)&&"Server"!==this.dataSourceSettings.mode?this.excelExportModule.exportToExcel("Excel",e,a):(this.exportType="Excel",this.grid.excelExport(e,t,i,a)),this.actionObj.actionName=this.getActionCompleteName();var r={exportInfo:{type:this.exportType,info:e}};this.actionObj.actionInfo=r,this.actionObj.actionName&&this.actionCompleteMethod()},n.prototype.csvExport=function(e,t,i,a){(this.enableVirtualization||this.enablePaging||this.allowEngineExport||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0)&&"Server"!==this.dataSourceSettings.mode?this.excelExportModule.exportToExcel("CSV",e,a):(this.exportType="CSV",this.grid.csvExport(e,t,i,a)),this.actionObj.actionName=this.getActionCompleteName();var r={exportInfo:{type:this.exportType,info:e}};this.actionObj.actionInfo=r,this.actionObj.actionName&&this.actionCompleteMethod()},n.prototype.gridPdfExport=function(e,t,i,a){var r={pdfExportProperties:e,isMultipleExport:t,isBlob:a,pdfDoc:i,currentExportView:"Table",pdfMargins:{}},n=null;this.trigger(m,r),this.pdfExportModule&&(this.pdfExportModule.exportProperties=r),n=this.enableVirtualization||this.enablePaging||this.allowEngineExport||Object.keys(r.pdfMargins).length>0||r.height||r.width||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0&&("Server"!==this.dataSourceSettings.mode||(this.enableVirtualization||this.enablePaging)&&"Server"===this.dataSourceSettings.mode&&this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0)?this.pdfExportModule.exportToPDF(r.pdfExportProperties,r.isMultipleExport,r.pdfDoc,r.isBlob):this.grid.pdfExport(r.pdfExportProperties,r.isMultipleExport,r.pdfDoc,r.isBlob),this.actionObj.actionName=this.getActionCompleteName();var s={exportInfo:{type:"PDF",info:e}};return this.actionObj.actionInfo=s,this.actionObj.actionName&&this.actionCompleteMethod(),n},n.prototype.chartExport=function(e,i,r,n,s){var o,l={pdfExportProperties:i,isMultipleExport:r,isBlob:s,pdfDoc:n,type:e,currentExportView:"Chart",pdfMargins:{}};this.trigger(m,l),this.chartExportModule.exportProperties=l;var d=l.fileName?l.fileName:(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.fileName)?"default":i.fileName;if("PDF"===e)o=this.chartExportModule.pdfChartExport(l.pdfExportProperties,l.pdfDoc,l.isMultipleExport,l.isBlob);else{var p=0===l.orientation||l.orientation?l.orientation:(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.pageOrientation)||"Landscape"===i.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait;o=this.chart.exportModule.export(l.type,d,p,null)}this.actionObj.actionName=this.getActionCompleteName();var h={exportInfo:{type:e,info:d}};return this.actionObj.actionInfo=h,this.actionObj.actionName&&this.actionCompleteMethod(),o},n.prototype.pdfExport=function(e,t,i,a,r){var n=this,s=null;return new Promise((function(o){if(r&&"Both"===n.displayOption.view){if("Chart"===n.displayOption.primary)n.chartExport("PDF",e,!0,i,!1).then((function(i){s=n.gridPdfExport(e,t,i,a),o(s)}));else n.gridPdfExport(e,!0,i,!1).then((function(i){s=n.chartExport("PDF",e,t,i,a),o(s)}))}else{var l=n.gridPdfExport(e,t,i,a);o(l)}}))},n.prototype.printChart=function(){this.chart&&this.chart.print()},n.prototype.onDrill=function(e,i){var a=this,n=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",s="",o="",l="";if(i?(s=i.fieldName,o=i.cell.axis,l=i.isDrilled?"up":"down"):(s="row"===(o=e.parentElement.classList.contains(Or)?"row":"column")?(0,t.closest)(e,"td").getAttribute("fieldname"):(0,t.closest)(e,"th").getAttribute("fieldname"),l=e.classList.contains(wr)?"up":"down"),"pivot"===this.dataType){var h=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),u=Number("row"===o?(0,t.closest)(e,"td").getAttribute("data-colindex"):(0,t.closest)(e,"th").getAttribute("data-colindex")),c=Number("row"===o?(0,t.closest)(e,"td").getAttribute("index"):(0,t.closest)(e,"th").getAttribute("index")),g=i?i.cell:this.engineModule.pivotValues[c][u],m=g.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(n),f=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:s,items:[m],delimiter:n}]}},!0);else{for(var S=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),v=0;v<S.length;v++){var y=S[v];if(m=m.split(n).join(y.delimiter?y.delimiter:n),n=y.delimiter=y.delimiter?y.delimiter:n,y.name===s){f=!0;var b=y.items.indexOf(m);b>-1?y.items.splice(b,1):y.items.push(m)}}this.setProperties({dataSourceSettings:{drilledMembers:S}},!0),f||this.dataSourceSettings.drilledMembers.push({name:s,items:[m],delimiter:n})}this.showWaitingPopup();var C=this,x={fieldName:s,memberName:m,delimiter:n,axis:o,action:l,currentCell:g},w={drillInfo:x,pivotview:C,cancel:!1};C.trigger(R,w,(function(e){if(e.cancel)a.hideWaitingPopup(),a.setProperties({dataSourceSettings:{drilledMembers:h}},!0);else{var t={dataSourceSettings:r.getClonedDataSourceSettings(a.dataSourceSettings)};C.trigger(d,t),C.setProperties({dataSourceSettings:t.dataSourceSettings},!0),C.enableVirtualization||C.enablePaging?"Server"===a.dataSourceSettings.mode?a.getEngine("onDrill",x,null,null,null,null,null):(C.engineModule.drilledMembers=C.dataSourceSettings.drilledMembers,C.engineModule.onDrill(x)):"Server"===a.dataSourceSettings.mode?a.getEngine("onDrill",x,null,null,null,null,null):C.engineModule.generateGridData(C.dataSourceSettings,!0),C.allowServerDataBinding=!1,C.setProperties({pivotValues:C.engineModule.pivotValues},!0),C.allowServerDataBinding=!0;var i={dataSourceSettings:r.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:a.pivotValues};a.trigger(p,i),C.engineModule.pivotValues=i.pivotValues;var n={drillInfo:x};a.actionObj.actionInfo=n,C.renderPivotGrid()}}))}else this.onOlapDrill(s,o,l,n,e,i)},n.prototype.onOlapDrill=function(e,i,a,n,s,o){var l,h=this,u=this,c=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);if(o)l=o.cell;else{var g=Number("row"===i?(0,t.closest)(s,"td").getAttribute("data-colindex"):(0,t.closest)(s,"th").getAttribute("data-colindex")),m=Number("row"===i?(0,t.closest)(s,"td").getAttribute("index"):(0,t.closest)(s,"th").getAttribute("index"));l=this.olapEngineModule.pivotValues[m][g]}var f="row"===i?this.olapEngineModule.tupRowInfo[l.ordinal]:this.olapEngineModule.tupColumnInfo[l.ordinal],S={axis:i,action:a,fieldName:e,delimiter:"~~",memberName:f.uNameCollection,currentCell:l};this.showWaitingPopup();var v={drillInfo:S,pivotview:u,cancel:!1},y=this.olapEngineModule.fieldList[S.fieldName]&&this.olapEngineModule.fieldList[S.fieldName].isHierarchy,b=f.drillInfo.map((function(e){return e.hierarchy})).indexOf(l.hierarchy.toString()),C=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);if(S&&"down"===S.action){for(var x=f.drillInfo.map((function(e){return e.uName})),w="",T=0;T<=b;T++){w=w+(""!==w?"~~":"")+(B=(U=x[T]).split("~~"))[B.length-1]}for(var M=this.olapEngineModule.getDrilledSets(S.memberName,l,this.olapEngineModule.fieldList[l.hierarchy]&&!this.olapEngineModule.fieldList[l.hierarchy].hasAllMember?l.valueSort.levelName.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-1:b,i),D=0,O=V=Object.keys(M);D<O.length;D++)for(var P=M[O[D]],N=0,E=C.length;N<E;N++){var I=C[N],F=P;I.delimiter&&(F=F.replace(/~~/g,I.delimiter));for(var L=[],A=0;A<I.items.length;A++)0!==I.items[A].indexOf(F)&&(L[L.length]=I.items[A]);I.items=L}this.olapEngineModule.drilledSets[l.actualText]=f.members[b],S.memberName=w;for(var k=[],j=0,q=C;j<q.length;j++){(U=q[j]).name===S.fieldName&&k.push(U)}if(k.length>0){if(k[0].delimiter&&(w=w.replace(/~~/g,k[0].delimiter)),-1===r.inArray(w,k[0].items)&&k[0].items.push(w),y)for(N=0;N<k[0].items.length;)k[0].items[N]===w?k[0].items.splice(N,1):++N}else if(!y){var H={name:S.fieldName,items:[w],delimiter:"~~"};C?C.push(H):C=[H]}v.drillInfo.memberName=w,this.setProperties({dataSourceSettings:{drilledMembers:C}},!0),u.trigger(R,v,(function(e){if(e.cancel)h.hideWaitingPopup(),h.setProperties({dataSourceSettings:{drilledMembers:c}},!0);else{var t={dataSourceSettings:r.getClonedDataSourceSettings(h.dataSourceSettings)};h.trigger(d,t),h.setProperties({dataSourceSettings:t.dataSourceSettings},!0),h.olapEngineModule.updateDrilledInfo(h.dataSourceSettings),h.allowServerDataBinding=!1,h.setProperties({pivotValues:h.olapEngineModule.pivotValues},!0),h.allowServerDataBinding=!0;var i={dataSourceSettings:r.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:u.olapEngineModule.pivotValues};h.trigger(p,i),h.olapEngineModule.pivotValues=i.pivotValues,h.renderPivotGrid()}}))}else{delete this.olapEngineModule.drilledSets[l.actualText];M=this.olapEngineModule.getDrilledSets(S.memberName,l,b,i);var V=Object.keys(M);for(x=f.drillInfo.map((function(e){return e.uName})),w="",T=0;T<=b;T++){var U,B;w=w+(""!==w?"~~":"")+(B=(U=x[T]).split("~~"))[B.length-1]}for(var _=0,G=V;_<G.length;_++){P=M[G[_]];var z=[];for(N=0,E=C.length;N<E;N++){var W=P;if((k=C[N]).name===S.fieldName&&z.push(k),k.delimiter&&(W=P.replace(/~~/g,k.delimiter)),!y){for(L=[],A=0;A<k.items.length;A++)0!==k.items[A].indexOf(W)&&(L[L.length]=k.items[A]);k.items=L}}if(y)if(z.length>0){z[0].delimiter&&(w=w.replace(/~~/g,z[0].delimiter)),-1===r.inArray(w,z[0].items)&&z[0].items.push(w)}else{H={name:S.fieldName,items:[w],delimiter:"~~"};C?C.push(H):C=[H]}}for(var Q=[],Y=0,K=C;Y<K.length;Y++){var X=K[Y];X.items.length>0&&Q.push(X)}this.setProperties({dataSourceSettings:{drilledMembers:C}},!0),u.trigger(R,v,(function(e){if(e.cancel)h.hideWaitingPopup(),h.setProperties({dataSourceSettings:{drilledMembers:c}},!0);else{var t={dataSourceSettings:r.getClonedDataSourceSettings(h.dataSourceSettings)};h.trigger(d,t),h.setProperties({dataSourceSettings:t.dataSourceSettings},!0),h.setProperties({dataSourceSettings:{drilledMembers:Q}},!0),h.olapEngineModule.updateDrilledInfo(h.dataSourceSettings),h.allowServerDataBinding=!1,h.setProperties({pivotValues:h.olapEngineModule.pivotValues},!0),h.allowServerDataBinding=!0;var i={dataSourceSettings:r.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:u.olapEngineModule.pivotValues};h.trigger(p,i),h.olapEngineModule.pivotValues=i.pivotValues,h.renderPivotGrid()}}))}},n.prototype.onContentReady=function(){var e,i,a=(0,ls.getScrollBarWidth)();this.isPopupClicked=!1,this.showFieldList&&this.pivotFieldListModule&&"Server"!==this.dataSourceSettings.mode?(this.pivotFieldListModule.element.style.display="block",(0,o.hideSpinner)(this.pivotFieldListModule.fieldListSpinnerElement)):this.fieldListSpinnerElement&&(0,o.hideSpinner)(this.fieldListSpinnerElement),this.isEmptyGrid?this.pivotValues.length>0&&(this.isEmptyGrid=!1,this.notEmpty=!0):("Server"===this.dataSourceSettings.mode&&this.isServerWaitingPopup||"Local"===this.dataSourceSettings.mode)&&this.hideWaitingPopup();var r=this.element.querySelector("."+vn)?this.element.querySelector("."+vn):this.element.querySelector("."+ba),n=this.element.querySelector("."+bn),s=this.virtualScrollSettings&&this.virtualScrollSettings.allowSinglePage&&"pivot"===this.dataType;if(this.grid){var l=this.element.querySelector("."+In),d=r.parentElement.offsetWidth<r.querySelector("."+Mr).offsetWidth,p="pivot"===this.dataType?this.engineModule:this.olapEngineModule;if(this.enableVirtualization&&p&&this.virtualscrollModule){if(s&&this.element.querySelector("."+as)&&((0,t.removeClass)([n,r],["e-virtual-pivot-content"]),(0,t.addClass)([this.element.querySelector("."+as)],[rs]),this.grid&&this.grid.element.querySelector(".e-spinner-inner")&&(0,t.removeClass)([this.grid.element.querySelector(".e-spinner-inner")],[rs])),s){var h=this.element.querySelector("."+as);if(h||(h=(0,t.createElement)("div",{className:as+" "+rs,innerHTML:this.localeObj.getConstant("loading")}),this.grid.element&&!this.element.querySelector("."+as)&&this.grid.element.insertBefore(h,this.grid.element.firstElementChild)),this.element.querySelector("."+Tn)&&this.element.querySelector("."+In)){var u=this.element.querySelector("."+In).offsetHeight+this.element.querySelector("."+Tn).offsetHeight;(0,t.setStyleAttribute)(h,{height:u+"px",width:this.element.querySelector("."+Tn).offsetWidth+"px",padding:Math.floor(u/2)+"px"})}}this.element.querySelector("."+ba)&&!this.element.querySelector("."+ba).querySelector("."+fn)&&(this.virtualDiv=(0,t.createElement)("div",{className:fn}),this.element.querySelector("."+ba).appendChild(this.virtualDiv)),this.element.querySelector("."+bn)&&!this.element.querySelector("."+bn).querySelector("."+fn)?(this.virtualHeaderDiv=(0,t.createElement)("div",{className:fn}),this.element.querySelector("."+bn).appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector("."+bn).querySelector("."+fn);var c=l.querySelector("."+Sn);if(l&&!c){this.virtualTableDiv=(0,t.createElement)("div",{className:Sn}),l.appendChild(this.virtualTableDiv),c=l.querySelector("."+Sn),this.virtualScrollDiv=(0,t.createElement)("div",{className:yn}),c.appendChild(this.virtualScrollDiv),(0,t.setStyleAttribute)(c,{minHeight:a+"px",maxHeight:a+"px",overflowX:"scroll"}),(0,t.setStyleAttribute)(this.virtualScrollDiv,{height:"0.1px"});var g=(0,t.createElement)("div",{className:vn});g.append.apply(g,Array.prototype.slice.call(r.childNodes)),r.appendChild(g),g.scrollLeft=0}var m=this.element.querySelector("."+ba).querySelector("."+Mr),f=this.gridSettings.rowHeight*p.rowCount+.1-m.clientHeight;f>this.scrollerBrowserLimit&&(this.verticalScrollScale=f/this.scrollerBrowserLimit,f=this.scrollerBrowserLimit),(i=this.gridSettings.columnWidth*p.columnCount)>this.scrollerBrowserLimit&&(this.horizontalScrollScale=i/this.scrollerBrowserLimit,i=this.scrollerBrowserLimit),(0,t.setStyleAttribute)(this.virtualDiv,{height:(f>.1?f:.1)+"px",width:(i>.1?i:.1)+"px"}),(0,t.setStyleAttribute)(this.virtualHeaderDiv,{height:0,width:(i>.1?i:.1)+"px"}),this.isAdaptive&&(r.style.minHeight="1px",r.style.minHeight="1px");var S=this.isAdaptive?r:l.querySelector("."+Sn)?l.querySelector("."+Sn):r;e=r.parentElement.scrollTop>this.scrollerBrowserLimit?r.querySelector("."+Mr).style.transform.split(",")[1].trim():(s?r.parentElement.scrollTop:-(r.parentElement.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-r.parentElement.scrollTop))+"px)",Number(e.split("px")[0])>this.virtualDiv.clientHeight&&(e=this.virtualDiv.clientHeight+"px)");var v=Math.abs(S.scrollLeft),y=v>this.scrollerBrowserLimit?r.querySelector("."+Mr).style.transform.split(",")[0].trim()+",":"translate("+(this.enableRtl?1:-1)*(v*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-v)+"px,";(0,t.setStyleAttribute)(r.querySelector("."+Mr),{transform:y+e}),(0,t.setStyleAttribute)(n.querySelector("."+Mr),{transform:y+0+"px)"}),!d&&l&&c||this.isAdaptive?c.style.display="none":c.style.display="block";var b=Number(-r.querySelector("."+Mr).style.transform.split("(")[1].split(",")[0].split("px")[0]);if(this.virtualscrollModule.alignFreezedCells(b,!0),d){var C=0;C=this.pivotColumns.length<25?i+r.querySelector("."+Mr).querySelector("."+is).offsetWidth+(l.offsetWidth-l.clientWidth):i+(l.offsetWidth-l.clientWidth),"auto"!==this.grid.height?this.grid.element.querySelector("."+yn).style.width=C+a+"px":this.grid.element.querySelector("."+yn).style.width=C+"px"}this.grid.element.querySelector("."+vn)&&(r.parentElement.scrollHeight!==r.scrollHeight?r.style.overflowY="hidden":r.style.overflowY="");var x="pivot"===this.dataType&&"column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,w=this.pageSettings.columnPageSize*x*this.gridSettings.columnWidth,M=S.scrollWidth-(Math.abs(v)+S.offsetWidth);if(this.virtualscrollModule&&w>0&&M<=w&&v>0){var D=r.scrollWidth-(Math.abs(r.scrollLeft)+r.parentElement.offsetWidth),O=void 0;D<1&&"horizondal"===this.scrollDirection&&(r.parentElement.scrollTop>0&&(O=r.parentElement.scrollTop),this.virtualDiv.style.display="none",D=r.scrollWidth-(Math.abs(r.scrollLeft)+r.parentElement.offsetWidth)),this.virtualDiv.style.display="",O&&(r.parentElement.scrollTop=O);var P=r.scrollWidth-(Math.abs(r.scrollLeft)+r.parentElement.offsetWidth);D>1&&(this.scrollPosObject.horizontalSection-=M<=0?D>M?D:-P:P===D?D-M:D<P&&(M===P||M>D)?-(P-D):0,"auto"!==this.grid.height&&(this.scrollPosObject.horizontalSection-=a),this.scrollPosObject.horizontalSection=this.scrollPosObject.horizontalSection>=-this.element.querySelector("."+en).querySelector("."+Pr+"."+is).offsetWidth?this.scrollPosObject.horizontalSection:-this.element.querySelector("."+en).querySelector("."+Pr+"."+is).offsetWidth),y=v>this.scrollerBrowserLimit?r.querySelector("."+Mr).style.transform.split(",")[0].trim()+",":"translate("+(this.enableRtl?1:-1)*(v*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-v)+"px,",(0,t.setStyleAttribute)(r.querySelector("."+Mr),{transform:y+e}),(0,t.setStyleAttribute)(n.querySelector("."+Mr),{transform:y+0+"px)"}),b=Number(-r.querySelector("."+Mr).style.transform.split("(")[1].split(",")[0].split("px")[0]),this.virtualscrollModule.alignFreezedCells(b,!0)}}if("Chart"!==this.currentView&&this.grid.hideScroll(),this.showGroupingBar){if(this.groupingBarModule&&this.element.querySelector("."+Ka)&&this.groupingBarModule.setGridRowWidth(),this.actionObj.fieldInfo&&this.actionObj.fieldInfo.fieldName){var N=this.pivotButtonModule.parentElement.querySelector('[data-uid="'+this.actionObj.fieldInfo.fieldName+'"]');(0,t.isNullOrUndefined)(N)||N.focus()}this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"}else this.element.style.minWidth="310px",this.grid.element.style.minWidth="310px"}if(this.unwireEvents(),this.wireEvents(),this.isChartLoaded=!1,this.isEmptyGrid||this.trigger(T),this.actionObj.actionName=this.getActionCompleteName(),this.actionObj.actionName&&(this.actionObj.actionName===Fi&&this.pivotCommon&&this.pivotCommon.filterDialog&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.pivotCommon.filterDialog.setFocus.bind(this.pivotCommon.filterDialog))),this.actionObj.actionName!==Jt&&this.actionCompleteMethod()),this.groupingModule&&(this.groupingModule.isUpdate=!1),this.engineModule&&this.engineModule.clearProperties(),this.virtualscrollModule&&this.grid&&this.virtualscrollModule.onHorizondalScroll(n,r),!this.isAdaptive&&this.enableVirtualization&&r&&this.virtualscrollModule&&!s){var E=r.parentElement.parentElement.querySelector(".e-movablescrolldiv");if(i<3*r.parentElement.clientWidth)r.style.overflowX="visible",E.style.display="none",n.scrollLeft=r.parentElement.scrollLeft,(0,t.setStyleAttribute)(r.querySelector("."+Mr),{transform:"translate(0px,"+e}),(0,t.setStyleAttribute)(n.querySelector("."+Mr),{transform:"translate(0px, 0px)"}),this.virtualscrollModule.alignFreezedCells(0,!0);else{t.EventHandler.remove(this.element.querySelector("."+In).querySelector("."+ba),"scroll",this.headerScrollUpdate);var I=this.element.querySelector("."+In).querySelector("."+ba).scrollLeft;r.style.overflowX="auto",E.style.display="block",0!==I&&(E.scrollLeft=I),E.scrollLeft!==r.scrollLeft&&0!==r.scrollLeft&&(E.scrollLeft=r.scrollLeft)}}},n.prototype.setToolTip=function(e){var i,a,r=this,n=Number(e.target.getAttribute("data-colindex")),s=Number(e.target.getAttribute("index")),o=this.dataSourceSettings.values.length>0&&this.pivotValues&&this.pivotValues[s]&&this.pivotValues[s][n]?this.pivotValues[s][n]:void 0;this.tooltip.content="";var l=!1;if(o&&"olap"===this.dataType){var d=o.actualText;if(!(0,t.isNullOrUndefined)(d)&&this.olapEngineModule.fieldList&&!this.olapEngineModule.fieldList[d]){var p=this.olapEngineModule.tupRowInfo;d=o.rowOrdinal>-1&&p.length>0&&p[o.rowOrdinal]&&!(0,t.isNullOrUndefined)(p[o.rowOrdinal].measureName)?p[o.rowOrdinal].measureName:d}if(this.olapEngineModule.fieldList&&this.olapEngineModule.fieldList[d])i=(h=this.olapEngineModule.fieldList[d]).isCalculatedField?h.type:h.aggregateType,a=this.olapEngineModule.dataFields[d]&&this.olapEngineModule.dataFields[d].caption?this.olapEngineModule.dataFields[d].caption:h.caption,l=!0}else{var h;if(o&&this.engineModule.fieldList&&this.engineModule.fieldList[o.actualText])i="DistinctCount"===(i=(h=this.engineModule.fieldList[o.actualText]).aggregateType)||"number"===h.type&&"include"!==h.type&&"exclude"!==h.type?void 0===i?"Sum":h.aggregateType:"Count",a=h.caption,l=!0}if(o&&l){var u=this.getRowText(s,0),c=this.getColText(0,n,s),g=""===o.formattedText?this.localeObj.getConstant("noValue"):o.formattedText;if(this.tooltipTemplate&&void 0!==this.getTooltipTemplate()){var m={rowHeaders:u,columnHeaders:c,aggregateType:i,valueField:a,value:g,rowFields:this.getHeaderField(s,n,"row"),columnFields:this.getHeaderField(s,n,"column")};if("function"==typeof this.tooltipTemplate&&this.isReact){var f=document.createElement("div");this.getTooltipTemplate()(m,this,"tooltipTemplate",this.element.id+"tooltipTemplate",null,null,f),this.renderReactTemplates((function(){r.enableHtmlSanitizer?r.tooltip.content=t.SanitizeHtmlHelper.sanitize(f.outerHTML):r.tooltip.content=f.outerHTML}))}else{var S=this.getTooltipTemplate()(m,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML;this.enableHtmlSanitizer?this.tooltip.content=t.SanitizeHtmlHelper.sanitize(S):this.tooltip.content=S}}else{var v="<div class=e-pivottooltip><p class="+Er+">"+this.localeObj.getConstant("row")+":</p><p class="+Ir+">"+u+"</p></br><p class="+Er+">"+this.localeObj.getConstant("column")+":</p><p class="+Ir+">"+c+"</p></br>"+(""!==o.actualText?"<p class="+Er+">"+("olap"===this.dataType?"":this.localeObj.getConstant(i)+" "+this.localeObj.getConstant("of")+" ")+a+":</p><p class="+Ir+">"+g+"</p></div>":"");this.tooltip.content=(0,t.initializeCSPTemplate)((function(){return v}))}}else e.cancel=!0},n.prototype.getTooltipTemplate=function(){return this.tooltipTemplateFn},n.prototype.getHeaderField=function(e,t,i){var a,r="",n="olap"===this.dataType?this.olapEngineModule:this.engineModule,s=n.valueSortSettings.headerDelimiter;if("row"===i){a=this.pivotValues[e][0].valueSort.levelName.toString().split(s).length;for(var o=0;o<a&&this.dataSourceSettings.rows.length>0&&this.dataSourceSettings.rows[o];o++)r+=(o?" - ":"")+(this.dataSourceSettings.rows[o].caption?this.dataSourceSettings.rows[o].caption:this.dataSourceSettings.rows[o].name)}else{if(this.dataSourceSettings.columns.length>0){var l=0===this.dataSourceSettings.values.length?0:Number(Object.keys(n.headerContent)[Object.keys(n.headerContent).length-1]);a=this.pivotValues[l][t].valueSort.levelName.toString().split(s).length,a=this.dataSourceSettings.values.length>1?a-1:a}for(var d=0;d<a&&this.dataSourceSettings.columns.length>0&&this.dataSourceSettings.columns[d];d++)r+=(d?" - ":"")+(this.dataSourceSettings.columns[d].caption?this.dataSourceSettings.columns[d].caption:this.dataSourceSettings.columns[d].name)}return r},n.prototype.getLevel=function(e){var t=e.valueSort?e.valueSort.levelName.toString():"",i=e.actualText?e.actualText.toString().split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,a=t.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-(i?i-1:i);return a?a-1:0},n.prototype.getRowText=function(e,i){var a=this.pivotValues[e][i],r="";if(a){var n=this.getLevel(a);if(r="grand sum"===a.type?this.localeObj.getConstant("grandTotal"):a.formattedText,"row"===this.dataSourceSettings.valueAxis)r=(r=0===this.dataSourceSettings.rows.length&&this.dataSourceSettings.values.length>1?this.pivotValues[e][0].valueSort.levelName.toString().slice((this.localeObj.getConstant("grandTotal")+this.dataSourceSettings.valueSortSettings.headerDelimiter).length).toString():1===this.dataSourceSettings.values.length?(0,t.isNullOrUndefined)(this.dataSourceSettings.values[0].caption)?this.dataSourceSettings.values[0].name:this.dataSourceSettings.values[0].caption:this.pivotValues[e][0].valueSort.levelName.toString()).split(this.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");else for(;n>0||void 0===a.index;)e--,void 0!==(a=this.pivotValues[e][i]).index&&n>a.level&&(r=r+this.dataSourceSettings.valueSortSettings.headerDelimiter+a.formattedText,n-=1);r=r.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).reverse().join(" - ")}return r},n.prototype.getColText=function(e,t,i){for(var a=this.pivotValues[0][t],r=a.axis,n="grand sum"===a.type?this.localeObj.getConstant("grandTotal"):a.formattedText;"value"!==r&&i>e;)e++,this.pivotValues[e]&&(r=(a=this.pivotValues[e][t]).axis,"sum"!==a.type&&"grand sum"!==a.type&&"value"!==r&&(n=n+" - "+a.formattedText));return n},n.prototype.updateClass=function(){this.enableRtl?(0,t.addClass)([this.element],Wi):(0,t.removeClass)([this.element],Wi),this.isAdaptive?(0,t.addClass)([this.element],Qi):(0,t.removeClass)([this.element],Qi),this.cssClass&&(0,t.addClass)([this.element],this.cssClass.split(" "))},n.prototype.mouseRclickHandler=function(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target),this.lastCellClicked=e.target},n.prototype.mouseDownHandler=function(e){3===e.which&&(this.lastCellClicked=e.target),this.isCellBoxMultiSelection&&(this.isMouseDown=!0,this.isMouseUp=!1,this.lastSelectedElement=void 0)},n.prototype.mouseMoveHandler=function(e){var i=this;if(this.isCellBoxMultiSelection&&(e.preventDefault(),this.isMouseDown&&e.target)){var a=e.target,r=a.parentElement.classList.contains(Or)||a.classList.contains(Or)?"row":"column";if(a="column"===r?(0,t.closest)(a,"th"):(0,t.closest)(a,"td")){var n=Number(a.getAttribute("data-colindex")),s=Number(a.getAttribute("index")),o={cancel:!1,isCellClick:!0,currentCell:a,data:this.pivotValues[s][n]};this.trigger(A,o,(function(e){if(!e.cancel){i.grid.clearSelection();var t=i.parentAt(a,"TH");i.lastSelectedElement&&i.lastSelectedElement!==t&&t.classList.contains(xn)?(i.lastSelectedElement.classList.remove(On),i.lastSelectedElement.classList.remove(xn),i.lastSelectedElement=t):(i.lastSelectedElement=t,t.classList.contains(Pr)&&t.classList.contains(is)||(t.classList.add(On),t.classList.add(xn))),i.renderModule.selected()}}))}}},n.prototype.mouseUpHandler=function(){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)},n.prototype.parentAt=function(e,t){for(;e.tagName!==t&&e.parentElement;)e=e.parentElement;return e},n.prototype.mouseClickHandler=function(e){(3===e.which||0===e.which)&&(this.lastCellClicked=e.target);var i=e.target;if(!(0,t.closest)(i,"."+ya)){var a=null,n=i.parentElement&&i.parentElement.classList.contains(Or)||i.classList.contains(Or)?"row":"column";if(a="column"===n?(0,t.closest)(i,"th"):(0,t.closest)(i,"td"),"column"!==n||a||"Row"===this.gridSettings.selectionSettings.mode||(a=(0,t.closest)(i,"td")),i.classList.contains(wr)||i.classList.contains(Tr)||!this.enableValueSorting||i.classList.contains("e-resized")||i.classList.contains("e-rhandler")&&i.classList.contains("e-rcursor")||"olap"===this.dataType&&this.enableVirtualization){if(!i.classList.contains(wr)&&!i.classList.contains(Tr))return void this.cellClicked(i,a,e);var s=i.parentElement.getAttribute("fieldname"),o=(p=r.getFieldInfo(s,this),i.classList.contains(wr)?this.actionObj.actionName=st:i.classList.contains(Tr)?this.actionObj.actionName=ot:"");if(this.actionObj.actionName=o,this.actionObj.fieldInfo=p.fieldItem,this.actionBeginMethod())return;try{this.onDrill(i)}catch(e){this.actionFailureMethod(e)}}else{var l="pivot"===this.dataType?this.engineModule:this.olapEngineModule;this.cellClicked(i,a,e);try{if(a&&(a.parentElement.parentElement.parentElement.parentElement.classList.contains(Tn)&&"column"===this.dataSourceSettings.valueAxis&&!a.classList.contains(is)||a.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(a.classList.contains("e-rowsheader")||a.classList.contains("e-stot")))){var d=a.getAttribute("fieldname"),p=r.getFieldInfo(d,this);if(this.actionObj.actionName=nt,this.actionObj.fieldInfo=p.fieldItem,this.actionBeginMethod())return;var h=Number(a.getAttribute("data-colindex")),u=Number(a.getAttribute("index"));if("row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)){var c=this.pivotValues[u][h];if(-1===this.dataSourceSettings.valueIndex)u="value"===c.type||3===c.memberType?u:u+1;else u=this.getLevel(c)<=l.measureIndex&&c.members&&c.members.length>0?c.members[0].rowIndex:u}else"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(h=Number(a.getAttribute("data-colindex"))+Number(a.getAttribute("aria-colspan"))-1,u=l.headerContent.length-1);this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(a.getAttribute("data-colindex"))+Number(a.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[u][h].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),this.showWaitingPopup();var g=this;if(l.enableValueSorting=!0,g.enableVirtualization||g.enablePaging){if(g.dataSourceSettings.enableSorting){for(var m=0,f=Object.keys(g.engineModule.fieldList);m<f.length;m++){var S=f[m];g.engineModule.fieldList[S].sort="Ascending"}g.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}"Server"===g.dataSourceSettings.mode?g.getEngine("onValueSort",null,null,null,null,null,null):(g.engineModule.rMembers=g.engineModule.headerCollection.rowHeaders,g.engineModule.cMembers=g.engineModule.headerCollection.columnHeaders,g.engineModule.applyValueSorting(),g.engineModule.updateEngine())}else"Server"===g.dataSourceSettings.mode?g.getEngine("onValueSort",null,null,null,null,null,null):"olap"===this.dataType?g.olapEngineModule.onSort(g.dataSourceSettings,!0):g.engineModule.generateGridData(g.dataSourceSettings,!0);g.allowServerDataBinding=!1,g.setProperties({pivotValues:l.pivotValues},!0),g.allowServerDataBinding=!0;var v={valueSortInfo:l.valueSortSettings};this.actionObj.actionInfo=v,g.renderPivotGrid()}}catch(e){this.actionFailureMethod(e)}}}},n.prototype.updateTotColWidth=function(){this.totColWidth=0;for(var e=0,t=this.pivotColumns;e<t.length;e++){var i=t[e];this.totColWidth=this.totColWidth+i.width}},n.prototype.framePivotColumns=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];if(a.columns&&a.columns.length>0)this.framePivotColumns(a.columns);else{var r="0.formattedText"===a.field?"":a.customAttributes&&a.customAttributes.cell&&a.customAttributes.cell.valueSort?a.customAttributes.cell.valueSort.levelName:"",n=this.renderModule.setSavedWidth("0.formattedText"===a.field?a.field:r,Number("auto"===a.width?a.minWidth:a.width));this.pivotColumns.push({allowReordering:a.allowReordering,allowResizing:a.allowResizing,headerText:r,width:n,autoFit:a.autoFit}),this.totColWidth=this.totColWidth+Number(n)}}},n.prototype.setGridColumns=function(e){if(!(0,t.isNullOrUndefined)(this.totColWidth)&&this.totColWidth>0||this.renderModule.isAutoFitEnabled){for(var i=0,a=e;i<a.length;i++){var r=a[i];if(r.columns&&r.columns.length>0)this.setGridColumns(r.columns);else if(this.renderModule.isAutoFitEnabled)r.autoFit=this.pivotColumns[this.posCount].autoFit,this.posCount++;else{var n="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"";r.allowReordering=this.pivotColumns[this.posCount].allowReordering,r.allowResizing=this.pivotColumns[this.posCount].allowResizing,r.autoFit=this.pivotColumns[this.posCount].autoFit;var s=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:n,Number(this.pivotColumns[this.posCount].width));r.autoFit?this.renderModule.isAutoFitEnabled=!0:"auto"!==r.width?r.width=s:r.minWidth=s,this.posCount++,r.allowReordering&&(this.gridSettings.allowReordering=!0),r.allowResizing&&(this.gridSettings.allowResizing=!0)}}this.gridSettings.allowReordering&&ls.Grid.Inject(ls.Reorder),this.gridSettings.allowResizing&&ls.Grid.Inject(ls.Resize)}},n.prototype.fillGridColumns=function(e){for(var t=0,i=e;t<i.length;t++){var a=i[t];a.allowReordering=this.gridSettings.allowReordering,a.allowResizing=this.gridSettings.allowResizing,a.clipMode=this.gridSettings.clipMode,this.posCount++,a.columns&&a.columns.length>0&&this.fillGridColumns(a.columns)}},n.prototype.triggerColumnRenderEvent=function(e){this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(e);var t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings,stackedColumns:this.getStackedColumns(e,[])};this.trigger(F,i),this.updateTotColWidth(),t!==this.pivotColumns[0].width&&(this.firstColWidth=this.pivotColumns[0].width,this.renderModule.resColWidth=parseInt(this.firstColWidth.toString(),10)),this.posCount=0,this.setGridColumns(e)},n.prototype.setCommonColumnsWidth=function(e,t){for(var i=0,a=e;i<a.length;i++){var r=a[i];"0.formattedText"!==r.field?r.columns?this.setCommonColumnsWidth(r.columns,t):r.autoFit||("auto"!==r.width?r.width=this.renderModule.lastColumn&&r.field===this.renderModule.lastColumn.field?t-3:t:r.minWidth=t):r.width=this.firstColWidth?this.firstColWidth:r.width}},n.prototype.getHeightAsNumber=function(){var e,t;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?(this.isAngular&&this.element&&this.element.style&&(t=window.getComputedStyle(this.element).display,this.element.style.display="block"),e=parseFloat(this.height.toString())/100*this.element.offsetHeight,this.isAngular&&this.element&&this.element.style&&(this.element.style.display=t)):this.height.toString().indexOf("px")>-1&&(e=Number(this.height.toString().split("px")[0])):e=Number(this.height),(e<this.minHeight||"auto"===this.height)&&(e=this.minHeight),e},n.prototype.getWidthAsNumber=function(){var e;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?e=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(e=Number(this.width.toString().split("px")[0])),isNaN(e)&&(e=this.element.offsetWidth)):e=Number(this.width),e<400&&(e=400),e},n.prototype.getGridWidthAsNumber=function(){var e,t=this.element.offsetWidth?this.element.offsetWidth:this.element.getBoundingClientRect().width;return isNaN(this.grid.width)?(this.grid.width.toString().indexOf("%")>-1?e=parseFloat(this.grid.width.toString())/100*t:this.grid.width.toString().indexOf("px")>-1&&(e=Number(this.grid.width.toString().split("px")[0])),isNaN(e)&&(e=t)):e=Number(this.grid.width),e},n.prototype.onWindowResize=function(){this.actionObj.actionName=Jt,this.actionBeginMethod()||(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500),this.actionObj.actionName=this.getActionCompleteName(),this.actionObj.actionName&&this.actionCompleteMethod())},n.prototype.refresh=function(){this.pivotRefresh()},n.prototype.layoutRefresh=function(){if(this.element&&this.element.classList.contains("e-pivotview")&&("olap"===this.dataType?this.olapEngineModule&&this.olapEngineModule.pivotValues:this.engineModule&&this.engineModule.pivotValues)){if(this.grid){var e="olap"===this.dataType&&this.olapEngineModule.pivotValues.length>0?this.olapEngineModule.pivotValues[0].length:this.dataSourceSettings.values.length>0&&this.engineModule&&this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2,t=this.renderModule.calculateColWidth(e);this.grid.width=this.renderModule.calculateGridWidth(),this.renderModule.calculateGridHeight(!0),this.gridSettings.allowAutoResizing&&this.setCommonColumnsWidth(this.grid.columns,t),this.triggerColumnRenderEvent(this.grid.columns),this.renderModule.isAutoFitEnabled?this.renderModule.addPivotAutoFitClass():this.renderModule.removePivotAutoFitClass(),this.element.querySelector("."+en).querySelector("colGroup").innerHTML=this.grid.getHeaderContent().querySelector("colgroup").innerHTML,this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+Ka)&&this.groupingBarModule.setGridRowWidth(),this.chart&&this.pivotChartModule&&(this.chart.height=this.pivotChartModule.getResizedChartHeight())}this.showToolbar&&this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.grid?this.getGridWidthAsNumber():this.getWidthAsNumber()),this.enablePaging&&this.notify(it,this),this.chart&&(this.showToolbar&&"Chart"===this.currentView||!this.showToolbar)&&(this.chart.width=this.showToolbar&&this.grid||"Both"===this.displayOption.view&&this.grid?this.getGridWidthAsNumber().toString():this.getWidthAsNumber().toString(),this.chart.height=this.pivotChartModule.getResizedChartHeight(),"Chart"===this.displayOption.view&&this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+Gn)&&this.groupingBarModule.refreshUI())}},n.prototype.cellClicked=function(e,i,a){var r=this;if(e.classList.contains(Nn)&&(e.classList.contains(Pn)?this.isPopupClicked=!1:this.isPopupClicked=!0),i&&!(0,t.isNullOrUndefined)(this.pivotValues)&&this.pivotValues.length>0){var n=Number(i.getAttribute("data-colindex")),s=Number(i.getAttribute("index")),o=Number(i.getAttribute("aria-colspan")),l={cancel:!1,isCellClick:!0,currentCell:i,data:this.pivotValues[s][n]};this.trigger(A,l,(function(e){r.gridSettings.allowSelection&&(("Both"===r.gridSettings.selectionSettings.mode?i.classList.contains(Dn):"Row"===r.gridSettings.selectionSettings.mode)?r.clearSelection(i,a):e.cancel||(r.clearSelection(i,a),r.applyColumnSelection(a,i,n,n+(o>0?o-1:0),s)),"Column"===r.gridSettings.selectionSettings.mode||i.classList.contains(Dr)||r.rowDeselect(i,a,s,r.gridSettings.selectionSettings.mode,e),"Column"===r.gridSettings.selectionSettings.mode||e.cancel||(("Multiple"===r.gridSettings.selectionSettings.type?a.ctrlKey||a.shiftKey:r.selectedRowIndex===s)?r.selectedRowIndex=void 0:(r.selectedRowIndex=s,r.grid.selectionModule.selectRow(s-r.renderModule.rowStartPos)))),r.cellClick&&e.isCellClick&&r.trigger(E,{currentCell:i,data:r.pivotValues[s][n],nativeEvent:a}),r.getSelectedCellsPos()}))}else this.clearSelection(null,a)},n.prototype.rowDeselect=function(e,i,a,r,n){if(!i.shiftKey&&!i.ctrlKey&&"Both"!==this.gridSettings.selectionSettings.mode||"Single"===this.gridSettings.selectionSettings.type)if(e.classList.contains(Cn)||e.classList.contains(xn)||e.classList.contains(On)){if((0,t.removeClass)(this.element.querySelectorAll("."+Cn),Cn),(0,t.removeClass)(this.element.querySelectorAll("."+xn),xn),(0,t.removeClass)(this.element.querySelectorAll("."+On),On),n.cancel)this.setSavedSelectedCells();else if("Cell"===r)(0,t.addClass)([e],[Cn]);else if("Row"===r||"Single"===this.gridSettings.selectionSettings.type){var s='[index="'+a+'"]';(0,t.addClass)(this.element.querySelectorAll(s),[xn,On]),"Row"!==r&&e.classList.add(Cn)}}else n.cancel?this.setSavedSelectedCells():((0,t.removeClass)(this.element.querySelectorAll("."+Cn),Cn),(0,t.removeClass)(this.element.querySelectorAll("."+xn),xn),(0,t.removeClass)(this.element.querySelectorAll("."+On),On));else(i.shiftKey||i.ctrlKey||"Both"===this.gridSettings.selectionSettings.mode)&&n.cancel&&((0,t.removeClass)(this.element.querySelectorAll("."+Cn),Cn),(0,t.removeClass)(this.element.querySelectorAll("."+xn),xn),(0,t.removeClass)(this.element.querySelectorAll("."+On),On),this.setSavedSelectedCells())},n.prototype.clearSelection=function(e,i){if(!i.shiftKey&&!i.ctrlKey||"Single"===this.gridSettings.selectionSettings.type)if("Cell"===this.gridSettings.selectionSettings.mode)e&&e.classList.contains(Dr)?(0,t.removeClass)(this.element.querySelectorAll("."+Dn+"."+Cn),Cn):(0,t.removeClass)(this.element.querySelectorAll("."+Dr+"."+On),[On,xn]);else if("Both"===this.gridSettings.selectionSettings.mode)if(e&&e.classList.contains(Dn))for(var a=0,r=[].slice.call(this.element.querySelectorAll("."+xn+", ."+Cn));a<r.length;a++){var n=r[a];(0,t.removeClass)([n],[On,xn,Cn])}else(0,t.removeClass)(this.element.querySelectorAll("."+Cn),Cn)},n.prototype.applyRowSelection=function(e,t,i){var a=this.engineModule.pivotValues[t][e];if(i.ctrlKey||i.shiftKey||!a||this.selectedRowIndex===t)this.selectedRowIndex=void 0;else{this.selectedRowIndex=t;var r=a.level,n=t;do{n++,a=this.engineModule.pivotValues[n][e]}while(a&&r<a.level);var s=this;this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-s.renderModule.rowStartPos,endIndex:n-(1+s.renderModule.rowStartPos)}:s.grid.selectionModule.selectRowsByRange(t-s.renderModule.rowStartPos,n-(1+s.renderModule.rowStartPos))}},n.prototype.applyColumnSelection=function(e,i,a,r,n){if(!i.classList.contains(Or)&&("Cell"!==this.gridSettings.selectionSettings.mode||i.classList.contains(Dr))){var s=e.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(e),this.isPopupClicked?(this.element.querySelector("."+Nn).classList.add(Pn),s=!0):(this.element.querySelector("."+Nn).classList.remove(Pn),s=!1));for(var o=[],l=this.gridSettings.selectionSettings.type,d=i.classList.contains(On),p=[],h={},u=a;u<=r;u++)p.push(u.toString());if(s&&"Single"!==l)d=!1;else{for(var c=0,g=[].slice.call(this.element.querySelectorAll("."+On));c<g.length;c++){var m=g[c];(0,t.removeClass)([m],[On,xn]),-1===p.indexOf(m.getAttribute("data-colindex"))&&(d=!1);var f=Number(m.getAttribute("data-colindex"));h[f]=f}p=Object.keys(h).length>0?Object.keys(h).sort((function(e,t){return parseInt(e,10)-parseInt(t,10)})):p}"Multiple"===l&&e.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?p:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=a?a=Number(this.shiftLockedPos[0]):r=r<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):r):this.shiftLockedPos=[];var S=[];if(e.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===l&&!i.classList.contains(Or))for(var v=0,y=[].slice.call(this.element.querySelectorAll("."+Or+"."+Cn));v<y.length;v++){m=y[v];S.push(m.getAttribute("index"))}for(var b=a;b<=r;)o.push('[data-colindex="'+b+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+n+'"]':"")),b++;if(!d){n=i.classList.contains(Pr)?n:this.renderModule.rowStartPos-1;for(var C=i.classList.contains(On),x=0,w=[].slice.call(this.element.querySelectorAll(o.toString()));x<w.length;x++){m=w[x];Number(m.getAttribute("index"))>=n&&(C&&s&&-1===S.indexOf(m.getAttribute("index"))?(0,t.removeClass)([m],[On,xn]):(0,t.addClass)([m],[On,xn]))}}this.renderModule.selected()}},n.prototype.getSelectedCellsPos=function(){var e=this;e.savedSelectedCellsPos=[],e.cellSelectionPos=[];for(var t=0,i=[].slice.call(this.element.querySelectorAll("."+xn));t<i.length;t++){var a=i[t];e.savedSelectedCellsPos.push({rowIndex:a.getAttribute("index"),colIndex:a.getAttribute("data-colindex")})}for(var r=0,n=[].slice.call(this.element.querySelectorAll("."+Cn));r<n.length;r++){a=n[r];e.cellSelectionPos.push({rowIndex:a.getAttribute("index"),colIndex:a.getAttribute("data-colindex")})}},n.prototype.setSavedSelectedCells=function(){for(var e=0,i=[].slice.call(this.savedSelectedCellsPos);e<i.length;e++){var a='[data-colindex="'+(s=i[e]).colIndex+'"][index="'+s.rowIndex+'"]';(0,t.addClass)([this.element.querySelector(a)],[On,xn])}for(var r=0,n=[].slice.call(this.cellSelectionPos);r<n.length;r++){var s;a='[data-colindex="'+(s=n[r]).colIndex+'"][index="'+s.rowIndex+'"]';(0,t.addClass)([this.element.querySelector(a)],[Cn])}},n.prototype.renderEmptyGrid=function(){var e=this;if(this.isEmptyGrid=!0,this.notEmpty=!1,this.isInitial=!0,this.renderModule=this.renderModule?this.renderModule:new cs(this),this.grid&&this.grid.element&&this.element.querySelector("."+en))this.notEmpty=!0,this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns();else{this.element.querySelector("."+en)&&(0,t.remove)(this.element.querySelector("."+en)),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){};var i=(0,t.createElement)("div",{id:this.element.id+"_grid"});this.element.appendChild(i),this.grid.isStringTemplate=!0,this.grid.appendTo(i),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",(function(){e.grid.scrollModule.setWidth(),e.grid.scrollModule.setHeight()}))}},n.prototype.initEngine=function(){var e=this;if(this.element.querySelector(".e-spin-hide")&&this.showWaitingPopup(),"pivot"===this.dataType){var i=(0,t.isNullOrUndefined)(this.dataSourceSettings.dataSource)?(0,t.isNullOrUndefined)(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0];if(i&&this.pivotCommon){var a="[object Array]"===Object.prototype.toString.call(i);if(a&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!a&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}var n={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger(d,n,(function(t){r.updateDataSourceSettings(e,t.dataSourceSettings),e.updatePageSettings(!1);var i={mode:"",savedFieldList:void 0,pageSettings:e.pageSettings,enableValueSorting:e.enableValueSorting,isDrillThrough:e.allowDrillThrough||e.editSettings.allowEditing,localeObj:e.localeObj,fieldsType:e.fieldsType,clonedReport:e.clonedReport,globalize:e.globalize,currenyCode:e.currencyCode,enablePaging:e.enablePaging,enableVirtualization:e.enableVirtualization,allowDataCompression:e.allowDataCompression,enableHtmlSanitizer:e.enableHtmlSanitizer,enableOptimizedRendering:e.enableVirtualization&&e.virtualScrollSettings&&e.virtualScrollSettings.allowSinglePage};if("pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var a=e.engineModule.data;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:"CSV"===e.dataSourceSettings.type?r.getClonedCSVData(a):r.getClonedData(a);var n=JSON.parse(e.getPersistData()).dataSourceSettings;n.dataSource=[],e.clonedReport=e.clonedReport?e.clonedReport:n}"Server"!==e.dataSourceSettings.mode&&e.engineModule.renderEngine(e.dataSourceSettings,i,e.aggregateCellInfo?e.getValueCellInfo.bind(e):void 0,e.onHeadersSort?e.getHeaderSortInfo.bind(e):void 0),e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.engineModule.pivotValues},!0),e.allowServerDataBinding=!0,e.enginePopulatedEventMethod("initEngine")}else"SSAS"===e.dataSourceSettings.providerType&&"olap"===e.dataType&&(i.savedFieldList=e.olapEngineModule.fieldList,i.savedFieldListData=e.olapEngineModule.fieldListData,r.renderOlapEngine(e,i),e.allowServerDataBinding=!1,e.setProperties({pivotValues:e.olapEngineModule.pivotValues},!0),e.allowServerDataBinding=!0,e.enginePopulatedEventMethod("initEngine"))}))},n.prototype.enginePopulatedEventMethod=function(e,t){if("initEngine"===e){var i=t||this;this.trigger(p,{pivotValues:this.pivotValues},(function(e){"olap"===i.dataType?(i.olapEngineModule.pivotValues=e.pivotValues,i.pivotValues=i.olapEngineModule.pivotValues):(i.engineModule.pivotValues=e.pivotValues,i.pivotValues=i.engineModule.pivotValues),i.notify(Ke,{}),i.notEmpty=!0}))}else{var a=t||this,r={dataSourceSettings:a.dataSourceSettings,pivotValues:a.pivotValues};a.trigger(p,r,(function(e){a.dataSourceSettings=e.dataSourceSettings,"olap"===a.dataType?(a.olapEngineModule.pivotValues=e.pivotValues,a.allowServerDataBinding=!1,a.setProperties({pivotValues:a.olapEngineModule.pivotValues},!0),a.allowServerDataBinding=!0):(a.engineModule.pivotValues=e.pivotValues,a.allowServerDataBinding=!1,a.setProperties({pivotValues:a.engineModule.pivotValues},!0),a.allowServerDataBinding=!0),a.pivotCommon.engineModule="olap"===a.dataType?a.olapEngineModule:a.engineModule,a.pivotCommon.dataSourceSettings=a.dataSourceSettings,a.renderPivotGrid()}))}},n.prototype.generateData=function(){this.isStaticRefresh||("Chart"!==this.displayOption.view&&(0,t.isNullOrUndefined)(this.grid)?(this.renderEmptyGrid(),this.showWaitingPopup()):(this.showWaitingPopup(),clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.refreshData.bind(this),100)))},n.prototype.refreshData=function(){var e=this;e.isStaticRefresh?(e.isStaticRefresh=!1,e.hideWaitingPopup()):e.dataSourceSettings&&(e.dataSourceSettings.dataSource||e.dataSourceSettings.url)?e.dataSourceSettings.dataSource instanceof i.DataManager?"pivot"===e.dataType&&e.remoteData.length>0?(this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),this.engineModule.data=e.remoteData,this.initEngine()):(0,t.isNullOrUndefined)(e.engineModule.data)||0!==e.engineModule.data.length?e.initEngine():(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(e.getData.bind(e),100)):""!==this.dataSourceSettings.url&&"olap"===this.dataType||e.dataSourceSettings.dataSource&&e.dataSourceSettings.dataSource.length>0||this.engineModule.data&&this.engineModule.data.length>0?("pivot"===e.dataType&&(this.hideWaitingPopup(),e.engineModule.data=e.dataSourceSettings.dataSource),e.initEngine()):"Server"===this.dataSourceSettings.mode?this.getEngine("onRefresh"):(this.notify(Ke,{}),this.hideWaitingPopup()):(this.notify(Ke,{}),this.hideWaitingPopup())},n.prototype.getValueCellInfo=function(e){var t=e;return this.trigger(xe,t),t},n.prototype.getHeaderSortInfo=function(e){var t=e;return this.trigger(we,t),t},n.prototype.bindTriggerEvents=function(e){this.trigger((0,ls.getObject)("name",e),e)},n.prototype.getData=function(){this.dataSourceSettings.dataSource.defaultQuery?this.dataSourceSettings.dataSource.executeQuery(this.dataSourceSettings.dataSource.defaultQuery).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},n.prototype.executeQuery=function(e){this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup();var i=this;i.engineModule.data=e.result,this.isEmptyGrid&&!(0,t.isNullOrUndefined)(i.engineModule.data)&&0===i.engineModule.data.length?this.hideWaitingPopup():!(0,t.isNullOrUndefined)(i.engineModule.data)&&i.engineModule.data.length>0?(this.isEmptyGrid=!1,i.initEngine()):(this.isEmptyGrid=!0,this.hideWaitingPopup(),this.renderEmptyGrid(),this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.pivotValues=[],this.engineModule.data=[],this.notify(Ke,{}))},n.prototype.applyFormatting=function(e){if(e){for(var i=[],a=e.length,r=0;r<a;r++)void 0!==e[r]&&void 0===e[r][0]&&i.push(r);for(r=0;r<e.length;r++)for(var n=1;e[r]&&n<e[r].length;n++)if("value"===e[r][n].axis&&""!==e[r][n].formattedText){e[r][n].style=void 0,e[r][n].cssClass=void 0;for(var s=this.dataSourceSettings.conditionalFormatSettings,o=0;o<s.length;o++)(!0===s[o].applyGrandTotals||(0,t.isNullOrUndefined)(s[o].applyGrandTotals)||""!==e[r][n].rowHeaders&&""!==e[r][n].columnHeaders)&&this.checkCondition(e[r][n].value,s[o].conditions,s[o].value1,s[o].value2)&&(s[o].measure&&e[r][n].actualText!==s[o].measure||void 0!==s[o].measure&&""===s[o].measure||void 0!==s[o].label&&""===s[o].label||!(!s[o].label||e[r][0].valueSort.levelName.indexOf(s[o].label)>-1||e[r][n].rowHeaders.indexOf(s[o].label)>-1||e[r][n].columnHeaders.indexOf(s[o].label)>-1)||(s[o].style&&s[o].style.backgroundColor&&(s[o].style.backgroundColor="#"===s[o].style.backgroundColor.charAt(0)&&this.conditionalFormattingModule.isHex(s[o].style.backgroundColor.substr(1))?s[o].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(s[o].style.backgroundColor)),s[o].style&&s[o].style.color&&(s[o].style.color="#"===s[o].style.color.charAt(0)&&this.conditionalFormattingModule.isHex(s[o].style.color.substr(1))?s[o].style.color:this.conditionalFormattingModule.colourNameToHex(s[o].style.color)),e[r][n].style=s[o].style,e[r][n].cssClass="format"+this.element.id+o))}var l=this.dataSourceSettings.conditionalFormatSettings;for(o=0;o<l.length;o++){var d=this.createStyleSheet.bind(this)(),p="color: "+l[o].style.color+"!important;background-color: "+l[o].style.backgroundColor+"!important;font-size: "+l[o].style.fontSize+"!important;font-family: "+l[o].style.fontFamily+" !important;",h=".format"+this.element.id+o;d.insertRule(h+", "+h+" .e-cellvalue{"+p+"}",0)}}},n.prototype.createStyleSheet=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet},n.prototype.applyHyperlinkSettings=function(){if(this.pivotValues){for(var e=this.pivotValues,i=[],a=e.length,r=0;r<a;r++)(0,t.isNullOrUndefined)(e[r])||void 0!==e[r][0]||i.push(r);if(this.hyperlinkSettings.conditionalSettings.length>0)for(r=0;r<e.length;r++)for(var n=1;e[r]&&n<e[r].length;n++)if("value"===e[r][n].axis){e[r][n].enableHyperlink=!1;for(var s=this.hyperlinkSettings.conditionalSettings,o=0;o<s.length;o++)if(this.checkCondition(e[r][n].value,s[o].conditions,s[o].value1,s[o].value2)){var l="row"===this.dataSourceSettings.valueAxis?r:"pivot"===this.dataType?this.engineModule.headerContent.length-1:this.olapEngineModule.headerContent.length-1,d="row"===this.dataSourceSettings.valueAxis?0:n;(!s[o].measure||1===this.dataSourceSettings.values.length||e[l][d].valueSort&&e[l][d].actualText===s[o].measure)&&(!s[o].label||e[i[s[o].label.split(".").length-1]]&&e[i[s[o].label.split(".").length-1]][n]&&e[i[s[o].label.split(".").length-1]][n].valueSort&&e[i[s[o].label.split(".").length-1]][n].valueSort[s[o].label]||e[r][0].valueSort.levelName.indexOf(s[o].label)>-1)&&(e[r][n].enableHyperlink=!0)}}if((0,t.isNullOrUndefined)(this.hyperlinkSettings.headerText))return;var p=this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:".";for(r=0;r<e.length;r++)for(n=1;e[r]&&n<e[r].length;n++)if("value"===e[r][n].axis){var h=this.hyperlinkSettings.headerText;if(e[r][0].valueSort.levelName.indexOf(h)>-1)e[r][0].enableHyperlink=!0,e[r][n].enableHyperlink=!0;else{var u=!1;for(o=0;o<i.length;o++)h=p+this.hyperlinkSettings.headerText,(p+e[i[o]][n].valueSort.levelName).indexOf(h)>-1&&(e[i[o]][n].enableHyperlink=!0,u=!0);e[r][n].enableHyperlink=u}}}},n.prototype.checkCondition=function(e,t,i,a){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<a&&e>=i&&e<=a||i>a&&e<=i&&e>=a;case"NotBetween":return!(i<a&&e>=i&&e<=a||i>a&&e<=i&&e>=a);default:return!1}},n.prototype.updateGroupingReport=function(e,i){if(!this.clonedDataSet&&!this.clonedReport){var a=this.engineModule.data;this.clonedDataSet="CSV"===this.dataSourceSettings.type?r.getClonedCSVData(a):r.getClonedData(a);var n=JSON.parse(this.getPersistData()).dataSourceSettings;n.dataSource=[],this.clonedReport=this.clonedReport?this.clonedReport:n}var s=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,o="CSV"===this.dataSourceSettings.type?r.getClonedCSVData(this.clonedDataSet):r.getClonedData(this.clonedDataSet),l=this.dataSourceSettings,d=this.clonedReport.properties?this.clonedReport.properties:this.clonedReport,p=[l.rows,l.columns,l.values,l.filters],h=[l.filterSettings,l.sortSettings,l.formatSettings,l.drilledMembers],u=d.rows;if(u=u.concat(d.columns,d.values,d.filters),0===e.length||e.length>0){this.engineModule.groupingFields={},this.setProperties({dataSourceSettings:{dataSource:o,groupSettings:e.length>0?l.groupSettings:[]}},!0);for(var c,g="Date"===i,m=[],f=0,S=p.length;f<S;f++)for(var v,y,b=function(e,i){var a=p[f][e].name;-1===m.indexOf(a)&&m.push(a);var n=m.indexOf(a);if(!(0,t.isNullOrUndefined)(a.match(s))&&g||-1!==a.indexOf("_custom_group")&&!r.getFieldByName(a.replace("_custom_group",""),l.groupSettings)){p[f].splice(e,1),m.splice(n,1),e--,i--,a=a.split("_")[0];for(var o=!1,d=0;d<p.length&&!(o=p[d].filter((function(e){return e.name===a})).length>0);d++);if(!o){c=a.split("_")[0];var h=r.getFieldByName(c,u);u=u.filter((function(e){return e.name!==c})),m.push(c),h&&(o?p[f].splice(e,1,h):p[f].splice(++e,0,h))}}else{(h=r.getFieldByName(a,u))?p[f].splice(e,1,h):c===a&&p[f].splice(e,1)}v=e,y=i},C=0,x=p[f].length;C<x;C++)b(C,x),C=v,x=y;for(var w=0,T=m;w<T.length;w++){var M=T[w],D=r.getFilterItemByName(M,d.filterSettings),O=r.getFieldByName(M,d.sortSettings),P=r.getFieldByName(M,d.formatSettings),N=r.getFieldByName(M,d.drilledMembers),E=[D,O,P,N];for(f=0,S=h.length;f<S;f++){var I=!1;for(C=0,x=h[f].length;C<x;C++){var F=h[f][C].name;if(!(0,t.isNullOrUndefined)(F.match(s))&&g||-1!==F.indexOf("_custom_group")&&!r.getFieldByName(F.replace("_custom_group",""),l.groupSettings))h[f].splice(C,1),C--,x--;else if(M===h[f][C].name){I=!0,E[f]?h[f].splice(C,1,E[f]):(h[f].splice(C,1),C--,x--);break}}!I&&0===f&&D&&h[f].push(D),!I&&1===f&&O&&h[f].push(O),!I&&2===f&&P&&h[f].push(P),!I&&3===f&&N&&h[f].push(N)}}}},n.prototype.removeButtonFocus=function(){document.querySelectorAll(".e-btn-focused")&&(0,t.removeClass)(document.querySelectorAll(".e-btn-focused"),"e-btn-focused")},n.prototype.wireEvents=function(){var e=this.virtualScrollSettings&&this.virtualScrollSettings.allowSinglePage&&"pivot"===this.dataType;"Chart"!==this.displayOption.view&&(t.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),t.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),t.EventHandler.add(this.element.querySelector("."+En),"mousemove",this.mouseMoveHandler,this),t.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),t.EventHandler.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this),this.virtualscrollModule&&this.enableVirtualization&&!e&&t.EventHandler.add(this.element.querySelector("."+In).querySelector("."+ba),"scroll",this.headerScrollUpdate,this)),t.EventHandler.add(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0)},n.prototype.headerScrollUpdate=function(){this.element.querySelector("."+bn).scrollLeft!==this.element.querySelector("."+In).querySelector("."+ba).scrollLeft&&(this.virtualscrollModule.direction="horizondal"),this.element.querySelector("."+bn).scrollLeft=this.element.querySelector("."+In).querySelector("."+ba).scrollLeft},n.prototype.unwireEvents=function(){"Chart"!==this.displayOption.view&&(t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),t.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector("."+En)&&t.EventHandler.remove(this.element.querySelector("."+En),"mousemove",this.mouseMoveHandler),t.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler),this.virtualscrollModule&&this.enableVirtualization&&this.element.querySelector("."+In)&&t.EventHandler.remove(this.element.querySelector("."+In).querySelector("."+ba),"scroll",this.headerScrollUpdate)),t.EventHandler.remove(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus),window.removeEventListener("resize",this.onWindowResize.bind(this),!0)},n.prototype.actionBeginMethod=function(){var e={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,cancel:!1};return this.trigger(Ve,e),e.cancel},n.prototype.actionCompleteMethod=function(){var e={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,actionInfo:this.actionObj.actionInfo};this.trigger(Ue,e),this.actionObj.actionName="",this.actionObj.actionInfo=void 0,this.actionObj.fieldInfo=void 0},n.prototype.actionFailureMethod=function(e){var t={actionName:this.actionObj.actionName,errorInfo:e};this.trigger(Be,t)},n.prototype.getActionCompleteName=function(){var e;switch(this.actionObj.actionName){case gt:e=Si;break;case mt:e=vi;break;case vt:e=yi;break;case yt:e=bi;break;case Pt:e=Ci;break;case Nt:e=xi;break;case Et:e=wi;break;case It:e=Ti;break;case Ft:e=Mi;break;case Lt:e=Di;break;case At:e=Oi;break;case Rt:e=Pi;break;case nt:e=Ni;break;case Gt:e=ei;break;case Vt:e=Ei;break;case Ut:e=Ii;break;case Bt:e=Fi;break;case _t:e=Li;break;case Kt:e=Ai;break;case zt:e=Ri;break;case qt:e=ki;break;case Wt:e=ti;break;case Qt:e=ii;break;case Yt:e=ai;break;case wt:e=gi;break;case Dt:e=mi;break;case Ot:e=fi;break;case xt:e=ci;break;case Mt:e=ui;break;case Tt:e=hi;break;case Jt:e=ji;break;case dt:e=si;break;case lt:e=oi;break;case pt:e=li;break;case ht:e=di;break;case Qe:e=Ui;break;case We:e=Vi;break;case Zt:e=Bi;break;case $t:e=_i;break;default:e=this.actionObj.actionName}return e},n.prototype.getStackedColumns=function(e,t){for(var i=0,a=e;i<a.length;i++){var r=a[i];t.push(r),r.columns&&r.columns.length>0&&this.getStackedColumns(r.columns,t)}return t},n.prototype.destroy=function(){this.removeInternalEvents(),this.engineModule&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=[],this.engineModule={}),this.olapEngineModule&&(this.olapEngineModule.fieldList={},this.olapEngineModule={}),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.allowGrouping&&this.groupingModule&&this.groupingModule.destroy(),this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy(),this.enablePaging&&this.pagerModule&&this.pagerModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy(),this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.tooltip&&!this.tooltip.isDestroyed&&this.tooltip.destroy(),this.calculatedFieldModule&&this.calculatedFieldModule.destroy(),this.chart&&!this.chart.isDestroyed&&(this.chart.destroy(),this.chart.isDestroyed&&(0,t.select)("#"+this.element.id+"_chart",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_chart",this.element))),this.grid&&!this.grid.isDestroyed&&(this.grid.destroy(),this.grid.isDestroyed&&(0,t.select)("#"+this.element.id+"_grid",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_grid",this.element))),this.commonModule&&this.commonModule.destroy(),this.pivotChartModule&&this.pivotChartModule.destroy(),this.pivotButtonModule&&!this.pivotButtonModule.isDestroyed&&this.pivotButtonModule.destroy(),this.pivotFieldListModule&&!this.pivotFieldListModule.isDestroyed&&(this.pivotFieldListModule.destroy(),this.pivotFieldListModule.isDestroyed&&null!==(0,t.select)("#"+this.element.id+"_PivotFieldList",this.element)&&(0,t.remove)((0,t.select)("#"+this.element.id+"_PivotFieldList",this.element))),(this.allowDrillThrough||this.editSettings&&this.editSettings.allowEditing)&&this.drillThroughModule&&this.drillThroughModule.destroy(),this.chartExportModule&&this.chartExportModule.destroy(),this.unwireEvents(),e.prototype.destroy.call(this),this.groupingBarModule&&(this.groupingBarModule=null),this.groupingModule&&(this.groupingModule=null),this.pivotFieldListModule&&(this.pivotFieldListModule=null),this.calculatedFieldModule&&(this.calculatedFieldModule=null),this.conditionalFormattingModule&&(this.conditionalFormattingModule=null),this.numberFormattingModule&&(this.numberFormattingModule=null),this.toolbarModule&&(this.toolbarModule=null),this.pagerModule&&(this.pagerModule=null),this.virtualscrollModule&&(this.virtualscrollModule=null),this.contextMenuModule&&(this.contextMenuModule=null),this.keyboardModule&&(this.keyboardModule=null),this.tooltip&&(this.tooltip=null),this.chart&&(this.chart=null),this.grid&&(this.grid=null),this.commonModule&&(this.commonModule=null),this.pivotChartModule&&(this.pivotChartModule=null),this.pivotButtonModule&&(this.pivotButtonModule=null),this.renderModule&&(this.renderModule=null),this.axisFieldModule&&(this.axisFieldModule=null),this.pdfExportModule&&(this.pdfExportModule=null),this.excelExportModule&&(this.excelExportModule=null),this.drillThroughModule&&(this.drillThroughModule=null),this.clonedDataSet&&(this.clonedDataSet=null),this.clonedReport&&(this.clonedReport=null),this.pagerModule&&(this.pagerModule=null),this.chartExportModule&&(this.chartExportModule=null),this.exportSpecifiedPages&&(this.exportSpecifiedPages=void 0),this.element.innerHTML="",(0,t.removeClass)([this.element],zi),(0,t.removeClass)([this.element],Wi),(0,t.removeClass)([this.element],Qi),this.globalize=null,this.localeObj=null,this.currentView=null,this.fieldListSpinnerElement=null,this.lastSortInfo=null,this.lastFilterInfo=null,this.lastAggregationInfo=null,this.lastCalcFieldInfo=null,this.lastCellClicked=null,this.lastColumn=null,this.pivotCommon=null},n.prototype.showNumberFormattingDialog=function(){this.allowNumberFormatting&&this.numberFormattingModule.showNumberFormattingDialog()},n.prototype.getValuesHeader=function(e,i){var a=this.dataSourceSettings.values;return"value"===i&&!(0,t.isNullOrUndefined)(e.valueSort)&&this.localeObj.getConstant("grandTotal")+this.dataSourceSettings.valueSortSettings.headerDelimiter+e.formattedText===e.valueSort.levelName&&("column"===e.axis&&0===this.dataSourceSettings.columns.length&&"column"===this.dataSourceSettings.valueAxis||"row"===e.axis&&0===this.dataSourceSettings.rows.length&&"row"===this.dataSourceSettings.valueAxis)?this.localeObj.getConstant("total")+" "+this.localeObj.getConstant(this.engineModule.fieldList[e.actualText].aggregateType)+" "+this.localeObj.getConstant("of")+" "+e.formattedText:"grandTotal"===i&&1===a.length&&"row"===this.dataSourceSettings.valueAxis&&e.formattedText===this.localeObj.getConstant("grandTotal")?this.localeObj.getConstant("total")+" "+this.localeObj.getConstant(a[a.length-1].type)+" "+this.localeObj.getConstant("of")+" "+((0,t.isNullOrUndefined)(a[a.length-1].caption)?a[a.length-1].name:a[a.length-1].caption):e.formattedText},Ko([(0,t.Property)("USD")],n.prototype,"currencyCode",void 0),Ko([(0,t.Property)(!1)],n.prototype,"showFieldList",void 0),Ko([(0,t.Complex)({},_s)],n.prototype,"gridSettings",void 0),Ko([(0,t.Complex)({},Uo)],n.prototype,"chartSettings",void 0),Ko([(0,t.Complex)({},Xo)],n.prototype,"groupingBarSettings",void 0),Ko([(0,t.Complex)({},$o)],n.prototype,"hyperlinkSettings",void 0),Ko([(0,t.Complex)({},el)],n.prototype,"pageSettings",void 0),Ko([(0,t.Complex)({},tl)],n.prototype,"pagerSettings",void 0),Ko([(0,t.Complex)({},Vs)],n.prototype,"dataSourceSettings",void 0),Ko([(0,t.Complex)({},Jo)],n.prototype,"editSettings",void 0),Ko([(0,t.Complex)({},il)],n.prototype,"displayOption",void 0),Ko([(0,t.Complex)({},al)],n.prototype,"virtualScrollSettings",void 0),Ko([(0,t.Property)()],n.prototype,"pivotValues",void 0),Ko([(0,t.Property)(!1)],n.prototype,"showGroupingBar",void 0),Ko([(0,t.Property)(!0)],n.prototype,"showTooltip",void 0),Ko([(0,t.Property)(!1)],n.prototype,"showToolbar",void 0),Ko([(0,t.Property)([])],n.prototype,"toolbar",void 0),Ko([(0,t.Property)(!1)],n.prototype,"showValuesButton",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowCalculatedField",void 0),Ko([(0,t.Property)(!1)],n.prototype,"enableFieldSearching",void 0),Ko([(0,t.Property)(!1)],n.prototype,"enableValueSorting",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowConditionalFormatting",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowNumberFormatting",void 0),Ko([(0,t.Property)("auto")],n.prototype,"height",void 0),Ko([(0,t.Property)("auto")],n.prototype,"width",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowExcelExport",void 0),Ko([(0,t.Property)(!1)],n.prototype,"enableVirtualization",void 0),Ko([(0,t.Property)(!1)],n.prototype,"enablePaging",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowDrillThrough",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowPdfExport",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowDeferLayoutUpdate",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowDataCompression",void 0),Ko([(0,t.Property)(1e3)],n.prototype,"maxNodeLimitInMemberEditor",void 0),Ko([(0,t.Property)(1e4)],n.prototype,"maxRowsInDrillThrough",void 0),Ko([(0,t.Property)(!0)],n.prototype,"loadOnDemandInMemberEditor",void 0),Ko([(0,t.Property)(!1)],n.prototype,"enableHtmlSanitizer",void 0),Ko([(0,t.Property)()],n.prototype,"cellTemplate",void 0),Ko([(0,t.Property)()],n.prototype,"toolbarTemplate",void 0),Ko([(0,t.Property)()],n.prototype,"tooltipTemplate",void 0),Ko([(0,t.Property)()],n.prototype,"spinnerTemplate",void 0),Ko([(0,t.Property)(!1)],n.prototype,"allowGrouping",void 0),Ko([(0,t.Property)(!0)],n.prototype,"exportAllPages",void 0),Ko([(0,t.Property)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],n.prototype,"aggregateTypes",void 0),Ko([(0,t.Property)(["Column","Bar","Line","Area","Scatter","Polar","StackingColumn","StackingArea","StackingBar","StackingLine","StepLine","StepArea","SplineArea","Spline","StackingColumn100","StackingBar100","StackingArea100","StackingLine100","Bubble","Pareto","Radar","Pie","Doughnut","Funnel","Pyramid"])],n.prototype,"chartTypes",void 0),Ko([(0,t.Property)("")],n.prototype,"cssClass",void 0),Ko([(0,t.Event)()],n.prototype,"queryCellInfo",void 0),Ko([(0,t.Event)()],n.prototype,"headerCellInfo",void 0),Ko([(0,t.Event)()],n.prototype,"resizing",void 0),Ko([(0,t.Event)()],n.prototype,"resizeStop",void 0),Ko([(0,t.Event)()],n.prototype,"pdfHeaderQueryCellInfo",void 0),Ko([(0,t.Event)()],n.prototype,"pdfQueryCellInfo",void 0),Ko([(0,t.Event)()],n.prototype,"excelHeaderQueryCellInfo",void 0),Ko([(0,t.Event)()],n.prototype,"excelQueryCellInfo",void 0),Ko([(0,t.Event)()],n.prototype,"columnDragStart",void 0),Ko([(0,t.Event)()],n.prototype,"columnDrag",void 0),Ko([(0,t.Event)()],n.prototype,"columnDrop",void 0),Ko([(0,t.Event)()],n.prototype,"beforePdfExport",void 0),Ko([(0,t.Event)()],n.prototype,"beforeExcelExport",void 0),Ko([(0,t.Event)()],n.prototype,"beforeColumnsRender",void 0),Ko([(0,t.Event)()],n.prototype,"selected",void 0),Ko([(0,t.Event)()],n.prototype,"cellDeselected",void 0),Ko([(0,t.Event)()],n.prototype,"rowSelected",void 0),Ko([(0,t.Event)()],n.prototype,"rowDeselected",void 0),Ko([(0,t.Event)()],n.prototype,"chartTooltipRender",void 0),Ko([(0,t.Event)()],n.prototype,"chartLegendClick",void 0),Ko([(0,t.Event)()],n.prototype,"beforePrint",void 0),Ko([(0,t.Event)()],n.prototype,"animationComplete",void 0),Ko([(0,t.Event)()],n.prototype,"legendRender",void 0),Ko([(0,t.Event)()],n.prototype,"textRender",void 0),Ko([(0,t.Event)()],n.prototype,"pointRender",void 0),Ko([(0,t.Event)()],n.prototype,"seriesRender",void 0),Ko([(0,t.Event)()],n.prototype,"chartMouseMove",void 0),Ko([(0,t.Event)()],n.prototype,"chartMouseClick",void 0),Ko([(0,t.Event)()],n.prototype,"pointMove",void 0),Ko([(0,t.Event)()],n.prototype,"chartMouseLeave",void 0),Ko([(0,t.Event)()],n.prototype,"chartMouseDown",void 0),Ko([(0,t.Event)()],n.prototype,"chartMouseUp",void 0),Ko([(0,t.Event)()],n.prototype,"dragComplete",void 0),Ko([(0,t.Event)()],n.prototype,"zoomComplete",void 0),Ko([(0,t.Event)()],n.prototype,"scrollStart",void 0),Ko([(0,t.Event)()],n.prototype,"scrollEnd",void 0),Ko([(0,t.Event)()],n.prototype,"scrollChanged",void 0),Ko([(0,t.Event)()],n.prototype,"multiLevelLabelRender",void 0),Ko([(0,t.Event)()],n.prototype,"chartLoaded",void 0),Ko([(0,t.Event)()],n.prototype,"chartLoad",void 0),Ko([(0,t.Event)()],n.prototype,"chartResized",void 0),Ko([(0,t.Event)()],n.prototype,"chartAxisLabelRender",void 0),Ko([(0,t.Event)()],n.prototype,"multiLevelLabelClick",void 0),Ko([(0,t.Event)()],n.prototype,"chartPointClick",void 0),Ko([(0,t.Event)()],n.prototype,"contextMenuClick",void 0),Ko([(0,t.Event)()],n.prototype,"contextMenuOpen",void 0),Ko([(0,t.Event)()],n.prototype,"onPdfCellRender",void 0),Ko([(0,t.Event)()],n.prototype,"saveReport",void 0),Ko([(0,t.Event)()],n.prototype,"fetchReport",void 0),Ko([(0,t.Event)()],n.prototype,"loadReport",void 0),Ko([(0,t.Event)()],n.prototype,"renameReport",void 0),Ko([(0,t.Event)()],n.prototype,"removeReport",void 0),Ko([(0,t.Event)()],n.prototype,"newReport",void 0),Ko([(0,t.Event)()],n.prototype,"toolbarRender",void 0),Ko([(0,t.Event)()],n.prototype,"toolbarClick",void 0),Ko([(0,t.Event)()],n.prototype,"load",void 0),Ko([(0,t.Event)()],n.prototype,"enginePopulating",void 0),Ko([(0,t.Event)()],n.prototype,"enginePopulated",void 0),Ko([(0,t.Event)()],n.prototype,"onFieldDropped",void 0),Ko([(0,t.Event)()],n.prototype,"fieldDrop",void 0),Ko([(0,t.Event)()],n.prototype,"fieldDragStart",void 0),Ko([(0,t.Event)()],n.prototype,"dataBound",void 0),Ko([(0,t.Event)()],n.prototype,"created",void 0),Ko([(0,t.Event)()],n.prototype,"destroyed",void 0),Ko([(0,t.Event)()],n.prototype,"beforeExport",void 0),Ko([(0,t.Event)()],n.prototype,"exportComplete",void 0),Ko([(0,t.Event)()],n.prototype,"conditionalFormatting",void 0),Ko([(0,t.Event)()],n.prototype,"memberFiltering",void 0),Ko([(0,t.Event)()],n.prototype,"cellClick",void 0),Ko([(0,t.Event)()],n.prototype,"drillThrough",void 0),Ko([(0,t.Event)()],n.prototype,"editCompleted",void 0),Ko([(0,t.Event)()],n.prototype,"beginDrillThrough",void 0),Ko([(0,t.Event)()],n.prototype,"hyperlinkCellClick",void 0),Ko([(0,t.Event)()],n.prototype,"cellSelecting",void 0),Ko([(0,t.Event)()],n.prototype,"drill",void 0),Ko([(0,t.Event)()],n.prototype,"cellSelected",void 0),Ko([(0,t.Event)()],n.prototype,"chartSeriesCreated",void 0),Ko([(0,t.Event)()],n.prototype,"aggregateCellInfo",void 0),Ko([(0,t.Event)()],n.prototype,"fieldListRefreshed",void 0),Ko([(0,t.Event)()],n.prototype,"memberEditorOpen",void 0),Ko([(0,t.Event)()],n.prototype,"calculatedFieldCreate",void 0),Ko([(0,t.Event)()],n.prototype,"numberFormatting",void 0),Ko([(0,t.Event)()],n.prototype,"aggregateMenuOpen",void 0),Ko([(0,t.Event)()],n.prototype,"fieldRemove",void 0),Ko([(0,t.Event)()],n.prototype,"beforeServiceInvoke",void 0),Ko([(0,t.Event)()],n.prototype,"afterServiceInvoke",void 0),Ko([(0,t.Event)()],n.prototype,"actionBegin",void 0),Ko([(0,t.Event)()],n.prototype,"actionComplete",void 0),Ko([(0,t.Event)()],n.prototype,"actionFailure",void 0),Ko([(0,t.Event)()],n.prototype,"onHeadersSort",void 0),n=Ko([t.NotifyPropertyChanges],n)}(t.Component),nl=S(437),sl=function(){function e(){}return e.getClonedPivotValues=function(e){for(var t=[],i=0;i<e.length;i++)if(e[i]){t[i]=[];for(var a=0;a<e[i].length;a++)e[i][a]&&(t[i][a]=this.getClonedPivotValueObj(e[i][a]))}return t},e.getClonedPivotValueObj=function(e){var t=0,i={};if(null!=e)for(var a=Object.keys(e);t<a.length;)i[a[t]]=e[a[t]],t++;else i=e;return i},e.isContainCommonElements=function(e,t){for(var i=0,a=e.length;i<a;i++)for(var r=0,n=t.length;r<n;r++)if(t[r]===e[i])return!0;return!1},e}(),ol=function(){function e(e){this.actualrCnt=0,this.parent=e}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.addHeaderAndFooter=function(e,i,a,r){var n=[];if((0,t.isNullOrUndefined)(e.rows))""!==i&&("footer"===a&&this.actualrCnt++,n.push({index:1,value:i}),this.rows.push({index:this.actualrCnt+1,cells:n}),this.actualrCnt="header"===a?this.actualrCnt+2:this.actualrCnt);else{this.actualrCnt="footer"===a?this.actualrCnt+r-e.rows[0].cells.length:this.actualrCnt;for(var s=e.rows,o=0;o<s.length;o++){var l=0;n=[];for(var d=s[o],p=0;p<d.cells.length;p++)n.push({index:l+1,value:d.cells[p].value,colSpan:d.cells[p].colSpan,rowSpan:d.cells[p].rowSpan,style:d.cells[p].style}),l+=n[p].colSpan;this.actualrCnt++,this.rows.push({index:this.actualrCnt,cells:n})}this.actualrCnt="header"===a?r:this.actualrCnt}},e.prototype.exportToExcel=function(e,i,a){this.rows=[],this.actualrCnt=0;var r,n=!(0,t.isNullOrUndefined)(i)&&!(0,t.isNullOrUndefined)(i.header),s=!(0,t.isNullOrUndefined)(i)&&!(0,t.isNullOrUndefined)(i.footer),o=!(0,t.isNullOrUndefined)(i)&&!(0,t.isNullOrUndefined)(i.fileName);this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;var l=sl.getClonedPivotValues(this.engine.pivotValues),d=o?i.fileName:"CSV"===e?"default.csv":"default.xlsx";if(this.parent.exportAllPages&&(this.parent.enableVirtualization||this.parent.enablePaging)){var p=this.engine.pageSettings,h=void 0;this.engine.isPagingOrVirtualizationEnabled=!1,"olap"===this.parent.dataType?(this.updateOlapPageSettings(!0),h=this.parent.olapEngineModule.mdxQuery.slice(0)):this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings,!0,!0),this.parent.applyFormatting(this.engine.pivotValues),r=sl.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=l,this.engine.pageSettings=p,this.engine.isPagingOrVirtualizationEnabled=!0,"olap"===this.parent.dataType&&(this.updateOlapPageSettings(!1),this.parent.olapEngineModule.mdxQuery=h)}else r=l;var u,c,g,S,v={fileName:d,header:"",footer:"",dataCollections:[r],excelExportProperties:i};this.parent.trigger(m,v,(function(e){u=e.fileName,c=e.header,g=e.footer,S=e.dataCollections})),!n&&(0,t.isNullOrUndefined)(v.excelExportProperties)&&""!==c?this.addHeaderAndFooter({},c,"header",void 0):(0,t.isNullOrUndefined)(v.excelExportProperties)||(0,t.isNullOrUndefined)(v.excelExportProperties.header)||this.addHeaderAndFooter(v.excelExportProperties.header,"","header",v.excelExportProperties.header.headerRows);for(var b=[],x=0;x<S.length;x++){for(var w=S[x],T=0,M=w.length,D=this.parent.renderModule.getFormatList(),O=0,P=0;P<M;P++)if(w[P]){this.actualrCnt++,T=w[P].length;for(var N=[],E=0;E<T;E++)if(w[P][E]){(z=w[P][E])&&"value"===z.axis&&""===z.formattedText&&(z.value=Number(z.formattedText));var I="row"===this.parent.dataSourceSettings.valueAxis&&"olap"===this.parent.dataType&&z.rowOrdinal&&this.engine.tupRowInfo[z.rowOrdinal]?this.engine.tupRowInfo[z.rowOrdinal].measureName:z.actualText,F="row"===z.axis?{hAlign:"Left",bold:!0,wrapText:!0}:{numberFormat:D[I],bold:!1,wrapText:!0},L={bold:!0,vAlign:"Center",wrapText:!0,indent:0===E?10*z.level:0};if(-1!==z.level||z.rowSpan){var A=this.engine.aggregatedValueMatrix,R="value"===z.axis?A[P]&&A[P][E]?A[P][E]:"#DIV/0!"===z.formattedText?z.formattedText:z.value:z.formattedText,k=0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis||0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis;if(R="grand sum"!==z.type||1===this.parent.dataSourceSettings.values.length&&"row"===this.parent.dataSourceSettings.valueAxis&&"column"===z.axis?"sum"===z.type?R.toString().replace("Total",this.parent.localeObj.getConstant("total")):!(0,t.isNullOrUndefined)(z.valueSort)&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+z.formattedText===z.valueSort.levelName&&k?this.parent.getValuesHeader(z,"value"):R:k?this.parent.getValuesHeader(z,"grandTotal"):this.parent.localeObj.getConstant("grandTotal"),-1!==z.level||z.rowSpan){N.push({index:E+1,value:R,colSpan:z.colSpan,rowSpan:-1===z.rowSpan?1:z.rowSpan});var j=N[N.length-1];if("value"===z.axis)(isNaN(z.value)||""===z.formattedText||void 0===z.formattedText||(0,t.isNullOrUndefined)(z.value))&&(j.value="Excel"===e?null:""),F.numberFormat="string"==typeof R?void 0:F.numberFormat,j.style=(0,t.isNullOrUndefined)(j.value)?{bold:!1,wrapText:!0}:F;else if(j.style=L,"row"===z.axis&&0===E)if(j.style=F,"olap"===this.parent.dataType){var q=this.parent.renderModule.indentCollection[P];j.style.indent=2*q,O=O>q?O:q}else{var H=z.valueSort?z.valueSort.levelName.toString():"",V=z.actualText?z.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,U=H.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(V?V-1:V),B=U?U-1:0;j.style.indent=2*B,O=B>O?B:O}(z.style||j.style.backColor||j.style.fontColor||j.style.fontName||j.style.fontSize)&&(j.style.backColor=j.style.backColor?j.style.backColor:z.style.backgroundColor,j.style.fontColor=j.style.fontColor?j.style.fontColor:z.style.color,j.style.fontName=j.style.fontName?j.style.fontName:z.style.fontFamily,(0,t.isNullOrUndefined)(j.style.fontSize)&&(0,t.isNullOrUndefined)(z.style.fontSize)||(j.style.fontSize=(0,t.isNullOrUndefined)(j.style.fontSize)?Number(z.style.fontSize.split("px")[0]):Number(j.style.fontSize))),j.style.borders={color:"#000000",lineStyle:"thin"};var _=void 0,G=void 0;"column"===z.axis?(_={style:L,cell:z},this.parent.trigger(y,_)):(G={style:F,cell:z,column:void 0,data:w,value:R},this.parent.trigger(C,G)),j.value="column"===z.axis?_.cell.formattedText:G.value,j.style="column"===z.axis?_.style:G.style}}E+=z.colSpan?z.colSpan-1:0}else{var z;_=void 0;(z={formattedText:""})&&(_={style:void 0,cell:z},this.parent.trigger(y,_)),N.push({index:E+1,colSpan:1,rowSpan:1,value:z.formattedText,style:_.style})}this.rows.push({index:this.actualrCnt,cells:N})}s?this.addHeaderAndFooter(i.footer,"","footer",i.footer.footerRows):!s&&""!==g&&(0,t.isNullOrUndefined)(v.excelExportProperties)?this.addHeaderAndFooter({},g,"footer",void 0):(0,t.isNullOrUndefined)(v.excelExportProperties)||(0,t.isNullOrUndefined)(v.excelExportProperties.footer)||this.addHeaderAndFooter(v.excelExportProperties.footer,"","footer",v.excelExportProperties.footer.footerRows);var W=[];for(E=0;E<T;E++)W.push({index:E+1,width:100});O>0&&(W[0].width=100+20*O),b.push({columns:W,rows:this.rows})}var Q,Y=new nl.Workbook({worksheets:b},"Excel"===e?"xlsx":"csv",void 0,this.parent.currencyCode),K=u.split(".").pop();a?Q=Y.saveAsBlob("xlsx"===K||"Excel"===e?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv"):Y.save("xlsx"===K||"csv"===K?u:u+("Excel"===e?".xlsx":".csv"));var X={type:e,promise:a?Q:null};this.parent.trigger(f,X)},e.prototype.updateOlapPageSettings=function(e){this.parent.olapEngineModule.isExporting=!!e,this.parent.exportSpecifiedPages?this.parent.olapEngineModule.exportSpeciedPages=this.parent.exportSpecifiedPages=e?this.parent.exportSpecifiedPages:void 0:(this.parent.olapEngineModule.pageSettings=e?null:this.parent.olapEngineModule.pageSettings,this.parent.olapEngineModule.isPaging=!e)},e.prototype.destroy=function(){this.engine&&(this.engine=null)},e}(),ll=function(){function e(e){this.parent=e,this.pdfExportHelper=new zo}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.addPage=function(e,i){i=i||this.exportProperties.pdfExportProperties;var n=e.document.sections.add(),s=e.document.pageSettings.height,o=e.document.pageSettings.width;if(this.exportProperties.width||this.exportProperties.height?(e.document.pageSettings.orientation=this.exportProperties.width>this.exportProperties.height||!this.exportProperties.height&&this.exportProperties.width>s||!this.exportProperties.width&&o>this.exportProperties.height?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,e.document.pageSettings.size=new a.SizeF(this.exportProperties.width?this.exportProperties.width:o,this.exportProperties.height?this.exportProperties.height:s)):(e.document.pageSettings.orientation=0===this.exportProperties.orientation||this.exportProperties.orientation?this.exportProperties.orientation:(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.pageOrientation)||"Landscape"===i.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.pageSize)||(e.document.pageSettings.size=r.getPageSize(i.pageSize))),!(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins)){var l=e.document.pageSettings.margins;l.top=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.top)?l.top:this.exportProperties.pdfMargins.top,l.bottom=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.bottom)?l.bottom:this.exportProperties.pdfMargins.bottom,l.left=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.left)?l.left:this.exportProperties.pdfMargins.left,l.right=(0,t.isNullOrUndefined)(this.exportProperties.pdfMargins.right)?l.right:this.exportProperties.pdfMargins.right}n.setPageSettings(e.document.pageSettings);var d=n.pages.add();return(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.header)||this.pdfExportHelper.drawHeader(i,e.document),(0,t.isNullOrUndefined)(i)||(0,t.isNullOrUndefined)(i.footer)||this.pdfExportHelper.drawFooter(i,e.document),d},e.prototype.getFontStyle=function(e){var i=a.PdfFontStyle.Regular;return!(0,t.isNullOrUndefined)(e)&&e.bold&&(i|=a.PdfFontStyle.Bold),!(0,t.isNullOrUndefined)(e)&&e.italic&&(i|=a.PdfFontStyle.Italic),!(0,t.isNullOrUndefined)(e)&&e.underline&&(i|=a.PdfFontStyle.Underline),!(0,t.isNullOrUndefined)(e)&&e.strikeout&&(i|=a.PdfFontStyle.Strikeout),i},e.prototype.getBorderStyle=function(e){var i=new a.PdfBorders;if((0,t.isNullOrUndefined)(e)){var r=new a.PdfColor(234,234,234);i.all=new a.PdfPen(r)}else{var n=e.width,s=(0,t.isNullOrUndefined)(n)||"number"!=typeof n?void 0:.75*n,o=new a.PdfColor(196,196,196);if(!(0,t.isNullOrUndefined)(e.color)){var l=this.pdfExportHelper.hexDecToRgb(e.color);o=new a.PdfColor(l.r,l.g,l.b)}var d=new a.PdfPen(o,s);(0,t.isNullOrUndefined)(e.dashStyle)||(d.dashStyle=this.pdfExportHelper.getDashStyle(e.dashStyle)),i.all=d}return i},e.prototype.getStyle=function(){var e=new a.PdfBorders;if((0,t.isNullOrUndefined)(this.gridStyle))return{brush:new a.PdfSolidBrush(new a.PdfColor),border:e,font:void 0};var i=(0,t.isNullOrUndefined)(this.gridStyle.header.fontName)?a.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.header.fontName),r=this.getFontStyle(this.gridStyle.header),n=(0,t.isNullOrUndefined)(this.gridStyle.header.fontSize)?10.5:this.gridStyle.header.fontSize,s=new a.PdfColor;if(!(0,t.isNullOrUndefined)(this.gridStyle.header.fontColor)){var o=this.pdfExportHelper.hexDecToRgb(this.gridStyle.header.fontColor);s=new a.PdfColor(o.r,o.g,o.b)}var l=new a.PdfStandardFont(i,n,r);return(0,t.isNullOrUndefined)(this.gridStyle.header.font)||(l=this.gridStyle.header.font),{border:this.getBorderStyle(this.gridStyle.header.border),font:l,brush:new a.PdfSolidBrush(s)}},e.prototype.setRecordThemeStyle=function(e,i){if(!(0,t.isNullOrUndefined)(this.gridStyle)&&!(0,t.isNullOrUndefined)(this.gridStyle.record)){var r=(0,t.isNullOrUndefined)(this.gridStyle.record.fontName)?a.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.record.fontName),n=(0,t.isNullOrUndefined)(this.gridStyle.record.fontSize)?9.75:this.gridStyle.record.fontSize,s=this.getFontStyle(this.gridStyle.record),o=new a.PdfStandardFont(r,n,s);(0,t.isNullOrUndefined)(this.gridStyle.record.font)||(o=this.gridStyle.record.font),e.style.setFont(o);var l=new a.PdfColor;if(!(0,t.isNullOrUndefined)(this.gridStyle.record.fontColor)){var d=this.pdfExportHelper.hexDecToRgb(this.gridStyle.record.fontColor);l=new a.PdfColor(d.r,d.g,d.b)}e.style.setTextBrush(new a.PdfSolidBrush(l))}var p=this.gridStyle&&this.gridStyle.record&&this.gridStyle.record.border?this.getBorderStyle(this.gridStyle.record.border):i;return e.style.setBorder(p),e},e.prototype.exportToPDF=function(e,i,r,n){var s=this;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridStyle=(0,t.isNullOrUndefined)(this.exportProperties.pdfExportProperties)?void 0:this.exportProperties.pdfExportProperties.theme;var o=this.applyEvent();(0,t.isNullOrUndefined)(r)||(o.document=r);var l=this.getStyle(),d=(0,t.isNullOrUndefined)(this.exportProperties)||(0,t.isNullOrUndefined)(this.exportProperties.fileName)?(0,t.isNullOrUndefined)(e)||(0,t.isNullOrUndefined)(e.fileName)?"default":e.fileName:this.exportProperties.fileName,p=100+20*(this.parent.renderModule.maxIndent?this.parent.renderModule.maxIndent:5),h=Math.floor((540-p)/90)+1,u=0,c=o.args.pivotValues[u];(this.exportProperties.columnSize||this.exportProperties.width||this.exportProperties.height)&&(h=this.exportProperties.columnSize>0?this.exportProperties.columnSize:c[0].length),this.exportProperties.allowRepeatHeader=!0===this.exportProperties.allowRepeatHeader||(0,t.isNullOrUndefined)(this.exportProperties.allowRepeatHeader);for(var g=!!this.exportProperties.allowRepeatHeader&&this.exportProperties.allowRepeatHeader,m=0;g&&h>1&&m<c.length;m++)for(var S=h;c[m]&&S<c[m].length;S+=h)c[m].splice(S,0,c[m][0]);var v=c&&c.length>0?c[0].length:0,y=0;do{(0,t.isNullOrUndefined)(e)||(this.exportProperties.header=(0,t.isNullOrUndefined)(e.header)||(0,t.isNullOrUndefined)(e.header.contents)||(0,t.isNullOrUndefined)(e.header.contents[0].value)?this.exportProperties.header:e.header.contents[0].value,this.exportProperties.footer=(0,t.isNullOrUndefined)(e.footer)||(0,t.isNullOrUndefined)(e.footer.contents)||(0,t.isNullOrUndefined)(e.footer.contents[0].value)?this.exportProperties.footer:e.footer.contents[0].value);var C=this.addPage(o,e),T=new a.PdfGrid,M=h>0?h:5;if(c&&c.length>0){T.columns.add(c[0].length-y>=M?M:c[0].length-y);for(var D=c.length,O=0,P=0,N=0,E=0;E<D;E++)if(c[E]){var I=!(c[E][0]&&"row"===c[E][0].axis),F=c[E].length>y+M?y+M:c[E].length;I&&T.headers.add(1);var L=I?T.headers.getHeader(O):T.rows.addRow();I?(L.style.setBorder(l.border),l.font&&L.style.setFont(l.font),L.style.setTextBrush(l.brush)):this.setRecordThemeStyle(L,l.border);for(var A=0,R=!0,k=y;k<F;k++){var j=!1;if(c[E][k]){var q=(V=c[E][k]).formattedText;q=0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length?this.parent.getValuesHeader(V,"value"):q,q="grand sum"===V.type?0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length?this.parent.getValuesHeader(V,"grandTotal"):this.parent.localeObj.getConstant("grandTotal"):"sum"===V.type?q.toString().replace("Total",this.parent.localeObj.getConstant("total")):q,(-1!==V.level||V.rowSpan)&&((-1!==V.level||V.rowSpan)&&(L.cells.getCell(A).columnSpan=V.colSpan?M-A<V.colSpan?M-A:V.colSpan:1,I&&V.rowSpan&&V.rowSpan>1&&(L.cells.getCell(A).rowSpan=V.rowSpan?V.rowSpan:1),L.cells.getCell(A).value=q?q.toString():""),""!==q&&(R=!1)),P=V.level>P?V.level:P,j="value"===V.axis,k+=L.cells.getCell(A).columnSpan?L.cells.getCell(A).columnSpan-1:0,A+=L.cells.getCell(A).columnSpan?L.cells.getCell(A).columnSpan-1:0,V.style&&(L=this.applyStyle(L,V,A));var H={style:void 0,pivotCell:V,cell:L.cells.getCell(A),column:T.columns.getColumn(A)};this.parent.trigger(w,H),"column"===V.axis?(H={style:H.style,cell:H.cell,gridCell:H.pivotCell},this.parent.trigger(b,H),L.cells.getCell(A).value=H.gridCell.formattedText?H.gridCell.formattedText:q):(H={style:H.style,cell:H.cell,column:void 0,data:H.pivotCell,value:q},this.parent.trigger(x,H),L.cells.getCell(A).value=H.value?H.value:q),H.style&&this.processCellStyle(L.cells.getCell(A),H)}else{var V;H={style:void 0,pivotCell:void 0,cell:L.cells.getCell(A),column:T.columns.getColumn(A)};this.parent.trigger(w,H),N=H.column.width,"column"===(V={formattedText:""}).axis&&(H={style:H.style,cell:H.cell,gridCell:H.pivotCell},this.parent.trigger(b,H)),H.style&&this.processCellStyle(L.cells.getCell(A),H),L.cells.getCell(A).value="",(0===k&&I&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0||0!==k&&I&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&T.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.engine.headerContent).length)&&T.headers.getHeader(0).cells.getCell(0).rowSpan++}var U=new a.PdfStringFormat;if("olap"===this.parent.dataType){var B=!I&&0===A&&c[E][k]?this.parent.renderModule.indentCollection[c[E][k].rowIndex]:0;U.paragraphIndent=15*B,P=P>B?P:B}else if(U.paragraphIndent=0,!I&&0===A&&c[E][k]&&-1!==c[E][k].level){var _=c[E][k],G=_.valueSort?_.valueSort.levelName.toString():"",z=_.actualText?_.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,W=G.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(z?z-1:z),Q=W?W-1:0;U.paragraphIndent=10*Q}U.alignment=j?a.PdfTextAlignment.Right:a.PdfTextAlignment.Left,U.lineAlignment=a.PdfVerticalAlignment.Middle,L.cells.getCell(A).style.stringFormat=U,A++}R&&(L.height=16),O++}T.columns.getColumn(0).width=N>0?N:100+20*P}0===y&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&T.headers.getHeader(0).cells.getCell(0).rowSpan--,T.draw(C,new a.PointF(10,20)),(y+=M)>=v&&o.args.pivotValues.length>u+1&&(u++,v=(c=o.args.pivotValues[u])&&c.length>0?c[0].length:0,y=0)}while(y<v);return new Promise((function(e){var t;n||i?n&&(t=o.document.save()):(o.document.save(d+".pdf"),o.document.destroy());var a={type:"PDF",promise:n?t:null};s.parent.trigger(f,a),e(o.document)}))},e.prototype.applyStyle=function(e,t,i){var r=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),n=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b));e.cells.getCell(i).style.backgroundBrush=n;var s=Number(t.style.fontSize.split("px")[0]),o=new a.PdfStandardFont(a.PdfFontFamily.TimesRoman,s,a.PdfFontStyle.Regular);return e.cells.getCell(i).style.font=o,r=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),n=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b)),e.cells.getCell(i).style.textBrush=n,e},e.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},e.prototype.getFont=function(e){if(e.style.font)return e.style.font;var i=e.cell.cellStyle.font&&e.cell.cellStyle.font.fontSize?e.cell.cellStyle.font.fontSize:(0,t.isNullOrUndefined)(e.style.fontSize)?9.75:.75*e.style.fontSize,r=(0,t.isNullOrUndefined)(e.style.fontFamily)?a.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),n=a.PdfFontStyle.Regular;return!(0,t.isNullOrUndefined)(e.style.bold)&&e.style.bold&&(n|=a.PdfFontStyle.Bold),!(0,t.isNullOrUndefined)(e.style.italic)&&e.style.italic&&(n|=a.PdfFontStyle.Italic),!(0,t.isNullOrUndefined)(e.style.underline)&&e.style.underline&&(n|=a.PdfFontStyle.Underline),!(0,t.isNullOrUndefined)(e.style.strikeout)&&e.style.strikeout&&(n|=a.PdfFontStyle.Strikeout),new a.PdfStandardFont(r,i,n)},e.prototype.processCellStyle=function(e,i){if(!(0,t.isNullOrUndefined)(i.style.backgroundColor)){var r=this.pdfExportHelper.hexDecToRgb(i.style.backgroundColor);e.style.backgroundBrush=new a.PdfSolidBrush(new a.PdfColor(r.r,r.g,r.b))}if(!(0,t.isNullOrUndefined)(i.style.textBrushColor)){var n=this.pdfExportHelper.hexDecToRgb(i.style.textBrushColor);e.style.textBrush=new a.PdfSolidBrush(new a.PdfColor(n.r,n.g,n.b))}if(!(0,t.isNullOrUndefined)(i.style.textPenColor)){var s=this.pdfExportHelper.hexDecToRgb(i.style.textPenColor);e.style.textPen=new a.PdfPen(new a.PdfColor(s.r,s.g,s.b))}if((0,t.isNullOrUndefined)(i.style.fontFamily)&&(0,t.isNullOrUndefined)(i.style.fontSize)&&(0,t.isNullOrUndefined)(i.style.bold)&&(0,t.isNullOrUndefined)(i.style.italic)&&(0,t.isNullOrUndefined)(i.style.underline)&&(0,t.isNullOrUndefined)(i.style.strikeout)||(e.style.font=this.getFont(i)),!(0,t.isNullOrUndefined)(i.style.border)){var o=new a.PdfBorders,l=i.style.border.width,d=(0,t.isNullOrUndefined)(l)||"number"!=typeof l?void 0:.75*l,p=new a.PdfColor(196,196,196);if(!(0,t.isNullOrUndefined)(i.style.border.color)){var h=this.pdfExportHelper.hexDecToRgb(i.style.border.color);p=new a.PdfColor(h.r,h.g,h.b)}var u=new a.PdfPen(p,d);(0,t.isNullOrUndefined)(i.style.border.dashStyle)||(u.dashStyle=this.pdfExportHelper.getDashStyle(i.style.border.dashStyle)),o.all=u,e.style.borders=o}},e.prototype.applyEvent=function(){var e,t,i=sl.getClonedPivotValues(this.engine.pivotValues);if(this.parent.exportAllPages&&(this.parent.enableVirtualization||this.parent.enablePaging)&&"Server"!==this.parent.dataSourceSettings.mode){var r=this.engine.pageSettings;this.engine.isPagingOrVirtualizationEnabled=!1,"olap"===this.parent.dataType?(this.updateOlapPageSettings(!0),t=this.parent.olapEngineModule.mdxQuery.slice(0)):this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings,!0,!0),this.parent.applyFormatting(this.engine.pivotValues),e=sl.getClonedPivotValues(this.engine.pivotValues),this.engine.pivotValues=i,this.engine.pageSettings=r,this.engine.isPagingOrVirtualizationEnabled=!0,"olap"===this.parent.dataType&&(this.updateOlapPageSettings(!1),this.parent.olapEngineModule.mdxQuery=t)}else e=i;var n={pivotValues:[e]};return this.parent.trigger(p,n),this.document=new a.PdfDocument,{document:this.document,args:n}},e.prototype.updateOlapPageSettings=function(e){this.parent.olapEngineModule.isExporting=!!e,this.parent.exportSpecifiedPages?this.parent.olapEngineModule.exportSpeciedPages=this.parent.exportSpecifiedPages=e?this.parent.exportSpecifiedPages:void 0:(this.parent.olapEngineModule.pageSettings=e?null:this.parent.olapEngineModule.pageSettings,this.parent.olapEngineModule.isPaging=!e)},e.prototype.destroy=function(){this.engine&&(this.engine=null),this.exportProperties&&(this.exportProperties=null),this.document&&(this.document=null),this.pdfExportHelper&&(this.pdfExportHelper=null)},e}(),dl=function(){function e(e){this.parent=e,this.parent.pagerModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"pager"},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(it,this.createPager,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||((0,t.isNullOrUndefined)(this.parent.pagerSettings.template)&&this.unWireEvent(),this.parent.off(it,this.createPager))},e.prototype.createPager=function(){null!==(0,t.select)("#"+this.parent.element.id+"pivot-pager",this.parent.element)&&((0,t.remove)((0,t.select)("#"+this.parent.element.id+"pivot-pager",this.parent.element)),this.destroy(),this.addEventListener());var e=this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber(),i=this.parent.pagerSettings;if(this.parent.enablePaging){var a=(0,t.createElement)("div",{id:this.parent.element.id+"pivot-pager",className:Zn+" "+(this.parent.isAdaptive||e<650?Qi:"")+" "+(this.parent.enableRtl?Wi:"")+" "+("Top"===this.parent.pagerSettings.position?" e-pivot-pager-top":" e-pivot-pager-bottom")+" "+(i.enableCompactView||e<400?"e-compact-view":""),styles:"width:"+(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())+"px"});this.parent.showFieldList&&(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)&&"Top"===i.position?this.parent.element.insertBefore(a,(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)):this.parent.showGroupingBar&&(0,t.select)("#"+this.parent.element.id+" ."+Qn,this.parent.element)&&"Top"===i.position?this.parent.element.insertBefore(a,(0,t.select)("#"+this.parent.element.id+" ."+Qn,this.parent.element)):"Top"===this.parent.pagerSettings.position?this.parent.element.insertBefore(a,(0,t.select)("#"+this.parent.element.id+"_grid",this.parent.element)):this.parent.element.append(a);var r=this;if(this.pager=new ls.Pager({enableRtl:this.parent.enableRtl,locale:this.parent.locale,template:""===i.template||i.template?i.template:(0,t.initializeCSPTemplate)((function(){return r.createPagerContainer()})),cssClass:this.parent.cssClass}),this.pager.isVue=this.parent.isVue,this.pager.appendTo(a),(0,t.isNullOrUndefined)(i.template)){if(i.showRowPager){if(!i.enableCompactView&&e>400)new ps.NumericTextBox({min:1,max:this.parent.engineModule.rowPageCount,showSpinButton:!1,format:"#",validateDecimalOnType:!0,decimals:0,strictMode:!0,value:this.parent.pageSettings.currentRowPage,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:e<669?"50px":"64px",change:this.rowPageChange.bind(this),cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_row_textbox",this.parent.element));if(i.showRowPageSize){var n=this.parent.pagerSettings.rowPageSizes.slice(0);-1===this.parent.pagerSettings.rowPageSizes.indexOf(this.parent.pageSettings.rowPageSize)&&(n.push(this.parent.pageSettings.rowPageSize),n.sort((function(e,t){return e-t}))),new hs.DropDownList({dataSource:n,value:this.parent.pageSettings.rowPageSize,enableRtl:this.parent.enableRtl,locale:this.parent.locale,change:this.rowPageSizeChange.bind(this),popupHeight:"300px",popupWidth:"100%",width:"64px",cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_row_size_list",this.parent.element))}}if(i.showColumnPager){if(!i.enableCompactView&&e>400)new ps.NumericTextBox({min:1,max:this.parent.engineModule.columnPageCount,showSpinButton:!1,format:"#",validateDecimalOnType:!0,decimals:0,strictMode:!0,value:this.parent.pageSettings.currentColumnPage,enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:e<669?"50px":"64px",change:this.columnPageChange.bind(this),cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_column_textbox",this.parent.element));if(i.showColumnPageSize){var s=this.parent.pagerSettings.columnPageSizes.slice(0);-1===this.parent.pagerSettings.columnPageSizes.indexOf(this.parent.pageSettings.columnPageSize)&&(s.push(this.parent.pageSettings.columnPageSize),s.sort((function(e,t){return e-t}))),new hs.DropDownList({dataSource:s,value:this.parent.pageSettings.columnPageSize,enableRtl:this.parent.enableRtl,locale:this.parent.locale,change:this.columnPageSizeChange.bind(this),popupHeight:"300px",popupWidth:"100%",width:"64px",cssClass:this.parent.cssClass}).appendTo((0,t.select)("#"+this.parent.element.id+"_column_size_list",this.parent.element))}}this.unWireEvent(),this.wireEvent()}}},e.prototype.wireEvent=function(){for(var e=[].slice.call(this.parent.element.querySelectorAll("."+Ji+", ."+$i+", ."+ea+", ."+Zi)),i=0;i<e.length;i++)t.EventHandler.add(e[i],"click",this.updatePageSettings,this)},e.prototype.unWireEvent=function(){for(var e=[].slice.call(this.parent.element.querySelectorAll("."+Ji+", ."+$i+", ."+ea+", ."+Zi)),i=0;i<e.length;i++)t.EventHandler.remove(e[i],"click",this.updatePageSettings)},e.prototype.columnPageChange=function(e){this.parent.pageSettings.currentColumnPage=e.value},e.prototype.rowPageChange=function(e){this.parent.pageSettings.currentRowPage=e.value},e.prototype.columnPageSizeChange=function(e){this.parent.pageSettings.columnPageSize=Number(e.value)},e.prototype.rowPageSizeChange=function(e){this.parent.pageSettings.rowPageSize=Number(e.value)},e.prototype.updatePageSettings=function(e){var t=e.target.id;switch(t){case this.parent.element.id+"_row_firstIcon":this.parent.pageSettings.currentRowPage=1;break;case this.parent.element.id+"_row_prevIcon":this.parent.pageSettings.currentRowPage=this.parent.pageSettings.currentRowPage>1?this.parent.pageSettings.currentRowPage-1:this.parent.pageSettings.currentRowPage;break;case this.parent.element.id+"_row_nextIcon":this.parent.pageSettings.currentRowPage=this.parent.pageSettings.currentRowPage<this.parent.engineModule.rowPageCount?this.parent.pageSettings.currentRowPage+1:this.parent.pageSettings.currentRowPage;break;case this.parent.element.id+"_row_lastIcon":this.parent.pageSettings.currentRowPage=this.parent.engineModule.rowPageCount;break;case this.parent.element.id+"_column_firstIcon":this.parent.pageSettings.currentColumnPage=1;break;case this.parent.element.id+"_column_prevIcon":this.parent.pageSettings.currentColumnPage=this.parent.pageSettings.currentColumnPage>1?this.parent.pageSettings.currentColumnPage-1:this.parent.pageSettings.currentColumnPage;break;case this.parent.element.id+"_column_nextIcon":this.parent.pageSettings.currentColumnPage=this.parent.pageSettings.currentColumnPage<this.parent.engineModule.columnPageCount?this.parent.pageSettings.currentColumnPage+1:this.parent.pageSettings.currentColumnPage;break;case this.parent.element.id+"_column_lastIcon":this.parent.pageSettings.currentColumnPage=this.parent.engineModule.columnPageCount}-1!==t.indexOf("_row")?this.parent.actionObj.actionName=Zt:-1!==t.indexOf("_column")&&(this.parent.actionObj.actionName=$t)},e.prototype.createPagerContainer=function(){var e,i,a=this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber(),r=this.parent.pagerSettings;r.showRowPager&&(e=this.createPagerItems("row",r,a)),r.showColumnPager&&(i=this.createPagerItems("column",r,a));var n=(0,t.createElement)("div",{id:this.parent.element.id+"_mainDiv",className:"e-pivot-pager-maindiv "+(r.showRowPager&&r.showColumnPager?"":"e-pivot-pager-single-maindiv")+" "+(r.isInversed?"e-inverse-view":"")}),s=(0,t.createElement)("div",{id:this.parent.element.id+"_vertical_separator",className:this.parent.isAdaptive||a<650?"e-pivotview-hseparator":"e-pivotview-vseparator"});return r.isInversed&&r.showColumnPager&&r.showRowPager?n.append(i,s,e):r.showColumnPager&&r.showRowPager?n.append(e,s,i):r.showRowPager&&!r.showColumnPager?n.append(e):!r.showRowPager&&r.showColumnPager&&n.append(i),n.outerHTML},e.prototype.createPagerItems=function(e,i,a){var r=!i.showRowPager||!i.showColumnPager,n=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_mainDiv",className:"row"===e?"e-pivot-pager-row-maindiv "+(i.showRowPageSize?"":es):"e-pivot-pager-column-maindiv "+(i.showColumnPageSize?"":es)}),s=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_pagerSettings",className:"row"===e?"e-pivot-row-pager-settings":"e-pivot-column-pager-settings"}),o="column"===e&&1===this.parent.pageSettings.currentColumnPage||"row"===e&&1===this.parent.pageSettings.currentRowPage,l="column"===e&&this.parent.pageSettings.currentColumnPage===this.parent.engineModule.columnPageCount||"row"===e&&this.parent.pageSettings.currentRowPage===this.parent.engineModule.rowPageCount,d=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_NavContainer",attrs:{class:"e-pivot-pager-nav-container "+$n}}),p=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_PageInfoContainer",attrs:{class:"e-pivot-pager-info-container "+$n}}),h=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_firstIcon",attrs:{class:"e-first e-icons e-icon-first"+(o?" e-firstpagedisabled "+Ki:" e-firstpage e-pager-default"),title:this.parent.localeObj.getConstant("goToFirstPage"),"aria-label":this.parent.localeObj.getConstant("goToFirstPage"),tabindex:"0",role:"button"}}),u=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_prevIcon",attrs:{class:"e-prev e-icons e-icon-prev"+(o?" e-prevpagedisabled "+Ki:" e-prevpage e-pager-default"),title:this.parent.localeObj.getConstant("goToPreviousPage"),"aria-label":this.parent.localeObj.getConstant("goToPreviousPage"),tabindex:"0",role:"button"}}),c=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_pagerString",className:"row"===e?"e-pivotview-row-pagerString":"e-pivotview-column-pagerString"});c.innerText="row"===e?this.parent.localeObj.getConstant("rowPage"):this.parent.localeObj.getConstant("columnPage");var g=(0,t.createElement)("input",{id:this.parent.element.id+"_"+e+"_textbox",className:"row"===e?"e-pivot-pager-row-dropdown":"e-pivot-pager-column-dropdown",attrs:{placeholder:"1"}}),m=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_of_string_mainDiv",className:"row"===e?"e-pivot-row-of-string-maindiv":"e-pivot-column-of-string-maindiv"}),f=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_ofString",className:"row"===e?"e-pivot-row-of-string":"e-pivot-column-of-string"});f.innerText=this.parent.localeObj.getConstant("of")+" ";var S=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_pagerNumber",className:"row"===e?"e-pivotview-row-pagerNumber":"e-pivotview-column-pagerNumber"});S.innerText=("row"===e?this.parent.engineModule.rowPageCount:this.parent.engineModule.columnPageCount).toString();var v=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_nextIcon",attrs:{class:"e-next e-icons e-icon-next"+(l?" e-nextpagedisabled "+Ki:" e-nextpage e-pager-default"),title:this.parent.localeObj.getConstant("goToNextPage"),"aria-label":this.parent.localeObj.getConstant("goToNextPage"),tabindex:"0",role:"button"}}),y=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_lastIcon",attrs:{class:"e-last e-icons e-icon-last"+(l?" e-lastpagedisabled "+Ki:" e-lastpage e-pager-default"),title:this.parent.localeObj.getConstant("goToLastPage"),"aria-label":this.parent.localeObj.getConstant("goToLastPage"),tabindex:"0",role:"button"}}),b=(0,t.createElement)("span",{id:this.parent.element.id+"_"+e+"_size",className:"row"===e?"e-pivotview-row-size":"e-pivotview-column-size"});b.innerText="row"===e?this.parent.localeObj.getConstant("rowPerPage"):this.parent.localeObj.getConstant("columnPerPage");var C=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_size_list_maindiv",className:"e-pager-dropdown "+$n}),x=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_size_list",className:"row"===e?"e-pivot-row-size-list":"e-pivot-column-size-list"}),w=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_text_div",className:"e-pivotview-text-div"}),T=(0,t.createElement)("div",{id:this.parent.element.id+"_"+e+"_text_div_1",className:"e-pivotview-text-div-1"});return C.append(x),i.enableCompactView||a<400?(d.append(u,v),s.append(d)):(m.append(f,S),d.append(h,u,v,y),p.append(g,m),s.append(d,p)),("row"===e&&i.showRowPager||"column"===e&&i.showColumnPager)&&(("column"===e&&!i.showRowPager||"row"===e&&!i.showColumnPager)&&r&&T.append(b,C),i.showColumnPager&&i.showRowPager||!r?("row"===e&&i.showRowPageSize||"column"===e&&i.showColumnPageSize?!i.enableCompactView&&a>400?(w.append(c,b),T.append(s,C)):(w.append(c,s),T.append(b,C)):("row"===e&&!i.showRowPageSize||"column"===e&&!i.showColumnPageSize)&&(w.append(c),T.append(s)),n.append(w,T)):("row"===e&&(i.showRowPageSize?n.append(s,c,T):n.append(s,c)),"column"===e&&(i.showColumnPageSize?n.append(s,c,T):n.append(s,c)))),n},e.prototype.destroy=function(){if(this.removeEventListener(),this.parent.pagerModule){var e=(0,t.select)("#"+this.parent.element.id+"_column_textbox",this.parent.element),i=e?(0,t.getInstance)(e,ps.NumericTextBox):null;i&&(i.destroy(),i=null);var a=(e=(0,t.select)("#"+this.parent.element.id+"_row_textbox",this.parent.element))?(0,t.getInstance)(e,ps.NumericTextBox):null;a&&(a.destroy(),a=null);var r=(e=(0,t.select)("#"+this.parent.element.id+"_column_size_list",this.parent.element))?(0,t.getInstance)(e,hs.DropDownList):null;r&&(r.destroy(),r=null);var n=(e=(0,t.select)("#"+this.parent.element.id+"_row_size_list",this.parent.element))?(0,t.getInstance)(e,hs.DropDownList):null;n&&(n.destroy(),n=null),this.pager&&this.pager.destroy(),this.pager=null}},e}(),pl=function(){function e(e){this.parent=e}return e.prototype.render=function(){var e=(0,t.createElement)("div",{id:this.parent.element.id+"_Container",className:ia+" "+("olap"===this.parent.dataType?"e-olapfieldlist-container":""),styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?(0,t.addClass)([e],Qi):(0,t.removeClass)([e],Qi),this.parent.enableRtl?(0,t.addClass)([e],Wi):(0,t.removeClass)([e],Wi),this.parent.cssClass&&(0,t.addClass)([e],this.parent.cssClass.split(" ")),this.parent.enableFieldSearching?(0,t.addClass)([e],la):(0,t.removeClass)([e],la),this.parentElement=(0,t.createElement)("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=(0,t.createElement)("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector("."+aa)),this.wireDialogEvent(this.parent.element.querySelector("."+aa))):this.renderStaticLayout(e)},e.prototype.renderStaticLayout=function(e){if(!this.parent.isAdaptive){var i=(0,t.createElement)("div",{className:"e-field-list-title"}),a=(0,t.createElement)("div",{className:"e-title-content"});a.innerText=this.parent.localeObj.getConstant("staticFieldList"),i.appendChild(a),i.appendChild(this.createCalculatedButton()),(0,t.addClass)([e],ra),e.appendChild(i),e.appendChild(this.parentElement),(0,t.addClass)([e],ra),this.parent.allowDeferLayoutUpdate&&(e.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons(e))}},e.prototype.renderDeferUpdateButtons=function(e){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new Cs.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:this.parent.isPopupView&&this.parent.pivotGridModule?!!(0,t.isNullOrUndefined)(this.parent.pivotGridModule.pivotDeferLayoutUpdate)||this.parent.pivotGridModule.pivotDeferLayoutUpdate:!!(0,t.isNullOrUndefined)(this.parent.isDeferLayoutUpdate)||this.parent.isDeferLayoutUpdate,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,change:this.onCheckChange.bind(this),cssClass:this.parent.cssClass}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo((0,t.select)("#"+this.parent.element.id+"DeferUpdateCheckBox",e)),this.deferUpdateApplyButton=new Cs.Button({cssClass:"e-defer-apply-button e-defer-update-btn"+("Popup"===this.parent.renderMode?" "+pr:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,isPrimary:!0,disabled:this.parent.isPopupView&&this.parent.pivotGridModule?!(0,t.isNullOrUndefined)(this.parent.pivotGridModule.pivotDeferLayoutUpdate)&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate:!(0,t.isNullOrUndefined)(this.parent.isDeferLayoutUpdate)&&!this.parent.isDeferLayoutUpdate}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo((0,t.select)("#"+this.parent.element.id+"_DeferUpdateButton1",e)),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this)),this.deferUpdateCancelButton=new Cs.Button({cssClass:"e-defer-cancel-button "+Ba+("Popup"===this.parent.renderMode?" "+pr:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,disabled:this.parent.isPopupView&&this.parent.pivotGridModule&&this.parent.pivotGridModule.refreshing?!(!this.parent.allowDeferLayoutUpdate||(0,t.isNullOrUndefined)(this.parent.pivotGridModule.pivotDeferLayoutUpdate))&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate:!(!this.parent.refreshing||(0,t.isNullOrUndefined)(this.parent.isDeferLayoutUpdate)||!this.parent.allowDeferLayoutUpdate)&&!this.parent.isDeferLayoutUpdate}),this.deferUpdateCancelButton.isStringTemplate=!0,this.deferUpdateCancelButton.appendTo((0,t.select)("#"+this.parent.element.id+"_DeferUpdateButton2",e)),this.parent.allowDeferLayoutUpdate&&(!this.parent.isDeferLayoutUpdate&&"Popup"===this.parent.renderMode&&this.parent.refreshing||this.parent.isPopupView&&this.parent.pivotGridModule&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate&&this.parent.pivotGridModule.refreshing)&&(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0,this.deferUpdateApplyButton.disabled=this.parent.isPopupView?this.parent.pivotGridModule.pivotDeferLayoutUpdate:this.parent.isDeferLayoutUpdate,this.deferUpdateCancelButton.disabled=this.parent.isPopupView?this.parent.pivotGridModule.pivotDeferLayoutUpdate:this.parent.isDeferLayoutUpdate),this.deferUpdateCancelButton.element.onclick=this.onCloseFieldList.bind(this)},e.prototype.createDeferUpdateButtons=function(){var e=(0,t.createElement)("div",{className:"e-layout-footer"});if(this.parent.allowDeferLayoutUpdate){var i=(0,t.createElement)("div",{className:"e-checkbox-layout",attrs:{title:this.parent.localeObj.getConstant("deferLayoutUpdate")}}),a=(0,t.createElement)("input",{id:this.parent.element.id+"DeferUpdateCheckBox"});i.appendChild(a),e.appendChild(i)}var r=(0,t.createElement)("div",{className:"e-button-layout"});if(this.parent.allowDeferLayoutUpdate){var n=(0,t.createElement)("button",{id:this.parent.element.id+"_DeferUpdateButton1",attrs:{type:"button",title:this.parent.localeObj.getConstant("apply")}});r.appendChild(n)}var s=(0,t.createElement)("button",{id:this.parent.element.id+"_DeferUpdateButton2",attrs:{type:"button",title:this.parent.localeObj.getConstant("cancel")}});return r.appendChild(s),e.appendChild(r),e},e.prototype.onCheckChange=function(e){e.checked&&(this.parent.clonedDataSource=(0,t.extend)({},this.parent.dataSourceSettings,null,!0),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=r.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),this.parent.clonedFieldList=r.getClonedFieldList(this.parent.pivotFieldList)),this.parent.isDeferLayoutUpdate=e.checked,this.parent.isPopupView&&this.parent.pivotGridModule&&(this.parent.pivotGridModule.pivotDeferLayoutUpdate=e.checked),"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!e.checked}),this.deferUpdateCancelButton.setProperties({disabled:!e.checked})):this.parent.allowDeferLayoutUpdate&&e.checked?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0),Object.keys(this.parent.clonedFieldList).length!==Object.keys(this.parent.pivotFieldList).length&&this.parent.calculatedFieldModule&&this.parent.calculatedFieldModule.field&&"pivot"===this.parent.dataType&&(this.parent.engineModule.fields=Object.keys(this.parent.clonedFieldList)),this.onCloseFieldList(null,!0)},e.prototype.applyButtonClick=function(){"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!1),this.parent.isDeferUpdateApplied=!0,this.parent.updateDataSource(!1);var e=this.parent;e.axisFieldModule.render(),e.clonedDataSource=(0,t.extend)({},e.dataSourceSettings,null,!0),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=r.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),e.clonedFieldList=r.getClonedFieldList(e.pivotFieldList)},e.prototype.onCloseFieldList=function(e,t){if((this.parent.allowDeferLayoutUpdate||t)&&(!this.parent.isPopupView||this.parent.pivotGridModule&&""!==this.parent.pivotGridModule.actionObj.actionName||""!==this.parent.actionObj.actionName)){if(this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),"olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList=r.getClonedFieldList(this.parent.clonedFieldList),this.parent.olapEngineModule.fieldListData=r.cloneOlapFieldSettings(this.parent.clonedFieldListData),this.parent.isPopupView)this.parent.isPopupView&&this.parent.clonedFieldListData&&Object.keys(this.parent.clonedFieldListData).length>0&&(this.parent.olapEngineModule.fieldListData=this.parent.clonedFieldListData);else for(var i=0,a=Object.keys(this.parent.clonedFieldList);i<a.length;i++){var n=a[i],s=this.parent.clonedFieldList[n];this.parent.olapEngineModule.updateFieldlistData(s.id,s.isSelected)}else this.parent.engineModule.fieldList=r.getClonedFieldList(this.parent.clonedFieldList);this.parent.updateDataSource(!1,!0)}if((!this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate)&&t&&(this.parent.pivotChange=!1),this.parent.allowDeferLayoutUpdate&&this.parent.isPopupView&&this.parent.pivotGridModule&&!this.parent.isAdaptive&&(this.parent.pivotGridModule.actionObj.actionName="",this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0)),this.parent.allowDeferLayoutUpdate&&this.parent.allowCalculatedField&&"pivot"===this.parent.dataType&&!this.parent.isAdaptive){this.parent.engineModule.fieldList=this.parent.pivotFieldList=r.getClonedFieldList(this.parent.clonedFieldList);var o=Object.keys(this.parent.engineModule.fieldList);if(this.parent.allowCalculatedField&&o.length!==this.parent.engineModule.fields.length){var l=[];this.parent.engineModule.fields.forEach((function(e){-1!==o.indexOf(e)&&(l[l.length]=e)})),this.parent.engineModule.fields=l}}"Popup"!==this.parent.renderMode||t?this.parent.actionObj.actionName=Gi:(this.parent.dialogRenderer.fieldListDialog.hide(),this.parent.actionObj.actionName=ri),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()},e.prototype.renderFieldListDialog=function(e){var i=(0,t.createElement)("div",{className:aa+" "+Yi+" e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList"),role:"button"}});if(this.parent.element.appendChild(i),this.parent.isAdaptive){var a='<div class=e-title-mobile-header><span class="'+Yi+" "+Mn+'"></span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"</div></div>",r=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:nr+" "+or+" "+lr+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:Yi+" "+dr,isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:sr+" "+or+" "+lr+" "+Ki+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:Yi+" "+dr,enableRtl:this.parent.enableRtl,isPrimary:!0}}];this.fieldListDialog=new o.Dialog({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:a,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:r,target:document.body,cssClass:this.parent.cssClass,close:this.removeFieldListIcon.bind(this),open:this.dialogOpen.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),(0,t.setStyleAttribute)((0,t.select)("#"+e.id+"_dialog-content",e),{padding:"0"});var n=e.querySelector(".e-footer-content");(0,t.addClass)([n],ha),(0,t.removeClass)([n.querySelector("."+sr)],pr),(0,t.removeClass)([n.querySelector("."+nr)],pr),this.fieldListDialog.element.querySelector("."+Mn).onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)}else{var s=this.createDeferUpdateButtons().outerHTML;a="<div class="+ar+"><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new o.Dialog({animationSettings:{effect:"Zoom"},header:a,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:s,closeOnEscape:!1,cssClass:this.parent.cssClass,target:(0,t.isNullOrUndefined)(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),this.renderDeferUpdateButtons(e),(0,t.setStyleAttribute)((0,t.select)("#"+e.id+"_title",e),{width:"100%"}),e.querySelector("."+ar).appendChild(this.createCalculatedButton())}},e.prototype.dialogOpen=function(){4===this.lastTabIndex?(this.adaptiveElement.items[this.lastTabIndex].content="",this.adaptiveElement.dataBind(),this.parent.notify($e,{})):this.adaptiveElement.refresh()},e.prototype.updateDataSource=function(e){for(var t=["filters","columns","rows","values"],i=0,a=e;i<a.length;i++){var r=a[i],n=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(r,n,-1)}this.parent.axisFieldModule.render(),this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},e.prototype.onDeferUpdateClick=function(){this.parent.updateDataSource(),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.renderAdaptiveLayout=function(e){var i=(0,t.createElement)("div",{className:ha});e.appendChild(this.parentElement);var a=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||a.pop(),this.adaptiveElement=new ds.Tab({heightAdjustMode:"Auto",items:a,height:"100%",enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,selected:this.tabSelect.bind(this),cssClass:this.parent.cssClass}),"Fixed"===this.parent.renderMode?(i.appendChild(this.createAddButton()),(0,t.addClass)([e],ra),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(i)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))},e.prototype.tabSelect=function(e){var i=(0,t.closest)(this.parentElement,"."+ia);this.lastTabIndex=e.selectedIndex,i&&i.querySelector("."+nr)&&(4!==e.selectedIndex?((0,t.addClass)([i.querySelector("."+sr)],Ki),(0,t.removeClass)([i.querySelector("."+nr)],Ki)):((0,t.removeClass)([i.querySelector("."+sr)],Ki),(0,t.addClass)([i.querySelector("."+nr)],Ki))),4===e.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify($e,{})):this.parent.axisFieldModule.render()},e.prototype.createCalculatedButton=function(){var e=(0,t.createElement)("button",{id:this.parent.element.id+"_CalculatedField",attrs:{type:"button",tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("CalculatedField")}}),i=new Cs.Button({cssClass:"e-calculated-field "+Ki+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("CalculatedField"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});return i.isStringTemplate=!0,i.appendTo(e),this.parent.calculatedFieldModule&&(0,t.removeClass)([e],Ki),i.element.onclick=this.showCalculatedField.bind(this),e},e.prototype.createAddButton=function(){var e=(0,t.createElement)("div",{className:ha+"-content"}),i=(0,t.createElement)("div",{}),a=(0,t.createElement)("div",{}),r=new Cs.Button({cssClass:sr+" "+or+" "+lr+" "+Ki+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:Yi+" "+dr,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),n=new Cs.Button({cssClass:nr+" "+or+" "+lr+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:Yi+" "+dr,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});return n.isStringTemplate=!0,n.appendTo(i),r.isStringTemplate=!0,r.appendTo(a),e.appendChild(i),e.appendChild(a),r.element.onclick=this.showCalculatedField.bind(this),n.element.onclick=this.showFieldListDialog.bind(this),e},e.prototype.createAxisTable=function(e){var i=(0,t.createElement)("div",{className:na+"-"+e}),a=(0,t.createElement)("div",{className:fa+" e-"+e}),r=(0,t.createElement)("span",{className:Sa});return r.innerText=this.parent.localeObj.getConstant("addPrompt"),i.appendChild(a),i.appendChild(r),i},e.prototype.showCalculatedField=function(){try{if(!this.parent.isAdaptive){if(this.parent.actionObj.actionName=Gt,this.parent.actionBeginMethod())return;this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),(0,t.addClass)([this.parent.element.querySelector("."+aa)],Xi))}this.parent.notify($e,{})}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.showFieldListDialog=function(){var e=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(e)},e.prototype.onShowFieldList=function(){if(this.parent.actionObj.actionName=St,!this.parent.actionBeginMethod()){this.parent.actionObj.actionName="";try{this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=(0,t.extend)({},this.parent.dataSourceSettings,null,!0),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=r.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),this.parent.clonedFieldList=r.getClonedFieldList(this.parent.pivotFieldList)),(0,t.addClass)([this.parent.element.querySelector("."+aa)],Xi),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.removeFieldListIcon=function(){this.parent.isAdaptive&&this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&this.adaptiveElement&&4===this.adaptiveElement.selectedItem&&((0,t.select)("#"+this.parent.element.id+"droppable",this.adaptiveElement.element)?this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!1):this.parent.notify($e,{edit:!1})),document.getElementById(this.parent.element.id+"calculateddialog")||(0,t.removeClass)([this.parent.element.querySelector("."+aa)],Xi)},e.prototype.keyPress=function(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireDialogEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.onShowFieldList,this)},e.prototype.unWireDialogEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.onShowFieldList)},e.prototype.destroy=function(){"Popup"===this.parent.renderMode&&this.unWireDialogEvent(this.parent.element.querySelector("."+aa)),this.deferUpdateCheckBox&&!this.deferUpdateCheckBox.isDestroyed&&(this.deferUpdateCheckBox.destroy(),this.deferUpdateCheckBox=null),this.deferUpdateApplyButton&&!this.deferUpdateApplyButton.isDestroyed&&(this.deferUpdateApplyButton.destroy(),this.deferUpdateApplyButton=null),this.deferUpdateCancelButton&&!this.deferUpdateCancelButton.isDestroyed&&(this.deferUpdateCancelButton.destroy(),this.deferUpdateCancelButton=null),this.adaptiveElement&&!this.adaptiveElement.isDestroyed&&(this.adaptiveElement.destroy(),this.adaptiveElement=null),"Popup"===this.parent.renderMode&&(this.fieldListDialog&&!this.fieldListDialog.isDestroyed&&(this.fieldListDialog.destroy(),this.fieldListDialog=null),document.getElementById(this.parent.element.id+"_Container")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_Container")))},e}(),hl=function(){function e(e){this.selectedNodes=[],this.isSearching=!1,this.parentIDs=[],this.isSpaceKey=!1,this.parent=e,this.addEventListener()}return e.prototype.render=function(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.fieldListSort=this.parent.pivotGridModule?this.parent.pivotGridModule.defaultFieldListOrder:this.parent.defaultFieldListOrder,this.fieldListSort="Ascending"===this.fieldListSort?"Ascend":"Descending"===this.fieldListSort?"Descend":"None",this.parent.isAdaptive)this.renderTreeDialog(e);else{var i=(0,t.createElement)("div",{className:"e-field-table "+("olap"===this.parent.dataType?"e-olap-field-table":"")}),a=(0,t.createElement)("div",{className:"e-field-header",attrs:{title:this.parent.localeObj.getConstant("allFields")}});a.innerText=this.parent.localeObj.getConstant("allFields");var r=(0,t.createElement)("div",{className:sa+" "+Kr});this.treeViewElement=(0,t.createElement)("div",{id:this.parent.element.id+"_TreeView",className:na+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});var n=(0,t.createElement)("div",{className:"e-field-header-container"});if(n.appendChild(a),i.appendChild(n),this.updateSortElements(n),this.parent.enableFieldSearching){var s=(0,t.createElement)("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-field-list-search"}),o=(0,t.createElement)("input",{attrs:{type:"text"}});s.appendChild(o),this.fieldSearch=new ps.TextBox({placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-field-list-search-input"+(this.parent.cssClass?" "+this.parent.cssClass:""),input:this.textChange.bind(this),showClearButton:!0}),this.fieldSearch.isStringTemplate=!0,this.fieldSearch.appendTo(o),this.fieldSearch.addIcon("append","e-field-list-search-icon "+Yi);var l=(0,t.createElement)("div",{className:sn+" "+Ki});l.innerText=this.parent.localeObj.getConstant("noMatches"),i.appendChild(s),i.appendChild(l)}if(r.appendChild(this.treeViewElement),i.appendChild(r),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode){var d=(0,t.createElement)("div",{className:"e-center-div"}),p=(0,t.createElement)("div",{className:"e-center-title"});p.innerText=this.parent.localeObj.getConstant("centerHeader"),this.parentElement.appendChild(d),this.parentElement.appendChild(p)}this.renderTreeView()}},e.prototype.updateSortElements=function(e){for(var i={None:"sortNone",Ascend:"sortAscending",Descend:"sortDescending"},a=0,r=Object.keys(i);a<r.length;a++){var n=r[a],s=(0,t.createElement)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":"Sort "+n,"data-sort":n,title:this.parent.localeObj.getConstant(i[n]),role:"button"},className:Yi+" e-sort-"+n.toLowerCase()+" "+(this.fieldListSort===n?"e-selected":"")});e.appendChild(s),this.unWireFieldListEvent(s),this.wireFieldListEvent(s)}},e.prototype.renderTreeView=function(){this.fieldTable=new ds.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},nodeChecked:this.nodeChecked.bind(this),nodeClicked:this.nodeStateChange.bind(this),keyPress:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree"+(this.parent.cssClass?" "+this.parent.cssClass:""),showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"None",loadOnDemand:"olap"!==this.parent.dataType,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0}}),this.treeViewElement.innerHTML="",this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(this.treeViewElement);var e="Fixed"===this.parent.renderMode?this.parent.element:this.parentElement;(0,t.isNullOrUndefined)(e.querySelector("."+na))||((0,t.getInstance)(e.querySelector("."+na),ds.TreeView).dragObj.enableAutoScroll=!1)},e.prototype.updateNodeIcon=function(e){if("olap"===this.parent.dataType)if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-icon"),(0,t.addClass)([i],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-open-icon"),(0,t.addClass)([i],"e-folderCDB-icon")}},e.prototype.updateTreeNode=function(e){var i=!1;"olap"===this.parent.dataType?i=this.updateOlapTreeNode(e):e.nodeData.hasChildren?(i=!1,e.node.querySelector("."+wn).style.display="none",(0,t.addClass)([e.node],da)):i=!0,(0,t.isNullOrUndefined)(e.nodeData.pid)||(0,t.addClass)([e.node],pa);var a=e.node.querySelector("."+rr);if(e.node.querySelector(".e-list-icon")&&a){var n=e.node.querySelector(".e-list-icon");a.insertBefore(n,e.node.querySelector(".e-list-text"))}if(i&&!this.parent.isAdaptive){var s=r.getFieldInfo(e.nodeData.id,this.parent);i=!1;var o=(0,t.createElement)("span",{attrs:{tabindex:"-1",title:s.fieldItem?s.fieldItem.allowDragAndDrop?this.parent.localeObj.getConstant("drag"):"":this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:Yi+" "+Na+" "+(s.fieldItem?s.fieldItem.allowDragAndDrop?"":Ea:"")});e.node.querySelector("."+wn)&&!e.node.querySelector(".cls.DRAG_CLASS")&&a&&a.insertBefore(o,e.node.querySelector("."+wn))}if(e.node.querySelector("."+Ha)&&(0,t.addClass)([e.node.querySelector("."+hr)],ur),this.parent.enableFieldSearching&&this.isSearching){var l=e.node;if("olap"===this.parent.dataType)for(var d=l.getAttribute("data-uid"),p=this.parent.pivotCommon.eventBase.searchListItem,h=0;h<this.parentIDs.length;h++){d===this.parentIDs[h]&&(0,t.addClass)([l],Ki);for(var u=0,c=p;u<c.length;u++){var g=c[u],m=this.parent.pivotCommon.eventBase.getParentIDs(this.fieldTable,g.getAttribute("data-uid"),[]);if(r.inArray(d,m)>-1){(0,t.removeClass)([l],Ki);break}}}else for(h=0;h<this.nonSearchList.length;h++){if(l.textContent===this.nonSearchList[h].textContent){(0,t.addClass)([l],Ki);break}if(l.innerText===this.nonSearchList[h].textContent){(0,t.addClass)([l],Ki);break}}}},e.prototype.updateOlapTreeNode=function(e){var t=!1;return"olap"===this.parent.dataType?(e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon,.e-folderCDB-open-icon,.e-dimensionCDB-icon,.e-kpiCDB-icon")&&(e.node.querySelector("."+wn).style.display="none"),e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-level-members")>-1&&(this.parent.isAdaptive?e.node.querySelector("."+wn).style.display="none":e.node.querySelector("."+wn).style.visibility="hidden"),e.node&&(e.node.querySelector(".e-hierarchyCDB-icon,.e-attributeCDB-icon,.e-namedSetCDB-icon")||e.node.querySelector(".e-measure-icon,.e-kpiGoal-icon,.e-kpiStatus-icon,.e-kpiTrend-icon,.e-kpiValue-icon")||e.node.querySelector(".e-calc-measure-icon,.e-calc-dimension-icon"))&&(e.node.querySelector(".e-measure-icon")?(e.node.querySelector(".e-list-icon").style.display="none",t=!0):t=!0)):t=!0,t},e.prototype.renderTreeDialog=function(e){var i=(0,t.createElement)("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")});this.parentElement.appendChild(i),this.fieldDialog=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,width:"320px",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!1,cssClass:this.parent.cssClass,close:this.closeTreeDialog.bind(this),target:(0,t.closest)(this.parentElement,"."+ia)}),this.fieldDialog.isStringTemplate=!0,this.fieldDialog.appendTo(i)},e.prototype.createTreeView=function(e){var i=(0,t.createElement)("div",{id:this.parent.element.id+"EditorDiv",className:La}),a=(0,t.createElement)("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:Ar}),r=(0,t.createElement)("input",{attrs:{type:"text"}});a.appendChild(r);var n=(0,t.createElement)("div",{className:sa}),s=(0,t.createElement)("div",{className:Aa+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});i.appendChild(a),this.editorSearch=new ps.MaskedTextBox({showClearButton:!0,placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:Rr+(this.parent.cssClass?" "+this.parent.cssClass:""),change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(r);var o=(0,t.createElement)("div",{className:sn+" "+Ki});return o.innerText=this.parent.localeObj.getConstant("noMatches"),i.appendChild(o),n.appendChild(s),i.appendChild(n),this.fieldTable=new ds.TreeView({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,loadOnDemand:"olap"!==this.parent.dataType,sortOrder:"olap"===this.parent.dataType?"None":"Ascending",enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,nodeChecked:this.nodeChecked.bind(this),nodeClicked:this.addNode.bind(this),keyPress:this.addNode.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0}}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(s),i},e.prototype.textChange=function(e){var i,a;this.parent.pivotCommon.eventBase.searchTreeNodes(e,this.fieldTable,!0),this.parent.isAdaptive?i=this.fieldDialog.element.querySelector("."+sn):(i=this.parentElement.querySelector("."+sn),a=this.parentElement.querySelector("."+Kr));var r=[].slice.call(this.fieldTable.element.querySelectorAll("li")),n=[].slice.call(this.fieldTable.element.querySelectorAll("li."+Ki));if(r.length===n.length?((0,t.removeClass)([i],Ki),this.parent.isAdaptive||((0,t.addClass)([a],Ki),(0,t.removeClass)([a],oa))):((0,t.addClass)([i],Ki),this.parent.isAdaptive||((0,t.removeClass)([a],Ki),(0,t.addClass)([a],oa))),this.isSearching=n.length>0,this.nonSearchList=n,"olap"===this.parent.dataType){this.parentIDs=[];for(var s=0;s<r.length;s++)if(r[s].classList.contains("e-level-1")){var o=r[s].getAttribute("data-uid");this.parentIDs.push(o)}}},e.prototype.dragStart=function(e){var i=this;if(e.event.target.classList.contains(Na)&&!e.event.target.classList.contains(Ea)){var a=r.getFieldInfo(e.draggedNode.getAttribute("data-uid"),this.parent),n={fieldName:a.fieldName,fieldItem:a.fieldItem,axis:a.axis,dataSourceSettings:this.parent.dataSourceSettings,cancel:!1};(this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ke,n,(function(a){if(a.cancel)i.parent.isDragging=!1,e.cancel=!0;else{i.parent.isDragging=!0,(0,t.addClass)([e.draggedNode.querySelector("."+hr)],ir);var r=void 0;r="olap"===i.parent.dataType?i.parent.olapEngineModule.fieldList[e.draggedNode.getAttribute("data-uid")]:i.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")];var n=[za,Wa,Ya];if(r&&"CalculatedField"===r.aggregateType)for(var s=0,o=n;s<o.length;s++){var l=o[s];(0,t.addClass)([i.parentElement.querySelector("."+l)],tr)}var d=e.clonedNode;d&&"Popup"===("pivotfieldlist"===i.parent.getModuleName()&&i.parent.renderMode)&&(d.style.zIndex=(i.parent.dialogRenderer.fieldListDialog.zIndex+1).toString())}}))}else this.parent.isDragging=!1,e.cancel=!0},e.prototype.dragStop=function(e){e.cancel=!0,this.parent.isDragging=!1;for(var i=0,a=[za,Wa,Ya];i<a.length;i++){var r=a[i];(0,t.removeClass)([this.parentElement.querySelector("."+r)],tr)}(0,t.removeClass)([e.draggedNode.querySelector("."+hr)],ir),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var n=e.draggedNodeData.id.toString();if(this.isNodeDropped(e,n)){var s=this.parent.pivotFieldList[n];if(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.isPopupView&&this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,n))this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&this.parent.pivotGridModule.pivotDeferLayoutUpdate?(s.isSelected=!0,this.updateDataSource()):this.parent.updateDataSource(),this.parent.axisFieldModule.render()}},e.prototype.isNodeDropped=function(e,i){var a=!0;if("true"===e.draggedNodeData.isChecked){var r=this.getButton(i),n=(0,t.closest)(r,"."+Ga),s=(0,t.closest)(e.target,"."+Ga);if(r&&n===s){for(var o=[].slice.call(n.querySelectorAll("."+ya)),l=(0,t.closest)(e.target,"."+va),d=void 0,p=-1,h=0,u=o.length;h<u;h++)if(o[h].id===r.id&&(d=h),l){var c=l.querySelector("."+ya);o[h].id===c.id&&(p=h)}if(d===p||d===o.length-1&&-1===p){var g=document.getElementById(this.parent.element.id+"_Container");(0,t.removeClass)([].slice.call(g.querySelectorAll("."+Ia)),Fa),a=!1}}}return a},e.prototype.getButton=function(e){for(var t,i=document.getElementById(this.parent.element.id+"_Container"),a=[].slice.call(i.querySelectorAll("."+ya)),r=0,n=a.length;r<n;r++)if(a[r].getAttribute("data-uid")===e){t=a[r];break}return t},e.prototype.nodeChecked=function(e){if(this.isSpaceKey){var i=(0,t.closest)(e.node,"."+rr);if(!(0,t.isNullOrUndefined)(i)){var a=(0,t.closest)(i,"li").getAttribute("data-uid");this.parent.isAdaptive?this.addNode(void 0,a,"check"===e.action,i):this.nodeStateChange(void 0,a,"check"===e.action,i)}}this.isSpaceKey=!1},e.prototype.nodeStateChange=function(e,i,a,n){var s=this;n=(0,t.isNullOrUndefined)(n)?e.node:n,i=(0,t.isNullOrUndefined)(i)?n.getAttribute("data-uid"):i,this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var o=this.parent.pivotFieldList[i];if(!(0,t.isNullOrUndefined)(e)){if(this.isSpaceKey=e.event.action&&"space"===e.event.action,(0,t.isNullOrUndefined)(o)||n.classList.contains(Ki)||e.event.target&&(e.event.target.classList.contains(ns)||e.event.target.classList.contains(ss))||e.event.action&&"enter"!==e.event.action)return;a=!1;var l=this.fieldTable.getNode(n);e.event&&e.event.target&&!e.event.target.closest("."+wn)?"true"===l.isChecked?(this.fieldTable.uncheckAll([n]),a=!1):(this.fieldTable.checkAll([n]),a=!0):a="true"===l.isChecked}var d=this.parent.isPopupView?this.parent.pivotGridModule:this.parent,p=r.getFieldInfo(i,this.parent),h=n.closest("."+da);if(a){var c={fieldName:i,dropField:p.fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"number"===o.type||"CalculatedField"===o.type&&o.formula&&o.formula.indexOf("Measure")>-1&&"olap"===this.parent.dataType?"values":"rows",dropPosition:p.position,draggedAxis:"fieldlist",cancel:!1};d.trigger(u,c,(function(e){if(e.cancel)s.updateCheckState(o,"check");else{(0,t.addClass)([n.querySelector("."+hr)],ur),h&&(0,t.addClass)([h.querySelector("."+hr)],ur),s.updateSelectedNodes(n,"check");var r=s.parent.pivotCommon.dataSourceUpdate.getNewField(i,p.fieldItem);s.updateReportSettings(r,e),s.updateNodeStateChange(i,o,a)}}))}else{var g={cancel:!1,fieldName:i,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:p.fieldItem,axis:p.axis};d.trigger(Le,g,(function(e){e.cancel?s.updateCheckState(o,"uncheck"):((0,t.removeClass)([n.querySelector("."+hr)],ur),h&&(0,t.isNullOrUndefined)(h.querySelector("."+pa+" ."+Ha))&&(0,t.removeClass)([h.querySelector("."+hr)],ur),s.updateSelectedNodes(n,"uncheck"),s.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"pivot"===s.parent.dataType&&s.parent.showValuesButton&&s.parent.dataSourceSettings.values.length>1&&p&&p.position<s.parent.dataSourceSettings.valueIndex&&("row"===s.parent.dataSourceSettings.valueAxis&&"rows"===p.axis||"column"===s.parent.dataSourceSettings.valueAxis&&"columns"===p.axis)&&d.setProperties({dataSourceSettings:{valueIndex:s.parent.dataSourceSettings.valueIndex-1}},!0),"olap"===s.parent.dataType&&0===s.parent.dataSourceSettings.values.length&&s.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]"),s.updateNodeStateChange(i,o,a))}))}},e.prototype.updateReportSettings=function(e,i){var a=i.dropPosition,r=i.dropAxis;if("pivot"===this.parent.dataType&&this.parent.showValuesButton&&this.parent.dataSourceSettings.values.length>1){var n="row"===this.parent.dataSourceSettings.valueAxis&&"rows"===r?this.parent.dataSourceSettings.rows:"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===r?this.parent.dataSourceSettings.columns:void 0;(0,t.isNullOrUndefined)(n)||(-1===a&&-1===this.parent.dataSourceSettings.valueIndex?this.parent.setProperties({dataSourceSettings:{valueIndex:n.length}},!0):a>-1&&a<=this.parent.dataSourceSettings.valueIndex?this.parent.setProperties({dataSourceSettings:{valueIndex:this.parent.dataSourceSettings.valueIndex+1}},!0):this.parent.dataSourceSettings.valueIndex>-1&&a>this.parent.dataSourceSettings.valueIndex&&(a-=1))}switch(r){case"filters":-1!==a?this.parent.dataSourceSettings.filters.splice(a,0,e):this.parent.dataSourceSettings.filters.push(e);break;case"rows":-1!==a?this.parent.dataSourceSettings.rows.splice(a,0,e):this.parent.dataSourceSettings.rows.push(e);break;case"columns":-1!==a?this.parent.dataSourceSettings.columns.splice(a,0,e):this.parent.dataSourceSettings.columns.push(e);break;case"values":if(-1!==a?this.parent.dataSourceSettings.values.splice(a,0,e):this.parent.dataSourceSettings.values.push(e),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.isMeasureAvail&&!(this.parent.dataSourceSettings.values.length>1)){var s={name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0};("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push(s)}}},e.prototype.updateCheckState=function(e,t){for(var i=this.fieldTable.element.querySelectorAll("."+wn),a=this.fieldTable.element.querySelectorAll(".e-list-text"),r=0;r<i.length;r++)e.caption===a[r].textContent&&("check"===t?this.fieldTable.uncheckAll([e.id]):this.fieldTable.checkAll([e.id]))},e.prototype.updateNodeStateChange=function(e,i,a){!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate?this.parent.updateDataSource(!0):(i.isSelected=a,"olap"===this.parent.dataType&&this.parent.olapEngineModule.updateFieldlistData(e,a),this.updateDataSource());var r=this.treeViewElement.querySelector('[data-uid="'+e+'"]');r.focus(),(0,t.removeClass)([r],"e-hover");var n=this.parent;setTimeout((function(){n.axisFieldModule.render()}))},e.prototype.updateSelectedNodes=function(e,i){if(e&&e.querySelector("ul"))for(var a=0,r=[].slice.call(e.querySelectorAll("li"));a<r.length;a++){var n=r[a];"check"===i?(0,t.addClass)([n.querySelector("."+hr)],ur):(0,t.removeClass)([n.querySelector("."+hr)],ur)}},e.prototype.updateDataSource=function(){this.parent.isPopupView?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(Ge,this)):this.parent.triggerPopulateEvent()},e.prototype.addNode=function(e,i,a,n){var s=this;n=(0,t.isNullOrUndefined)(n)?e.node:n,i=(0,t.isNullOrUndefined)(i)?n.getAttribute("data-uid"):i;var o=this.parent.pivotFieldList[i];if(!(0,t.isNullOrUndefined)(e)){if(this.isSpaceKey=e.event.key&&" "===e.event.key,(0,t.isNullOrUndefined)(o)||e.node.classList.contains(Ki)||e.event.target&&(e.event.target.classList.contains(ns)||e.event.target.classList.contains(ss))||e.event.key&&"Enter"!==e.event.key)return;a=!1;var l=this.fieldTable.getNode(e.node);e.event&&e.event.target&&!e.event.target.classList.contains(qa)?"true"===l.isChecked?(this.fieldTable.uncheckAll([e.node]),a=!1):(this.fieldTable.checkAll([e.node]),a=!0):a="true"===l.isChecked}var d=r.getFieldInfo(o.id.toString(),this.parent),p=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;if(a){var h={fieldName:d.fieldName,dropField:d.fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:["filters","columns","rows","values"][this.parent.dialogRenderer.adaptiveElement.selectedItem],draggedAxis:"fieldlist",cancel:!1};p.trigger(u,h,(function(e){e.cancel?s.updateCheckState(o,"check"):s.selectedNodes.push(o.id.toString())}))}else{var c={cancel:!1,fieldName:d.fieldName,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:d.fieldItem,axis:d.axis};p.trigger(Le,c,(function(e){if(e.cancel)s.updateCheckState(o,"uncheck");else for(var t=s.selectedNodes.length;t--;)if(s.selectedNodes[t]===o.id.toString()){s.selectedNodes.splice(t,1);break}}))}},e.prototype.refreshTreeView=function(){if(this.fieldTable){var e=this.getUpdatedData();this.fieldTable.fields={dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},this.fieldTable.dataBind()}},e.prototype.getUpdatedData=function(){var e=this.getTreeData(),t=this.fieldTable.expandedNodes;return this.updateExpandedNodes(e,t),this.applySorting(e,this.fieldListSort)},e.prototype.getTreeData=function(e){var i=[];if("olap"===this.parent.dataType)i=this.getOlapTreeData(e);else{for(var a=this.parent.pivotFieldList?Object.keys(this.parent.pivotFieldList):[],r={},n=0,s=a;n<s.length;n++){var o=s[n],l=this.parent.pivotFieldList[o];if(r[o]={id:l.id,pid:l.pid,caption:l.caption,isSelected:l.isSelected},!(0,t.isNullOrUndefined)(l.pid)&&!r[o].hasChildren){var d=l.pid+"_group_name";r[o].pid=d,r[d]={id:d,caption:l.pid,isSelected:r[d]&&r[d].isSelected?r[d].isSelected:l.isSelected,hasChildren:!0}}}if(this.parent.isAdaptive){for(var p=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],h=a.length;h--;)r[a[h]].isSelected=!1;for(var u=0,c=p;u<c.length;u++){r[c[u].name].isSelected=!0}}for(var g=0,m=Object.keys(r);g<m.length;g++){var f=r[l=m[g]];i.push(f)}}return i},e.prototype.getOlapTreeData=function(e){var i=[],a=this.parent.olapEngineModule.fieldListData?this.parent.olapEngineModule.fieldListData:[];if(this.parent.isAdaptive)for(var n=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],s=0;s<a.length;){var o=a[s],l=void 0;if(3===e){if("[measures]"!==o.id.toLowerCase()&&(0===o.id.toLowerCase().indexOf("[measures]")||o.spriteCssClass&&-1!==o.spriteCssClass.indexOf("e-measureCDB"))||"[calculated members].[_0]"===o.id.toLowerCase()||o.spriteCssClass&&-1!==o.spriteCssClass.indexOf("e-calc-measure-icon")){(l={id:o.id,caption:o.caption,hasChildren:o.hasChildren,type:o.type,aggregateType:o.aggregateType,isSelected:o.isSelected,pid:o.pid,spriteCssClass:o.spriteCssClass}).isSelected=!1,l.spriteCssClass&&-1!==l.spriteCssClass.indexOf("e-measureCDB")&&(l.spriteCssClass=l.spriteCssClass.replace("e-folderCDB-icon","e-measureGroupCDB-icon"),l.pid=void 0);for(var d=0,p=n;d<p.length;d++){var h=p[d];if(l.id===h.name){l.isSelected=!0;break}}i.push(l)}}else if(!(0===o.id.toLowerCase().indexOf("[measures]")||o.spriteCssClass&&-1!==o.spriteCssClass.indexOf("e-measureCDB")||o.spriteCssClass&&-1!==o.spriteCssClass.indexOf("e-calc-measure-icon"))){(l={id:o.id,caption:o.caption,hasChildren:o.hasChildren,type:o.type,aggregateType:o.aggregateType,isSelected:o.isSelected,pid:o.pid,spriteCssClass:o.spriteCssClass}).isSelected=!1;for(var u=0,c=n;u<c.length;u++){var g=c[u];if(l.id===g.name){l.isSelected=!0;break}}i.push(l)}s++}else i=(0,t.isNullOrUndefined)(this.parent.olapEngineModule.fieldListData)?[]:r.getClonedData(this.parent.olapEngineModule.fieldListData);return i},e.prototype.updateExpandedNodes=function(e,t){if(t.length>0)for(var i=0,a=0,r=e;a<r.length;a++){var n=r[a];if(t.indexOf(n.id)>-1&&(i++,n.expanded=!0,n.spriteCssClass=n.spriteCssClass&&n.spriteCssClass.toString().indexOf("e-folderCDB-icon")>-1?n.spriteCssClass.toString().replace("e-folderCDB-icon","e-folderCDB-open-icon"):n.spriteCssClass,i===t.length))break}},e.prototype.updateSorting=function(e){var i=e.target,a=i.getAttribute("data-sort");if(this.parent.actionObj.actionName=Ht,!this.parent.actionBeginMethod()){try{if(-1===i.className.indexOf("e-selected")){switch(a){case"None":this.fieldListSort="None",(0,t.addClass)([i],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Ascend":this.fieldListSort="Ascend",(0,t.addClass)([i],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-none")],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Descend":this.fieldListSort="Descend",(0,t.addClass)([i],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),(0,t.removeClass)([this.parentElement.querySelector(".e-sort-none")],"e-selected")}this.refreshTreeView()}}catch(e){this.parent.actionFailureMethod(e)}this.parent.actionObj.actionName=this.parent.getActionCompleteName(),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},e.prototype.applySorting=function(e,t){if(e.length>0)if("olap"===this.parent.dataType){var i=void 0,a=void 0;this.parent.dataSourceSettings.calculatedFieldSettings.length>0&&"[calculated members].[_0]"===e[0].id.toLowerCase()?(a=e[0],i=e[1],e.splice(0,2)):(i=e[0],e.splice(0,1)),e="Ascend"===t?e.sort((function(e,t){return e.caption>t.caption?1:t.caption>e.caption?-1:0})):"Descend"===t?e.sort((function(e,t){return e.caption<t.caption?1:t.caption<e.caption?-1:0})):e,a?e.splice(0,0,a,i):e.splice(0,0,i)}else this.fieldTable.sortOrder="Ascend"===t?"Ascending":"Descend"===t?"Descending":"None";return e},e.prototype.onFieldAdd=function(){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()},e.prototype.closeTreeDialog=function(){this.selectedNodes=[],this.fieldDialog.hide(),this.fieldDialog.destroy(),document.getElementById(this.parent.element.id+"_FieldListTreeView")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_FieldListTreeView")),this.fieldDialog=null},e.prototype.keyPress=function(e){if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireFieldListEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.updateSorting,this)},e.prototype.unWireFieldListEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.updateSorting)},e.prototype.addEventListener=function(){this.parent.on(Je,this.refreshTreeView,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Je,this.refreshTreeView)},e.prototype.destroy=function(){this.removeEventListener(),this.editorSearch&&!this.editorSearch.isDestroyed&&(this.editorSearch.destroy(),this.editorSearch=null),this.fieldSearch&&!this.fieldSearch.isDestroyed&&(this.fieldSearch.destroy(),this.fieldSearch=null),this.fieldTable&&!this.fieldTable.isDestroyed&&(this.fieldTable.destroy(),this.fieldTable=null),this.fieldDialog&&!this.fieldDialog.isDestroyed&&(this.fieldDialog.destroy(),this.fieldDialog=null)},e}(),ul=function(){function e(e){this.parent=e}return e.prototype.render=function(){if(!this.parent.isAdaptive){var e=(0,t.createElement)("div",{className:"e-axis-table "+("olap"===this.parent.dataType?"e-olap-axis-table":"")});this.leftAxisPanel=(0,t.createElement)("div",{className:ua}),this.rightAxisPanel=(0,t.createElement)("div",{className:ca}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()},e.prototype.renderAxisTable=function(){for(var e=["filters","rows","columns","values"],i=0,a=e.length;i<a;i++){var r=(0,t.createElement)("div",{className:na+"-"+e[i]}),n=(0,t.createElement)("div",{className:Zr+"-container"}),s=(0,t.createElement)("div",{className:"e-axis-header",attrs:{title:this.parent.localeObj.getConstant(e[i])}});s.innerText=this.parent.localeObj.getConstant(e[i]),n.appendChild(this.getIconupdate(e[i])),n.appendChild(s);var o=(0,t.createElement)("div",{className:fa+" e-"+e[i]}),l=void 0;l="rows"===e[i]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===e[i]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===e[i]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");var d=(0,t.createElement)("span",{className:Sa});d.innerText=l,new t.Droppable(o,{}),r.appendChild(n),r.appendChild(o),r.appendChild(d),i<=1?this.leftAxisPanel.appendChild(r):this.rightAxisPanel.appendChild(r),this.unWireEvent(o),this.wireEvent(o)}},e.prototype.getIconupdate=function(e){var i=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:Zr+"-icon-container"}),a=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:Yi+" "+Zr+"-"+e});return i.appendChild(a),i},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),t.EventHandler.add(e,"mouseleave",this.updateDropIndicator,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),t.EventHandler.remove(e,"mouseleave",this.updateDropIndicator)},e.prototype.updateDropIndicator=function(e){var i=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains(fa)&&"mouseover"===e.type){(0,t.removeClass)([].slice.call(i.querySelectorAll("."+Ia)),Fa),(0,t.removeClass)([].slice.call(i.querySelectorAll("."+Ia+"-last")),Fa);var a=[].slice.call(e.target.querySelectorAll("."+va));a.length>0&&(0,t.addClass)([a[a.length-1].querySelector("."+Ia+"-last")],Fa)}else this.parent.isDragging&&(e.target.classList.contains(Ga)||"mouseleave"!==e.type)||((0,t.removeClass)([].slice.call(i.querySelectorAll("."+Ia)),Fa),(0,t.removeClass)([].slice.call(i.querySelectorAll("."+Ia+"-last")),Fa))},e}(),cl=function(){function e(e){this.parent=e,this.menuOption=new us(this.parent),this.parent.pivotButtonModule=this,this.addEventListener(),this.parent instanceof vl&&(this.axisField=new gl(this.parent)),this.isDestroyed=!1}return e.prototype.renderPivotButton=function(e){var i,a=this;this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Container");var n,s=Array.prototype.slice.call(this.parentElement.querySelectorAll(".e-group-"+e.axis));"rows"===e.axis&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&(0,t.isNullOrUndefined)(this.parentElement.querySelector("."+Xn))&&(s.push(this.parent.groupingBarModule.rowPanel),n=this.parent.groupingBarModule.rowPanel);var o=(0,t.extend)([],e.field,null,!0),l=e.axis,d=-1,p="pivot"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton);if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&p&&this.parent.dataSourceSettings.values.length>1&&(0,t.isNullOrUndefined)(r.getFieldByName("[Measures]",o))){var h=r.getFieldByName("[Measures]",this.parent.dataSourceSettings.fieldMapping),u={name:"[Measures]",caption:this.parent.localeObj.getConstant("values"),axis:e.axis,showRemoveIcon:!h||!("showRemoveIcon"in h)||h.showRemoveIcon,allowDragAndDrop:!h||!("allowDragAndDrop"in h)||h.allowDragAndDrop};-1===this.parent.dataSourceSettings.valueIndex||this.parent.dataSourceSettings.valueIndex>o.length?(d=o.length,o.push(u),this.parent.setProperties({dataSourceSettings:{valueIndex:-1}},!0)):(d=this.parent.dataSourceSettings.valueIndex,o.splice(d,0,u))}if("pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Container"),!this.parentElement.querySelector("."+na+"-"+l))return;var c=this.parentElement.querySelector("."+na+"-"+l).querySelector("."+Sa);0===o.length?(0,t.removeClass)([c],Ki):(0,t.addClass)([c],Ki),n=this.parentElement.querySelector("."+na+"-"+l).querySelector("."+fa)}else this.parentElement=this.parent.element,(0,t.isNullOrUndefined)(this.parentElement.querySelector(".e-group-"+l))||(n=this.parentElement.querySelector(".e-group-"+l));if(n)if("pivotview"===this.parent.getModuleName()&&0===o.length)for(var g=0;g<s.length;g++){if(!(v=s[g]).classList.contains(Un)&&!v.classList.contains(Vn))(c=(0,t.createElement)("span",{className:Sa})).innerText=this.parent.groupingBarSettings.allowDragAndDrop?"rows"===l?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===l?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===l?this.parent.localeObj.getConstant("valueAxisPrompt"):"filters"===l?this.parent.localeObj.getConstant("filterAxisPrompt"):this.parent.localeObj.getConstant("allFields"):"",v.appendChild(c)}else{g=0;for(var m=o.length;g<m;g++)for(var f="pivotfieldlist"===this.parent.getModuleName()?[n]:s,S=0;S<f.length;S++){var v=f[S];if(this.parent.olapEngineModule&&(this.parent.olapEngineModule.fieldList[o[g].name]||"[Measures]"===o[g].name)||this.parent.engineModule){var y="olap"===this.parent.dataType&&("[measures]"===o[g].name.toLowerCase()||"values"===l),b="olap"===this.parent.dataType&&"values"===l;if(!v.classList.contains(Un)&&!v.classList.contains(Vn)){var C=(0,t.createElement)("div",{className:va+(0===g&&"all-fields"!==l?" e-first-btn":""),attrs:{"data-tag":l+":"+o[g].name}}),x=o[g].caption?o[g].caption:o[g].name;x=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(x):x;var w=(0,t.createElement)("div",{id:this.parent.element.id+"_"+o[g].name,className:ya+" "+o[g].name.replace(/[^A-Z0-9]/gi,""),attrs:{"data-uid":o[g].name,tabindex:"pivotview"===this.parent.getModuleName()&&this.parent.grid&&"rows"===l&&!v.classList.contains(Hn)?"-1":"0",isvalue:g===d||y&&!b?"true":"false","aria-disabled":"false","aria-label":x,"data-type":"olap"===this.parent.dataType?b?"isMeasureFieldsAvail":y?"isMeasureAvail":o[g].type:o[g].type,"data-caption":x,"data-basefield":this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(o[g].baseField):o[g].baseField,"data-baseitem":this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(o[g].baseItem):o[g].baseItem,role:"button"}}),T=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:Ia}),M=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:Ia+"-last"}),D=this.createButtonDragIcon(o[g],w),O=this.createButtonText(o,g,l,d);if(w.appendChild(O),"all-fields"!==l){if(y||o[g].isNamedSet||o[g].isCalculatedField||(-1!==["filters","values"].indexOf(l)||d===g||"olap"===this.parent.dataType&&("pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization)||this.createSortOption(w,o[g].name,o[g]),"values"!==l&&d!==g&&this.createFilterOption(w,o[g].name,l,o[g]),"values"===l&&this.getTypeStatus(o,g,w)),o[g].isCalculatedField||"CalculatedField"===o[g].type){var P=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("editCalculatedField")},className:Yi+" "+on});this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&(o[g].showEditIcon||void 0===o[g].showEditIcon)?(0,t.removeClass)([P],Ki):(0,t.addClass)([P],Ki),w.appendChild(P)}var N=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("remove")},className:Yi+" "+Pa});"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showRemoveIcon&&(o[g].showRemoveIcon||void 0===o[g].showRemoveIcon)?(0,t.removeClass)([N],Ki):(0,t.addClass)([N],Ki):o[g].showRemoveIcon||void 0===o[g].showRemoveIcon?(0,t.removeClass)([N],Ki):(0,t.addClass)([N],Ki),w.appendChild(N),C.appendChild(T),C.appendChild(w),C.appendChild(M)}else C.appendChild(T),C.appendChild(w);v.appendChild(C);var E=new Cs.Button({enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass});E.isStringTemplate=!0,E.appendTo(w),this.unWireEvent(C,g===d&&"all-fields"!==l?"values":l,y),this.wireEvent(C,g===d&&"all-fields"!==l?"values":l,y),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&(this.createDraggable(o[g],"pivotview"===this.parent.getModuleName()?O:D),(0,t.getInstance)(w.querySelector(".e-draggable"),t.Draggable).enableAutoScroll=!1)}}}if("values"===l){var I=(0,t.select)("."+Bn,this.parentElement)?(0,t.getInstance)((0,t.select)("."+Bn,this.parentElement),hs.DropDownList):null,F=function(e){var i=s[e];if(i.classList.contains(Un)&&L.parent.pivotChartModule){var a=o.map((function(e){return{text:e.caption?e.caption:e.name,value:e.name}})),r=L.parent;if(I&&i.querySelector("."+Bn))I.dataSource=a,I.value=r.chartSettings.enableMultipleAxis?a[0].value:r.pivotChartModule.currentMeasure;else{var n=(0,t.createElement)("div",{className:Bn});i.appendChild(n),I=new hs.DropDownList({dataSource:a,enableRtl:L.parent.enableRtl,locale:L.parent.locale,value:r.chartSettings.enableMultipleAxis?a[0].value:r.pivotChartModule.currentMeasure,width:200,fields:{value:"value",text:"text"},cssClass:"e-group-chart-values-drodown"+(L.parent.cssClass?" "+L.parent.cssClass:""),change:function(e){e.e&&null!==e.e&&(r.chartSettings.value=e.value)}}),I.isStringTemplate=!0,I.appendTo(n)}}},L=this;for(g=0;g<s.length;g++)F(g)}else if("columns"===l){var A=void 0,R=(0,t.select)("."+_n,this.parentElement)?(0,t.getInstance)((0,t.select)("."+_n,this.parentElement),hs.DropDownList):null;for(g=0;g<s.length;g++){if((v=s[g]).classList.contains(Vn)&&this.parent.pivotChartModule){for(var k=this.parent.pivotChartModule.currentMeasure,j=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",q=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(j).join(" - "):"",H="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,V=H.pivotValues,U=this.parent.pivotChartModule.getColumnTotalIndex(V),B=[],_=!1,G=0,z=Object.keys(V);G<z.length;G++){var W=z[G];if(_)break;var Q=Number(W);if(V[Q][0]&&"row"===V[Q][0].axis&&(0===this.parent.dataSourceSettings.rows.length||"grand sum"!==V[Q][0].type))for(var Y=V[Q][0],K="olap"===this.parent.dataType?H.tupRowInfo[Y.ordinal]:void 0,X=V[Q],J=0,Z=Object.keys(X);J<Z.length;J++){var $=Z[J],ee=Number($),te=V[Q][ee],ie="olap"===this.parent.dataType&&K&&K.measureName?K.measureName:te.actualText;if(!U[te.colIndex]&&"value"===te.axis&&"header"!==Y.type&&""!==ie&&ie===k){_=!0;var ae="olap"===this.parent.dataType?te.columnHeaders.toString().split(/~~|::/).join(" - "):te.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");B.push({value:ae,text:ae,title:(i={},i.title=ae,i)}),ae===q&&(A=B.length)}}}if(R&&v.querySelector("."+_n))R.dataSource=B,R.value=void 0!==A?B[A-1].value:B[0].value;else{var re=(0,t.createElement)("div",{className:_n});v.appendChild(re),R=new hs.DropDownList({dataSource:B,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:A?B[A-1].value:B[0]?B[0].value:"",width:"200",fields:{value:"value",text:"text",htmlAttributes:"title"},cssClass:"e-group-chart-columns-dropdown"+(this.parent.cssClass?" "+this.parent.cssClass:""),change:function(e){if(e.e&&null!==e.e){var t=a.parent.chartSettings.columnDelimiter?a.parent.chartSettings.columnDelimiter:"-";a.parent.chartSettings.columnHeader=e.value.split(" - ").join(t)}}}),R.isStringTemplate=!0,R.appendTo(re)}}}}}},e.prototype.createButtonText=function(e,i,a,r){var n,s,o;"filters"===a&&(s=this.updateButtontext(e[i].name)),void 0!==(o="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e[i].name]&&(n="DistinctCount"===(n=o.fieldList[e[i].name].aggregateType)||"number"===o.fieldList[e[i].name].type&&"include"!==o.fieldList[e[i].name].type&&"exclude"!==o.fieldList[e[i].name].type?void 0===n?"Sum":o.fieldList[e[i].name].aggregateType:"Count");var l=e[i].caption?e[i].caption:e[i].name;l=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(l):l;var d=(0,t.createElement)("span",{attrs:{title:"filters"===a?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[e[i].name].type?l:l+" ("+s+")":"olap"===this.parent.dataType?l:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===a&&"CalculatedField"!==n?this.parent.localeObj.getConstant(n)+" "+this.parent.localeObj.getConstant("of")+" "+l:l,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":r===i?"":n},className:Ca+" "+("pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&(e[i].allowDragAndDrop||void 0===e[i].allowDragAndDrop)?"":Ea:"")});return d.innerText="filters"===a?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[e[i].name].type?l:l+" ("+s+")":"olap"===this.parent.dataType?l:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===a&&"CalculatedField"!==n?this.parent.localeObj.getConstant(n)+" "+this.parent.localeObj.getConstant("of")+" "+l:l,d},e.prototype.getTypeStatus=function(e,t,i){var a=("olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e[t].name];"CalculatedField"!==a.aggregateType&&this.validateDropdown(a.type)&&this.createSummaryType(i,e[t].name,e[t])},e.prototype.validateDropdown=function(e){var t=this.parent.aggregateTypes;if("number"!==e)return t.indexOf("Count")>-1||t.indexOf("DistinctCount")>-1;for(var i=0;i<t.length;i++)if(this.parent.getAllSummaryType().indexOf(t[i])>-1)return!0;return!1},e.prototype.createSummaryType=function(e,i,a){var r=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("format")},className:Yi+" "+ta});return"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showValueTypeIcon&&a.showValueTypeIcon?(0,t.removeClass)([r],Ki):(0,t.addClass)([r],Ki):a.showValueTypeIcon?(0,t.removeClass)([r],Ki):(0,t.addClass)([r],Ki),e.appendChild(r),r},e.prototype.createMenuOption=function(e){this.menuOption.render(e,this.parentElement),this.parent.pivotButtonModule=this},e.prototype.openCalculatedFieldDialog=function(e){var i=e.target.parentElement.getAttribute("data-uid"),a=r.getFieldInfo(i,this.parent);if(this.parent.actionObj.actionName=Vt,this.parent.actionObj.fieldInfo=a,!this.parent.actionBeginMethod())try{"pivotview"===this.parent.getModuleName()?this.parent.isAdaptive&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed?(this.parent.pivotFieldListModule.element.querySelector("."+aa).click(),this.parent.pivotFieldListModule.dialogRenderer.adaptiveElement.select(4),this.parent.pivotFieldListModule.calculatedFieldModule.updateAdaptiveCalculatedField(!0,i)):(this.parent.isAdaptive||(this.parent.calculatedFieldModule.buttonCall=!0),this.parent.notify($e,{edit:!0,fieldName:i})):"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isAdaptive?(this.parent.dialogRenderer.adaptiveElement.select(4),this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!0,i),this.parent.calculatedFieldModule.buttonCall=!0):(this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),(0,t.addClass)([this.parent.element.querySelector("."+aa)],Xi)),this.parent.notify($e,{edit:!0,fieldName:i}),this.parent.calculatedFieldModule&&(this.parent.calculatedFieldModule.buttonCall=!0)))}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.createDraggable=function(e,i){this.draggable=new t.Draggable(i,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&e.allowDragAndDrop?"":"."+ya:e.allowDragAndDrop?"":"."+ya})},e.prototype.createButtonDragIcon=function(e,i){var a=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),r=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("drag")},className:Yi+" "+Na+" "+(e.allowDragAndDrop||void 0===e.allowDragAndDrop?"":Ea)});return a.appendChild(r),"pivotfieldlist"===this.parent.getModuleName()&&i.appendChild(a),a},e.prototype.createSortOption=function(e,i,a){var r,n,s;if(s="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate)r="Descending"===s.fieldList[i].sort?Ta:"";else{r="";for(var o=0;o<this.parent.dataSourceSettings.sortSettings.length;o++)this.parent.dataSourceSettings.sortSettings[o].name===i&&(r="Descending"===this.parent.dataSourceSettings.sortSettings[o].order?Ta:"")}return n="None"===s.fieldList[i].sort?(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:Yi}):(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:Yi+" "+xa+" "+r}),this.parent.dataSourceSettings.enableSorting?"pivotview"===this.parent.getModuleName()?a.showSortIcon&&this.parent.groupingBarSettings.showSortIcon?(0,t.removeClass)([n],Ki):(0,t.addClass)([n],Ki):a.showSortIcon?(0,t.removeClass)([n],Ki):(0,t.addClass)([n],Ki):(0,t.addClass)([n],Ki),e.appendChild(n),n},e.prototype.createFilterOption=function(e,i,a,n){var s,o;o="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;var l=r.getFieldByName(i,this.parent.dataSourceSettings.filterSettings);if(!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate)o.fieldList[i].filter=null===o.fieldList[i].filter?[]:o.fieldList[i].filter,s="Server"===this.parent.dataSourceSettings.mode&&!l||"Local"===this.parent.dataSourceSettings.mode&&0===o.fieldList[i].filter.length?o.fieldList[i].isExcelFilter?Oa:Da:Oa;else{s=Da;for(var d=0;d<this.parent.dataSourceSettings.filterSettings.length;d++)this.parent.dataSourceSettings.filterSettings[d].name===i&&(s=Oa)}var p=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("filter")},className:Ma+" "+Yi+" "+s});return(this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==a||this.parent.dataSourceSettings.allowMemberFilter?(0,t.removeClass)([p],Ki):(0,t.addClass)([p],Ki),"pivotview"===this.parent.getModuleName()?((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==a||this.parent.dataSourceSettings.allowMemberFilter)&&this.parent.groupingBarSettings.showFilterIcon&&n.showFilterIcon?(0,t.removeClass)([p],Ki):(0,t.addClass)([p],Ki):n.showFilterIcon&&((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==a||this.parent.dataSourceSettings.allowMemberFilter)?(0,t.removeClass)([p],Ki):(0,t.addClass)([p],Ki),e.appendChild(p),p},e.prototype.updateButtontext=function(e){var t,i,a=(t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e].filter.length,r=t.fieldList[e].filterType,n=t.fieldList[e].dateMember.length,s=t.fieldList[e].filter[0];if("olap"===this.parent.dataType)i=this.updateOlapButtonText(t,e,s,a);else if("include"===r)1===a?i=s:a>1&&(i=a===n?this.parent.localeObj.getConstant("all"):this.parent.localeObj.getConstant("multipleItems"));else if("exclude"===r){if(1===a)i=2===n?s!==t.fieldList[e].dateMember[0].actualText?s:t.fieldList[e].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(a>1){var o=void 0,l=Object.keys(t.fieldList[e].members),d=t.fieldList[e].filter;if(a===l.length-1)for(o=0;o<l.length;o++){var p=l[o];if(-1===d.indexOf(p)){i=l[o];break}}else i=this.parent.localeObj.getConstant("multipleItems")}}else i=this.parent.localeObj.getConstant("all");return i},e.prototype.updateOlapButtonText=function(e,t,i,a){var r,n=e.fieldList[t].actualFilter;if(n.length>0){var s=e.fieldList[t].members,o=[];if(e.fieldList[t].filterMembers.length>0){for(var l={},d=0,p=n;d<p.length;d++){l[c=p[d]]=c,s[c]&&(l=this.parent.pivotCommon.eventBase.getParentNode(t,c,l))}for(var h=0,u=l?Object.keys(l):[];h<u.length;h++){var c;s[c=u[h]].isSelected&&(s[c].parent&&s[s[c].parent].isSelected||o.push(c))}i=1===o.length?s[o[0]].caption:i}a=0===o.length?a:o.length}return 0===a?r=e.fieldList[t].allMember?e.fieldList[t].allMember:this.parent.localeObj.getConstant("all"):1===a?r=i:a>1&&(r=this.parent.localeObj.getConstant("multipleItems")),r},e.prototype.createDragClone=function(e){var i=(0,t.closest)(e.element,"."+ya),a=(0,t.createElement)("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"+(this.parent.cssClass?" "+this.parent.cssClass:"")}),r=(0,t.createElement)("span",{className:rr});return r.innerText=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(i.textContent):i.textContent,a.appendChild(r),document.body.appendChild(a),a},e.prototype.onDragStart=function(e){var i=this,a=(0,t.closest)(e.element,"."+ya),n=document.getElementById(this.parent.element.id+"_DragClone"),s=r.getFieldInfo(a.getAttribute("data-uid"),this.parent),o={fieldName:s.fieldName,fieldItem:s.fieldItem,axis:s.axis,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ke,o,(function(r){if(r.cancel)i.parent.isDragging=!1,i.draggable.intDestroy(e.event),(0,t.detach)(n);else{i.parent.isDragging=!0;var s=("olap"===i.parent.dataType?i.parent.olapEngineModule:i.parent.engineModule).fieldList[a.getAttribute("data-uid")],o=[za,Wa,Ya];if((0,t.addClass)([a],ir),n&&"Popup"===("pivotfieldlist"===i.parent.getModuleName()&&i.parent.renderMode)){var l=i.parent;n.style.zIndex=(l.dialogRenderer.fieldListDialog.zIndex+1).toString()}if(s&&"CalculatedField"===s.aggregateType)for(var d=0,p=o;d<p.length;d++){var h=p[d];(0,t.addClass)([i.parentElement.querySelector("."+h)],tr)}}}))},e.prototype.onDragging=function(e){this.draggable.setProperties({cursorAt:{top:!(0,t.isNullOrUndefined)(e.event.targetTouches)||t.Browser.isDevice?60:-20}})},e.prototype.onDragStop=function(e){this.parent.isDragging=!1,e.target&&e.element&&(0,t.closest)(e.element,"."+Xa)&&!(0,t.closest)(e.target,"."+Ga)&&(e.cancel=!0);var i=(0,t.closest)(e.element,"."+ya);(0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+ya)),ir),(0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+Ia)),Fa);for(var a=0,r=[za,Wa,Ya];a<r.length;a++){var n=r[a];(0,t.removeClass)([this.parentElement.querySelector("."+n)],tr)}if(this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(e.target,i)&&!e.cancel&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,i.getAttribute("data-uid")))){this.updateDataSource();this.parent.axisFieldModule.render()}},e.prototype.isButtonDropped=function(e,i){var a=(0,t.closest)(i,"."+Ga),r=(0,t.closest)(e,"."+Ga),n=!0;if(a&&a===r){for(var s=[].slice.call(a.querySelectorAll("."+ya)),o=(0,t.closest)(e,"."+va),l=void 0,d=-1,p=0,h=s.length;p<h;p++)if(s[p].id===i.id&&(l=p),o){var u=o.querySelector("."+ya);s[p].id===u.id&&(d=p)}(l===d||l===s.length-1&&-1===d)&&((0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+Ia)),Fa),n=!1)}return n},e.prototype.updateSorting=function(e){var i=(0,t.closest)(e.target,"."+ya),a=r.getFieldInfo(i?i.getAttribute("data-uid"):"",this.parent);if(!e.target.classList.contains(Ma)&&!e.target.classList.contains(Pa)&&!e.target.classList.contains(Na)&&i&&a.fieldItem&&(a.fieldItem.showSortIcon||(0,t.isNullOrUndefined)(a.fieldItem.showSortIcon))&&!a.fieldItem.isCalculatedField){if(this.parent.actionObj.actionName=Ut,this.parent.actionObj.fieldInfo=a,this.parent.actionBeginMethod())return;try{if((this.parent instanceof vl||this.parent.groupingBarSettings.showSortIcon)&&this.parent.dataSourceSettings.enableSorting&&("olap"!==this.parent.dataType||!("pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization||"pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization))){if(this.parent.pivotCommon.eventBase.updateSorting(e),this.parent.staticPivotGridModule&&(this.parent.staticPivotGridModule.actionObj=this.parent.actionObj),!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotfieldlist"!==this.parent.getModuleName()){var n={sortInfo:this.parent.lastSortInfo};this.parent.actionObj.actionInfo=n,this.updateDataSource(!0)}this.parent instanceof vl&&this.axisField.render()}}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.updateDataSource=function(e){!1===this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!1===this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotview"===this.parent.getModuleName()?this.parent.updateDataSource(e):"pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView&&this.parent.pivotGridModule?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(Ge,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent()},e.prototype.updateFiltering=function(e){var t=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,i=e.target.parentElement.getAttribute("data-uid"),a=r.getFieldInfo(i,this.parent);if(this.parent.actionObj.actionName=Bt,this.parent.actionObj.fieldInfo=a,!this.parent.actionBeginMethod())try{"pivotfieldlist"===t.getModuleName()?(0,o.showSpinner)(t.fieldListSpinnerElement):t.showWaitingPopup(),t.mouseEventArgs=e,t.filterTargetID="pivotfieldlist"!==this.parent.pivotCommon.moduleName?this.parent.element:document.getElementById(this.parent.pivotCommon.parentID+"_Container"),"Server"===t.dataSourceSettings.mode?this.parent.engineModule.fieldList[i].members&&Object.keys(this.parent.engineModule.fieldList[i].members).length>0?this.updateFilterEvents():t.getEngine("fetchFieldMembers",null,null,null,null,null,i):("pivot"!==t.dataType||this.parent.engineModule.fieldList[i].isMembersFilled||this.parent.engineModule.fetchFieldMembers(i),this.updateFilterEvents())}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.updateFilterEvents=function(){var e=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;this.parent.pivotCommon.eventBase.updateFiltering(e.mouseEventArgs);var t=e.mouseEventArgs.target;this.fieldName=t.parentElement.getAttribute("data-uid"),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.bindDialogEvents(),"pivotfieldlist"===e.getModuleName()?(0,o.hideSpinner)(e.fieldListSpinnerElement):e.hideWaitingPopup()},e.prototype.bindDialogEvents=function(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.parent.pivotCommon.filterDialog.dialogPopUp.buttons=this.buttonModel(),this.parent.pivotCommon.filterDialog.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):this.parent.dataSourceSettings.allowMemberFilter&&(this.index=0,this.updateDialogButtonEvents())},e.prototype.buttonModel=function(){return[{buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" "+Ki)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this.parent.pivotCommon.filterDialog),buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}]},e.prototype.tabSelect=function(e){this.index=e.selectedIndex,this.updateDialogButtonEvents(),(0,t.removeClass)([].slice.call(this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),e.selectedIndex>0&&(0,t.addClass)([this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===e.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab"),0===e.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.parent.pivotCommon.filterDialog.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector("."+Ua).removeAttribute("disabled"))},e.prototype.updateDialogButtonEvents=function(){this.parent.pivotCommon.filterDialog.dialogPopUp.buttons=this.buttonModel(),this.parent.pivotCommon.filterDialog.dialogPopUp.dataBind()},e.prototype.updateCustomFilter=function(){var e,i=this,a=this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector(".e-selected-tab"),n=a.getAttribute("data-fieldname"),s=a.getAttribute("data-selectedField"),o=a.getAttribute("data-type"),l=a.getAttribute("data-measure"),d=a.getAttribute("data-operator"),p=a.getAttribute("data-value1"),h=a.getAttribute("data-value2"),u="value"===o?"Value":"date"===o?"Date":"number"===o?"Number":"Label",c={name:n,type:u,measure:l,condition:d,value1:"date"===o?new Date(p):p,value2:"date"===o?new Date(h):h};if("olap"===this.parent.dataType){c.selectedField=s,this.removeDataSourceSettings(n,s,u);for(var g=0,m=this.parent.dataSourceSettings.filterSettings;g<m.length;g++){var f=m[g];f.name===n&&f.selectedField===s&&(e=f)}}else e=r.getFilterItemByName(n,this.parent.dataSourceSettings.filterSettings);if((0,t.isNullOrUndefined)(p)||""===p||["Between","NotBetween"].indexOf(d)>-1&&((0,t.isNullOrUndefined)(h)||""===h)){var S=u.toLowerCase()+((0,t.isNullOrUndefined)(p)||""===p?"_input_option_1":"_input_option_2"),v=(0,t.select)("#"+this.parent.element.id+"_"+S,a);return(0,t.addClass)([v],pn),void v.focus()}var y={cancel:!1,filterSettings:c,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings)};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Ee,y,(function(t){t.cancel||(c=t.filterSettings,e?((e=e.properties?e.properties:e).type=c.type,e.measure=c.measure,e.condition=c.condition,e.value1=c.value1,e.value2=c.value2,"olap"===i.parent.dataType&&(e.selectedField=c.selectedField)):i.parent.dataSourceSettings.filterSettings.push(c)),"Value"!==u&&(i.parent.lastFilterInfo=r.getFilterItemByName(n,i.parent.dataSourceSettings.filterSettings),i.parent.lastFilterInfo=i.parent.lastFilterInfo.properties?i.parent.lastFilterInfo.properties:i.parent.lastFilterInfo),i.parent.pivotCommon.filterDialog.dialogPopUp.close(),t.cancel||(i.refreshPivotButtonState(n,!0),i.updateDataSource(!0))}))},e.prototype.ClearFilter=function(){var e=this.parent.pivotCommon.filterDialog.dialogPopUp.element,t=e.getAttribute("data-fieldname"),i=e.querySelector(".e-selected-tab");if(this.parent.pivotCommon.filterDialog.dialogPopUp.close(),"olap"===this.parent.dataType&&i){var a=i.getAttribute("data-selectedField");this.removeDataSourceSettings(t,a)}else this.removeDataSourceSettings(t);var n=r.getFilterItemByName(t,this.parent.dataSourceSettings.filterSettings);this.refreshPivotButtonState(t,!!n),this.updateDataSource(!0)},e.prototype.removeButton=function(e){var t=this,i=e.target,a=i.parentElement.getAttribute("data-uid"),n=r.getFieldInfo(a,this.parent);if(this.parent.actionObj.actionName=_t,this.parent.actionObj.fieldInfo=n,!this.parent.actionBeginMethod()){var s={cancel:!1,fieldName:a,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:n.fieldItem,axis:n.axis};try{("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Le,s,(function(e){e.cancel||("true"===i.parentElement.getAttribute("isvalue")?(t.parent.setProperties({dataSourceSettings:{values:[]}},!0),"olap"===t.parent.dataType&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]")):(t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(a),"pivot"===t.parent.dataType&&t.parent.showValuesButton&&t.parent.dataSourceSettings.values.length>1&&n.position<t.parent.dataSourceSettings.valueIndex&&("row"===t.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===t.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&t.parent.setProperties({dataSourceSettings:{valueIndex:t.parent.dataSourceSettings.valueIndex-1}},!0),"olap"===t.parent.dataType&&0===t.parent.dataSourceSettings.values.length&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]")),"pivotfieldlist"===t.parent.getModuleName()&&t.parent.axisFieldModule.render(),t.updateDataSource())}))}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.nodeStateModified=function(e){var i=(0,t.closest)(e.node,"li"),a=i.getAttribute("data-fieldname");if("all"===i.getAttribute("data-memberId"))this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=null,"check"===e.action?this.parent.pivotCommon.filterDialog.memberTreeView.checkAll():this.parent.pivotCommon.filterDialog.memberTreeView.uncheckAll(),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[a].isHierarchy&&this.updateNodeStates(this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes(),a),this.checkedStateAll(e.action),this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=this.nodeStateModified.bind(this);else{if("olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[a].isHierarchy){var r=this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes();this.updateNodeStates(r,a)}var n=this.parent.pivotCommon.currentTreeItemsPos[i.getAttribute("data-memberId")].index;this.parent.pivotCommon.currentTreeItems[n]&&(this.parent.pivotCommon.currentTreeItems[n].isSelected="check"===e.action,this.parent.pivotCommon.currentTreeItemsPos[i.getAttribute("data-memberId")].isSelected="check"===e.action)}this.parent.pivotCommon.filterDialog.updateCheckedState()},e.prototype.checkedStateAll=function(e){for(var t={},i=0,a=this.parent.pivotCommon.searchTreeItems;i<a.length;i++){(s=a[i]).isSelected="check"===e,t[s.htmlAttributes["data-memberId"]]=s.htmlAttributes["data-memberId"]}for(var r=0,n=this.parent.pivotCommon.currentTreeItems;r<n.length;r++){var s;void 0!==t[(s=n[r]).htmlAttributes["data-memberId"]]&&(s.isSelected="check"===e,this.parent.pivotCommon.currentTreeItemsPos[s.htmlAttributes["data-memberId"]].isSelected="check"===e)}},e.prototype.updateNodeStates=function(e,t){var i=this.parent.pivotCommon.engineModule.fieldList[t],a=i.members,r=i.currrentMembers;if(i.searchMembers.length>0){for(var n=0,s=Object.keys(r);n<s.length;n++){if(r[u=s[n]]&&(r[u].isSelected=!1),a[u])if(a[u].isSelected=!1,this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+u+'"]'))(d=this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+u+'"]'))&&!d.querySelector("ul")&&this.parent.pivotCommon.eventBase.updateChildNodeStates(i.filterMembers,t,u,!1)}for(var o=0,l=e;o<l.length;o++){var d;if(a[m=l[o]])if(this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+m+'"]'))(d=this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+m+'"]'))&&!d.querySelector("ul")&&(a[m].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(i.filterMembers,t,m,!0));r[m]&&(r[m].isSelected=!0)}}else{for(var p=0,h=Object.keys(a);p<h.length;p++){var u;a[u=h[p]].isSelected&&(a[u].isSelected=!1)}for(var c=0,g=e;c<g.length;c++){var m;a[m=g[c]]&&(a[m].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(i.filterMembers,t,m,!0))}}},e.prototype.updateFilterState=function(e){var t=this,i=!1,a={items:[],name:e,type:"Include"},n="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;if("olap"===this.parent.dataType&&n&&!n.fieldList[e].isHierarchy){var s=n.fieldList[e].members,o=n.fieldList[e].currrentMembers;if(a.items=this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes(),a.levelCount=n.fieldList[e].levelCount,i=a.items.length!==this.parent.pivotCommon.filterDialog.memberTreeView.fields.dataSource.length,n.fieldList[e].searchMembers.length>0&&!i){var l=Object.keys(s).length,d=Object.keys(o).length;i=l!==d||l!==a.items.length}for(var p=0,h=a.items;p<h.length;p++){var u=h[p];n.fieldList[e].searchMembers.length>0&&o[u]?o[u].isSelected=!0:s[u]&&(s[u].isSelected=!0)}}else{for(var c=0,g=this.parent.pivotCommon.searchTreeItems;c<g.length;c++){var m=g[c];m.isSelected&&(this.parent.pivotCommon.isDateField?a.items.push(m.name):a.items.push(m.htmlAttributes["data-memberId"]))}i=a.items.length!==this.parent.pivotCommon.currentTreeItems.length}if("olap"===this.parent.dataType&&this.removeDataSourceSettings(e),this.parent.allowDeferLayoutUpdate){n.fieldList[a.name].filterType=a.type.toLowerCase(),n.fieldList[a.name].filter=[];for(var f=0;f<a.items.length;f++)n.fieldList[a.name].filter.push(a.items[f])}var S={filterSettings:a,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Ee,S,(function(n){if(a=n.filterSettings,!n.cancel){if(r.getFilterItemByName(e,t.parent.dataSourceSettings.filterSettings))for(var s=0;s<t.parent.dataSourceSettings.filterSettings.length;s++)if(t.parent.dataSourceSettings.filterSettings[s].name===e){t.parent.dataSourceSettings.filterSettings.splice(s,1);break}t.parent.dataSourceSettings.filterSettings.push(a)}if(t.parent.pivotCommon.filterDialog.dialogPopUp.close(),!n.cancel){t.refreshPivotButtonState(e,i),i||(t.removeDataSourceSettings(e),a={}),t.parent.lastFilterInfo=a;var o={filterInfo:t.parent.lastFilterInfo};t.parent.actionObj.actionInfo=o,t.updateDataSource(!0);var l=t;l.parent instanceof vl&&l.axisField.render()}for(var d=0,p=[].slice.call(t.parentElement.querySelectorAll(".e-pivot-button"));d<p.length;d++){var h=p[d];if(h.getAttribute("data-uid")===e){h.focus();break}}}))},e.prototype.refreshPivotButtonState=function(e,i){for(var a,r=0,n=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));r<n.length;r++){var s=n[r];if(s.getAttribute("data-uid")===e){a=s.querySelector("."+Ma);break}}a&&(i?((0,t.removeClass)([a],Da),(0,t.addClass)([a],Oa)):((0,t.removeClass)([a],Oa),(0,t.addClass)([a],Da)))},e.prototype.removeDataSourceSettings=function(e,t,i){for(var a=this.parent.dataSourceSettings.filterSettings,r=0,n=a.length;r<n;r++)if("olap"===this.parent.dataType&&t){if(!i&&a[r].name===e&&a[r].selectedField===t){a.splice(r,1);break}i&&a[r].type!==i&&a[r].name===e&&(a.splice(r,1),n--,r--)}else if(a[r].name===e){if(a.splice(r,1),"olap"!==this.parent.dataType)break;n--,r--}},e.prototype.updateDropIndicator=function(e){if(this.parent.isDragging&&((0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+Ia+"-last")),Fa),(0,t.removeClass)([].slice.call(this.parentElement.querySelectorAll("."+Ia)),Fa),(0,t.closest)(e.target,"."+Ga))){var i=(0,t.closest)(e.target,"."+va);(0,t.addClass)([i.querySelector("."+Ia)],Fa)}},e.prototype.wireEvent=function(e,i,a){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),a||(-1===["filters","values"].indexOf(i)&&null!==e.querySelector("."+ya)&&t.EventHandler.add(e.querySelector("."+ya),"click",this.updateSorting,this),"values"!==i&&null!==e.querySelector("."+Ma)&&t.EventHandler.add(e.querySelector("."+Ma),"click",this.updateFiltering,this),"values"===i&&null!==e.querySelector("."+ta)&&t.EventHandler.add(e.querySelector("."+ta),"click",this.createMenuOption,this)),null!==e.querySelector("."+on)&&t.EventHandler.add(e.querySelector("."+on),"click",this.openCalculatedFieldDialog,this),null!==e.querySelector("."+Pa)&&t.EventHandler.add(e.querySelector("."+Pa),"click",this.removeButton,this)},e.prototype.unWireEvent=function(e,i,a){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),a||(-1===["filters","values"].indexOf(i)&&null!==e.querySelector("."+ya)&&t.EventHandler.remove(e.querySelector("."+ya),"click",this.updateSorting),"values"!==i&&null!==e.querySelector("."+Ma)&&t.EventHandler.remove(e.querySelector("."+Ma),"click",this.updateFiltering),"values"===i&&null!==e.querySelector("."+ta)&&t.EventHandler.remove(e.querySelector("."+ta),"click",this.createMenuOption)),null!==e.querySelector("."+on)&&t.EventHandler.remove(e.querySelector("."+on),"click",this.openCalculatedFieldDialog),null!==e.querySelector("."+Pa)&&t.EventHandler.remove(e.querySelector("."+Pa),"click",this.removeButton)},e.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on(Ze,this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(Ze,this.handlers.load)},e.prototype.destroy=function(){this.menuOption&&(this.menuOption.destroy(),this.menuOption=null);var e=(0,t.select)("."+Bn,this.parentElement),i=e?(0,t.getInstance)(e,hs.DropDownList):null;i&&!i.isDestroyed&&i.destroy();var a=(e=(0,t.select)("."+_n,this.parentElement))?(0,t.getInstance)(e,hs.DropDownList):null;a&&!a.isDestroyed&&(a.destroy(),a=null),this.draggable&&!this.draggable.isDestroyed&&(this.draggable.destroy(),this.draggable=null),this.axisField&&(this.axisField=null),this.removeEventListener(),this.isDestroyed=!0},e}(),gl=function(){function e(e){this.parent=e}return e.prototype.render=function(){(!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed)&&new cl(this.parent),this.createPivotButtons()},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=this.parent.dialogRenderer.parentElement;if(t.querySelector("."+na+"-filters")&&(t.querySelector("."+na+"-filters").querySelector("."+fa).innerHTML=""),t.querySelector("."+na+"-rows")&&(t.querySelector("."+na+"-rows").querySelector("."+fa).innerHTML=""),t.querySelector("."+na+"-columns")&&(t.querySelector("."+na+"-columns").querySelector("."+fa).innerHTML=""),t.querySelector("."+na+"-values")&&(t.querySelector("."+na+"-values").querySelector("."+fa).innerHTML=""),"pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&(!(this.parent.dataSourceSettings.dataSource instanceof i.DataManager)&&this.parent.dataSourceSettings.dataSource.length>0||this.parent.dataSourceSettings.dataSource instanceof i.DataManager&&this.parent.engineModule.data&&this.parent.engineModule.data.length>0)||"olap"===this.parent.dataType&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url)for(var a=["rows","columns","values","filters"],r=0,n=e.length;r<n;r++)if(e[r]){var s={field:e[r],axis:a[r].toString()};this.parent.notify(Ze,s)}},e}(),ml=function(){function e(e){this.parent=e,this.parent.dialogRenderer=new pl(this.parent),this.parent.treeViewModule=new hl(this.parent),this.parent.axisTableModule=new ul(this.parent),this.parent.axisFieldModule=new gl(this.parent)}return e.prototype.render=function(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()},e}(),fl=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),Sl=function(e,t,i,a){var r,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(n<3?r(s):n>3?r(t,i,s):r(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s},vl=function(e){function a(t,i){var a=e.call(this,t,i)||this;return a.pivotChange=!1,a.isRequiredUpdate=!0,a.lastSortInfo={},a.lastFilterInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.isPopupView=!1,a.enableValueSorting=!1,a.request="undefined"!=typeof window?new XMLHttpRequest:null,a.remoteData=[],a.actionObj={},a.destroyEngine=!1,a.defaultFieldListOrder="None",a.isDeferUpdateApplied=!1,a}return fl(a,e),a.prototype.requiredModules=function(){var e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedField"}),e},a.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},a.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.olapEngineModule=new _o,this.dataType="olap"):(this.engineModule=new s,this.dataType="pivot"),this.isAdaptive=t.Browser.isDevice,this.globalize=new t.Internationalization(this.locale),this.renderModule=new ml(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"Add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"Apply",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption",summarizeValuesBy:"Summarize values by",baseField:"Base field",baseItem:"Base item",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",memberType:"Field Type",selectedHierarchy:"Parent Hierarchy",formatString:"Format",expressionField:"Expression",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",Currency:"Currency",Percent:"Percent",Custom:"Custom",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",caption:"Field Caption",copy:"Copy",of:"of",group:"Group",removeCalculatedField:"Are you sure you want to delete this calculated field?",yes:"Yes",no:"No",None:"None"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.isDeferLayoutUpdate=(0,t.isNullOrUndefined)(this.isDeferLayoutUpdate)&&!this.isPopupView?this.allowDeferLayoutUpdate:this.isDeferLayoutUpdate,this.wireEvent()},a.prototype.frameCustomProperties=function(e,t){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var i=this.pivotGridModule?this.pivotGridModule.pageSettings:this.pageSettings,a=!!this.pivotGridModule&&this.pivotGridModule.enablePaging,r=!!this.pivotGridModule&&this.pivotGridModule.enableVirtualization,n=this.pivotGridModule?this.pivotGridModule.enableHtmlSanitizer:this.enableHtmlSanitizer,s=this.pivotGridModule?this.pivotGridModule.localeObj:this.staticPivotGridModule?this.staticPivotGridModule.localeObj:this.localeObj,o=!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),l=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,d=!(!this.pivotGridModule||!this.pivotGridModule.allowDataCompression)&&this.pivotGridModule.allowDataCompression,p=this.pivotGridModule&&this.pivotGridModule.enableVirtualization&&this.pivotGridModule.virtualScrollSettings&&this.pivotGridModule.virtualScrollSettings.allowSinglePage;return"olap"===this.dataType?{mode:"",savedFieldList:t||void 0,savedFieldListData:e||void 0,pageSettings:i,enableValueSorting:l,isDrillThrough:o,localeObj:s,enableVirtualization:r,allowDataCompression:d}:{mode:"",savedFieldList:void 0,pageSettings:i,enableValueSorting:l,isDrillThrough:o,localeObj:s,clonedReport:this.clonedReport,globalize:this.globalize,currenyCode:this.currencyCode,enablePaging:a,enableVirtualization:r,enableHtmlSanitizer:n,allowDataCompression:d,enableOptimizedRendering:p}},a.prototype.render=function(){"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=r.generateUUID(),this.getEngine("initialRender",null,null,null,null,null,null)):new t.Fetch(this.dataSourceSettings.url,"GET").send().then((function(e){return"string"==typeof e?e:e.text()})).then(this.onReadyStateChange.bind(this)):this.initialLoad()},a.prototype.getEngine=function(e,t,i,a,n,s,o,l,d){var p=this;this.currentAction=e,this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var h={pageSettings:this.pivotGridModule?JSON.parse(this.pivotGridModule.getPageSettings()).pageSettings:void 0,enableValueSorting:this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,enableDrillThrough:!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),locale:JSON.stringify(r.getLocalizedObject(this)),enableOptimizedRendering:this.pivotGridModule&&this.pivotGridModule.enableVirtualization&&this.pivotGridModule.virtualScrollSettings&&this.pivotGridModule.virtualScrollSettings.allowSinglePage,requestType:"string",headers:{"Content-type":"application/json"}};this.request.readyState!==XMLHttpRequest.UNSENT&&this.request.readyState!==XMLHttpRequest.OPENED||(this.request.withCredentials=!1);var u={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:e,customProperties:{},internalProperties:h,drillItem:t,sortItem:i,aggregatedItem:a,calculatedItem:n,filterItem:s,memberName:o,fetchRawDataArgs:l,editArgs:d,hash:this.guid,isGroupingUpdated:"onRefresh"===this.currentAction&&this.dataSourceSettings.groupSettings.length>0||!(!this.pivotGridModule||!this.pivotGridModule.groupingModule)&&this.pivotGridModule.groupingModule.isUpdate};this.trigger(qe,u,(function(e){p.request=e.request,u.internalProperties=e.internalProperties,u.customProperties=e.customProperties,u.dataSourceSettings=e.dataSourceSettings,u.calculatedItem=e.calculatedItem,u.drillItem=e.drillItem,u.editArgs=e.editArgs,u.fetchRawDataArgs=e.fetchRawDataArgs,u.filterItem=e.filterItem,u.hash=e.hash,u.memberName=e.memberName,u.sortItem=e.sortItem})),this.request.open("POST",this.dataSourceSettings.url,!0),this.request.onreadystatechange=this.onSuccess.bind(this);for(var c=Object.keys(u.internalProperties.headers),g=0;g<c.length;g++){var m=c[g],f=String(u.internalProperties.headers[m]);this.request.setRequestHeader(m,f)}"string"===u.internalProperties.requestType?this.request.send(JSON.stringify(u)):"base64"===u.internalProperties.requestType&&this.request.send(btoa(JSON.stringify(u)))},a.prototype.onSuccess=function(){if(this.request.readyState===XMLHttpRequest.DONE){try{var e={action:this.currentAction,response:this.request.responseText};this.trigger(He,e);var i=JSON.parse(this.request.responseText);if("fetchFieldMembers"===this.currentAction){var a=JSON.parse(i.members),n=[],s={};this.engineModule.globalize=(0,t.isNullOrUndefined)(this.globalize)?new t.Internationalization:this.globalize,this.engineModule.formatFields=this.engineModule.setFormattedFields(this.dataSourceSettings.formatSettings);for(var o=r.isDateField(i.memberName,this.engineModule),l="number"===this.engineModule.fieldList[i.memberName].type,d=Object.keys(a),p=0,h=d.length;p<h;p++){var u=a[d[p]],c=o?this.engineModule.getFormattedValue(u.Name,i.memberName):{formattedText:u.Caption};s[d[p]]={index:u.Index,ordinal:u.Ordinal,isDrilled:u.IsDrilled,caption:c.formattedText},n.push({formattedText:c.formattedText,actualText:o?c.dateText:l?isNaN(Number(u.Name))?u.Name:Number(u.Name):u.Name})}this.engineModule.fieldList[i.memberName].members=s,this.engineModule.fieldList[i.memberName].dateMember=n,this.pivotButtonModule.updateFilterEvents()}else{var g=r.formatFieldList(JSON.parse(i.fieldList));if(this.engineModule.fieldList)for(d=Object.keys(this.engineModule.fieldList),p=0;p<d.length;p++)this.engineModule.fieldList[d[p]]&&g[d[p]]&&(g[d[p]].dateMember=this.engineModule.fieldList[d[p]].dateMember,g[d[p]].formattedMembers=this.engineModule.fieldList[d[p]].formattedMembers,g[d[p]].members=this.engineModule.fieldList[d[p]].members);this.engineModule.fieldList=g,this.engineModule.fields=JSON.parse(i.fields),this.engineModule.rowCount=JSON.parse(i.pivotCount).RowCount,this.engineModule.columnCount=JSON.parse(i.pivotCount).ColumnCount,this.engineModule.rowStartPos=JSON.parse(i.pivotCount).RowStartPosition,this.engineModule.colStartPos=JSON.parse(i.pivotCount).ColumnStartPosition,this.engineModule.rowFirstLvl=JSON.parse(i.pivotCount).RowFirstLevel,this.engineModule.colFirstLvl=JSON.parse(i.pivotCount).ColumnFirstLevel;for(var m=void 0,f=r.formatPivotValues(JSON.parse(i.pivotValue)),S=0;S<f.length;S++)if(f[S]&&f[S][0]&&"row"===f[S][0].axis){m=S;break}this.engineModule.headerContent=r.frameContent(f,"header",m,this),this.engineModule.pageSettings=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0;var v=JSON.parse(i.dataSourceSettings).ValueSortSettings;this.engineModule.valueSortSettings={headerText:v.HeaderText,headerDelimiter:v.HeaderDelimiter,sortOrder:v.SortOrder,columnIndex:v.ColumnIndex},this.engineModule.pivotValues=f,this.engineModule.isEmptyData=0===this.dataSourceSettings.values.length}}catch(e){this.engineModule.pivotValues=[]}"fetchFieldMembers"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotGridModule&&this.pivotGridModule.calculatedFieldModule&&this.pivotGridModule.calculatedFieldModule.isRequireUpdate&&(this.pivotGridModule.calculatedFieldModule.endDialog(),this.pivotGridModule.calculatedFieldModule.isRequireUpdate=!1))}},a.prototype.onReadyStateChange=function(e){var i=[];if("CSV"===this.dataSourceSettings.type)for(var a=e.split(/\r?\n|\r/),r=0;r<a.length;r++)(0,t.isNullOrUndefined)(a[r])||""===a[r]||i.push(a[r].split(","));else try{i=JSON.parse(e)}catch(e){i=[]}i&&i.length>0&&this.setProperties({dataSourceSettings:{dataSource:i}},!0),this.initialLoad()},a.prototype.initialLoad=function(){var e=this,i={dataSourceSettings:this.dataSourceSettings,defaultFieldListOrder:this.defaultFieldListOrder};this.trigger(l,i,(function(a){e.dataSourceSettings=a.dataSourceSettings,e.defaultFieldListOrder=i.defaultFieldListOrder,(0,t.addClass)([e.element],zi),e.enableRtl?(0,t.addClass)([e.element],Wi):(0,t.removeClass)([e.element],Wi),e.isAdaptive?(0,t.addClass)([e.element],Qi):(0,t.removeClass)([e.element],Qi),e.cssClass&&(0,t.addClass)([e.element],e.cssClass.split(" ")),e.notify(_e,{})}))},a.prototype.wireEvent=function(){this.on(_e,this.generateData,this),this.on(Ke,this.fieldListRender,this)},a.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off(_e,this.generateData),this.off(Ke,this.fieldListRender))},a.prototype.getPersistData=function(){return this.addOnPersist(["dataSourceSettings"])},a.prototype.getModuleName=function(){return"pivotfieldlist"},a.prototype.onPropertyChanged=function(i,a){for(var n=!1,s=0,o=Object.keys(i);s<o.length;s++){var l=o[s];switch(l){case"locale":e.prototype.refresh.call(this);break;case"dataSourceSettings":if(i.dataSourceSettings&&(!(0,t.isNullOrUndefined)(i.dataSourceSettings.dataSource)&&this.clonedDataSet!==i.dataSourceSettings.dataSource&&i.dataSourceSettings.groupSettings||1===Object.keys(i.dataSourceSettings).length&&"dataSource"===Object.keys(i.dataSourceSettings)[0]&&this.dataSourceSettings.groupSettings.length>0)&&(this.clonedDataSet=i.dataSourceSettings.dataSource,this.engineModule.groupingFields={}),((0,t.isNullOrUndefined)(i.dataSourceSettings.dataSource)||i.dataSourceSettings.groupSettings&&i.dataSourceSettings.groupSettings.length>0)&&("olap"!==this.dataType||(0,t.isNullOrUndefined)(i.dataSourceSettings.url))||("olap"!==this.dataType&&((0,t.isNullOrUndefined)(this.savedDataSourceSettings)||(r.updateDataSourceSettings(this.staticPivotGridModule,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),i.dataSourceSettings.dataSource&&0===i.dataSourceSettings.dataSource.length&&!(0,t.isNullOrUndefined)(this.staticPivotGridModule)&&(this.savedDataSourceSettings=r.getClonedDataSourceSettings(this.staticPivotGridModule.dataSourceSettings),this.staticPivotGridModule.setProperties({dataSourceSettings:{rows:[],columns:[],values:[],filters:[]}},!0))),"pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[],this.engineModule.groupingFieldsInfo={}):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0),(0,t.isNullOrUndefined)(this.staticPivotGridModule)||(this.staticPivotGridModule.pivotValues=[]),this.initialLoad()),r.isButtonIconRefesh(l,a,i)){if(this.isPopupView&&this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule){var d=r.cloneFieldSettings(this.dataSourceSettings.filters),p=r.cloneFieldSettings(this.dataSourceSettings.values),h=r.cloneFieldSettings(this.dataSourceSettings.rows),u=r.cloneFieldSettings(this.dataSourceSettings.columns);this.pivotGridModule.setProperties({dataSourceSettings:{rows:h,columns:u,values:p,filters:d}},!0),this.pivotGridModule.axisFieldModule.render()}else if(!this.isPopupView&&this.staticPivotGridModule&&!this.staticPivotGridModule.isDestroyed){var c=this.staticPivotGridModule;if(c.showGroupingBar&&c.groupingBarModule&&c.axisFieldModule.render(),c.showFieldList&&c.pivotFieldListModule){h=r.cloneFieldSettings(c.dataSourceSettings.rows),u=r.cloneFieldSettings(c.dataSourceSettings.columns),p=r.cloneFieldSettings(c.dataSourceSettings.values),d=r.cloneFieldSettings(c.dataSourceSettings.filters);c.pivotFieldListModule.setProperties({dataSourceSettings:{rows:h,columns:u,values:p,filters:d}},!0),c.pivotFieldListModule.axisFieldModule.render(),c.pivotFieldListModule.treeViewModule.fieldTable&&!c.isAdaptive&&c.pivotFieldListModule.notify(Je,{})}}this.axisFieldModule.render(),this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Je,{})}break;case"aggregateTypes":this.axisFieldModule&&this.axisFieldModule.render(),this.pivotGridModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({aggregateTypes:i.aggregateTypes},!0),this.pivotGridModule.axisFieldModule.render());break;case"showValuesButton":this.axisFieldModule&&this.axisFieldModule.render(),this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({showValuesButton:i.showValuesButton},!0),this.pivotGridModule.axisFieldModule.render());break;case"enableRtl":this.enableRtl?(0,t.addClass)([this.element],Wi):(0,t.removeClass)([this.element],Wi),n=!0;break;case"enableFieldSearching":this.refresh()}n&&this.fieldListRender()}},a.prototype.initEngine=function(){var e=this;if("pivot"===this.dataType){var i=(0,t.isNullOrUndefined)(this.dataSourceSettings.dataSource)?(0,t.isNullOrUndefined)(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0];if(i&&this.pivotCommon){var a="[object Array]"===Object.prototype.toString.call(i);if(a&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!a&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}}var n={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)},s=this.isPopupView?this.pivotGridModule:this;s.trigger(d,n,(function(t){if(r.updateDataSourceSettings(e,t.dataSourceSettings),"pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var i=e.dataSourceSettings.dataSource;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:"CSV"===e.dataSourceSettings.type?r.getClonedCSVData(i):r.getClonedData(i);var a=JSON.parse(e.getPersistData()).dataSourceSettings;a.dataSource=[],e.clonedReport=e.clonedReport?e.clonedReport:a}var n=e.frameCustomProperties();n.enableValueSorting=e.staticPivotGridModule?e.staticPivotGridModule.enableValueSorting:e.enableValueSorting,"Server"!==e.dataSourceSettings.mode&&e.engineModule.renderEngine(e.dataSourceSettings,n,e.aggregateCellInfo?e.getValueCellInfo.bind(e):void 0,e.onHeadersSort?e.getHeaderSortInfo.bind(e):void 0),e.pivotFieldList=e.engineModule.fieldList;var o={pivotFieldList:e.pivotFieldList,pivotValues:e.engineModule.pivotValues},l=e;s.trigger(p,o,(function(e){l.pivotFieldList=e.pivotFieldList,l.engineModule.pivotValues=e.pivotValues,l.notify(Ke,{}),l.trigger(T)}))}else if("olap"===e.dataType){r.renderOlapEngine(e),e.pivotFieldList=e.olapEngineModule.fieldList;o={pivotFieldList:e.pivotFieldList,pivotValues:e.olapEngineModule.pivotValues};var d=e;s.trigger(p,o,(function(e){d.pivotFieldList=e.pivotFieldList,d.olapEngineModule.pivotValues=e.pivotValues,d.notify(Ke,{}),d.trigger(T)}))}})),"None"!==this.defaultFieldListOrder&&this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Je,{})},a.prototype.generateData=function(){this.pivotFieldList={},this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.dataSourceSettings.dataSource instanceof i.DataManager?"pivot"===this.dataType&&this.remoteData.length>0?(this.engineModule.data=this.remoteData,this.initEngine()):setTimeout(this.getData.bind(this),100):this.notify(Ke,{}):(this.notify(Ke,{}),this.trigger(T))},a.prototype.getValueCellInfo=function(e){var t=e;return this.trigger(xe,t),t},a.prototype.getHeaderSortInfo=function(e){var t=e;return this.trigger(we,t),t},a.prototype.getData=function(){this.dataSourceSettings.dataSource.defaultQuery?this.dataSourceSettings.dataSource.executeQuery(this.dataSourceSettings.dataSource.defaultQuery).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},a.prototype.executeQuery=function(e){this.engineModule.data=e.result,this.initEngine()},a.prototype.fieldListRender=function(){var e;this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(e=this.dialogRenderer.fieldListDialog.visible,this.dialogRenderer.fieldListDialog.destroy(),(0,t.remove)(document.getElementById(this.element.id+"_Container"))),this.renderModule.render(),"Popup"===this.renderMode?(this.fieldListSpinnerElement=this.dialogRenderer.fieldListDialog.element,e&&this.dialogRenderer.fieldListDialog.show()):this.fieldListSpinnerElement=this.element.querySelector(".e-pivotfieldlist-container"),this.spinnerTemplate?(0,o.createSpinner)({target:this.fieldListSpinnerElement,template:this.spinnerTemplate,cssClass:this.cssClass?this.cssClass:void 0},this.createElement):(0,o.createSpinner)({target:this.fieldListSpinnerElement,cssClass:this.cssClass?this.cssClass:void 0},this.createElement);var i={pivotEngine:"olap"===this.dataType?this.olapEngineModule:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:"Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:(0,t.select)("#"+this.element.id+"_Container",this.element),moduleName:this.getModuleName(),enableRtl:this.enableRtl,enableHtmlSanitizer:this.enableHtmlSanitizer,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj,dataType:this.dataType,cssClass:this.cssClass};this.pivotCommon=new ws(i),this.pivotCommon.control=this,this.allowDeferLayoutUpdate&&(this.clonedDataSource=(0,t.extend)({},this.dataSourceSettings,null,!0),"olap"===this.dataType&&(this.clonedFieldListData=r.cloneOlapFieldSettings(this.olapEngineModule.fieldListData)),this.clonedFieldList=r.getClonedFieldList(this.pivotFieldList))},a.prototype.getFieldCaption=function(e){var t=this.getFields(e),i="olap"===this.dataType?this.olapEngineModule:this.engineModule;if(t.length>0&&i&&i.fieldList)for(var a=t.length;a--;)if(t[a])for(var r=0,n=t[a];r<n.length;r++){var s=n[r];s&&i.fieldList[s.name]&&(s.caption?i.fieldList[s.name].caption=s.caption:i.fieldList[s.name].caption=s.name)}},a.prototype.getFields=function(e){return[e.rows,e.columns,e.values,e.filters]},a.prototype.updateDataSource=function(e,i){this.pivotGridModule&&this.pivotGridModule.showWaitingPopup(),(0,o.showSpinner)(this.fieldListSpinnerElement);var a=this,n=a.isPopupView?a.pivotGridModule:a,s=!1,l=a.pivotGridModule&&(a.pivotGridModule.enableVirtualization||a.pivotGridModule.enablePaging)?a.pivotGridModule.pageSettings:void 0,p=Object.keys(a.lastCalcFieldInfo).length>0,h=Object.keys(a.lastSortInfo).length>0,u=Object.keys(a.lastAggregationInfo).length>0,c=Object.keys(a.lastFilterInfo).length>0,g={dataSourceSettings:r.getClonedDataSourceSettings(a.dataSourceSettings)};n.trigger(d,g,(function(o){if(l&&(h||c||u||p)||(r.updateDataSourceSettings(a,o.dataSourceSettings),r.updateDataSourceSettings(a.pivotGridModule,o.dataSourceSettings)),(0,t.isNullOrUndefined)(i)){var d=!h&&(a.staticPivotGridModule?a.staticPivotGridModule.enableValueSorting:a.enableValueSorting);if(h&&""!==a.dataSourceSettings.valueSortSettings.headerText&&(a.pivotGridModule&&a.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),a.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0)),"pivot"===a.dataType){var g=a.frameCustomProperties();g.enableValueSorting=d,g.savedFieldList=a.pivotFieldList,l&&(h||c||u||p)&&!a.allowDeferLayoutUpdate?(h&&("Server"===n.dataSourceSettings.mode?n.getEngine("onSort",null,a.lastSortInfo,null,null,null,null):a.engineModule.onSort(a.lastSortInfo),a.lastSortInfo={}),c&&("Server"===n.dataSourceSettings.mode?n.getEngine("onFilter",null,null,null,null,a.lastFilterInfo,null):a.engineModule.onFilter(a.lastFilterInfo,a.dataSourceSettings),a.lastFilterInfo={}),u&&("Server"===n.dataSourceSettings.mode?n.getEngine("onAggregation",null,null,a.lastAggregationInfo,null,null,null):a.engineModule.onAggregation(a.lastAggregationInfo),a.lastAggregationInfo={}),p&&("Server"===n.dataSourceSettings.mode?n.getEngine("onCalcOperation",null,null,null,a.lastCalcFieldInfo,null,null):a.engineModule.onCalcOperation(a.lastCalcFieldInfo,a.dataSourceSettings),a.lastCalcFieldInfo={})):("Server"===a.dataSourceSettings.mode?h?n.getEngine("onSort",null,a.lastSortInfo,null,null,null,null):u?n.getEngine("onAggregation",null,null,a.lastAggregationInfo,null,null,null):p?n.getEngine("onCalcOperation",null,null,null,a.lastCalcFieldInfo,null,null):c?n.getEngine("onFilter",null,null,null,null,a.lastFilterInfo,null):n.getEngine("onDrop",null,null,null,null,null,null):a.engineModule.renderEngine(a.dataSourceSettings,g,a.aggregateCellInfo?a.getValueCellInfo.bind(a):void 0,a.onHeadersSort?a.getHeaderSortInfo.bind(a):void 0),a.lastSortInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.lastFilterInfo={})}else s=a.updateOlapDataSource(a,h,p,s,d);a.getFieldCaption(a.dataSourceSettings)}else a.axisFieldModule.render(),a.isRequiredUpdate=!1;a.enginePopulatedEventMethod(a,e,s)}))},a.prototype.enginePopulatedEventMethod=function(e,i,a){var n=this,s=e.isPopupView?e.pivotGridModule:e,l={dataSourceSettings:e.dataSourceSettings,pivotFieldList:"pivot"===e.dataType?e.engineModule.fieldList:e.olapEngineModule.fieldList,pivotValues:"pivot"===e.dataType?e.engineModule.pivotValues:e.olapEngineModule.pivotValues};s.trigger(p,l,(function(s){e.dataSourceSettings=s.dataSourceSettings,e.pivotCommon.dataSourceSettings=e.dataSourceSettings,e.pivotFieldList=s.pivotFieldList,"olap"===e.dataType?(e.olapEngineModule.pivotValues=s.pivotValues,e.pivotCommon.engineModule=e.olapEngineModule):(e.engineModule.pivotValues=s.pivotValues,e.pivotCommon.engineModule=e.engineModule),i||!e.treeViewModule.fieldTable||e.isAdaptive||e.notify(Je,{}),e.isRequiredUpdate?(e.allowDeferLayoutUpdate&&(e.clonedDataSource=(0,t.extend)({},e.dataSourceSettings,null,!0),"olap"===n.dataType&&(n.clonedFieldListData=r.cloneOlapFieldSettings(n.olapEngineModule.fieldListData)),e.clonedFieldList=r.getClonedFieldList(e.pivotFieldList)),e.updateView(e.pivotGridModule)):n.isPopupView&&(n.isDeferLayoutUpdate||e.pivotGridModule&&e.pivotGridModule.pivotDeferLayoutUpdate)&&(e.pivotGridModule.engineModule=e.engineModule,e.pivotGridModule.setProperties({dataSourceSettings:e.dataSourceSettings.properties},!0),e.pivotGridModule.notify(Ge,e),(0,o.hideSpinner)(e.fieldListSpinnerElement)),(n.isPopupView&&e.pivotGridModule&&e.pivotGridModule.allowDeferLayoutUpdate&&!e.isRequiredUpdate||!(0,t.isNullOrUndefined)(e.pivotGridModule))&&((0,o.hideSpinner)(e.fieldListSpinnerElement),e.pivotGridModule.hideWaitingPopup()),e.isRequiredUpdate=!0,!e.pivotGridModule||a?(0,o.hideSpinner)(e.fieldListSpinnerElement):e.pivotGridModule.fieldListSpinnerElement=e.fieldListSpinnerElement}));var d=this.getActionCompleteName();this.actionObj.actionName=d,this.actionObj.actionName&&this.actionCompleteMethod()},a.prototype.updateOlapDataSource=function(e,t,i,a,n){var s=e.frameCustomProperties(e.olapEngineModule.fieldListData,e.olapEngineModule.fieldList);return s.enableValueSorting=n,s.savedFieldList=e.pivotFieldList,i||t?(e.olapEngineModule.savedFieldList=e.pivotFieldList,e.olapEngineModule.savedFieldListData=e.olapEngineModule.fieldListData,i?(e.olapEngineModule.updateCalcFields(e.dataSourceSettings,e.lastCalcFieldInfo),e.lastCalcFieldInfo={},a=!e.olapEngineModule.dataFields[e.lastCalcFieldInfo.name],e.pivotGridModule&&e.pivotGridModule.hideWaitingPopup()):e.olapEngineModule.onSort(e.dataSourceSettings)):r.renderOlapEngine(e,s),e.lastSortInfo={},e.lastAggregationInfo={},e.lastCalcFieldInfo={},e.lastFilterInfo={},a},a.prototype.update=function(e){e&&(this.clonedDataSet=e.clonedDataSet,this.clonedReport=e.clonedReport,this.setProperties({dataSourceSettings:e.dataSourceSettings,showValuesButton:e.showValuesButton},!0),this.engineModule=e.engineModule,this.olapEngineModule=e.olapEngineModule,this.dataType=e.dataType,this.pivotFieldList="olap"===this.dataType?e.olapEngineModule.fieldList:e.engineModule.fieldList,this.isPopupView?this.pivotGridModule=e:this.staticPivotGridModule=e,this.getFieldCaption(e.dataSourceSettings),this.pivotCommon.engineModule="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=this,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(Je,{}),this.axisFieldModule.render(),!this.isPopupView&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=(0,t.extend)({},this.dataSourceSettings,null,!0),"olap"===this.dataType&&(this.clonedFieldListData=r.cloneOlapFieldSettings(this.olapEngineModule.fieldListData)),this.clonedFieldList=r.getClonedFieldList(this.pivotFieldList)))},a.prototype.updateView=function(e){if(e){var t="Calculated field applied"===this.actionObj.actionName&&"olap"===e.dataType;!e.element.querySelector(".e-spin-hide")||t||this.allowDeferLayoutUpdate&&!this.isDeferUpdateApplied&&!e.isInitial||e.showWaitingPopup(),e.clonedDataSet=this.clonedDataSet,e.clonedReport=this.clonedReport,e.setProperties({dataSourceSettings:this.dataSourceSettings,showValuesButton:this.showValuesButton},!0),e.engineModule=this.engineModule,e.olapEngineModule=this.olapEngineModule,e.dataType=this.dataType,this.pivotChange||(e.pivotValues="olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues);var i={dataSourceSettings:r.getClonedDataSourceSettings(e.dataSourceSettings),pivotValues:e.pivotValues};e.trigger(De,i),this.isPopupView||(this.staticPivotGridModule=e,e.isStaticRefresh=!0),this.isDeferUpdateApplied=!1,this.staticPivotGridModule&&(this.staticPivotGridModule.isServerWaitingPopup=!0),e.dataBind()}},a.prototype.triggerPopulateEvent=function(){var e=this,t=this.isPopupView?this.pivotGridModule:this,i={dataSourceSettings:this.dataSourceSettings,pivotFieldList:"olap"===this.dataType?this.olapEngineModule.fieldList:this.engineModule.fieldList,pivotValues:"olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues};t.trigger(p,i,(function(t){e.dataSourceSettings=t.dataSourceSettings,e.pivotFieldList=t.pivotFieldList,"olap"===e.dataType?e.olapEngineModule.pivotValues=t.pivotValues:e.engineModule.pivotValues=t.pivotValues}))},a.prototype.actionBeginMethod=function(){var e={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,cancel:!1};return(this.isPopupView?this.pivotGridModule:this).trigger(Ve,e),e.cancel},a.prototype.actionCompleteMethod=function(){var e={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,actionInfo:this.actionObj.actionInfo};(this.isPopupView?this.pivotGridModule:this).trigger(Ue,e),this.actionObj.actionName="",this.actionObj.actionInfo=void 0,this.actionObj.fieldInfo=void 0},a.prototype.actionFailureMethod=function(e){var t={actionName:this.actionObj.actionName,errorInfo:e};(this.isPopupView?this.pivotGridModule:this).trigger(Be,t)},a.prototype.getActionCompleteName=function(){return this.actionObj.actionName===Gt?ei:this.actionObj.actionName===Vt?Ei:this.actionObj.actionName===Ut?Ii:this.actionObj.actionName===Bt?Fi:this.actionObj.actionName===_t?Li:this.actionObj.actionName===Kt?Ai:this.actionObj.actionName===Ht?ni:this.actionObj.actionName},a.prototype.destroy=function(){this.unWireEvent(),this.engineModule&&!this.destroyEngine&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=[],this.engineModule={}),this.olapEngineModule&&!this.destroyEngine&&(this.olapEngineModule.fieldList={},this.olapEngineModule={}),this.pivotFieldList&&(this.pivotFieldList={}),this.contextMenuModule&&this.contextMenuModule.destroy(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),this.pivotCommon&&this.pivotCommon.destroy(),this.dialogRenderer&&this.dialogRenderer.destroy(),this.calculatedFieldModule&&this.calculatedFieldModule.destroy(),e.prototype.destroy.call(this),this.contextMenuModule&&(this.contextMenuModule=null),this.treeViewModule&&(this.treeViewModule=null),this.pivotButtonModule&&(this.pivotButtonModule=null),this.pivotCommon&&(this.pivotCommon=null),this.dialogRenderer&&(this.dialogRenderer=null),this.calculatedFieldModule&&(this.calculatedFieldModule=null),this.axisFieldModule&&(this.axisFieldModule=null),this.axisTableModule&&(this.axisTableModule=null),this.renderModule&&(this.renderModule=null),this.clonedDataSet&&(this.clonedDataSet=null),this.clonedReport&&(this.clonedReport=null),this.clonedFieldList&&(this.clonedFieldList=null),this.clonedFieldListData&&(this.clonedFieldListData=null),this.localeObj&&(this.localeObj=null),this.defaultLocale&&(this.defaultLocale=null),this.element.innerHTML="",(0,t.removeClass)([this.element],zi),(0,t.removeClass)([this.element],Wi),(0,t.removeClass)([this.element],Qi)},Sl([(0,t.Complex)({},Vs)],a.prototype,"dataSourceSettings",void 0),Sl([(0,t.Property)("Popup")],a.prototype,"renderMode",void 0),Sl([(0,t.Property)()],a.prototype,"target",void 0),Sl([(0,t.Property)("")],a.prototype,"cssClass",void 0),Sl([(0,t.Property)(!1)],a.prototype,"enableHtmlSanitizer",void 0),Sl([(0,t.Property)(!1)],a.prototype,"allowCalculatedField",void 0),Sl([(0,t.Property)(!1)],a.prototype,"enableFieldSearching",void 0),Sl([(0,t.Property)(!1)],a.prototype,"showValuesButton",void 0),Sl([(0,t.Property)(!1)],a.prototype,"allowDeferLayoutUpdate",void 0),Sl([(0,t.Property)(1e3)],a.prototype,"maxNodeLimitInMemberEditor",void 0),Sl([(0,t.Property)(!0)],a.prototype,"loadOnDemandInMemberEditor",void 0),Sl([(0,t.Property)()],a.prototype,"spinnerTemplate",void 0),Sl([(0,t.Property)(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],a.prototype,"aggregateTypes",void 0),Sl([(0,t.Property)("USD")],a.prototype,"currencyCode",void 0),Sl([(0,t.Event)()],a.prototype,"load",void 0),Sl([(0,t.Event)()],a.prototype,"enginePopulating",void 0),Sl([(0,t.Event)()],a.prototype,"memberFiltering",void 0),Sl([(0,t.Event)()],a.prototype,"enginePopulated",void 0),Sl([(0,t.Event)()],a.prototype,"onFieldDropped",void 0),Sl([(0,t.Event)()],a.prototype,"fieldDrop",void 0),Sl([(0,t.Event)()],a.prototype,"fieldDragStart",void 0),Sl([(0,t.Event)()],a.prototype,"aggregateCellInfo",void 0),Sl([(0,t.Event)()],a.prototype,"memberEditorOpen",void 0),Sl([(0,t.Event)()],a.prototype,"calculatedFieldCreate",void 0),Sl([(0,t.Event)()],a.prototype,"aggregateMenuOpen",void 0),Sl([(0,t.Event)()],a.prototype,"fieldRemove",void 0),Sl([(0,t.Event)()],a.prototype,"dataBound",void 0),Sl([(0,t.Event)()],a.prototype,"created",void 0),Sl([(0,t.Event)()],a.prototype,"destroyed",void 0),Sl([(0,t.Event)()],a.prototype,"beforeServiceInvoke",void 0),Sl([(0,t.Event)()],a.prototype,"afterServiceInvoke",void 0),Sl([(0,t.Event)()],a.prototype,"actionBegin",void 0),Sl([(0,t.Event)()],a.prototype,"actionComplete",void 0),Sl([(0,t.Event)()],a.prototype,"actionFailure",void 0),Sl([(0,t.Event)()],a.prototype,"onHeadersSort",void 0),a=Sl([t.NotifyPropertyChanges],a)}(t.Component),yl="Count",bl="Median",Cl="Sum",xl="DistinctCount",wl="Product",Tl="SampleStDev",Ml="PopulationStDev",Dl="SampleVar",Ol="PopulationVar",Pl="CalculatedField",Nl=function(){function e(e){this.isFormula=!1,this.isRequireUpdate=!1,this.formatTypes=["Standard","Currency","Percent","Custom","None"],this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.treeObj=null,this.droppable=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.formatText=null,this.formatType=null,this.fieldType=null,this.parentHierarchy=null,this.isEdit=!1,this.currentFieldName=null}return e.prototype.getModuleName=function(){return"calculatedField"},e.prototype.keyActionHandler=function(e){var i=e.currentTarget.querySelector(".e-node-focus");if(i)switch(e.action){case"moveRight":case"shiftE":"pivot"===this.parent.dataType&&this.displayMenu(i);break;case"delete":"LI"===i.tagName&&!i.querySelector(".e-list-icon.e-format")&&!i.querySelector(".e-list-icon").classList.contains(".e-icons")&&i.querySelector("."+Rn)&&i.querySelector("."+Rn).classList.contains("e-list-icon")&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,i);break;case"enter":var a=i.getAttribute("data-field"),r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog),n=i.getAttribute("data-type"),s=(0,t.select)("#"+this.parentID+"droppable",r.element);"pivot"===this.parent.dataType?""===s.value?s.value=n===Pl?i.getAttribute("data-uid"):'"'+n+"("+a+')"':""!==s.value&&(s.value=n===Pl?s.value+i.getAttribute("data-uid"):s.value+'"'+n+"("+a+')"'):(this.parent.olapEngineModule&&this.parent.olapEngineModule.fieldList[a]&&this.parent.olapEngineModule.fieldList[a].isCalculatedField&&(a=this.parent.olapEngineModule.fieldList[a].tag),""===s.value?s.value=a:""!==s.value&&(s.value=s.value+a))}},e.prototype.fieldClickHandler=function(e){var i=(0,t.closest)(e.event.target,"li");(e.event.target.classList.contains(zr)||e.event.target.classList.contains(on)||e.event.target.classList.contains(ln)||e.event.target.classList.contains(Rn))&&(this.parent.isAdaptive?"olap"===this.parent.dataType&&this.parent.isAdaptive&&("LI"===i.tagName&&i.querySelector(".e-list-edit-icon").classList.contains(on)&&e.event.target.classList.contains(on)?(this.isEdit=!0,this.currentFieldName=i.getAttribute("data-field"),this.fieldText=i.getAttribute("data-caption"),this.formulaText=i.getAttribute("data-formula"),this.formatType=i.getAttribute("data-formatString"),this.formatText="Custom"===this.formatType?i.getAttribute("data-customformatstring"):null,this.fieldType=i.getAttribute("data-membertype"),this.parentHierarchy="Dimension"===this.fieldType?i.getAttribute("data-hierarchy"):null,(0,t.addClass)([i.querySelector(".e-list-edit-icon")],ln),(0,t.removeClass)([i.querySelector(".e-list-edit-icon")],on),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):"LI"===i.tagName&&i.querySelector(".e-list-edit-icon").classList.contains(ln)&&e.event.target.classList.contains(ln)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,this.parentHierarchy=this.fieldType=this.formatType=null,(0,t.addClass)([i.querySelector(".e-list-edit-icon")],on),(0,t.removeClass)([i.querySelector(".e-list-edit-icon")],ln)):"LI"===i.tagName&&i.querySelector("."+Rn).classList.contains("e-icons")&&e.event.target.classList.contains(Rn)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,e.node)):this.displayMenu(i,e.node,e.event.target))},e.prototype.accordionClickHandler=function(e){if(e.item&&-1!==e.item.iconCss.indexOf("e-list-icon")&&(0,t.closest)(e.originalEvent.target,".e-acrdn-header-icon")){var i=(0,t.closest)(e.originalEvent.target,".e-acrdn-header").querySelector("."+jr),a=i.getAttribute("data-field"),n=i.getAttribute("data-caption"),s=r.getFieldByName(a,this.parent.dataSourceSettings.formatSettings),o=(0,t.closest)(e.originalEvent.target,".e-acrdn-header-icon");if(s){var l=this.getFormat(s.format),d=l?this.formatTypes.indexOf(l)>-1?s.format:"Custom":"None";this.formatType=d}o.querySelector("."+on)&&e.originalEvent.target.classList.contains(on)?(this.isEdit=!0,this.currentFieldName=a,this.fieldText=n||a,this.formulaText=this.parent.engineModule.fieldList[a].formula,this.formatText=s?s.format:"",(0,t.addClass)([o.querySelector(".e-list-icon")],ln),(0,t.removeClass)([o.querySelector(".e-list-icon")],on),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):o.querySelector("."+ln)&&e.originalEvent.target.classList.contains(ln)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,(0,t.addClass)([o.querySelector(".e-list-icon")],on),(0,t.removeClass)([o.querySelector(".e-list-icon")],ln)):o.querySelector("."+Rn)&&e.originalEvent.target.classList.contains(Rn)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,i)}},e.prototype.accordionCreated=function(){for(var e=(0,t.getInstance)((0,t.select)("#"+this.parentID+"accordDiv",document),ds.Accordion).element.querySelectorAll(".e-acrdn-item"),i=0;i<e.length;i++)if(e[i].querySelector("."+on)||e[i].querySelector("."+ln)){var a=(0,t.createElement)("span",{className:"e-list-icon "+Rn+" e-icons"});(0,t.append)([a],e[i].querySelector(".e-acrdn-header-icon")),(0,t.addClass)([e[i]],"e-select")}},e.prototype.clearFormula=function(){this.treeObj&&this.treeObj.element.querySelector("li")&&((0,t.removeClass)(this.treeObj.element.querySelectorAll("li"),"e-active"),this.displayMenu(this.treeObj.element.querySelector("li")))},e.prototype.displayMenu=function(e,i,a){var r=!a||a.classList.contains(on),n=!a||a.classList.contains(ln),s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog),l=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),ps.MaskedTextBox);try{if("pivot"!==this.parent.dataType||!e.querySelector(".e-list-icon.e-format")||!e.querySelector(".e-list-icon.e-format").classList.contains(Yi)||e.querySelector(".e-list-icon").classList.contains(ln)||e.querySelector(".e-list-icon").classList.contains(Rn)||e.querySelector(".e-list-icon").classList.contains(on)||"LI"!==e.tagName){if("LI"===e.tagName&&(e.querySelector("."+on)&&e.querySelector("."+on).classList.contains("e-list-icon")&&r||"olap"===this.parent.dataType&&e.getAttribute("data-type")===Pl&&e.classList.contains("e-active")&&(a&&!a.classList.contains(Rn)||!a))){this.isEdit=!0;var d=e.getAttribute("data-field"),p=e.getAttribute("data-caption");this.currentFieldName=d,l.value=p,l.dataBind();var h=e.getAttribute("data-formatString"),u=s.element,c=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",u),hs.DropDownList),g=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",u),ps.MaskedTextBox),m=e.getAttribute("data-customformatstring");if("olap"===this.parent.dataType){var f=e.getAttribute("data-membertype"),S=e.getAttribute("data-hierarchy"),v=e.getAttribute("data-formula"),y=(0,t.select)("#"+this.parentID+"_FieldNameTitle",u),b=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",u),hs.DropDownList),C=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",u),hs.DropDownList);y.innerText=this.parent.localeObj.getConstant("caption"),(0,t.select)("#"+this.parentID+"droppable",document).value=v,b.readonly=!0,b.value=f,b.dataBind(),"Dimension"===f&&(C.value=S)}else(0,t.addClass)(this.treeObj.element.querySelectorAll("."+ln),on),(0,t.removeClass)(this.treeObj.element.querySelectorAll("."+ln),ln),(0,t.addClass)([e.querySelector(".e-list-icon")],ln),(0,t.removeClass)([e.querySelector(".e-list-icon")],on),e.querySelector("."+ln).setAttribute("title",this.parent.localeObj.getConstant("clearCalculatedField")),(0,t.select)("#"+this.parentID+"droppable",document).value=e.getAttribute("data-uid");""!==h&&(c.value=h,c.dataBind()),g.value=m,g.dataBind()}else if("LI"===e.tagName&&(e.querySelector("."+ln)&&e.querySelector("."+ln).classList.contains("e-list-icon")&&n||"olap"===this.parent.dataType&&!e.classList.contains("e-active"))){this.isEdit=!1,l.value="",l.dataBind();u=s.element;if((g=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",u),ps.MaskedTextBox)).value="",g.dataBind(),"olap"===this.parent.dataType){C=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",u),hs.DropDownList),c=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",u),hs.DropDownList),b=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",u),hs.DropDownList);(y=(0,t.select)("#"+this.parentID+"_FieldNameTitle",u)).innerText=this.parent.localeObj.getConstant("fieldTitle"),C.index=0,C.dataBind(),c.index=0,c.dataBind(),b.index=0,b.readonly=!1,b.dataBind()}else(0,t.addClass)(this.treeObj.element.querySelectorAll("."+ln),on),(0,t.removeClass)(this.treeObj.element.querySelectorAll("."+ln),ln),e.querySelector("."+on).setAttribute("title",this.parent.localeObj.getConstant("edit"));(0,t.select)("#"+this.parentID+"droppable",document).value=""}else if("LI"===e.tagName&&e.querySelector("."+Rn)&&e.querySelector("."+Rn).classList.contains("e-list-icon")&&!r&&!n){if(this.parent.actionObj.actionName=_t,this.parent.actionBeginMethod())return;var x=(0,t.select)("#"+this.parentID+"droppable",document),w={name:this.isEdit?this.currentFieldName:l.value,caption:l.value,formula:x.value};this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),w,!0,i)}}else{var T=(0,t.select)("#"+this.parentID+"CalcContextmenu",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"CalcContextmenu",document),ds.ContextMenu):null;T&&!T.isDestroyed&&T.destroy(),this.curMenu=e.querySelector("."+hr),this.openContextMenu(e)}}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.removeCalcField=function(e){var i,a=this.parent.dataSourceSettings,r=e.getAttribute("data-field"),n=a.calculatedFieldSettings;"pivot"===this.parent.dataType&&(this.parent.isAdaptive?"number"==typeof(p=parseInt(e.getAttribute("id").split(this.parentID+"_")[1],10))&&(0,t.getInstance)((0,t.select)("#"+this.parentID+"accordDiv",document),ds.Accordion).hideItem(p):this.treeObj.removeNodes([e]));for(var s=0;s<n.length;s++)if(n[s]&&n[s].name===r){n.splice(s,1);break}if("olap"===this.parent.dataType){for(var o=(i=this.parent.olapEngineModule).fieldListData?i.fieldListData:[],l=0,d=Object.keys(o);l<d.length;l++){var p,h=d[l];if(o[parseInt(h,10)].name===r)if("number"==typeof(p=parseInt(h,10))){o.splice(p,1);break}}var u=this.treeObj.getNode(e).parentID;this.treeObj.removeNodes([e]),n.length<=0&&this.treeObj.removeNodes([u])}else i=this.parent.engineModule;if(i.fields)for(s=0;s<i.fields.length;s++)if(i.fields[s]===r){i.fields.splice(s,1);break}i.savedFieldList&&i.savedFieldList[r]&&delete i.savedFieldList[r],i.fieldList&&i.fieldList[r]&&delete i.fieldList[r];var c=a.formatSettings;for(s=0;s<c.length;s++)if(c[s]&&c[s].name===r){c.splice(s,1);break}for(var g=[a.values,a.rows,a.columns,a.filters],m=(s=0,g.length);s<m;s++)for(var f=0,S=g[s].length;f<S;f++)if(g[s][f].name===r){g[s].splice(f,1);break}if(this.isEdit&&this.currentFieldName===r){var v=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),ps.MaskedTextBox);this.isEdit=!1,v.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null}(!this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&!this.parent.pivotGridModule.pivotDeferLayoutUpdate||"pivotfieldlist"!==this.parent.getModuleName())&&this.parent.updateDataSource(),this.closeErrorDialog()},e.prototype.openContextMenu=function(e){var i=this,a=e.getAttribute("data-field"),r="number"!==this.parent.engineModule.fieldList[a].type?"string":"number",n="string"===r?this.getValidSummaryType().slice(0,2):this.getValidSummaryType(),s={cancel:!1,fieldName:a,aggregateTypes:this.getMenuItems(r).slice()};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Re,s,(function(a){if(!a.cancel){for(var r=[],s=[],o=0,l=a.aggregateTypes;o<l.length;o++){var d=l[o];n.indexOf(d)>-1&&-1===r.indexOf(d)&&(r.push(d),s.push({id:i.parent.element.id+"Calc_"+d,text:i.parent.localeObj.getConstant(d)}))}i.createMenu(s,e);var p=e.getBoundingClientRect(),h=window.scrollY||document.documentElement.scrollTop,u=(0,t.getInstance)((0,t.select)("#"+i.parentID+"CalcContextmenu",document),ds.ContextMenu);i.parent.enableRtl?u.open(p.top+h,p.left-100):u.open(p.top+h,p.left+150)}}))},e.prototype.selectContextMenu=function(e){if(null!==e.element.textContent){var i=(0,t.closest)(this.curMenu,".e-list-item").getAttribute("data-caption");(0,t.closest)(this.curMenu,".e-list-item").setAttribute("data-type",e.element.id.split("_").pop()),this.curMenu.textContent=i+" ("+e.element.textContent+")",(0,t.addClass)([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","0"),this.curMenu.parentElement.parentElement.focus()}},e.prototype.createMenu=function(e,i){var a,r=this,n={cssClass:this.parentID+"calculatedmenu"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:e,enableRtl:this.parent.enableRtl,locale:this.parent.locale,select:this.selectContextMenu.bind(this),onClose:function(){r.treeObj.element.focus(),(0,t.addClass)([i],["e-hover","e-node-focus"])}};a=(0,t.select)("#"+this.parentID+"CalcContextmenu",document)?(0,t.select)("#"+this.parentID+"CalcContextmenu",document):(0,t.createElement)("ul",{id:this.parentID+"CalcContextmenu"}),(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog).element.appendChild(a);var s=new ds.ContextMenu(n);s.isStringTemplate=!0,s.appendTo(a)},e.prototype.applyFormula=function(){var e=this,i=this,a=!1;(0,t.removeClass)([document.getElementById(this.parentID+"ddlelement")],pn);var n=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),ps.MaskedTextBox);this.newFields=(0,t.extend)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0);var s={fieldName:this.isEdit?this.currentFieldName:n.value,calculatedField:this.getCalculatedFieldInfo(),calculatedFieldSettings:r.cloneCalculatedFieldSettings(this.parent.dataSourceSettings.calculatedFieldSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(Ie,s,(function(r){if(r.cancel)e.endDialog(),e.parent.lastCalcFieldInfo={},e.isFormula=!1;else{var n=r.calculatedField;if(!e.isEdit)if("olap"===i.parent.dataType){var s=n.name;i.parent.olapEngineModule.fieldList[s]&&"CalculatedField"!==i.parent.olapEngineModule.fieldList[s].type&&(a=!0)}else for(var o=0,l=Object.keys(i.parent.engineModule.fieldList);o<l.length;o++){var d=l[o];n.name&&n.name===d&&"CalculatedField"!==i.parent.engineModule.fieldList[d].aggregateType&&(a=!0)}if(a)return void i.parent.pivotCommon.errorDialog.createErrorDialog(i.parent.localeObj.getConstant("error"),i.parent.localeObj.getConstant("fieldExist"));e.existingReport=(0,t.extend)({},e.parent.dataSourceSettings,null,!0);var p=e.parent.dataSourceSettings;if((0,t.isNullOrUndefined)(n.name)||""===n.name||(0,t.isNullOrUndefined)(n.caption)||""===n.caption||!n.formula||""===n.formula){if((0,t.isNullOrUndefined)(n.name)||""===n.name||(0,t.isNullOrUndefined)(n.caption)||""===n.caption)(0,t.getInstance)((0,t.select)("#"+e.parentID+"ddlelement",document),ps.MaskedTextBox).value="",(0,t.addClass)([document.getElementById(e.parentID+"ddlelement")],pn),document.getElementById(e.parentID+"ddlelement").focus();else e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("invalidFormula"))}else{s=void 0;if("olap"===e.parent.dataType){if(s={name:n.name,formula:n.formula,formatString:n.formatString},(0,t.isNullOrUndefined)(n.hierarchyUniqueName)||(s.hierarchyUniqueName=n.hierarchyUniqueName),e.isFieldExist=!1,e.isEdit){for(S=0;S<p.calculatedFieldSettings.length;S++)if(p.calculatedFieldSettings[S].name===s.name&&e.isEdit){p.calculatedFieldSettings[S].hierarchyUniqueName=n.hierarchyUniqueName,e.parent.olapEngineModule.fieldList[s.name].caption=n.caption,p.calculatedFieldSettings[S].formatString=s.formatString,p.calculatedFieldSettings[S].formula=s.formula,s=p.calculatedFieldSettings[S],e.updateFormatSettings(p,s.name,n.formatString),e.parent.olapEngineModule.getFormattedFields(p.formatSettings),e.parent.olapEngineModule.formatFields[s.name]&&(e.parent.olapEngineModule.formatFields[s.name].format?e.parent.olapEngineModule.formatFields[s.name].format=e.getFormat(s.formatString):delete e.parent.olapEngineModule.formatFields[s.name]),e.isFieldExist=!0;break}for(var h=!1,u=0,c=[p.rows,p.columns,p.values,p.filters];u<c.length;u++){for(var g=0,m=c[u];g<m.length;g++){var f=m[g];if(f.isCalculatedField&&null!==s.name&&f.name===s.name&&e.isEdit){f.caption=n.caption,e.isFieldExist=!0,h=!0;break}}if(h)break}}else for(var S=0;S<p.calculatedFieldSettings.length;S++)if(p.calculatedFieldSettings[S].name===s.name)return void e.createConfirmDialog(i.parent.localeObj.getConstant("alert"),i.parent.localeObj.getConstant("confirmText"),n);e.isFieldExist||(p.calculatedFieldSettings.push(s),e.updateFormatSettings(p,s.name,n.formatString),e.parent.olapEngineModule.getFormattedFields(p.formatSettings),e.parent.olapEngineModule.formatFields[s.name]&&(e.parent.olapEngineModule.formatFields[s.name].format?e.parent.olapEngineModule.formatFields[s.name].format=e.getFormat(s.formatString):delete e.parent.olapEngineModule.formatFields[s.name])),e.parent.lastCalcFieldInfo=s}else{s={name:n.name,caption:n.caption,type:"CalculatedField"};var v={name:n.name,formula:n.formula};if((0,t.isNullOrUndefined)(n.formatString)||(v.formatString=n.formatString),e.isFieldExist=!0,e.isEdit){for(S=0;S<p.values.length;S++)if(p.values[S].type===Pl&&null!==s.name&&p.values[S].name===s.name&&e.isEdit)for(y=0;y<p.calculatedFieldSettings.length;y++)p.calculatedFieldSettings[y].name===s.name&&(p.values[S].caption=n.caption,e.currentFormula=p.calculatedFieldSettings[y].formula,p.calculatedFieldSettings[y].formula=n.formula,e.parent.engineModule.fieldList[s.name].caption=n.caption,e.updateFormatSettings(p,s.name,n.formatString),e.isFieldExist=!1)}else for(var S=0;S<p.values.length;S++)if(p.values[S].type===Pl&&p.values[S].name===s.name){for(var y=0;y<p.calculatedFieldSettings.length;y++)if(p.calculatedFieldSettings[y].name===s.name)return void e.createConfirmDialog(i.parent.localeObj.getConstant("alert"),i.parent.localeObj.getConstant("confirmText"),n);e.isFieldExist=!1}e.isFieldExist&&(p.values.push(s),p.calculatedFieldSettings.push(v),e.updateFormatSettings(p,s.name,n.formatString)),e.parent.lastCalcFieldInfo=v}e.addFormula(p,s.name)}}}))},e.prototype.getCalculatedFieldInfo=function(){var e=(0,t.select)("#"+this.parentID+"calculateddialog",document),i=e?(0,t.getInstance)(e,o.Dialog):void 0,a=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),ps.MaskedTextBox),r=(0,t.select)("#"+this.parentID+"droppable",document),n=this.parent.isAdaptive?this.parent.dialogRenderer.adaptiveElement.element:i.element,s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",n),ps.MaskedTextBox),l={name:this.isEdit?this.currentFieldName:a.value,caption:a.value,formula:r.value},d=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",n),hs.DropDownList);if(l.formatString="Custom"===d.value?s.value:"None"===d.value?null:d.value,"olap"===this.parent.dataType){var p=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",n),hs.DropDownList),h=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",n),hs.DropDownList);"Dimension"===p.value&&(l.hierarchyUniqueName=h.value)}return l},e.prototype.updateFormatSettings=function(e,i,a){for(var r={name:i,format:a,useGrouping:!0},n=!1,s=0;s<e.formatSettings.length;s++)if(e.formatSettings[s].name===i){if("undefined"===a||void 0===a||""===a){e.formatSettings.splice(s,1),n=!0;break}var o=e.formatSettings[s].properties?e.formatSettings[s].properties:e.formatSettings[s];o.format=a,e.formatSettings.splice(s,1,o),n=!0;break}n||""===a||(0,t.isNullOrUndefined)(a)||e.formatSettings.push(r)},e.prototype.addFormula=function(e,t){this.isFormula=!0,this.field=t,"Server"===this.parent.dataSourceSettings.mode?r.updateDataSourceSettings(this.parent,r.getClonedDataSourceSettings(e)):this.parent.setProperties({dataSourceSettings:e},!0),"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isDeferLayoutUpdate||this.parent.pivotGridModule&&this.parent.pivotGridModule.pivotDeferLayoutUpdate)&&(this.parent.isRequiredUpdate=!1);try{var i={calculatedFieldInfo:this.parent.lastCalcFieldInfo};this.parent.actionObj.actionInfo=i;var a=this.parent.actionObj.actionName===Vt?Ei:ei;this.parent.actionObj.actionName=a,this.parent.updateDataSource(!1);var n="pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;n&&"Server"!==n.dataSourceSettings.mode?this.endDialog():this.isRequireUpdate=!0,"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode&&this.parent.isDeferLayoutUpdate&&(this.parent.pivotChange=!0)}catch(e){this.showError()}},e.prototype.endDialog=function(){this.isEdit=!1;var e=(0,t.select)("#"+this.parentID+"calculateddialog",document),i=e?(0,t.getInstance)(e,o.Dialog):void 0;if(i)i.close();else{(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),ps.MaskedTextBox).value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null;var a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element;if(this.parent.dialogRenderer.parentElement.querySelector("."+qr).value="",(0,t.select)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value="",(0,t.select)("#"+this.parentID+"Custom_Format_Element",this.parent.dialogRenderer.parentElement).value="","olap"===this.parent.dataType){var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",a),hs.DropDownList),n=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",a),hs.DropDownList);r.index=0,r.readonly=!1,r.dataBind(),n.index=0,n.enabled=!1,n.dataBind()}var s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",a),ps.MaskedTextBox),l=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",a),hs.DropDownList);l.index="olap"===this.parent.dataType?0:4,l.dataBind(),s.enabled=!1,s.dataBind()}},e.prototype.showError=function(){if(this.parent.engineModule.fieldList[this.field]&&delete this.parent.engineModule.fieldList[this.field],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),this.parent.setProperties({dataSourceSettings:this.existingReport},!0),this.isEdit){for(var e=this.parent.dataSourceSettings.calculatedFieldSettings,t=0;e&&t<e.length;t++)if(e[t].name===this.field){e[t].formula=this.currentFormula;break}}else if(this.parent.engineModule.fields)for(t=0;t<this.parent.engineModule.fields.length;t++)if(this.parent.engineModule.fields[t]===this.field){this.parent.engineModule.fields.splice(t,1);break}this.parent.lastCalcFieldInfo={},this.parent.updateDataSource(!1),this.isFormula=!1},e.prototype.getFieldListData=function(e){var i=[];if("olap"===this.parent.dataType)for(var a=0,n=i=r.getClonedData(e.olapEngineModule.fieldListData?e.olapEngineModule.fieldListData:[]);a<n.length;a++){var s=n[a];s.spriteCssClass&&(s.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||s.spriteCssClass.indexOf("e-level-members")>-1)?s.hasChildren=!0:s.spriteCssClass&&s.spriteCssClass.indexOf("e-namedSetCDB-icon")>-1?s.hasChildren=!1:s.spriteCssClass&&s.spriteCssClass.indexOf("e-calcMemberGroupCDB")>-1&&(s.expanded=this.isEdit)}else for(var o=0,l=e.engineModule.fieldList?Object.keys(e.engineModule.fieldList):[];o<l.length;o++){var d,p=l[o],h=null,u=e.engineModule.fieldList[p];h="number"===u.type&&"include"!==e.engineModule.fieldList[p].type&&"exclude"!==e.engineModule.fieldList[p].type||"DistinctCount"===u.aggregateType?void 0!==u.aggregateType?u.aggregateType:Cl:yl,d=this.parent.localeObj.getConstant(h),i.push({index:u.index,name:(this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(u.caption):u.caption)+" ("+d+")",type:h,icon:zr+" "+Yi,formula:this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(u.formula):u.formula,field:this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(p):p,caption:this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(u.caption?u.caption:p):u.caption?u.caption:p})}return i},e.prototype.fieldDropped=function(e){e.cancel=!0;var i=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog),a=(0,t.select)("#"+this.parentID+"droppable",i.element);(0,t.removeClass)([a],"e-copy-drop"),(0,t.removeClass)([e.draggedNode.querySelector("."+hr)],ir);var r=e.draggedNode.getAttribute("data-field");if("olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList[r]&&this.parent.olapEngineModule.fieldList[r].isCalculatedField&&(r=this.parent.olapEngineModule.fieldList[r].tag),e.target.id===this.parentID+"droppable"&&""===a.value)a.value=r,a.focus();else if(e.target.id===this.parentID+"droppable"&&""!==a.value){var n=a.value,s=a.selectionStart,l=n.substring(s,n.length),d=(h=n.substring(0,s))+r;a.value=h+r+l,a.focus(),a.setSelectionRange(d.length,d.length)}else e.cancel=!0;else{var p=e.draggedNode.getAttribute("data-type");if(e.target.id===this.parentID+"droppable"&&""===a.value)a.value=p===Pl?e.draggedNodeData.id.toString():'"'+p+"("+r+')"',a.focus();else if(e.target.id===this.parentID+"droppable"&&""!==a.value){d=void 0,s=a.selectionStart;var h=(n=a.value).substring(0,s);l=n.substring(s,n.length);p===Pl?(d=h+e.draggedNodeData.id.toString(),a.value=h+e.draggedNodeData.id.toString()+l):(d=h+'"'+p+"("+r+')"',a.value=h+'"'+p+"("+r+')"'+l),a.focus(),a.setSelectionRange(d.length,d.length)}else e.cancel=!0}},e.prototype.createDialog=function(){var e=this;if(null!==(0,t.select)("#"+this.parentID+"calculateddialog",document))for((0,t.remove)((0,t.select)("#"+this.parentID+"calculateddialog",document));!(0,t.isNullOrUndefined)(document.querySelector("."+this.parentID+"calculatedmenu"));)(0,t.remove)(document.querySelector("."+this.parentID+"calculatedmenu"));var i=(0,t.createElement)("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div "+("olap"===this.parent.dataType?"e-olap-calc-dialog-div":"")});this.parent.element.appendChild(i);var a=[{click:this.applyFormula.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0,cssClass:this.parent.cssClass}},{click:this.cancelClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel"),cssClass:this.parent.cssClass}}];if("olap"===this.parent.dataType){var r={click:this.clearFormula.bind(this),buttonModel:{cssClass:"e-calc-clear-btn"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("clear")}};a.splice(0,0,r)}var n=new o.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:a,close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),open:function(){(0,t.select)("#"+e.parentID+"ddlelement",n.element)&&(0,t.select)("#"+e.parentID+"ddlelement",n.element).focus()},animationSettings:{effect:"Zoom"},width:"25%",isModal:!0,closeOnEscape:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body,cssClass:this.parent.cssClass});n.isStringTemplate=!0,n.appendTo(i)},e.prototype.cancelClick=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog).close(),this.isEdit=!1},e.prototype.beforeOpen=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog).element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))},e.prototype.closeDialog=function(){"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&((0,t.addClass)([this.parent.element.querySelector("."+aa)],Xi),this.parent.dialogRenderer.fieldListDialog.show())),this.destroy(),(0,t.isNullOrUndefined)(document.getElementById(this.parentID+"calculateddialog"))||(0,t.remove)(document.getElementById(this.parentID+"calculateddialog")),(0,t.isNullOrUndefined)(document.querySelector("."+this.parentID+"calculatedmenu"))||(0,t.remove)(document.querySelector("."+this.parentID+"calculatedmenu"));var e="pivotview"===this.parent.getModuleName()||"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode?0:500;this.buttonCall&&(this.buttonCall=!1,setTimeout(this.setFocus.bind(this),e))},e.prototype.setFocus=function(){var e;if("pivotview"===this.parent.getModuleName()&&this.parent.element?e=this.parent.element:document.getElementById(this.parent.element.id+"_Container")&&(e=document.getElementById(this.parent.element.id+"_Container")),e)for(var t=0,i=[].slice.call(e.querySelectorAll(".e-pivot-button"));t<i.length;t++){var a=i[t];if(a.getAttribute("data-uid")===this.currentFieldName){a.focus();break}}},e.prototype.renderDialogElements=function(){var e=(0,t.createElement)("div",{id:this.parentID+"outerDiv",className:("olap"===this.parent.dataType?"e-olap-calc-outer-div ":"")+"e-pivot-calc-outer-div"}),i=(0,t.createElement)("div",{id:this.parentID+"Olap_Tree_Div",className:"e-olap-field-tree-div"}),a=(0,t.createElement)("div",{id:this.parentID+"Pivot_Calc_Div",className:"e-pivot-calculated-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+Wr)&&this.parent.isAdaptive){var r=(0,t.createElement)("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(r);var n=(0,t.createElement)("div",{id:this.parentID+"buttonDiv",className:Jr}),s=(0,t.createElement)("button",{id:this.parentID+"addBtn",className:"e-pivot-add-button",attrs:{type:"button"}});s.innerText=this.parent.localeObj.getConstant("add");var l=(0,t.createElement)("button",{id:this.parentID+"cancelBtn",className:"e-pivot-cancel-button",attrs:{type:"button"}});l.innerText=this.parent.localeObj.getConstant("cancel"),n.appendChild(l),n.appendChild(s),e.appendChild(n)}else{if(!this.parent.isAdaptive&&"olap"===this.parent.dataType)(f=(0,t.createElement)("div",{className:"e-pivot-field-name-title",id:this.parentID+"_FieldNameTitle"})).innerText=this.parent.localeObj.getConstant("fieldTitle"),a.appendChild(f);var d=(0,t.createElement)("div",{id:this.parentID+"innerDiv",className:"e-pivot-calc-input-div"}),p=(0,t.createElement)("input",{id:this.parentID+"ddlelement",attrs:{type:"text"},className:qr});d.appendChild(p),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(d):a.appendChild(d);var h=(0,t.createElement)("div",{id:this.parentID+"control_container",className:Yr});if(!this.parent.isAdaptive){var u=(0,t.createElement)("div",{className:an});if(u.innerText="olap"===this.parent.dataType?this.parent.localeObj.getConstant("allFields"):this.parent.localeObj.getConstant("formulaField"),"olap"===this.parent.dataType){var c=(0,t.createElement)("div",{className:an+"-container"});c.appendChild(u);var g=(0,t.createElement)("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldTooltip"),role:"button"},className:Yi+" "+dn});c.appendChild(g),new o.Tooltip({content:this.parent.localeObj.getConstant("fieldTooltip"),position:this.parent.enableRtl?"RightCenter":"LeftCenter",target:"."+dn,offsetY:(this.parent.enableRtl,-10),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:220,cssClass:this.parent.cssClass}).appendTo(c),h.appendChild(c)}else e.appendChild(u)}var m=(0,t.createElement)("div",{className:Qr+"-outer-div"});h.appendChild(m);var f,S=(0,t.createElement)("div",{id:this.parentID+"tree",className:Qr});if(m.appendChild(S),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(h):i.appendChild(h),!this.parent.isAdaptive)(f=(0,t.createElement)("div",{className:"e-pivot-formula-title"})).innerText="olap"===this.parent.dataType?this.parent.localeObj.getConstant("expressionField"):this.parent.localeObj.getConstant("formula"),"olap"===this.parent.dataType?a.appendChild(f):e.appendChild(f);var v=(0,t.createElement)("textarea",{id:this.parentID+"droppable",className:Wr+" e-control e-textbox e-input",attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):"olap"===this.parent.dataType?this.parent.localeObj.getConstant("olapDropText"):this.parent.localeObj.getConstant("dropText")}});if("olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(v):a.appendChild(v),this.parent.isAdaptive){n=(0,t.createElement)("div",{id:this.parentID+"buttonDiv",className:Jr});(O=(0,t.createElement)("button",{id:this.parentID+"okBtn",className:Xr,attrs:{type:"button"}})).innerText=this.parent.localeObj.getConstant("apply"),n.appendChild(O),e.appendChild(n)}if("olap"===this.parent.dataType){if(!this.parent.isAdaptive){var y=(0,t.createElement)("div",{className:"e-olap-member-title"});y.innerText=this.parent.localeObj.getConstant("memberType"),a.appendChild(y)}var b=(0,t.createElement)("div",{id:this.parentID+"Member_Type_Div",className:Br});if(this.parent.isAdaptive)e.appendChild(b);else{a.appendChild(b);var C=(0,t.createElement)("div",{className:"e-olap-hierarchy-title"});C.innerText=this.parent.localeObj.getConstant("selectedHierarchy"),a.appendChild(C)}var x=(0,t.createElement)("div",{id:this.parentID+"Hierarchy_List_Div",className:Vr});this.parent.isAdaptive?e.appendChild(x):a.appendChild(x)}if(!this.parent.isAdaptive){var w=(0,t.createElement)("div",{className:"e-pivot-format-title"});w.innerText=this.parent.localeObj.getConstant("formatString"),a.appendChild(w)}var T=(0,t.createElement)("div",{id:this.parentID+"Format_Div",className:Ur});this.parent.isAdaptive?e.appendChild(T):a.appendChild(T);var M=(0,t.createElement)("div",{id:this.parentID+"custom_Format_Div",className:"e-pivot-calc-custom-format-div"}),D=(0,t.createElement)("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:Hr});if(M.appendChild(D),a.appendChild(M),this.parent.isAdaptive?e.appendChild(M):a.appendChild(M),"pivotfieldlist"===this.parent.getModuleName()&&null===this.parent.dialogRenderer.parentElement.querySelector("."+Wr)&&this.parent.isAdaptive){var O=e.querySelector("."+Xr);e.appendChild(O)}else"olap"===this.parent.dataType&&e.appendChild(i),e.appendChild(a)}return e},e.prototype.renderAdaptiveLayout=function(e){var i=this.parent.dialogRenderer.adaptiveElement;if(e){if((0,t.select)("#"+this.parentID+"droppable",i.element)){var a=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),ps.MaskedTextBox);this.formulaText=(0,t.select)("#"+this.parentID+"droppable",document).value,this.fieldText=a.value}if(i.element.querySelector("."+Br)){var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",i.element),hs.DropDownList);this.fieldType=r.value}if(i.element.querySelector("."+Vr)){var n=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",i.element),hs.DropDownList);this.parentHierarchy="Dimension"===this.fieldType?n.value:null}if(i.element.querySelector("."+Ur)){var s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",i.element),hs.DropDownList);this.formatType=s.value}if(i.element.querySelector("."+Hr)){var o=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",i.element),ps.MaskedTextBox);this.formatText="Custom"===("olap"===this.parent.dataType?this.formatType:this.getFormat(this.formatType))?o.value:null}}else this.currentFieldName=this.formulaText=this.fieldText=this.formatText=null,this.fieldType=this.formatType=this.parentHierarchy=null;this.renderMobileLayout(i)},e.prototype.updateAdaptiveCalculatedField=function(e,i){var a=this.parent.dialogRenderer.adaptiveElement.element;this.isEdit=e;var n=e?"pivot"===this.parent.dataType?this.parent.engineModule.fieldList[i]:this.parent.olapEngineModule.fieldList[i]:{id:null,caption:null,formula:null,fieldType:"Measure",formatString:"pivot"===this.parent.dataType?null:"Standard",parentHierarchy:null};this.currentFieldName=n.id;var s=(0,t.getInstance)((0,t.select)("#"+this.parentID+"ddlelement",document),ps.MaskedTextBox);if((0,t.select)("#"+this.parentID+"droppable",document)&&(this.formulaText=(0,t.select)("#"+this.parentID+"droppable",document).value=n.formula,this.fieldText=s.value=n.caption,s.dataBind()),a.querySelector("."+Br)){var o=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Member_Type_Div",a),hs.DropDownList);this.fieldType=o.value=n.fieldType,o.readonly=!!e,o.dataBind()}if(a.querySelector("."+Vr)){var l=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",a),hs.DropDownList);"Dimension"===this.fieldType?this.parentHierarchy=l.value=n.parentHierarchy:(this.parentHierarchy=null,l.index=0),l.dataBind()}if(a.querySelector("."+Ur)){var d=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Format_Div",a),hs.DropDownList);this.formatType=d.value=this.formatTypes.indexOf(n.formatString)>-1?n.formatString:"Custom"}if(a.querySelector("."+Hr)){var p=(0,t.getInstance)((0,t.select)("#"+this.parentID+"Custom_Format_Element",a),ps.MaskedTextBox),h=r.getFieldByName(i,this.parent.dataSourceSettings.formatSettings);"pivot"===this.parent.dataType?this.formatText=p.value=h?h.format:null:this.formatText=p.value="Custom"===this.formatType?n.formatString:null,p.dataBind()}},e.prototype.createDropElements=function(){for(var e=this,i=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog):null,a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element,n=[],s=[],l=0,d=this.formatTypes;l<d.length;l++){var p=d[l];n.push({value:"pivot"===this.parent.dataType?this.getFormat(p):p,text:this.parent.localeObj.getConstant(p)})}if("olap"===this.parent.dataType){for(var h=[],u=0,c=["Measure","Dimension"];u<c.length;u++){var g=c[u];h.push({value:g,text:this.parent.localeObj.getConstant(g)})}for(var m=0,f=r.getClonedData(this.parent.olapEngineModule.fieldListData);m<f.length;m++){var S=f[m];S.spriteCssClass&&(S.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||S.spriteCssClass.indexOf("e-hierarchyCDB-icon")>-1)&&s.push({value:S.id,text:S.caption})}var v=new hs.DropDownList({dataSource:h,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:null!==this.fieldType?this.fieldType:h[0].value,readonly:this.isEdit,cssClass:_r+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){y.enabled="Dimension"===i.value,e.fieldType=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value,y.dataBind()}});v.isStringTemplate=!0,v.appendTo((0,t.select)("#"+this.parentID+"Member_Type_Div",a));var y=new hs.DropDownList({dataSource:s,enableRtl:this.parent.enableRtl,locale:this.parent.locale,allowFiltering:!0,enabled:"Dimension"===v.value,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+s[0].text.toString(),fields:{value:"value",text:"text"},value:null!==this.parentHierarchy&&"Dimension"===v.value?this.parentHierarchy:s[0].value,cssClass:_r+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){e.parentHierarchy=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value}});y.isStringTemplate=!0,y.appendTo((0,t.select)("#"+this.parentID+"Hierarchy_List_Div",a))}var b=new hs.DropDownList({dataSource:n,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:this.parent.isAdaptive&&null!==this.formatType?this.formatType:"olap"===this.parent.dataType?n[0].value:n[4].value,cssClass:_r+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){C.enabled="Custom"===i.value,e.formatType=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value,C.dataBind()}});b.isStringTemplate=!0,b.appendTo((0,t.select)("#"+this.parentID+"Format_Div",a));var C=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("customFormat"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,value:null!==this.formatText&&"Custom"===b.value?this.formatText:null,enabled:"Custom"===b.value,change:function(i){e.formatText=i.value,e.formulaText=(0,t.select)("#"+e.parentID+"droppable",document).value},cssClass:this.parent.cssClass});C.isStringTemplate=!0,C.appendTo((0,t.select)("#"+this.parentID+"Custom_Format_Element",a))},e.prototype.getFormat=function(e){var t=e;if("olap"!==this.parent.dataType)switch(t){case"Standard":t="N";break;case"Currency":t="C";break;case"Percent":t="P";break;case"N":t="Standard";break;case"C":t="Currency";break;case"P":t="Percent"}else switch(t){case"Standard":t="N";break;case"Currency":t="C";break;case"Percent":t="P"}return t},e.prototype.createTreeView=function(){var e=this,i=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog):null,a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element;"olap"===this.parent.dataType?this.treeObj=new ds.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,nodeDragStart:this.dragStart.bind(this),nodeDragging:function(e){e.event.target&&e.event.target.classList.contains(Wr)?((0,t.removeClass)([e.clonedNode],tr),(0,t.addClass)([e.event.target],"e-copy-drop")):((0,t.addClass)([e.clonedNode],tr),(0,t.removeClass)([e.event.target],"e-copy-drop"),e.dropIndicator="e-no-drop",(0,t.addClass)([e.clonedNode.querySelector("."+Yi)],"e-icon-expandable"),(0,t.removeClass)([e.clonedNode.querySelector("."+Yi)],"e-list-icon"))},nodeClicked:this.fieldClickHandler.bind(this),nodeSelected:function(i){i.node.getAttribute("data-type")===Pl?e.displayMenu(i.node):((0,t.removeClass)([i.node],"e-active"),i.cancel=!0)},nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),sortOrder:"None",cssClass:this.parent.cssClass}):this.treeObj=new ds.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,cssClass:this.parent.cssClass,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),keyPress:function(e){39===e.event.keyCode&&(e.cancel=!0)},sortOrder:"Ascending"}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo((0,t.select)("#"+this.parentID+"tree",a))},e.prototype.updateNodeIcon=function(e){if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable.e-process")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-icon"),(0,t.addClass)([i],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){i=e.node.querySelector(".e-list-icon");(0,t.removeClass)([i],"e-folderCDB-open-icon"),(0,t.addClass)([i],"e-folderCDB-icon")}else{for(var a=this.treeObj.fields.dataSource,r=[],n=0,s=a;n<s.length;n++){var o=s[n];o.pid===e.nodeData.id.toString()&&r.push(o)}if(0!==r.length)return;this.parent.olapEngineModule.calcChildMembers=[],this.parent.olapEngineModule.getCalcChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString()),r=this.parent.olapEngineModule.calcChildMembers,this.parent.olapEngineModule.calcChildMembers=[];for(var l=0,d=r;l<d.length;l++){(i=d[l]).pid=e.nodeData.id.toString(),i.hasChildren=!1,i.spriteCssClass="e-level-members",i.caption=""===i.caption?this.parent.localeObj.getConstant("blank"):i.caption,a.push(i)}this.treeObj.addNodes(r,e.node)}},e.prototype.nodeCollapsing=function(e){e.cancel=!0},e.prototype.dragStart=function(e){var i=!1,a=e.clonedNode;if(a&&("olap"===this.parent.dataType&&(a.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||a.querySelector(".e-dimensionCDB-icon,.e-attributeCDB-icon,.e-hierarchyCDB-icon")||a.querySelector(".e-level-members,.e-namedSetCDB-icon"))||"pivot"===this.parent.dataType&&e.event.target.classList.contains(Na))&&(i=!0),i){(0,t.addClass)([e.draggedNode.querySelector("."+hr)],ir),(0,t.addClass)([a],"e-pivot-calc");var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog);a.style.zIndex=(r.zIndex+1).toString(),a.style.display="inline"}else e.cancel=!0},e.prototype.drawTreeNode=function(e){if("olap"===this.parent.dataType){e.node.querySelector(".e-measure-icon")&&(e.node.querySelector(".e-list-icon").style.display="none");var i=e.nodeData;e.node.setAttribute("data-field",i.id),e.node.setAttribute("data-caption",i.caption);var a=e.node.querySelector("."+rr);if(e.nodeData&&e.nodeData.type===Pl&&a&&e.node.querySelector(".e-list-icon.e-calc-member")){e.node.setAttribute("data-type",i.type),e.node.setAttribute("data-membertype",i.fieldType),e.node.setAttribute("data-hierarchy",i.parentHierarchy?i.parentHierarchy:""),e.node.setAttribute("data-formula",i.formula);var n=i.formatString?this.formatTypes.indexOf(i.formatString)>-1?i.formatString:"Custom":"None";e.node.setAttribute("data-formatString",n),e.node.setAttribute("data-customformatstring","Custom"===n?i.formatString:"");var s=(0,t.createElement)("span",{className:Rn+" e-icons e-list-icon"});if(a.classList.add("e-calcfieldmember"),this.parent.isAdaptive){var o=(0,t.createElement)("span",{className:"e-list-edit-icon"+(this.isEdit&&this.currentFieldName===i.id?" e-edited ":" e-edit ")+Yi}),l=(0,t.createElement)("div",{className:"e-list-header-icon"});l.appendChild(o),l.appendChild(s),a.appendChild(l)}else a.appendChild(s)}if(this.parent.isAdaptive){var d=e.node.querySelector("."+rr);if(e.node&&e.node.querySelector(".e-list-icon")&&d){var p=e.node.querySelector(".e-list-icon");d.insertBefore(p,e.node.querySelector(".e-list-text"))}e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon")&&(e.node.querySelector("."+wn).style.display="none"),e.node&&e.node.querySelector(".e-level-members")&&(e.node.querySelector(".e-list-icon").style.display="none")}}else{i=e.nodeData.field;e.node.setAttribute("data-field",i),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);var h=r.getFieldByName(i,this.parent.dataSourceSettings.formatSettings);if(e.node.setAttribute("data-formatString",h?h.format:""),h){var u=this.getFormat(h.format);n=u?this.formatTypes.indexOf(u)>-1?h.format:"Custom":"None";e.node.setAttribute("data-customformatstring","Custom"===n?u:""),e.node.setAttribute("data-formatString",h?n:"")}var c=(0,t.createElement)("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:Yi+" e-drag"}),g=(0,t.createElement)("div",{className:" e-iconspace"});(0,t.prepend)([c],e.node.querySelector("."+rr)),(0,t.append)([g,e.node.querySelector("."+zr)],e.node.querySelector("."+rr)),this.getMenuItems(this.parent.engineModule.fieldList[i].type).length<=0?(0,t.removeClass)([e.node.querySelector("."+zr)],Yi):e.node.querySelector("."+zr).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[i].aggregateType===Pl&&(e.node.querySelector("."+zr).setAttribute("title",this.parent.localeObj.getConstant("remove")),(0,t.addClass)([e.node.querySelector("."+zr)],Rn),(0,t.addClass)([e.node.querySelector(".e-iconspace")],[on,Yi,"e-list-icon"]),e.node.querySelector("."+on).setAttribute("title",this.parent.localeObj.getConstant("edit")),e.node.querySelector("."+on).setAttribute("aria-disabled","false"),e.node.querySelector("."+on).setAttribute("tabindex","-1"),(0,t.removeClass)([e.node.querySelector("."+zr)],zr),(0,t.removeClass)([e.node.querySelector(".e-iconspace")],"e-iconspace"))}},e.prototype.createTypeContainer=function(e){for(var i=(0,t.createElement)("div",{id:this.parentID+"control_container",className:Yr}),a=this.getMenuItems(this.parent.engineModule.fieldList[e].type),r=0;r<a.length;r++){var n=(0,t.createElement)("input",{id:this.parentID+"radio"+e+a[r],attrs:{type:"radio","data-ftxt":e,"data-value":a[r]},className:"e-pivot-calc-radio"});i.appendChild(n)}return i},e.prototype.getMenuItems=function(e,i){for(var a=(0,t.isNullOrUndefined)(i)?this.parent.aggregateTypes:i,r=[],n=this.getValidSummaryType(),s=0;s<a.length;s++)n.indexOf(a[s])>-1&&r.indexOf(a[s])<0&&((a[s]!==yl&&a[s]!==xl||"number"===e)&&"number"!==e||r.push(a[s]));return r},e.prototype.getValidSummaryType=function(){return[yl,xl,Cl,"Avg",bl,"Min","Max",wl,Tl,Ml,Dl,Ol]},e.prototype.getAccordionData=function(e){for(var t=[],i=Object.keys(e.engineModule.fieldList),a=0,r=i.length;a<r;a++){var n=i[a];t.push({header:"<input id="+this.parentID+"_"+a+" class="+jr+' type="checkbox" data-field='+n+' data-caption="'+this.parent.engineModule.fieldList[n].caption+'" data-type='+this.parent.engineModule.fieldList[n].type+"/>",content:this.parent.engineModule.fieldList[n].aggregateType===Pl||this.getMenuItems(this.parent.engineModule.fieldList[n].type).length<1?"":this.createTypeContainer(n).outerHTML,iconCss:this.parent.engineModule.fieldList[n].aggregateType===Pl?"e-list-icon "+(this.isEdit&&this.currentFieldName===n?"e-edited":"e-edit"):""})}return t},e.prototype.renderMobileLayout=function(e){var i=this;e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind();var a=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog):null,r=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:a.element;this.parent.isAdaptive&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+Wr)&&this.createDropElements();var n=new Cs.Button({cssClass:Gr+(this.parent.cssClass?" "+this.parent.cssClass:""),isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});if(n.isStringTemplate=!0,n.appendTo((0,t.select)("#"+this.parentID+"cancelBtn",r)),n.element&&(n.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+Wr)&&this.parent.isAdaptive){var s=new Cs.Button({cssClass:Gr+" e-outline"+(this.parent.cssClass?" "+this.parent.cssClass:""),isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});s.isStringTemplate=!0,s.appendTo((0,t.select)("#"+this.parentID+"okBtn",r));var l=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:function(e){i.fieldText=e.value,i.formulaText=(0,t.select)("#"+i.parentID+"droppable",document).value},cssClass:this.parent.cssClass});if(l.isStringTemplate=!0,l.appendTo((0,t.select)("#"+this.parentID+"ddlelement",r)),null!==this.formulaText&&null!==(0,t.select)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement))(0,t.select)("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value=this.formulaText;null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+qr)&&(this.parent.dialogRenderer.parentElement.querySelector("."+qr).value=this.fieldText,l.value=this.fieldText),s.element&&(s.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){var d=new Cs.Button({cssClass:Gr+(this.parent.cssClass?" "+this.parent.cssClass:""),isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});if(d.isStringTemplate=!0,d.appendTo((0,t.select)("#"+this.parentID+"addBtn",r)),"olap"===this.parent.dataType)this.treeObj=new ds.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,sortOrder:"None",enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeClicked:this.fieldClickHandler.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(e){(0,t.removeClass)([e.node],"e-active"),e.cancel=!0},cssClass:this.parent.cssClass}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo((0,t.select)("#"+this.parentID+"accordDiv",r));else{var p=new ds.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,expanding:this.accordionExpand.bind(this),clicked:this.accordionClickHandler.bind(this),created:this.accordionCreated.bind(this)});p.isStringTemplate=!0,p.appendTo((0,t.select)("#"+this.parentID+"accordDiv",r)),this.updateType()}d.element&&(d.element.onclick=this.addBtnClick.bind(this))}},e.prototype.accordionExpand=function(e){if(0===e.element.querySelectorAll(".e-radio-wrapper").length)for(var i=Object.keys(this.parent.engineModule.fieldList),a=0,r=i.length;a<r;a++){var n=i[a],s="number"!==this.parent.engineModule.fieldList[n].type?[yl,xl]:[Cl,yl,"Avg",bl,"Min","Max",xl,wl,Tl,Ml,Dl,Ol],o=void 0;if(n===e.element.querySelector("[data-field").getAttribute("data-field"))for(var l=0;l<s.length;l++)(o=new Cs.RadioButton({label:this.parent.localeObj.getConstant(s[l]),name:"AggregateType"+n,checked:e.element.querySelector("[data-type").getAttribute("data-type")===s[l],change:this.onChange.bind(this),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass})).isStringTemplate=!0,o.appendTo((0,t.select)("#"+this.parentID+"radio"+n+s[l],e.element))}},e.prototype.onChange=function(e){var t=e.event.target.parentElement.querySelector(".e-label").innerText,i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",e.event.target.getAttribute("data-value"))},e.prototype.updateType=function(){for(var e=Object.keys(this.parent.engineModule.fieldList),i=(0,t.select)("#"+this.parentID+"calculateddialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog):null,a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:i.element,r=0,n=e.length;r<n;r++){var s=e[r],l=null;l="number"===this.parent.engineModule.fieldList[s].type&&"include"!==this.parent.engineModule.fieldList[s].type&&"exclude"!==this.parent.engineModule.fieldList[s].type||"DistinctCount"===this.parent.engineModule.fieldList[s].aggregateType?void 0!==this.parent.engineModule.fieldList[s].aggregateType?this.parent.engineModule.fieldList[s].aggregateType:Cl:yl;var d=new Cs.CheckBox({label:this.parent.engineModule.fieldList[s].caption+" ("+this.parent.localeObj.getConstant(l)+")",locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass});d.isStringTemplate=!0,d.appendTo((0,t.select)("#"+this.parentID+"_"+r,a)),(0,t.select)("#"+this.parentID+"_"+r,a).setAttribute("data-field",s),(0,t.select)("#"+this.parentID+"_"+r,a).setAttribute("data-type",l)}},e.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.addBtnClick=function(){var e="",t=null,i=null;if("pivot"===this.parent.dataType){for(var a=document.querySelectorAll(".e-accordion .e-check"),r=0;r<a.length;r++)if(t=a[r].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(i=a[r].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(Pl))e=e+'"'+i+"("+t+')"';else for(var n=0;n<this.parent.dataSourceSettings.calculatedFieldSettings.length;n++)if(this.parent.dataSourceSettings.calculatedFieldSettings[n].name===t){e+=this.parent.dataSourceSettings.calculatedFieldSettings[n].formula;break}}else for(var s=this.treeObj.getAllCheckedNodes(),o=this.parent.olapEngineModule,l=0,d=s;l<d.length;l++){var p=d[l];e+=o.fieldList[p]&&o.fieldList[p].type===Pl?o.fieldList[p].tag:p}this.formulaText=null!==this.formulaText?this.formulaText+e:e,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createCalculatedFieldDialog=function(e){if(this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName())this.renderAdaptiveLayout(!e||void 0===e.edit||e.edit),this.isEdit=e&&void 0!==e.edit?e.edit:this.isEdit;else if(!this.parent.isAdaptive){if(this.isEdit=!(!e||void 0===e.edit)&&e.edit,this.renderDialogLayout(),e&&e.edit){var i=this.treeObj.element.querySelector('li[data-field="'+e.fieldName+'"]');if(i)if((0,t.addClass)([i],["e-active","e-node-focus"]),i.setAttribute("aria-selected","true"),i.id=this.treeObj.element.id+"_active","pivot"===this.parent.dataType){var a={event:{target:i.querySelector(".e-list-icon.e-edit.e-icons")}};this.fieldClickHandler(a)}else this.displayMenu(i)}var r=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog);r.element.style.top=parseInt(r.element.style.top,10)<0?"0px":r.element.style.top}},e.prototype.renderDialogLayout=function(){this.newFields=(0,t.extend)([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.createDialog();var e=(0,t.getInstance)((0,t.select)("#"+this.parentID+"calculateddialog",document),o.Dialog);e.content=this.renderDialogElements(),e.refresh();var i=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass});i.isStringTemplate=!0,i.appendTo((0,t.select)("#"+this.parentID+"ddlelement",e.element)),this.createDropElements(),this.createTreeView(),this.droppable=new t.Droppable((0,t.select)("#"+this.parentID+"droppable",e.element)),this.keyboardEvents=new t.KeyboardEvents(e.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter",shiftE:"shift+E",delete:"delete"},eventName:"keydown"})},e.prototype.createConfirmDialog=function(e,i,a,r,n){var s=(0,t.createElement)("div",{id:this.parentID+"_CalculatedFieldErrorDialog",className:_a});this.parent.element.appendChild(s);var l=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:r?this.removeCalcField.bind(this,n):this.replaceFormula.bind(this,a),buttonModel:{cssClass:Ua+" e-flat e-primary"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:r?this.parent.localeObj.getConstant("yes"):this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:r?this.parent.localeObj.getConstant("no"):this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass,close:this.removeErrorDialog.bind(this)});l.isStringTemplate=!0,l.appendTo(s)},e.prototype.replaceFormula=function(e){var i=this.parent.dataSourceSettings;if("olap"===this.parent.dataType){for(var a=0;a<i.calculatedFieldSettings.length;a++)if(i.calculatedFieldSettings[a].name===e.name){(0,t.isNullOrUndefined)(e.hierarchyUniqueName)||(i.calculatedFieldSettings[a].hierarchyUniqueName=e.hierarchyUniqueName),i.calculatedFieldSettings[a].formatString=e.formatString,i.calculatedFieldSettings[a].formula=e.formula,this.parent.lastCalcFieldInfo=i.calculatedFieldSettings[a];break}}else for(var r=0;r<i.values.length;r++)if(i.values[r].type===Pl&&i.values[r].name===e.name)for(a=0;a<i.calculatedFieldSettings.length;a++)i.calculatedFieldSettings[a].name===e.name&&(i.calculatedFieldSettings[a].formula=e.formula,this.parent.lastCalcFieldInfo=i.calculatedFieldSettings[a],this.updateFormatSettings(i,e.name,e.formatString));this.addFormula(i,e.name),this.removeErrorDialog()},e.prototype.removeErrorDialog=function(){var e=(0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document),i=e?(0,t.getInstance)(e,o.Dialog):null;i&&!i.isDestroyed&&i.destroy(),null!==(0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document)&&(0,t.remove)((0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document))},e.prototype.closeErrorDialog=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document),o.Dialog).close()},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on($e,this.createCalculatedFieldDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off($e,this.createCalculatedFieldDialog)},e.prototype.destroy=function(){this.treeObj&&!this.treeObj.isDestroyed&&this.treeObj.destroy(),this.treeObj&&(this.treeObj=null),this.newFields&&(this.newFields=null),this.curMenu&&(this.curMenu=null),this.droppable&&(this.droppable=null),this.keyboardEvents&&(this.keyboardEvents=null);var e=(0,t.select)("#"+this.parentID+"ddlelement",document);e&&(0,t.getInstance)(e,ps.MaskedTextBox).destroy(),(e=(0,t.select)("#"+this.parentID+"calculateddialog",document))&&(0,t.getInstance)(e,o.Dialog).destroy(),(e=(0,t.select)("#"+this.parentID+"CalcContextmenu",document))&&(0,t.getInstance)(e,ds.ContextMenu).destroy(),(e=(0,t.select)("#"+this.parentID+"accordDiv",document))&&(0,t.getInstance)(e,ds.Accordion).destroy(),(e=(0,t.select)("#"+this.parentID+"_CalculatedFieldErrorDialog",document))&&(0,t.getInstance)(e,o.Dialog).destroy()},e}();vl.Inject(Nl);var El=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"fieldList"},e.prototype.initiateModule=function(){if(!(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)){if(this.element=(0,t.createElement)("div",{id:this.parent.element.id+"_PivotFieldList",styles:"position:"+(this.parent.enableRtl?"static":"absolute")+";height:0;width:"+this.parent.element.style.width+";display:none"}),null===(0,t.select)("#"+this.parent.element.id+"containerwrapper",document)){var e=(0,t.createElement)("div",{id:this.parent.element.id+"containerwrapper",styles:"height:"+(isNaN(this.parent.height)?this.parent.height:this.parent.height+"px")});this.parent.element.parentElement.appendChild(e),e.appendChild(this.element),e.appendChild(this.parent.element)}else(0,t.select)("#"+this.parent.element.id+"containerwrapper",document).appendChild(this.element);this.parent.pivotFieldListModule=new vl({dataSourceSettings:{providerType:this.parent.dataSourceSettings.providerType,rows:[],columns:[],values:[],filters:[]},spinnerTemplate:this.parent.spinnerTemplate,allowDeferLayoutUpdate:this.parent.allowDeferLayoutUpdate,renderMode:"Popup",allowCalculatedField:this.parent.allowCalculatedField,showValuesButton:this.parent.showValuesButton,enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:this.parent.element.parentElement,aggregateTypes:this.parent.aggregateTypes,maxNodeLimitInMemberEditor:this.parent.maxNodeLimitInMemberEditor,aggregateCellInfo:this.parent.bindTriggerEvents.bind(this.parent),onHeadersSort:this.parent.bindTriggerEvents.bind(this.parent),cssClass:this.parent.cssClass,enableFieldSearching:this.parent.enableFieldSearching,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),this.parent.pivotFieldListModule.isPopupView=!0,this.parent.pivotFieldListModule.pivotGridModule=this.parent,this.parent.pivotFieldListModule.appendTo(this.element)}},e.prototype.updateControl=function(){if(this.parent.allowDeferLayoutUpdate&&(this.parent.actionObj.actionName="Field list refreshed"),this.element){for(var e=void 0,i=0;i<this.parent.toolbar.length;i++)"FieldList"===this.parent.toolbar[i]&&(e=!0);e&&"Server"===this.parent.dataSourceSettings.mode?this.element.style.display="none":this.element.style.display="block",(0,t.prepend)([this.element],this.parent.element),this.parent.showGroupingBar&&this.parent.groupingBarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.update.bind(this))):(0,t.isNullOrUndefined)(this.element.querySelector("."+aa))||((0,t.setStyleAttribute)(this.element.querySelector("."+aa),{left:"auto"}),this.parent.enableRtl?(0,t.removeClass)([this.element.querySelector("."+aa)],"e-fieldlist-left"):(0,t.addClass)([this.element.querySelector("."+aa)],"e-fieldlist-left")),(0,t.setStyleAttribute)(this.element,{width:(0,t.formatUnit)(this.parent.element.offsetWidth)})}this.parent.pivotFieldListModule.update(this.parent)},e.prototype.update=function(){var e;if((e="Table"!==this.parent.currentView?this.parent.chart?this.parent.pivotChartModule.getCalulatedWidth():e:this.parent.grid?this.parent.grid.element.offsetWidth:e)&&!(0,t.isNullOrUndefined)(this.element.querySelector("."+aa))){var i=e<400?400:e;(0,t.setStyleAttribute)(this.element.querySelector("."+aa),{left:(0,t.formatUnit)(this.parent.enableRtl?-Math.abs(i-this.element.querySelector("."+aa).offsetWidth):i-this.element.querySelector("."+aa).offsetWidth),top:this.parent.element.querySelector("."+ma)?this.parent.element.querySelector("."+aa).offsetHeight.toString()+"px":""}),this.parent.enableRtl?(0,t.addClass)([this.element.querySelector("."+aa)],"e-fieldlist-left"):(0,t.removeClass)([this.element.querySelector("."+aa)],"e-fieldlist-left")}},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Xe,this.initiateModule,this),this.parent.on(Ge,this.updateControl,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Xe,this.initiateModule),this.parent.off(Ge,this.updateControl))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed&&(this.parent.pivotFieldListModule.destroy(),this.parent.pivotFieldListModule=null,(0,t.isNullOrUndefined)((0,t.select)("#"+this.parent.element.id+"_PivotFieldList",document))||(0,t.remove)((0,t.select)("#"+this.parent.element.id+"_PivotFieldList",document)))},e}(),Il=function(){function e(e){this.parent=e}return e.prototype.render=function(){(!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed)&&new cl(this.parent),this.createPivotButtons();for(var e=[],i=(e=e.concat([].slice.call(this.parent.groupingBarModule.rowPanel.querySelectorAll("."+va)))).length,a=0;a<i;a++){var r=(0,t.createElement)("span",{className:"e-indent-div",styles:"width:"+24*a+"px"});(0,t.prepend)([r],e[a])}},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],a=Array.prototype.slice.call(this.parent.element.querySelectorAll("."+Xa+",."+Ja+",."+Za+",."+$a+",."+er));(0,t.isNullOrUndefined)(this.parent.element.querySelector("."+Xn))&&a.push(this.parent.groupingBarModule.rowPanel);for(var n=0;n<a.length;n++){var s=a[n];this.parent.dataSourceSettings.values.length>0&&s.classList.contains(Un)&&this.parent.dataSourceSettings.columns.length>0&&s.classList.contains(Vn)||(s.innerHTML="")}if("pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&(!(this.parent.dataSourceSettings.dataSource instanceof i.DataManager)&&this.parent.dataSourceSettings.dataSource.length>0||this.parent.dataSourceSettings.dataSource instanceof i.DataManager&&this.parent.engineModule.data&&this.parent.engineModule.data.length>0)||"olap"===this.parent.dataType&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url){var o=["rows","columns","values","filters"];if("pivot"===this.parent.dataType&&this.parent.groupingBarSettings.showFieldsPanel){o.push("all-fields"),e.push([]);for(var l=0,d=this.parent.engineModule&&this.parent.engineModule.fieldList?Object.keys(this.parent.engineModule.fieldList):[];l<d.length;l++){var p=d[l];this.parent.engineModule.fieldList[p]&&!this.parent.engineModule.fieldList[p].isSelected&&e[e.length-1].push(r.getFieldInfo(p,this.parent,!0).fieldItem)}}n=0;for(var h=e.length;n<h;n++)if(e[n]){var u={field:e[n],axis:o[n].toString()};this.parent.notify(Ze,u)}}},e}(),Fl=function(){function e(e){this.parent=e,this.parent.groupingBarModule=this,this.resColWidth=this.parent.isAdaptive?180:249,this.addEventListener(),this.parent.axisFieldModule=new Il(this.parent),this.touchObj=new t.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return e.prototype.getModuleName=function(){return"groupingBar"},e.prototype.renderLayout=function(){this.groupingTable=(0,t.createElement)("div",{className:Ka});var e=(0,t.createElement)("div",{className:ua});this.rightAxisPanel=(0,t.createElement)("div",{className:ca});var i=(0,t.createElement)("div",{className:"e-axis-row "+Zr+"container"}),a=(0,t.createElement)("div",{className:"e-axis-column "+Zr+"container"}),r=(0,t.createElement)("div",{className:"e-axis-value "+Zr+"container"}),n=(0,t.createElement)("div",{className:$r+" "+Zr+"container"});this.rowPanel=(0,t.createElement)("div",{className:Ja+" "+za});var s=(0,t.createElement)("div",{className:Za+" "+Wa}),o=(0,t.createElement)("div",{className:$a+" "+Qa}),l=(0,t.createElement)("div",{className:er+" "+Ya});i.appendChild(this.rowPanel),a.appendChild(s),r.appendChild(o),n.appendChild(l),this.rowAxisPanel=i,e.appendChild(r),e.appendChild(i),this.rightAxisPanel.appendChild(n),this.rightAxisPanel.appendChild(a),this.groupingTable.appendChild((0,t.createElement)("div",{styles:"display:flex;"})),this.groupingTable.firstElementChild.appendChild(e),this.groupingTable.firstElementChild.appendChild(this.rightAxisPanel),"pivot"===this.parent.dataType&&null!=this.parent.groupingBarSettings&&this.parent.groupingBarSettings.showFieldsPanel&&(this.gridPanel=this.createToolbarUI(this.groupingTable)),this.groupingTable.classList.add(Qn),this.groupingTable.querySelector("."+Ja).classList.add(Xn);for(var d=0,p=[this.rowPanel,s,o,l];d<p.length;d++){var h=p[d];this.parent.groupingBarSettings.allowDragAndDrop&&new t.Droppable(h,{}),this.unWireEvent(h),this.wireEvent(h)}"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode?(this.groupingChartTable=this.groupingTable.cloneNode(!0),(0,t.select)("#"+this.parent.element.id+"_AllFields",this.groupingChartTable)&&((0,t.select)("#"+this.parent.element.id+"_AllFields",this.groupingChartTable).remove(),this.chartPanel=this.createToolbarUI(this.groupingChartTable)),this.groupingChartTable.classList.add(Gn),this.groupingChartTable.classList.remove(Qn),this.groupingChartTable.querySelector("."+Ja).classList.add(Hn),this.groupingChartTable.querySelector("."+Ja).classList.remove(Xn),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)<0?this.groupingChartTable.querySelector("."+$a).classList.add("e-group-chart-multi-values"):this.groupingChartTable.querySelector("."+$a).classList.add(Un),this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)>-1?this.groupingChartTable.querySelector("."+Za).classList.add(Vn):this.groupingChartTable.querySelector("."+Za).classList.add("e-group-chart-accumulation-column"),this.groupingChartTable.querySelector("."+er).classList.add("e-group-chart-filters")):this.groupingChartTable=void 0,"Chart"!==this.parent.displayOption.view&&"Chart"!==this.parent.groupingBarSettings.displayMode||(this.groupingTable=void 0)},e.prototype.appendToElement=function(){var e=this.groupingTable?this.groupingTable:this.groupingChartTable,i=e.getElementsByClassName(ua)[0],a=e.getElementsByClassName(er+" "+Ya)[0],r=e.getElementsByClassName(Za+" "+Wa)[0],n=e.getElementsByClassName($a+" "+Qa)[0];if((this.parent.element.querySelector("."+en)||this.parent.element.querySelector("."+qn))&&this.parent.showGroupingBar){if(this.parent.element.querySelector("."+Ka))for(var s=this.parent.element.querySelectorAll("."+Ka),o=0;o<s.length;o++){var l=s[o];(0,t.remove)(l)}if(this.groupingChartTable)if((0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)){if((0,t.setStyleAttribute)(this.groupingChartTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.parent.element.insertBefore(this.groupingChartTable,(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)),this.groupingChartTable.querySelector("."+ga)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed){var d=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.chartPanel.width=d<400?"398px":d,this.chartPanel.refreshOverflow(),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this)))}}else this.groupingChartTable=void 0;if("Chart"!==this.parent.displayOption.view&&this.groupingTable){this.parent.isAdaptive&&(i.style.minWidth="180px",n.style.minWidth="180px"),this.parent.firstColWidth&&(i.style.minWidth="auto",n.style.minWidth="auto"),a.removeAttribute("style"),r.removeAttribute("style"),this.rowPanel.removeAttribute("style");var p=void 0;if(p="olap"===this.parent.dataType?this.parent.olapEngineModule.headerContent?Object.keys(this.parent.olapEngineModule.headerContent).length:0:this.parent.engineModule.headerContent?Object.keys(this.parent.engineModule.headerContent).length:0,!(0,t.isNullOrUndefined)(p)){var h=this.parent.element.querySelector("."+Tn).querySelector(".e-columnheader");h.removeAttribute("style"),(0,t.addClass)([h.querySelector("."+Pr)],"e-group-row"),h.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",h.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none"}if(this.parent.element.insertBefore(this.groupingTable,this.parent.element.querySelector("."+en)),(0,t.setStyleAttribute)(this.groupingTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable&&this.groupingTable.querySelector("."+ga)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed){var u=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.gridPanel.width=u<400?"398px":u,this.gridPanel.refreshOverflow()}this.groupingTable.style.minWidth="400px",this.parent.axisFieldModule.render(),this.setGridRowWidth();var c=this.parent.element.querySelector("."+Tn).querySelector("colgroup").children[0],g=(0,t.formatUnit)(this.groupingTable.offsetWidth-parseInt(c.style.width,10));(0,t.setStyleAttribute)(n,{width:c.style.width}),(0,t.setStyleAttribute)(this.rightAxisPanel,{width:g});var m=n.offsetHeight/2;m>r.offsetHeight&&((0,t.setStyleAttribute)(a,{height:(0,t.formatUnit)(m)}),(0,t.setStyleAttribute)(r,{height:(0,t.formatUnit)(m+2)}));var f=this.parent.element.querySelector("."+Tn).offsetHeight;(0,t.setStyleAttribute)(this.rowPanel,{height:f+"px"}),this.parent.element.querySelector("."+Tn).querySelector(".e-rhandler")&&(this.parent.element.querySelector("."+Tn).querySelector(".e-rhandler").style.height=f+"px");for(var S=[].slice.call(this.parent.element.querySelector("."+Tn).querySelector("thead").querySelectorAll("tr")).filter((function(e){return e.childNodes.length>0})),v=f/S.length,y=0,b=S;y<b.length;y++){var C=b[y];(0,t.setStyleAttribute)(C,{height:v+"px"});for(var x=0,w=[].slice.call(C.querySelectorAll(".e-rhandler"));x<w.length;x++){var T=w[x];(0,t.setStyleAttribute)(T,{height:v+"px"})}}}else this.parent.axisFieldModule.render(),this.updateChartAxisHeight();this.parent.showToolbar&&"Both"===this.parent.displayOption.view&&("Table"===this.parent.currentView?this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none":this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none")}},e.prototype.updateChartAxisHeight=function(){if(this.groupingChartTable&&(0,t.select)("#"+this.parent.element.id+"_chart",this.parent.element)){var e=this.groupingChartTable.querySelector("."+Ja),i=this.groupingChartTable.querySelector("."+$a),a=this.groupingChartTable.querySelector("."+er),r=this.groupingChartTable.querySelector("."+Za);if(e&&r&&(e.style.height="auto",r.style.height="auto",e.offsetHeight>0&&r.offsetHeight>0)){var n=e.offsetHeight>r.offsetHeight?e.offsetHeight:r.offsetHeight;(0,t.setStyleAttribute)(e,{height:(0,t.formatUnit)(n)}),(0,t.setStyleAttribute)(r,{height:(0,t.formatUnit)(n)})}if(i&&a&&(i.style.height="auto",a.style.height="auto",i.offsetHeight>0&&a.offsetHeight>0)){n=i.offsetHeight>a.offsetHeight?i.offsetHeight:a.offsetHeight;(0,t.setStyleAttribute)(i,{height:(0,t.formatUnit)(n)}),(0,t.setStyleAttribute)(a,{height:(0,t.formatUnit)(n)})}}},e.prototype.refreshUI=function(){if(this.groupingChartTable){if((0,t.setStyleAttribute)(this.groupingChartTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingChartTable.querySelector("."+ga)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed){var e=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.chartPanel.width=e<400?"398px":e,this.chartPanel.refreshOverflow()}this.updateChartAxisHeight(),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this)))}if(this.groupingTable){var i=this.groupingTable.getElementsByClassName($a+" "+Qa)[0];if((0,t.setStyleAttribute)(this.groupingTable,{width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable&&this.groupingTable.querySelector("."+ga)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed){var a=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2;this.gridPanel.width=a<400?"398px":a,this.gridPanel.refreshOverflow()}this.groupingTable.style.minWidth="400px";var r=this.parent.element.querySelector("."+Tn).querySelector("colgroup").children[0],n=(0,t.formatUnit)(this.groupingTable.offsetWidth-parseInt(r.style.width,10));if((0,t.setStyleAttribute)(i,{width:r.style.width}),(0,t.setStyleAttribute)(this.rightAxisPanel,{width:n}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this))),!this.parent.grid.element.querySelector(".e-group-row")){var s=this.parent.element.querySelector("."+Tn).querySelector(".e-columnheader");(0,t.addClass)([s.querySelector("."+Pr)],"e-group-row"),(0,t.setStyleAttribute)(this.rowPanel,{height:this.parent.element.querySelector("."+Tn).offsetHeight+"px"}),s.querySelector(".e-group-row").appendChild(this.rowAxisPanel),(0,t.setStyleAttribute)(s.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"}),(0,t.setStyleAttribute)(s.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});var o=this.parent.element.querySelector("."+Tn).offsetHeight;(0,t.setStyleAttribute)(this.rowPanel,{height:o+"px"}),this.parent.element.querySelector("."+Tn).querySelector(".e-rhandler")&&(this.parent.element.querySelector("."+Tn).querySelector(".e-rhandler").style.height=o+"px");for(var l=[].slice.call(this.parent.element.querySelector("."+Tn).querySelector("thead").querySelectorAll("tr")).filter((function(e){return e.childNodes.length>0})),d=o/l.length,p=0,h=l;p<h.length;p++){var u=h[p];(0,t.setStyleAttribute)(u,{height:d+"px"});for(var c=0,g=[].slice.call(u.querySelectorAll(".e-rhandler"));c<g.length;c++){var m=g[c];m.parentElement.parentElement.querySelector("."+is)||(0,t.setStyleAttribute)(m,{height:d+"px"})}}}}},e.prototype.alignIcon=function(){var e,i=this.parent.pivotFieldListModule.element;if(e="Table"===this.parent.currentView?this.parent.grid?this.parent.grid.element.offsetWidth:e:this.parent.chart?this.parent.pivotChartModule.getCalulatedWidth():e){var a=e<400?400:e;(0,t.setStyleAttribute)(i.querySelector("."+aa),{left:(0,t.formatUnit)(this.parent.enableRtl?-Math.abs(a-i.querySelector("."+aa).offsetWidth):a-i.querySelector("."+aa).offsetWidth),top:this.parent.element.querySelector("."+ma)?this.parent.element.querySelector("."+aa).offsetHeight.toString()+"px":""})}},e.prototype.setGridRowWidth=function(){var e=this.parent.element.querySelector("."+Tn).querySelector(".e-columnheader");(0,t.addClass)([e.querySelector("."+Pr)],"e-group-row"),e.querySelector(".e-group-row").appendChild(this.rowAxisPanel);var i=this.parent.element.querySelector("."+Tn).querySelector("colgroup").children[0];if(this.rowPanel.querySelector("."+ya))if(this.parent.isAdaptive){if(!this.parent.firstColWidth)(a=this.parent.grid.columns)&&a.length>0&&(a[0].width=this.resColWidth),this.parent.posCount=0,this.parent.grid.headerModule.refreshUI()}else{var a,r=[].slice.call(this.rowPanel.querySelectorAll("."+va)),n=r[r.length-1],s=n.querySelector("."+ya).offsetWidth+n.querySelector(".e-indent-div").offsetWidth+20,o=(0,t.formatUnit)(s<this.resColWidth?this.resColWidth:s),l=this.parent.element.querySelector("."+Tn).querySelector("."+Pr),d=this.parent.element.querySelector("."+ba).querySelector("tbody").querySelector("."+is),p=this.parent.element.querySelector("."+ba).querySelector("colgroup").children[0],h=parseInt(o,10),u=this.parent.pivotColumns.length>0;(a=this.parent.grid.columns)&&a.length>0&&(a[0].width=a[0].autoFit?a[0].width:h>this.resColWidth?h:this.resColWidth);var c=void 0;c="olap"===this.parent.dataType?this.parent.renderModule.calculateColWidth(this.parent.olapEngineModule.pivotValues.length>0?this.parent.olapEngineModule.pivotValues[0].length:2):this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.engineModule.pivotValues.length>0?this.parent.engineModule.pivotValues[0].length:2);for(var g=0;g<a.length;g++)if(0!==g)if(a[g].columns)this.parent.setCommonColumnsWidth(this.parent.renderModule.pivotColumns[g].columns,c);else if("auto"!==a[g].width){var m=a[g].customAttributes?a[g].customAttributes.cell.valueSort.levelName:"",f=this.parent.renderModule.setSavedWidth(m,c);a[g].width=a[g].autoFit||u&&this.parent.pivotColumns[g].autoFit?a[g].width:this.parent.renderModule.lastColumn&&this.parent.renderModule.lastColumn.field===a[g].field?f-3:f}else a[g].minWidth=c;this.parent.posCount=0,this.parent.setGridColumns(this.parent.grid.columns),this.parent.grid.headerModule.refreshUI(),this.parent.firstColWidth||(o=a[0].autoFit?a[0].width.toString():o,i.style.width=o,p.style.width=o,l.style.width=o,d.style.width=o,(0,t.setStyleAttribute)(l,{width:o}),(0,t.setStyleAttribute)(d,{width:o}))}else this.parent.grid.columns&&this.parent.grid.columns.length>0&&(this.parent.grid.columns[0].width=this.parent.grid.columns[0].width>this.resColWidth?this.parent.grid.columns[0].width:this.resColWidth),this.parent.grid.headerModule.refreshUI();this.groupingTable&&this.refreshUI()},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.dropIndicatorUpdate,this),t.EventHandler.add(e,"mouseleave",this.dropIndicatorUpdate,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.dropIndicatorUpdate),t.EventHandler.remove(e,"mouseleave",this.dropIndicatorUpdate)},e.prototype.dropIndicatorUpdate=function(e){(this.parent.isDragging&&e.target.classList.contains(Ga)&&"mouseover"===e.type||!this.parent.isDragging||!e.target.classList.contains(Ga)&&"mouseleave"===e.type)&&((0,t.removeClass)([].slice.call(this.parent.element.querySelectorAll("."+Ia)),Fa),(0,t.removeClass)([].slice.call(this.parent.element.querySelectorAll("."+Ia+"-last")),Fa))},e.prototype.tapHoldHandler=function(e){var i=(0,t.closest)(e.originalEvent.target,"."+ya);if(!(0,t.isNullOrUndefined)(i)&&this.parent.isAdaptive){var a=i.getBoundingClientRect();return this.parent.contextMenuModule.fieldElement=i,void this.parent.contextMenuModule.menuObj.open(a.top,a.left)}},e.prototype.RefreshFieldsPanel=function(){if("pivot"===this.parent.dataType&&null!=this.parent.groupingBarSettings){if((0,t.selectAll)("#"+this.parent.element.id+"_AllFields",this.parent.element).length>0)for(var e=0,i=(0,t.selectAll)("#"+this.parent.element.id+"_AllFields",this.parent.element);e<i.length;e++){i[e].remove()}this.parent.groupingBarSettings.showFieldsPanel&&(this.groupingChartTable&&"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode&&(this.chartPanel=this.createToolbarUI(this.groupingChartTable)),this.groupingTable&&(this.gridPanel=this.createToolbarUI(this.groupingTable)),this.parent.axisFieldModule.render(),this.refreshUI())}},e.prototype.createToolbarUI=function(e){(0,t.select)("#"+this.parent.element.id+"_AllFields",e)&&(0,t.select)("#"+this.parent.element.id+"_AllFields",e).remove(),e.prepend((0,t.createElement)("div",{id:this.parent.element.id+"_AllFields"}));var i=new ds.Toolbar({cssClass:ga+(this.parent.cssClass?" "+this.parent.cssClass:""),enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,items:[{template:"<div class="+Xa+"></div>"}],allowKeyboard:!1,width:this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2});return i.appendTo((0,t.select)("#"+this.parent.element.id+"_AllFields",e)),i},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Xe,this.renderLayout,this),this.parent.on(Ge,this.appendToElement,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Ge,this.appendToElement),this.parent.off(Xe,this.renderLayout))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotButtonModule&&(this.parent.pivotButtonModule.destroy(),this.parent.pivotButtonModule=null),this.groupingTable&&this.groupingTable.querySelector("."+ga)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed&&(this.gridPanel.destroy(),this.gridPanel=null),this.groupingChartTable&&this.groupingChartTable.querySelector("."+ga)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed&&(this.chartPanel.destroy(),this.chartPanel=null),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy(),this.parent.element.querySelector("."+Ka)&&(0,t.remove)(this.parent.element.querySelector("."+Ka))},e}(),Ll=function(){function e(e){this.parent=e,this.parent.conditionalFormattingModule=this,this.parentID=this.parent.element.id,this.fontColor=[],this.backgroundColor=[],this.newFormat=[]}return e.prototype.getModuleName=function(){return"conditionalFormatting"},e.prototype.createDialog=function(){null!==(0,t.select)("#"+this.parentID+"conditionalformatting",document)&&(0,t.remove)((0,t.select)("#"+this.parentID+"conditionalformatting",document));var e=(0,t.createElement)("div",{id:this.parentID+"conditionalformatting",className:"e-pivot-formatting-dialog"});this.parent.element.appendChild(e);var i,a=[{click:this.addButtonClick.bind(this),buttonModel:{cssClass:(this.parent.isAdaptive?"e-small e-round "+hn:hn)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:Yi+" "+dr,content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:this.applyButtonClick.bind(this),isFlat:!0,buttonModel:{isPrimary:!0,cssClass:"e-format-apply-button"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply")}},{click:this.cancelButtonClick.bind(this),isFlat:!0,buttonModel:{cssClass:"e-format-cancel-button"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}];(i=this.parent.isAdaptive?new o.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,position:{X:"center",Y:"center"},allowDragging:!0,buttons:a,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:this.parent.cssClass,header:this.parent.localeObj.getConstant("conditionalFormatting"),target:document.body}):new o.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:a,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:this.parent.cssClass,isModal:!0,closeOnEscape:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormatting"),target:this.parent.element})).isStringTemplate=!0,i.appendTo(e)},e.prototype.beforeOpen=function(){(0,t.select)("#"+this.parentID+"conditionalformatting",document).querySelector("."+mn).setAttribute("title",this.parent.localeObj.getConstant("conditionalFormatting"))},e.prototype.addButtonClick=function(){var e=this,t=this;this.parent.trigger(Oe,{conditions:"LessThan",value1:0,applyGrandTotals:!0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}},(function(i){t.refreshConditionValues(),e.destroyColorPickers(),t.newFormat.push(i),t.addFormat()}))},e.prototype.applyButtonClick=function(){if(this.refreshConditionValues()){this.parent.setProperties({dataSourceSettings:{conditionalFormatSettings:this.newFormat}},!0);var e={conditionalFormattingInfo:this.parent.dataSourceSettings.conditionalFormatSettings};this.parent.actionObj.actionInfo=e,this.parent.dataSourceSettings.values.length>0&&this.parent.renderPivotGrid(),(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),o.Dialog).close()}},e.prototype.cancelButtonClick=function(){(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),o.Dialog).close(),this.newFormat=[]},e.prototype.refreshConditionValues=function(){for(var e=0;e<this.newFormat.length;e++){if(""===(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).value||""===(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).value)return""===(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).value?(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).focus():(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).focus(),!1;this.newFormat[e].value1=Number((0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).value),this.newFormat[e].value2=Number((0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).value)}return!0},e.prototype.addFormat=function(){for(var e=(0,t.createElement)("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),i=0;i<this.newFormat.length;i++)e.appendChild(this.createDialogElements(i));if(0===this.newFormat.length){var a=this.createDialogElements(),r=(0,t.createElement)("p",{id:this.parentID+"emptyFormat",className:"e-pivot-conditional-empty-format"});r.innerText=this.parent.localeObj.getConstant("emptyFormat"),a.appendChild(r),e.appendChild(a)}(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),o.Dialog).setProperties({content:e},!1);for(i=0;i<this.newFormat.length;i++)this.renderDropDowns(i),this.renderColorPicker(i)},e.prototype.createDialogElements=function(e){var i=(0,t.createElement)("div",{id:this.parentID+"outerDiv"+e,className:"e-format-outer-div"});if(void 0!==e){var a=this.newFormat[e],r=(0,t.createElement)("button",{id:this.parentID+"removeButton"+e,className:"e-format-delete-button",attrs:{type:"button",title:this.parent.localeObj.getConstant("delete")}});i.appendChild(r);var n=(0,t.createElement)("div",{id:this.parentID+"innerDiv"+e,className:"e-format-inner-div"}),s=(0,t.createElement)("table",{id:this.parentID+"cftable"+e,className:un,attrs:{role:"table"}}),o=(0,t.createElement)("tr"),l=(0,t.createElement)("td"),d=(0,t.createElement)("span",{id:this.parentID+"valuelabel"+e,className:"e-format-value-label"});d.innerText=this.parent.localeObj.getConstant("value"),l.appendChild(d),o.appendChild(l),s.appendChild(o),o=(0,t.createElement)("tr"),l=(0,t.createElement)("td");var p=(0,t.createElement)("div",{id:this.parentID+"measure"+e}),h=(0,t.createElement)("input",{id:this.parentID+"measureinput"+e,attrs:{type:"text",tabindex:"0"}});p.appendChild(h),l.appendChild(p),o.appendChild(l),l=(0,t.createElement)("td");var u=(0,t.createElement)("div",{id:this.parentID+"condition"+e}),c=(0,t.createElement)("input",{id:this.parentID+"conditioninput"+e,attrs:{type:"text",tabindex:"0"}});u.appendChild(c),l.appendChild(u),o.appendChild(l),l=(0,t.createElement)("td");var g="Between"!==a.conditions&&"NotBetween"!==a.conditions?"display:none; width:10px":"",m=(0,t.createElement)("input",{id:this.parentID+"conditionvalue1"+e,attrs:{type:"text",tabindex:"0",value:(0,t.isNullOrUndefined)(a.value1)?"0":a.value1.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive?""===g?"width: 35%":"width: 100%":""===g?"width: 45px":"width: 120px",className:cn+" e-format-value1"});l.appendChild(m);var f=(0,t.createElement)("span",{id:this.parentID+"valuespan"+e,className:"e-format-value-span",innerHTML:"&",styles:g});l.appendChild(f);var S=(0,t.createElement)("input",{id:this.parentID+"conditionvalue2"+e,attrs:{type:"text",tabindex:"0",value:(0,t.isNullOrUndefined)(a.value2)?"0":a.value2.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive&&""===g?"width: 35%":""===g?"width: 45px":g,className:cn+" e-format-value2"});l.appendChild(S),o.appendChild(l),s.appendChild(o),this.parent.isAdaptive&&(n.appendChild(s),s=(0,t.createElement)("table",{id:this.parentID+"cftable",className:un,attrs:{role:"table"}})),o=(0,t.createElement)("tr"),l=(0,t.createElement)("td");var v=(0,t.createElement)("span",{id:this.parentID+"formatlabel"+e,className:"e-format-label"});v.innerText=this.parent.localeObj.getConstant("formatLabel"),l.appendChild(v),o.appendChild(l),s.appendChild(o),o=(0,t.createElement)("tr"),l=(0,t.createElement)("td");var y=(0,t.createElement)("div",{id:this.parentID+"fontname"+e}),b=(0,t.createElement)("input",{id:this.parentID+"fontnameinput"+e,attrs:{type:"text",tabindex:"0"}});y.appendChild(b),l.appendChild(y),o.appendChild(l),l=(0,t.createElement)("td");var C=(0,t.createElement)("div",{id:this.parentID+"fontsize"+e}),x=(0,t.createElement)("input",{id:this.parentID+"fontsizeinput"+e,attrs:{type:"text",tabindex:"0"}});C.appendChild(x),l.appendChild(C),o.appendChild(l),this.parent.isAdaptive&&(s.appendChild(o),o=(0,t.createElement)("tr"),s.appendChild(o),o=(0,t.createElement)("tr")),l=(0,t.createElement)("td");var w=(0,t.createElement)("input",{id:this.parentID+"fontcolor"+e,attrs:{type:"color",tabindex:"0"},className:"e-format-font-color"});l.appendChild(w);var T=(0,t.createElement)("input",{id:this.parentID+"backgroundcolor"+e,attrs:{type:"color",tabindex:"0"},className:"e-format-back-color"});l.appendChild(T),o.appendChild(l),l=(0,t.createElement)("td");var M=(0,t.createElement)("div",{id:this.parentID+"valuepreview"+e,className:cn+" e-format-value-preview",innerHTML:"123.45"});l.appendChild(M),o.appendChild(l),s.appendChild(o),n.appendChild(s),i.appendChild(n)}return i},e.prototype.renderDropDowns=function(e){var i=(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),o.Dialog).element,a=this.newFormat[e],r=[];r.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var n=0;n<this.parent.dataSourceSettings.values.length;n++){var s=this.parent.dataSourceSettings.values[n].caption||this.parent.dataSourceSettings.values[n].name;s=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s):s,r.push({index:n+1,name:s,field:this.parent.dataSourceSettings.values[n].name})}var l=(0,t.isNullOrUndefined)(a.measure)?this.parent.localeObj.getConstant("AllValues"):a.measure,d=[];d[e]=new hs.DropDownList({dataSource:r,fields:{text:"name",value:"field"},value:l,width:this.parent.isAdaptive?"100%":"120px",cssClass:this.parent.cssClass,popupHeight:"200px",popupWidth:"auto",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.measureChange.bind(this,e)}),d[e].isStringTemplate=!0,d[e].appendTo((0,t.select)("#"+this.parentID+"measureinput"+e,i));var p=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];l=(0,t.isNullOrUndefined)(a.conditions)?"LessThan":a.conditions;var h=[];h[e]=new hs.DropDownList({dataSource:p,fields:{value:"value",text:"name"},value:l,width:this.parent.isAdaptive?"100%":"120px",cssClass:this.parent.cssClass,popupHeight:"200px",popupWidth:"auto",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.conditionChange.bind(this,e)}),h[e].isStringTemplate=!0,h[e].appendTo((0,t.select)("#"+this.parentID+"conditioninput"+e,i));l=(0,t.isNullOrUndefined)(a.style.fontFamily)?"Arial":a.style.fontFamily;var u=[];u[e]=new hs.DropDownList({dataSource:[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}],fields:{text:"name"},value:l,width:this.parent.isAdaptive?"100%":"120px",cssClass:this.parent.cssClass,popupWidth:"150px",popupHeight:"200px",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.fontNameChange.bind(this,e)}),u[e].isStringTemplate=!0,u[e].appendTo((0,t.select)("#"+this.parentID+"fontnameinput"+e,i));l=(0,t.isNullOrUndefined)(a.style.fontSize)?"12px":a.style.fontSize;var c=[];c[e]=new hs.DropDownList({dataSource:[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}],fields:{text:"name"},popupHeight:"200px",value:l,width:this.parent.isAdaptive?"100%":"120px",change:this.fontSizeChange.bind(this,e),locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass}),c[e].isStringTemplate=!0,c[e].appendTo((0,t.select)("#"+this.parentID+"fontsizeinput"+e,i))},e.prototype.conditionChange=function(e,i){this.newFormat[e].conditions=i.value,"Between"===i.value||"NotBetween"===i.value?((0,t.select)("#"+this.parentID+"valuespan"+e,document).style.display="inline-block",(0,t.select)("#"+this.parentID+"valuespan"+e,document).style.width=this.parent.isAdaptive?"10%":"10px",(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).style.display="inline-block",(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).style.width=this.parent.isAdaptive?"35%":"45px",(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).style.width=this.parent.isAdaptive?"35%":"45px"):((0,t.select)("#"+this.parentID+"valuespan"+e,document).style.display="none",(0,t.select)("#"+this.parentID+"conditionvalue2"+e,document).style.display="none",(0,t.select)("#"+this.parentID+"conditionvalue1"+e,document).style.width=this.parent.isAdaptive?"100%":"120px")},e.prototype.fontNameChange=function(e,i){this.newFormat[e].style.fontFamily=i.value.toString(),(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontFamily=i.value},e.prototype.fontSizeChange=function(e,i){this.newFormat[e].style.fontSize=i.value.toString(),(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontSize=i.value},e.prototype.measureChange=function(e,t){this.newFormat[e].measure=t.value.toString()===this.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()},e.prototype.renderColorPicker=function(e){var i=(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),o.Dialog).element,a=this.newFormat[e],r=(0,t.isNullOrUndefined)(a.style.color)?"black":a.style.color,n="#"===r.charAt(0)&&this.isHex(r.substr(1))?r:this.colourNameToHex(r);(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.color=n,this.fontColor[e]=new ps.ColorPicker({cssClass:gn+" e-format-font-color-picker"+(this.parent.cssClass?" "+this.parent.cssClass:""),value:n,mode:"Palette",change:this.fontColorChange.bind(this,e),locale:this.parent.locale,enableRtl:this.parent.enableRtl}),this.fontColor[e].isStringTemplate=!0,this.fontColor[e].appendTo((0,t.select)("#"+this.parentID+"fontcolor"+e,i)),(0,t.addClass)([this.fontColor[e].element.nextElementSibling.querySelector(".e-selected-color")],Yi),n="#"===(r=(0,t.isNullOrUndefined)(a.style.backgroundColor)?"white":a.style.backgroundColor).charAt(0)&&this.isHex(r.substr(1))?r:this.colourNameToHex(r),(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.backgroundColor=n,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontFamily=a.style.fontFamily,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.fontSize=a.style.fontSize,this.backgroundColor[e]=new ps.ColorPicker({cssClass:gn+(this.parent.cssClass?" "+this.parent.cssClass:""),value:n,mode:"Palette",change:this.backColorChange.bind(this,e),locale:this.parent.locale,enableRtl:this.parent.enableRtl}),this.backgroundColor[e].isStringTemplate=!0,this.backgroundColor[e].appendTo((0,t.select)("#"+this.parentID+"backgroundcolor"+e,i)),(0,t.addClass)([this.backgroundColor[e].element.nextElementSibling.querySelector(".e-selected-color")],Yi);var s=new Cs.Button({iconCss:Yi+" e-format-delete-icon",cssClass:Gr+(this.parent.cssClass?" "+this.parent.cssClass:""),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});s.isStringTemplate=!0,s.appendTo((0,t.select)("#"+this.parentID+"removeButton"+e,i)),s.element.onclick=this.toggleButtonClick.bind(this,e)},e.prototype.backColorChange=function(e,i){this.newFormat[e].style.backgroundColor=i.currentValue.hex,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.backgroundColor=i.currentValue.hex},e.prototype.fontColorChange=function(e,i){this.newFormat[e].style.color=i.currentValue.hex,(0,t.select)("#"+this.parentID+"valuepreview"+e,document).style.color=i.currentValue.hex},e.prototype.toggleButtonClick=function(e){this.destroyColorPickers(),this.newFormat.splice(e,1),this.addFormat()},e.prototype.isHex=function(e){for(var t=parseInt(e,16);"0"===e.charAt(0);)e=e.substr(1);return t.toString(16)===e.toLowerCase()||0===t&&""===e},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.prototype.colourNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};if(void 0!==t[e.toLowerCase()])return t[e.toLowerCase()];if(0===e.search("rgba")){for(var i=e.substr(5).split(")")[0].split(","),a="",r=0;r<i.length-1;r++)i[r]=(+i[r]).toString(16),1===i[r].length&&(i[r]="0"+i[r]),a+=i[r];return"#"+a+Math.round(255*+i[3]).toString(16)}if(0===e.search("rgb")){for(i=e.substr(4).split(")")[0].split(","),a="",r=0;r<i.length;r++)i[r]=(+i[r]).toString(16),1===i[r].length&&(i[r]="0"+i[r]),a+=i[r];return"#"+a}return"#d5d5d5"},e.prototype.removeDialog=function(){var e=(0,t.select)("#"+this.parentID+"conditionalformatting",document),i=e?(0,t.getInstance)(e,o.Dialog):null;i&&!i.isDestroyed&&(this.destroyColorPickers(),i.destroy()),e&&(0,t.remove)(e),this.fontColor=[],this.backgroundColor=[],this.newFormat=[]},e.prototype.destroyColorPickers=function(){for(var e=0;e<(this.newFormat?this.newFormat.length:0);e++)this.fontColor&&this.fontColor[e]&&!this.fontColor[e].isDestroyed&&this.fontColor[e].destroy(),this.backgroundColor&&this.backgroundColor[e]&&!this.backgroundColor[e].isDestroyed&&this.backgroundColor[e].destroy()},e.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var e=0;e<this.parent.dataSourceSettings.conditionalFormatSettings.length;e++)this.newFormat.push((0,t.extend)({},this.parent.dataSourceSettings.conditionalFormatSettings[e].properties,null,!0));this.createDialog(),(0,t.getInstance)((0,t.select)("#"+this.parentID+"conditionalformatting",document),o.Dialog).refresh(),this.addFormat()},e.prototype.destroy=function(){var e=(0,t.select)("#"+this.parentID+"conditionalformatting",document),i=e?(0,t.getInstance)(e,o.Dialog):null;i&&!i.isDestroyed&&i.close()},e}(),Al=function(){function e(e){this.isMultiAxisChange=!1,this.isReportChange=!1,this.currentReport="",this.parent=e,this.parent.toolbarModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.createToolbar=function(){this.parent.isModified=!1,this.renderDialog(),null!==(0,t.select)("#"+this.parent.element.id+"pivot-toolbar",this.parent.element)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"pivot-toolbar",this.parent.element));var e=(0,t.createElement)("div",{id:this.parent.element.id+"pivot-toolbar",className:kn});this.parent.showFieldList&&(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)?this.parent.element.insertBefore(e,(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)):this.parent.showGroupingBar&&(0,t.select)("#"+this.parent.element.id+" .e-pivot-grouping-bar",this.parent.element)?this.parent.element.insertBefore(e,(0,t.select)("#"+this.parent.element.id+" .e-pivot-grouping-bar",this.parent.element)):this.parent.element.insertBefore(e,(0,t.select)("#"+this.parent.element.id+"_grid",this.parent.element)),this.toolbar=new ds.Toolbar({created:this.create.bind(this),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,items:this.getItems(),allowKeyboard:!1,cssClass:this.parent.cssClass,width:this.parent.gridSettings.allowAutoResizing?"auto":this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2}),this.toolbar.isStringTemplate=!0;var i="viewContainerRef";this.parent[i]&&((0,t.setValue)("registeredTemplate",{},this.toolbar),this.toolbar[i]=this.parent[i]),this.parent.toolbarTemplate&&"string"==typeof this.parent.toolbarTemplate?(this.toolbar.appendTo(this.parent.toolbarTemplate),this.parent.element.replaceChild(this.toolbar.element,this.parent.element.querySelector("."+kn)),this.toolbar.element.classList.add(kn)):this.toolbar.appendTo(e),this.toolbar.width=this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber(),this.parent.chart&&this.parent.chart.setProperties({width:this.parent.grid?this.parent.getGridWidthAsNumber().toString():this.parent.getWidthAsNumber().toString()},!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ka)&&this.parent.groupingBarModule.refreshUI()},e.prototype.fetchReports=function(){var e={reportName:[]};return this.parent.trigger(G,e),e},e.prototype.fetchReportsArgs=function(){var e=new i.Deferred;return this.parent.trigger(G,{reportName:[]},(function(t){e.resolve(t)})),e},e.prototype.getItems=function(){for(var e=this.parent.toolbar.filter((function(e,t,i){return i.indexOf(e)===t})),i=[],a=0,r=e;a<r.length;a++){var n=r[a];switch(n){case"New":i.push({prefixIcon:"e-new-report "+Yi,tooltipText:this.parent.localeObj.getConstant("new"),click:this.actionClick.bind(this),id:this.parent.element.id+"new"});break;case"Save":i.push({prefixIcon:"e-save-report "+Yi,tooltipText:this.parent.localeObj.getConstant("save"),click:this.actionClick.bind(this),id:this.parent.element.id+"save"});break;case"SaveAs":i.push({prefixIcon:"e-saveas-report "+Yi,tooltipText:this.parent.localeObj.getConstant("saveAs"),click:this.actionClick.bind(this),id:this.parent.element.id+"saveas"});break;case"Rename":i.push({prefixIcon:"e-rename-report "+Yi,tooltipText:this.parent.localeObj.getConstant("rename"),click:this.actionClick.bind(this),id:this.parent.element.id+"rename"});break;case"Remove":i.push({prefixIcon:Rn+" "+Yi,tooltipText:this.parent.localeObj.getConstant("deleteReport"),click:this.actionClick.bind(this),id:this.parent.element.id+"remove"});break;case"Load":i.push({template:"<div><input class=e-load-report id="+this.parent.element.id+"_reportlist></input></div>",click:this.actionClick.bind(this),id:this.parent.element.id+"load"});break;case"Grid":var s="Chart"===this.parent.displayOption.view;i.push({prefixIcon:"e-toolbar-grid "+Yi,tooltipText:this.parent.localeObj.getConstant("grid"),id:this.parent.element.id+"grid",cssClass:(s?rn:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),click:this.menuItemClick.bind(this)});break;case"Chart":var o="Table"===this.parent.displayOption.view;i.push({template:'<ul id="'+this.parent.element.id+'chart_menu"></ul>',id:this.parent.element.id+"chartmenu",cssClass:(o?rn:"")+(this.parent.cssClass?" "+this.parent.cssClass:"")});break;case"MDX":"olap"===this.parent.dataType&&i.push({prefixIcon:"e-mdx "+Yi,id:this.parent.element.id+"mdxQuery",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("mdxQuery")});break;case"Export":i.push({template:'<ul id="'+this.parent.element.id+'export_menu"></ul>',id:this.parent.element.id+"exportmenu"});break;case"SubTotal":i.push({template:'<ul id="'+this.parent.element.id+'subtotal_menu"></ul>',id:this.parent.element.id+"subtotalmenu"});break;case"GrandTotal":i.push({template:'<ul id="'+this.parent.element.id+'grandtotal_menu"></ul>',id:this.parent.element.id+"grandtotalmenu"});break;case"ConditionalFormatting":i.push({prefixIcon:"e-toolbar-formatting "+Yi,id:this.parent.element.id+"formatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("toolbarFormatting")});break;case"NumberFormatting":i.push({prefixIcon:"e-pivot-format-toolbar "+Yi,id:this.parent.element.id+"numberFormatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("numberFormat")});break;case"Formatting":i.push({template:'<ul id="'+this.parent.element.id+'formatting_menu"></ul>',id:this.parent.element.id+"formattingmenu"});break;case"FieldList":i.push({prefixIcon:"e-toolbar-fieldlist "+Yi,tooltipText:this.parent.localeObj.getConstant("fieldList"),click:this.actionClick.bind(this),align:"Right",id:this.parent.element.id+"fieldlist"}),this.parent.element.querySelector(".e-toggle-field-list")&&(this.parent.element.querySelector(".e-toggle-field-list").style.display="none");break;default:"object"==typeof n&&i.push(n)}}this.parent.showFieldList&&-1===e.indexOf("FieldList")&&(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element)&&"none"===(0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element).style.display&&((0,t.select)("#"+this.parent.element.id+"_PivotFieldList",this.parent.element).style.display="block");var l={customToolbar:i};return this.parent.trigger(K,l),i},e.prototype.reportChange=function(e){if(this.parent.actionObj.actionName=qt,this.isReportChange=!0,this.parent.actionBeginMethod())e.cancel=!0;else try{this.dropArgs=e,this.parent.isModified&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.reportLoad(e)}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.reportLoad=function(e){var t=this;if("Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){var i={reportName:e.itemData.value},a={reportName:e.itemData.value};this.parent.actionObj.actionInfo=a,this.parent.trigger(z,i,(function(e){t.currentReport=e.reportName,t.parent.isModified=!1}))}},e.prototype.saveReport=function(e){if(this.currentReport&&""!==this.currentReport&&e.item.id===this.parent.element.id+"save"){var t={report:this.getCurrentReport(),reportName:this.currentReport};this.parent.actionObj.actionName=this.parent.getActionCompleteName();var i={reportName:this.currentReport};this.parent.actionObj.actionInfo=i,this.parent.trigger(_,t),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod(),this.parent.isModified=!1}else{if(""===this.currentReport&&(e.item.id===this.parent.element.id+"save"||e.item.id===this.parent.element.id+"saveas"))return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"));this.dialogShow(e,"saveAs")}},e.prototype.mdxQueryDialog=function(){(0,t.select)("#"+this.parent.element.id+"mdx-dialog",document)||this.renderMDXDialog();var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"mdx-dialog",document),o.Dialog),i=(0,t.createElement)("div",{className:"e-mdx-query"}),a=(0,t.createElement)("textarea",{className:Yn,attrs:{readonly:"readonly","aria-label":this.parent.localeObj.getConstant("mdxQuery")}});a.innerText=this.parent.olapEngineModule.getMDXQuery(this.parent.dataSourceSettings).trim(),i.appendChild(a),e.content=i,e.show()},e.prototype.dialogShow=function(e,i){if(e){var a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),o.Dialog);a.header=e.item.tooltipText;var r=(0,t.createElement)("div",{className:"e-report-outer"}),n=(0,t.createElement)("div",{className:"e-pivotview-report-label"});n.innerText=this.parent.localeObj.getConstant("reportName");var s=(0,t.createElement)("input",{className:jn+" "+cn,attrs:{placeholder:this.parent.localeObj.getConstant("emptyReportName"),value:i&&"rename"===i?this.currentReport:""}});s.innerText=i&&"rename"===i?this.currentReport:"",s.setSelectionRange(s.textContent.length,s.textContent.length),r.appendChild(n),r.appendChild(s),a.content=r,a.refresh(),a.show()}},e.prototype.renameReport=function(e){this.parent.trigger(X,e),this.currentReport&&""!==this.currentReport?this.dialogShow(e,"rename"):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"))},e.prototype.actionClick=function(e){var t=e.item.id===this.parent.element.id+"new"?lt:e.item.id===this.parent.element.id+"save"?dt:e.item.id===this.parent.element.id+"saveas"?pt:e.item.id===this.parent.element.id+"rename"?ht:e.item.id===this.parent.element.id+"remove"?ut:e.item.id===this.parent.element.id+"load"?ct:e.item.id===this.parent.element.id+"formatting"?gt:e.item.id===this.parent.element.id+"numberFormatting"?mt:e.item.id===this.parent.element.id+"mdxQuery"?ft:e.item.id===this.parent.element.id+"fieldlist"?St:"";if(this.parent.actionObj.actionName=t,!this.parent.actionBeginMethod())try{switch(e.item.id){case this.parent.element.id+"save":case this.parent.element.id+"saveas":this.saveReport(e);break;case this.parent.element.id+"remove":return this.action="Remove",void(this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeConfirm")):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport")));case this.parent.element.id+"rename":this.renameReport(e);break;case this.parent.element.id+"new":this.action="New",this.newArgs=e,this.parent.isModified&&this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.createNewReport(e);break;case this.parent.element.id+"load":this.action="Load";break;case this.parent.element.id+"fieldlist":this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.onShowFieldList();break;case this.parent.element.id+"formatting":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"mdxQuery":this.mdxQueryDialog();break;case this.parent.element.id+"numberFormatting":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog()}}catch(e){this.parent.actionFailureMethod(e)}},e.prototype.renderDialog=function(){null!==(0,t.select)("#"+this.parent.element.id+"report-dialog",this.parent.element)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"report-dialog",this.parent.element));var e=(0,t.createElement)("div",{id:this.parent.element.id+"report-dialog",className:"e-pivotview-report-dialog"});this.parent.element.appendChild(e);var i=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.okBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass});i.isStringTemplate=!0,i.appendTo(e)},e.prototype.renderMDXDialog=function(){null!==(0,t.select)("#"+this.parent.element.id+"mdx-dialog",this.parent.element)&&(0,t.remove)((0,t.select)("#"+this.parent.element.id+"mdx-dialog",this.parent.element));var e=(0,t.createElement)("div",{id:this.parent.element.id+"mdx-dialog",className:"e-pivotview-mdx-dialog"});this.parent.element.appendChild(e);var i=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.copyMDXQuery.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("copy"),isPrimary:!0}}],header:this.parent.localeObj.getConstant("mdxQuery"),isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass});i.isStringTemplate=!0,i.appendTo(e)},e.prototype.copyMDXQuery=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"mdx-dialog",document),o.Dialog).element.querySelector("."+Yn);try{e.select(),document.execCommand("copy")}catch(e){window.alert("Oops, unable to copy")}},e.prototype.okBtnClick=function(){var e=this,i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),o.Dialog),a=i.element.querySelector("."+jn);if(a&&""===a.value)a.focus();else{if(this.parent.localeObj||(this.parent=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id,document),rl)),i.header!==this.parent.localeObj.getConstant("save")&&i.header!==this.parent.localeObj.getConstant("saveAs")||!a.value||""===a.value){if(i.header===this.parent.localeObj.getConstant("new")&&a.value&&""!==a.value){this.action="New",this.currentReport=a.value;var r=!1,n=this,s={reportName:[]};this.parent.trigger(G,s,(function(i){for(var l=0;l<i.reportName.length;l++)if(a.value===s.reportName[l]){r=!0;break}if(r)n.createConfirmDialog(n.parent.localeObj.getConstant("alert"),n.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+a.value+'"'+n.parent.localeObj.getConstant("replaceConfirmAfter"));else{n.parent.trigger(Y);var d={report:n.getCurrentReport(),reportName:a.value},p={reportName:a.value};e.parent.actionObj.actionInfo=p,n.parent.trigger(_,d),n.parent.isModified=!1,n.updateReportList(),(0,t.getInstance)((0,t.select)("#"+e.parent.element.id+"report-dialog",document),o.Dialog).hide()}}))}else if(i.header===this.parent.localeObj.getConstant("rename")&&a.value&&""!==a.value){if(this.currentReport===a.value)return void i.hide();this.action="Rename";var l=!1;this.renameText=a.value;g=this.fetchReports();for(var d=0;d<g.reportName.length;d++)if(a.value===g.reportName[d]){l=!0;break}if(l)return void this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+a.value+'"'+this.parent.localeObj.getConstant("replaceConfirmAfter"));var p={reportName:this.currentReport,rename:a.value},h={reportName:{oldName:this.currentReport,newName:a.value}};this.parent.actionObj.actionInfo=h,this.parent.trigger(W,p),this.currentReport=a.value,this.updateReportList(),i.hide()}}else{this.action="Save",this.currentReport=a.value;var u=!1,c=this,g={reportName:[]};this.parent.trigger(G,g,(function(i){for(var r=0;r<i.reportName.length;r++)if(a.value===i.reportName[r]){u=!0;break}if(u)c.createConfirmDialog(c.parent.localeObj.getConstant("alert"),c.parent.localeObj.getConstant("replaceConfirmBefore")+'"'+a.value+'"'+c.parent.localeObj.getConstant("replaceConfirmAfter"));else{var n={report:c.getCurrentReport(),reportName:a.value},s={reportName:a.value};e.parent.actionObj.actionInfo=s,c.parent.trigger(_,n),c.parent.isModified=!1,c.updateReportList(),(0,t.getInstance)((0,t.select)("#"+e.parent.element.id+"report-dialog",document),o.Dialog).hide()}}))}this.parent.actionObj.actionName=this.parent.getActionCompleteName(),this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},e.prototype.createNewReport=function(e){this.dialogShow(e)},e.prototype.cancelBtnClick=function(){(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),o.Dialog).hide()},e.prototype.createConfirmDialog=function(e,i){document.getElementById(this.parent.element.id+"_ConfirmDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_ConfirmDialog").parentElement);var a=(0,t.createElement)("div",{id:this.parent.element.id+"_ConfirmDialog",className:_a});this.parent.element.appendChild(a);var r=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{buttonModel:{content:this.parent.localeObj.getConstant("yes"),isPrimary:!0,cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:"")},click:this.okButtonClick.bind(this)},{buttonModel:{content:this.parent.localeObj.getConstant("no"),cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:"")},click:this.cancelButtonClick.bind(this)}]});r.isStringTemplate=!0,r.appendTo(a),r.element.querySelector(".e-dlg-header").innerText=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(e):e},e.prototype.okButtonClick=function(){var e=this,i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),o.Dialog);if("Remove"===this.action){var a={reportName:this.currentReport},r={reportName:this.currentReport};this.parent.actionObj.actionInfo=r,this.parent.trigger(Q,a);var n=this.fetchReports();if(n.reportName&&n.reportName.length>0){var s={reportName:n.reportName[n.reportName.length-1]};this.parent.trigger(z,s,(function(t){e.currentReport=t.reportName,e.parent.isModified=!1})),this.currentReport=n.reportName[n.reportName.length-1]}else this.currentReport="",this.parent.isModified=!1,this.action="";this.updateReportList(),this.parent.actionObj.actionName=pi,this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}else if("New"===this.action||"Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){if(this.currentReport&&""!==this.currentReport&&this.parent.isModified){var l={report:this.getCurrentReport(),reportName:this.currentReport};r={reportName:this.currentReport};this.parent.actionObj.actionInfo=r,this.parent.actionObj.actionName=si,this.parent.actionObj.actionName&&this.parent.actionCompleteMethod(),this.parent.trigger(_,l),this.parent.isModified=!1,"New"===this.action?(this.parent.actionObj.actionName=lt,this.createNewReport(this.newArgs)):(this.parent.actionObj.actionName=qt,this.reportLoad(this.dropArgs))}else if("New"===this.action){this.parent.trigger(Y);l={report:this.getCurrentReport(),reportName:this.currentReport};this.parent.trigger(_,l),this.parent.isModified=!1,this.updateReportList(),i.hide()}}else if("Save"===this.action){l={report:this.getCurrentReport(),reportName:this.currentReport};this.parent.trigger(_,l),this.parent.isModified=!1,this.updateReportList(),i.hide()}else if("Rename"===this.action){var d={reportName:this.currentReport,rename:this.renameText,isReportExists:!0};this.parent.trigger(W,d),this.currentReport=this.renameText,this.parent.isModified=!1,this.updateReportList(),i.hide()}(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ConfirmDialog",document),o.Dialog).hide()},e.prototype.cancelButtonClick=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"report-dialog",document),o.Dialog);if("New"===this.action)this.parent.isModified?this.createNewReport(this.newArgs):e.hide();else if("Save"===this.action){if((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element)){var i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element),hs.DropDownList);this.currentReport=i.value}e.hide()}else"Rename"===this.action?e.hide():this.dropArgs&&"Remove"!==this.action&&this.reportLoad(this.dropArgs);(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ConfirmDialog",document),o.Dialog).hide()},e.prototype.createChartMenu=function(){var e=this;if((0,t.select)("#"+this.parent.element.id+"chart_menu",this.parent.element)){for(var i=(0,t.select)("#"+this.parent.element.id+"chart_menu",this.parent.element),a=[],r=this.getValidChartType(),n=0;n<r.length&&n<7;n++){var s=r[n];a.push({text:this.parent.localeObj.getConstant(s.toLowerCase()),id:this.parent.element.id+"_"+s})}7===a.length&&(a.splice(6),a.push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_ChartMoreOption"}));var o=a.length<=0||"Table"===this.parent.displayOption.view;a.push({separator:!0}),a.push({text:this.parent.localeObj.getConstant("multipleAxes"),id:this.parent.element.id+"_multipleAxes"}),a.push({text:this.parent.localeObj.getConstant("showLegend"),id:this.parent.element.id+"_showLegend"});var l=[{iconCss:"e-toolbar-chart "+Yi,items:o?[]:a}],d=i?(0,t.getInstance)(i,ds.Menu):null;d&&!d.isDestroyed&&(d.destroy(),d=null),(d=new ds.Menu({items:l,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:Jn+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.whitespaceRemove.bind(this),onClose:function(){e.focusToolBar()},beforeItemRender:this.multipleAxesCheckbox.bind(this)})).isStringTemplate=!0,d.appendTo(i)}},e.prototype.create=function(){var e=this;if((0,t.select)("#"+this.parent.element.id+"chart_menu",this.parent.element)&&this.createChartMenu(),(0,t.select)("#"+this.parent.element.id+"export_menu",this.parent.element)){var i=(0,t.select)("#"+this.parent.element.id+"export_menu",this.parent.element),a=[{iconCss:"e-export "+Yi,items:[{text:this.parent.localeObj.getConstant("pdf"),iconCss:Fn+" "+Yi,id:this.parent.element.id+"pdf"},{text:this.parent.localeObj.getConstant("excel"),iconCss:Ln+" "+Yi,id:this.parent.element.id+"excel"},{text:this.parent.localeObj.getConstant("csv"),iconCss:An+" "+Yi,id:this.parent.element.id+"csv"},{text:this.parent.localeObj.getConstant("png"),iconCss:"e-pivotview-png-export "+Yi,id:this.parent.element.id+"png"},{text:this.parent.localeObj.getConstant("jpeg"),iconCss:"e-pivotview-jpeg-export "+Yi,id:this.parent.element.id+"jpeg"},{text:this.parent.localeObj.getConstant("svg"),iconCss:"e-pivotview-svg-export "+Yi,id:this.parent.element.id+"svg"}]}],r=new ds.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:Jn+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.updateExportMenu.bind(this),onClose:function(){e.focusToolBar()}});r.isStringTemplate=!0,r.appendTo(i)}if((0,t.select)("#"+this.parent.element.id+"subtotal_menu",this.parent.element)){var n=(0,t.select)("#"+this.parent.element.id+"subtotal_menu",this.parent.element),s=(a=[{iconCss:"e-sub-total "+Yi,items:[{text:this.parent.localeObj.getConstant("showSubTotals"),id:this.parent.element.id+"subtotal",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("doNotShowSubTotals"),id:this.parent.element.id+"notsubtotal",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("showSubTotalsRowsOnly"),id:this.parent.element.id+"subtotalrow",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("showSubTotalsColumnsOnly"),id:this.parent.element.id+"subtotalcolumn",iconCss:Wn+" "+Yi},{separator:!0},{text:this.parent.localeObj.getConstant("subTotalPosition"),id:this.parent.element.id+"subtotalpositions",iconCss:zn+" "+Yi,items:[{text:this.parent.localeObj.getConstant("auto"),id:this.parent.element.id+"sub-none-position",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("top"),id:this.parent.element.id+"sub-top-position",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("bottom"),id:this.parent.element.id+"sub-bottom-position",iconCss:Wn+" "+Yi}]}]}],new ds.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:Jn+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.updateSubtotalSelection.bind(this),onClose:function(){e.focusToolBar()}}));s.isStringTemplate=!0,s.appendTo(n)}if((0,t.select)("#"+this.parent.element.id+"grandtotal_menu",this.parent.element)){var o=(0,t.select)("#"+this.parent.element.id+"grandtotal_menu",this.parent.element),l=(a=[{iconCss:"e-grand-total "+Yi,items:[{text:this.parent.localeObj.getConstant("showGrandTotals"),id:this.parent.element.id+"grandtotal",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("doNotShowGrandTotals"),id:this.parent.element.id+"notgrandtotal",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("showGrandTotalsRowsOnly"),id:this.parent.element.id+"grandtotalrow",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("showGrandTotalsColumnsOnly"),id:this.parent.element.id+"grandtotalcolumn",iconCss:Wn+" "+Yi},{separator:!0},{text:this.parent.localeObj.getConstant("grandTotalPosition"),id:this.parent.element.id+"grandtotalpositions",iconCss:zn+" "+Yi,items:[{text:this.parent.localeObj.getConstant("top"),id:this.parent.element.id+"top-position",iconCss:Wn+" "+Yi},{text:this.parent.localeObj.getConstant("bottom"),id:this.parent.element.id+"bottom-position",iconCss:Wn+" "+Yi}]}]}],new ds.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:Jn+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this),beforeOpen:this.updateGrandtotalSelection.bind(this),onClose:function(){e.focusToolBar()}}));l.isStringTemplate=!0,l.appendTo(o)}if((0,t.select)("#"+this.parent.element.id+"formatting_menu",this.parent.element)){var d=(0,t.select)("#"+this.parent.element.id+"formatting_menu",this.parent.element),p=(a=[{iconCss:"e-pivot-format-menu "+Yi,items:[{text:this.parent.localeObj.getConstant("numberFormatMenu"),iconCss:"e-pivot-number-format-menu "+Yi,id:this.parent.element.id+"numberFormattingMenu"},{text:this.parent.localeObj.getConstant("conditionalFormattingMenu"),iconCss:"e-pivot-conditional-format-menu "+Yi,id:this.parent.element.id+"conditionalFormattingMenu"}]}],new ds.Menu({items:a,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:Jn+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.menuItemClick.bind(this)}));p.isStringTemplate=!0,p.appendTo(d)}var h={report:this.parent.getPersistData(),reportName:this.parent.localeObj.getConstant("defaultReport")};if(this.currentReport=this.parent.localeObj.getConstant("defaultReport"),this.parent.trigger(_,h),(0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element)){var u=(0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element),c=this.fetchReports(),g=new hs.DropDownList({dataSource:c.reportName,width:"150px",popupHeight:"200px",placeholder:""===this.currentReport?this.parent.localeObj.getConstant("reportList"):"",enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-reportlist-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),select:this.reportChange.bind(this),value:this.currentReport});g.isStringTemplate=!0,g.appendTo(u)}this.updateItemElements()},e.prototype.getCurrentReport=function(){var e=this.parent.getPersistData();if("CSV"===this.parent.dataSourceSettings.type&&"Server"!==this.parent.dataSourceSettings.mode){var t=JSON.parse(e);t.dataSourceSettings.dataSource.splice(0,0,this.parent.engineModule.fields),e=JSON.stringify(t)}return e},e.prototype.updateItemElements=function(){for(var e=0,t=[].slice.call(this.toolbar.element.querySelectorAll(".e-toolbar-item"));e<t.length;e++){var i=t[e];i.querySelector("button")?i.querySelector("button").setAttribute("tabindex","0"):i.querySelector(".e-menu.e-menu-parent")&&(i.querySelector(".e-menu.e-menu-parent").setAttribute("tabindex","-1"),i.querySelector(".e-menu-item.e-menu-caret-icon")&&i.querySelector(".e-menu-item.e-menu-caret-icon").setAttribute("tabindex","0"))}},e.prototype.whitespaceRemove=function(e){var t=e.element.querySelector(".e-separator");t&&(t.style.margin="0px")},e.prototype.multipleAxesCheckbox=function(e){var i=this;if(this.parent.element.id+"_multipleAxes"===e.element.id){(n=(0,t.createElement)("input",{id:this.parent.element.id+"_checkBox"})).style.display="none",this.parent.element.appendChild(n);var a=new Cs.CheckBox({label:this.parent.localeObj.getConstant("multipleAxes"),cssClass:"e-multipleAxes"+(this.parent.cssClass?" "+this.parent.cssClass:""),checked:this.parent.chartSettings.enableMultipleAxis,change:function(){document.getElementById(i.parent.element.id+"_multipleAxes").click()},enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});e.element.innerText="",a.appendTo(n),["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)>-1&&!e.element.classList.contains(rn)?(e.element.classList.add(rn),a.disabled=!0):["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&e.element.classList.contains(rn)&&(e.element.classList.remove(rn),a.disabled=!1);var r=this.parent.element.querySelector("."+wn+".e-multipleAxes");e.element.appendChild(r)}else if(this.parent.element.id+"_showLegend"===e.element.id){var n;(n=(0,t.createElement)("input",{id:this.parent.element.id+"_showLegendCheckBox"})).style.display="none",this.parent.element.appendChild(n);a=new Cs.CheckBox({label:this.parent.localeObj.getConstant("showLegend"),checked:this.getLableState(),cssClass:"e-showLegend"+(this.parent.cssClass?" "+this.parent.cssClass:""),change:function(){document.getElementById(i.parent.element.id+"_showLegend").click()},enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});e.element.innerText="",a.appendTo(n);r=this.parent.element.querySelector("."+wn+".e-showLegend");e.element.appendChild(r)}},e.prototype.getLableState=function(){var e=JSON.parse(this.parent.getChartSettings()).chartSettings;return e&&e.legendSettings&&void 0!==e.legendSettings.visible?this.showLableState=e.legendSettings.visible:this.showLableState=!0,this.showLableState},e.prototype.getAllChartItems=function(){return["Line","Column","Area","Bar","StackingColumn","StackingArea","StackingBar","StackingLine","StepLine","StepArea","SplineArea","Scatter","Spline","StackingColumn100","StackingBar100","StackingArea100","StackingLine100","Bubble","Pareto","Polar","Radar","Pie","Pyramid","Funnel","Doughnut"]},e.prototype.updateExportMenu=function(e){var i=[].slice.call(e.element.querySelectorAll("li"));"Table"===this.parent.currentView?((0,t.addClass)(i.slice(3),nn),(0,t.removeClass)(i.slice(1,3),nn)):((0,t.addClass)(i.slice(1,3),nn),(0,t.removeClass)(i.slice(3),nn))},e.prototype.updateSubtotalSelection=function(e){e.parentItem.id!==this.parent.element.id+"subtotalpositions"?((0,t.select)("#"+this.parent.element.id+"subtotal ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"subtotal ."+Wn,e.element).classList.add(zn),(0,t.select)("#"+this.parent.element.id+"notsubtotal ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"notsubtotal ."+Wn,e.element).classList.add(zn),(0,t.select)("#"+this.parent.element.id+"subtotalrow ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"subtotalrow ."+Wn,e.element).classList.add(zn),(0,t.select)("#"+this.parent.element.id+"subtotalcolumn ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"subtotalcolumn ."+Wn,e.element).classList.add(zn),this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&!this.parent.dataSourceSettings.showColumnSubTotals?(0,t.select)("#"+this.parent.element.id+"subtotalrow ."+Wn,e.element).classList.remove(zn):this.parent.dataSourceSettings.showSubTotals&&!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?(0,t.select)("#"+this.parent.element.id+"subtotalcolumn ."+Wn,e.element).classList.remove(zn):this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?(0,t.select)("#"+this.parent.element.id+"subtotal ."+Wn,e.element).classList.remove(zn):this.parent.dataSourceSettings.showSubTotals&&(this.parent.dataSourceSettings.showRowSubTotals||this.parent.dataSourceSettings.showColumnSubTotals)||(0,t.select)("#"+this.parent.element.id+"notsubtotal ."+Wn,e.element).classList.remove(zn)):((0,t.select)("#"+this.parent.element.id+"sub-none-position ."+Wn,e.element).classList.add(zn),"Auto"===this.parent.dataSourceSettings.subTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"sub-none-position ."+Wn,e.element).classList.remove(zn),(0,t.select)("#"+this.parent.element.id+"sub-top-position ."+Wn,e.element).classList.add(zn),"Top"===this.parent.dataSourceSettings.subTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"sub-top-position ."+Wn,e.element).classList.remove(zn),(0,t.select)("#"+this.parent.element.id+"sub-bottom-position ."+Wn,e.element).classList.add(zn),"Bottom"===this.parent.dataSourceSettings.subTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"sub-bottom-position ."+Wn,e.element).classList.remove(zn))},e.prototype.updateGrandtotalSelection=function(e){e.parentItem.id!==this.parent.element.id+"grandtotalpositions"?((0,t.select)("#"+this.parent.element.id+"grandtotal ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"grandtotal ."+Wn,e.element).classList.add(zn),(0,t.select)("#"+this.parent.element.id+"notgrandtotal ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"notgrandtotal ."+Wn,e.element).classList.add(zn),(0,t.select)("#"+this.parent.element.id+"grandtotalrow ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"grandtotalrow ."+Wn,e.element).classList.add(zn),(0,t.select)("#"+this.parent.element.id+"grandtotalcolumn ."+Wn,e.element).classList.contains(zn)||(0,t.select)("#"+this.parent.element.id+"grandtotalcolumn ."+Wn,e.element).classList.add(zn),this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&!this.parent.dataSourceSettings.showColumnGrandTotals?(0,t.select)("#"+this.parent.element.id+"grandtotalrow ."+Wn,e.element).classList.remove(zn):this.parent.dataSourceSettings.showGrandTotals&&!this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?(0,t.select)("#"+this.parent.element.id+"grandtotalcolumn ."+Wn,e.element).classList.remove(zn):this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?(0,t.select)("#"+this.parent.element.id+"grandtotal ."+Wn,e.element).classList.remove(zn):this.parent.dataSourceSettings.showGrandTotals&&(this.parent.dataSourceSettings.showRowGrandTotals||this.parent.dataSourceSettings.showColumnGrandTotals)||(0,t.select)("#"+this.parent.element.id+"notgrandtotal ."+Wn,e.element).classList.remove(zn)):((0,t.select)("#"+this.parent.element.id+"top-position ."+Wn,e.element).classList.add(zn),"Top"===this.parent.dataSourceSettings.grandTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"top-position ."+Wn,e.element).classList.remove(zn),(0,t.select)("#"+this.parent.element.id+"bottom-position ."+Wn,e.element).classList.add(zn),"Bottom"===this.parent.dataSourceSettings.grandTotalsPosition&&(0,t.select)("#"+this.parent.element.id+"bottom-position ."+Wn,e.element).classList.remove(zn))},e.prototype.updateReportList=function(){if((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element)){var e=this.fetchReports(),i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_reportlist",this.parent.element),hs.DropDownList);i.dataSource=e.reportName,""===this.currentReport&&i.dataSource.length>0?(i.value=i.dataSource[i.dataSource.length-1],i.text=i.dataSource[i.dataSource.length-1],this.currentReport=i.dataSource[i.dataSource.length-1]):(i.value=this.currentReport,i.text=this.currentReport),i.refresh()}},e.prototype.menuItemClick=function(e){var t,i=this,a={},r=e.item.id===this.parent.element.id+"grid"?vt:e.item.id===this.parent.element.id+"_Column"||e.item.id===this.parent.element.id+"_Bar"||e.item.id===this.parent.element.id+"_Line"||e.item.id===this.parent.element.id+"_Area"||e.item.id===this.parent.element.id+"_Scatter"||e.item.id===this.parent.element.id+"_Polar"||e.item.id===this.parent.element.id+"_ChartMoreOption"?yt:e.item.id===this.parent.element.id+"_multipleAxes"?bt:e.item.id===this.parent.element.id+"_showLegend"?Ct:e.item.id===this.parent.element.id+"pdf"?xt:e.item.id===this.parent.element.id+"png"?wt:e.item.id===this.parent.element.id+"excel"?Tt:e.item.id===this.parent.element.id+"csv"?Mt:e.item.id===this.parent.element.id+"jpeg"?Dt:e.item.id===this.parent.element.id+"svg"?Ot:e.item.id===this.parent.element.id+"notsubtotal"?Pt:e.item.id===this.parent.element.id+"subtotalrow"?Nt:e.item.id===this.parent.element.id+"subtotalcolumn"?Et:e.item.id===this.parent.element.id+"subtotal"?It:e.item.id===this.parent.element.id+"notgrandtotal"?Ft:e.item.id===this.parent.element.id+"grandtotalrow"?Lt:e.item.id===this.parent.element.id+"grandtotalcolumn"?At:e.item.id===this.parent.element.id+"grandtotal"?Rt:e.item.id===this.parent.element.id+"numberFormattingMenu"?kt:e.item.id===this.parent.element.id+"conditionalFormattingMenu"?jt:"";if(this.parent.actionObj.actionName=r,!this.parent.actionBeginMethod()){(this.getAllChartItems().indexOf(e.item.id.split(this.parent.element.id+"_")[1])>-1||"ChartMoreOption"===e.item.id.split(this.parent.element.id+"_")[1]||"multipleAxes"===e.item.id.split(this.parent.element.id+"_")[1]||"showLegend"===e.item.id.split(this.parent.element.id+"_")[1])&&(t=e.item.id.split(this.parent.element.id+"_")[1]);try{switch(e.item.id){case this.parent.element.id+"grid":if(this.parent.grid&&this.parent.chart){this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none"),this.parent.currentView="Table",this.parent.setProperties({displayOption:{primary:"Table"}},!0),this.parent.showGroupingBar&&this.parent.groupingBarModule&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none");var n={toolbarInfo:{displayOption:this.parent.displayOption,gridSettings:this.parent.gridSettings}};this.parent.actionObj.actionInfo=n,this.parent.layoutRefresh()}break;case this.parent.element.id+"pdf":"Table"===this.parent.currentView?this.parent.pdfExport({fileName:"Export.pdf"},!1,void 0,!1):this.parent.chartExport("PDF",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"excel":a={excelExportProperties:{fileName:"Export.xlsx"},isBlob:void 0,isMultipleExport:void 0,workbook:void 0},this.parent.trigger(m,a,(function(e){i.parent.excelExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"csv":a={excelExportProperties:{fileName:"Export.csv"},isBlob:!1,isMultipleExport:!1,workbook:void 0},this.parent.trigger(m,a,(function(e){"Server"===i.parent.dataSourceSettings.mode?i.parent.getEngine("onCsvExport",null,null,null,null,null,null,null,null,e.excelExportProperties):i.parent.csvExport(e.excelExportProperties,e.isMultipleExport,e.workbook,e.isBlob)}));break;case this.parent.element.id+"png":this.parent.chartExport("PNG",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"jpeg":this.parent.chartExport("JPEG",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"svg":this.parent.chartExport("SVG",{fileName:"result"},void 0,null,void 0);break;case this.parent.element.id+"notsubtotal":this.parent.setProperties({dataSourceSettings:{showSubTotals:!1,showColumnSubTotals:!1,showRowSubTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotalrow":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!1,showRowSubTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotalcolumn":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!0,showRowSubTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"subtotal":this.parent.setProperties({dataSourceSettings:{showSubTotals:!0,showColumnSubTotals:!0,showRowSubTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"notgrandtotal":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!1,showColumnGrandTotals:!1,showRowGrandTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotalrow":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!1,showRowGrandTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotalcolumn":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!0,showRowGrandTotals:!1}},!0),this.parent.refreshData();break;case this.parent.element.id+"grandtotal":this.parent.setProperties({dataSourceSettings:{showGrandTotals:!0,showColumnGrandTotals:!0,showRowGrandTotals:!0}},!0),this.parent.refreshData();break;case this.parent.element.id+"top-position":this.parent.setProperties({dataSourceSettings:{grandTotalsPosition:"Top"}},!0),this.parent.refreshData();break;case this.parent.element.id+"bottom-position":this.parent.setProperties({dataSourceSettings:{grandTotalsPosition:"Bottom"}},!0),this.parent.refreshData();break;case this.parent.element.id+"sub-top-position":this.parent.setProperties({dataSourceSettings:{subTotalsPosition:"Top"}},!0),this.parent.refreshData();break;case this.parent.element.id+"sub-bottom-position":this.parent.setProperties({dataSourceSettings:{subTotalsPosition:"Bottom"}},!0),this.parent.refreshData();break;case this.parent.element.id+"sub-none-position":this.parent.setProperties({dataSourceSettings:{subTotalsPosition:"Auto"}},!0),this.parent.refreshData();break;case this.parent.element.id+"numberFormattingMenu":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog();break;case this.parent.element.id+"conditionalFormattingMenu":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"_"+t:e.item&&e.item.text&&("ChartMoreOption"===t?this.createChartTypeDialog():"multipleAxes"===t?(this.parent.chartSettings.enableScrollOnMultiAxis&&(this.isMultiAxisChange=!0),this.parent.chartSettings.enableMultipleAxis=!this.parent.chartSettings.enableMultipleAxis,this.updateChartType(this.parent.chartSettings.chartSeries.type,!0)):this.getAllChartItems().indexOf(t)>-1?this.updateChartType(t,!1):"showLegend"===t&&(this.parent.chart.legendSettings.visible=!this.showLableState,this.parent.chartSettings.legendSettings?this.parent.chartSettings.legendSettings.visible=!this.showLableState:this.parent.setProperties({chartSettings:{legendSettings:{visible:!this.showLableState}}},!0),this.updateChartType(this.parent.chartSettings.chartSeries.type,!0)))}}catch(e){this.parent.actionFailureMethod(e)}}},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(tt,this.createToolbar,this)},e.prototype.getValidChartType=function(){for(var e=[],t=0;t<=this.parent.chartTypes.length;t++){var i=this.parent.chartTypes[t];this.getAllChartItems().indexOf(i)>-1&&e.indexOf(i)<0&&e.push(i)}return e},e.prototype.createChartTypeDialog=function(){var e=this,i=this.parent.element.appendChild((0,t.createElement)("div",{id:this.parent.element.id+"_ChartTypeDialog",className:"e-pivotchart-type-dialog"})),a=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("chartTypeSettings"),content:this.getDialogContent(),isModal:!0,beforeOpen:this.beforeOpen.bind(this),visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:function(){e.chartTypeDialogUpdate()},buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){e.removeDialog()},buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parent.element,cssClass:this.parent.cssClass,close:this.removeDialog.bind(this)});a.isStringTemplate=!0,a.appendTo(i)},e.prototype.removeDialog=function(){var e=(0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",this.parent.element)?(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",this.parent.element),o.Dialog):null;e&&!e.isDestroyed&&e.destroy(),document.getElementById(this.parent.element.id+"_ChartTypeDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_ChartTypeDialog"))},e.prototype.chartTypeDialogUpdate=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeOption"),hs.DropDownList).value,i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis"),Cs.CheckBox).checked,a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogShowLabel"),Cs.CheckBox).checked;this.parent.chart.legendSettings.visible=a,this.chartLableState&&(this.parent.chart.legendSettings.visible=a,this.parent.chartSettings.legendSettings?this.parent.chartSettings.legendSettings.visible=a:this.parent.setProperties({chartSettings:{legendSettings:{visible:a}}},!0)),this.updateChartType(e,!1),this.parent.chartSettings.enableMultipleAxis=i,this.parent.chartSettings.multipleAxisMode=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),hs.DropDownList).value,((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document),o.Dialog):null).close()},e.prototype.updateChartType=function(e,i){if(this.getAllChartItems().indexOf(e)>-1&&this.parent.chart){this.parent.currentView="Chart",this.parent.setProperties({displayOption:{primary:"Chart"}},!0),this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&(this.parent.element.querySelector("."+qn).style.width=(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())),this.parent.chart.setProperties({width:(0,t.formatUnit)(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())},!0),this.parent.chartSettings.chartSeries.type!==e||i?this.parent.chartSettings.chartSeries.type=e:this.parent.chart.refresh();var a={toolbarInfo:{displayOption:this.parent.displayOption,chartSettings:this.parent.chartSettings}};this.parent.actionObj.actionInfo=a}},e.prototype.getDialogContent=function(){var e=(0,t.createElement)("div",{className:"e-chart-type-div-content"}),i=(0,t.createElement)("div",{className:"e-chart-type-option-container"}),a=(0,t.createElement)("div",{className:"e-multiple-axes-mode-container"}),r=(0,t.createElement)("div",{className:"e-chart-type-option-text"});r.innerText=this.parent.localeObj.getConstant("ChartType");var n=(0,t.createElement)("div",{className:"e-multiple-axes-mode-text"});n.innerText=this.parent.localeObj.getConstant("multipleAxisMode");var s=(0,t.createElement)("div",{id:this.parent.element.id+"_ChartTypeOption"}),o=(0,t.createElement)("div",{id:this.parent.element.id+"_AxisModeOption"});i.appendChild(r),i.appendChild(s);for(var l=[],d=[{value:"Stacked",text:this.parent.localeObj.getConstant("stacked")},{value:"Single",text:this.parent.localeObj.getConstant("single")},{value:"Combined",text:this.parent.localeObj.getConstant("combined")}],p=this.getValidChartType(),h=0;h<p.length;h++)l.push({value:p[h],text:this.parent.localeObj.getConstant(p[h].toLowerCase())});var u=new hs.DropDownList({dataSource:l,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:this.parent.chartSettings.chartSeries.type?this.parent.chartSettings.chartSeries.type:this.getValidChartType()[0],width:"100%",change:this.changeDropDown.bind(this),cssClass:this.parent.cssClass});u.isStringTemplate=!0,u.appendTo(s),e.appendChild(i);var c=(0,t.createElement)("input",{id:this.parent.element.id+"_DialogMultipleAxis",attrs:{type:"checkbox"}});e.appendChild(c);var g=(0,t.createElement)("input",{id:this.parent.element.id+"_DialogShowLabel",attrs:{type:"checkbox"}});e.appendChild(g),a.appendChild(n),a.appendChild(o),e.appendChild(a);var m=new hs.DropDownList({dataSource:d,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:this.parent.chartSettings.multipleAxisMode?this.parent.chartSettings.multipleAxisMode:"Stacked",width:"100%",enabled:this.parent.chartSettings.enableMultipleAxis,cssClass:this.parent.cssClass});return m.isStringTemplate=!0,m.appendTo(o),e},e.prototype.changeDropDown=function(e){var i=JSON.parse(this.parent.getChartSettings()).chartSettings;if(i&&i.legendSettings&&void 0!==i.legendSettings.visible||((0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogShowLabel"),Cs.CheckBox).checked=!0),["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(e.value.toString())>-1)(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis"),Cs.CheckBox).disabled=!0,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),hs.DropDownList).enabled=!1;else{var a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis"),Cs.CheckBox);a.disabled=!1,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),hs.DropDownList).enabled=a.checked}},e.prototype.beforeOpen=function(){var e=this,i=new Cs.CheckBox({label:this.parent.localeObj.getConstant("multipleAxes"),cssClass:"e-dialog-multiple-axis"+(this.parent.cssClass?" "+this.parent.cssClass:""),checked:!!this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableMultipleAxis,change:function(i){(0,t.getInstance)((0,t.select)("#"+e.parent.element.id+"_AxisModeOption"),hs.DropDownList).enabled=i.checked},enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),a=new Cs.CheckBox({label:this.parent.localeObj.getConstant("showLegend"),checked:this.getLableState(),change:function(){e.chartLableState=!0},cssClass:"e-dialog-show-legend"+(this.parent.cssClass?" "+this.parent.cssClass:""),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),r=(0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document)?(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document),o.Dialog):null;a.appendTo((0,t.select)("#"+this.parent.element.id+"_DialogShowLabel",r.element)),i.appendTo((0,t.select)("#"+this.parent.element.id+"_DialogMultipleAxis",r.element)),["Pie","Funnel","Pyramid","Doughnut","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)>-1&&(i.disabled=!0,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_AxisModeOption"),hs.DropDownList).enabled=!1);var n=JSON.parse(this.parent.getChartSettings()).chartSettings;n&&n.legendSettings&&void 0!==n.legendSettings.visible?this.chartLableState=!0:this.chartLableState=!1},e.prototype.refreshToolbar=function(){this.createToolbar()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(tt,this.createToolbar)},e.prototype.destroy=function(){this.removeEventListener();var e=(0,t.select)("#"+this.parent.element.id+"_ConfirmDialog",document),i=e?(0,t.getInstance)(e,o.Dialog):null;i&&!i.isDestroyed&&(i.destroy(),i=null);var a=(e=(0,t.select)("#"+this.parent.element.id+"report-dialog",document))?(0,t.getInstance)(e,o.Dialog):null;a&&!a.isDestroyed&&(a.destroy(),a=null);var r=(e=(0,t.select)("#"+this.parent.element.id+"mdx-dialog",document))?(0,t.getInstance)(e,o.Dialog):null;r&&!r.isDestroyed&&(r.destroy(),r=null);var n=(e=(0,t.select)("#"+this.parent.element.id+"chart_menu",document))?(0,t.getInstance)(e,ds.Menu):null;n&&!n.isDestroyed&&(n.destroy(),n=null);var s=(e=(0,t.select)("#"+this.parent.element.id+"_ChartTypeDialog",document))?(0,t.getInstance)(e,o.Dialog):null;s&&!s.isDestroyed&&(s.destroy(),s=null);var l=(e=(0,t.select)("#"+this.parent.element.id+"export_menu",document))?(0,t.getInstance)(e,ds.Menu):null;l&&!l.isDestroyed&&(l.destroy(),l=null);var d=(e=(0,t.select)("#"+this.parent.element.id+"subtotal_menu",document))?(0,t.getInstance)(e,ds.Menu):null;d&&!d.isDestroyed&&(d.destroy(),d=null);var p=(e=(0,t.select)("#"+this.parent.element.id+"grandtotal_menu",document))?(0,t.getInstance)(e,ds.Menu):null;p&&!p.isDestroyed&&(p.destroy(),p=null);var h=(e=(0,t.select)("#"+this.parent.element.id+"formatting_menu",document))?(0,t.getInstance)(e,ds.Menu):null;h&&!h.isDestroyed&&(h.destroy(),h=null);var u=(e=(0,t.select)("#"+this.parent.element.id+"_reportlist",document))?(0,t.getInstance)(e,hs.DropDownList):null;u&&!u.isDestroyed&&(u.destroy(),u=null),this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.destroy(),this.toolbar=null),(e=(0,t.select)("#"+this.parent.element.id+"pivot-toolbar",document))&&(0,t.remove)(e)},e.prototype.focusToolBar=function(){(0,t.removeClass)(document.querySelector("."+kn).querySelectorAll(".e-menu-item.e-focused"),"e-focused"),(0,t.removeClass)(document.querySelector("."+kn).querySelectorAll(".e-menu-item.e-selected"),"e-selected"),document.querySelector(".e-toolbar-items")&&(0,t.addClass)([document.querySelector(".e-toolbar-items")],"e-focused")},e}(),Rl=function(){function e(e){this.parent=e,this.parent.numberFormattingModule=this,this.removeEventListener(),this.addEventListener(),this.newFormat=[],this.lastFormattedValue=[]}return e.prototype.getModuleName=function(){return"numberFormatting"},e.prototype.showNumberFormattingDialog=function(){var e,i=this,a=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatDialog",className:"e-pivot-format-dialog"});this.parent.element.appendChild(a),this.dialog=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("numberFormat"),content:this.getDialogContent(),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateFormatting.bind(this),buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply"),isPrimary:!0}},{click:function(){i.dialog.hide()},buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,cssClass:this.parent.cssClass,target:this.parent.element,close:this.removeDialog.bind(this)}),this.dialog.isStringTemplate=!0,this.dialog.appendTo(a),this.dialog.element.querySelector("."+mn).innerText=this.parent.localeObj.getConstant("numberFormat"),this.newFormat=[{name:this.parent.localeObj.getConstant("AllValues"),format:"N0",useGrouping:!0,type:void 0}];for(var r=[],n=0;n<this.parent.dataSourceSettings.formatSettings.length;n++)e={name:this.parent.dataSourceSettings.formatSettings[n].name,format:this.parent.dataSourceSettings.formatSettings[n].format,useGrouping:this.parent.dataSourceSettings.formatSettings[n].useGrouping,type:this.parent.dataSourceSettings.formatSettings[n].type},this.newFormat.push(e);for(n=0;n<this.newFormat.length;n++)r.push(this.newFormat[n].name);for(var s=0;s<this.parent.dataSourceSettings.values.length;s++)-1===r.indexOf(this.parent.dataSourceSettings.values[s].name)&&(e={name:this.parent.dataSourceSettings.values[s].name,format:"N0",useGrouping:!0},this.newFormat.push(e));this.renderControls()},e.prototype.getDialogContent=function(){var e=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatDialogOuter",className:"e-pivot-format-dialog-outer"}),i=(0,t.createElement)("table",{id:this.parent.element.id+"_FormatTable",className:"e-pivot-format-table",attrs:{role:"tableItems"}}),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td"),n=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatValueLable",className:"e-pivot-format-value-lable"});n.innerText=this.parent.localeObj.getConstant("values");var s=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatValueDrop"});r.appendChild(n),r.appendChild(s),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td");var o=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatLable",className:"e-pivot-format-lable"});o.innerText=this.parent.localeObj.getConstant("formatType");var l=(0,t.createElement)("div",{id:this.parent.element.id+"_FormatDrop"});r.appendChild(o),r.appendChild(l),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td");var d=(0,t.createElement)("div",{id:this.parent.element.id+"_GroupingLable",className:"e-pivot-format-grouping-lable"});d.innerText=this.parent.localeObj.getConstant("grouping");var p=(0,t.createElement)("div",{id:this.parent.element.id+"_GroupingDrop"});r.appendChild(d),r.appendChild(p),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td");var h=(0,t.createElement)("div",{id:this.parent.element.id+"_DecimalLable",className:"e-pivot-format-decimal-lable"});h.innerText=this.parent.localeObj.getConstant("decimalPlaces");var u=(0,t.createElement)("div",{id:this.parent.element.id+"_DecimalDrop"});return r.appendChild(h),r.appendChild(u),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),r=(0,t.createElement)("td"),this.customLable=(0,t.createElement)("div",{id:this.parent.element.id+"_CustomLable",className:"e-pivot-format-custom-lable"}),this.customLable.innerText=this.parent.localeObj.getConstant("customFormatString"),this.customText=(0,t.createElement)("input",{id:this.parent.element.id+"_CustomText",attrs:{type:"text",tabindex:"0"},className:cn+" e-pivot-format-custom-text"}),r.appendChild(this.customLable),r.appendChild(this.customText),a.appendChild(r),i.appendChild(a),a=(0,t.createElement)("tr"),i.appendChild(a),e.appendChild(i),e},e.prototype.renderControls=function(){var e,i,a;if((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.dialog.element)){var r=[];r.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var n=0;n<this.parent.dataSourceSettings.values.length;n++){var s=this.parent.dataSourceSettings.values[n].caption||this.parent.dataSourceSettings.values[n].name;s=this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(s):s,r.push({index:n+1,name:s,field:this.parent.dataSourceSettings.values[n].name})}(e=new hs.DropDownList({dataSource:r,fields:{text:"name",value:"field"},enableRtl:this.parent.enableRtl,locale:this.parent.locale,index:0,cssClass:"e-pivot-format-value-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),change:this.valueChange.bind(this),width:"100%",open:this.customUpdate.bind(this)})).isStringTemplate=!0,e.appendTo((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.dialog.element))}if((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.dialog.element)){var o=[{index:0,name:this.parent.localeObj.getConstant("number")},{index:1,name:this.parent.localeObj.getConstant("currency")},{index:2,name:this.parent.localeObj.getConstant("percentage")},{index:3,name:this.parent.localeObj.getConstant("Custom")}];(i=new hs.DropDownList({dataSource:o,fields:{text:"name",value:"name"},index:0,change:this.dropDownChange.bind(this),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-pivot-format-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%"})).isStringTemplate=!0,i.appendTo((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.dialog.element))}if((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.dialog.element)){o=[{index:0,name:this.parent.localeObj.getConstant("true")},{index:1,name:this.parent.localeObj.getConstant("false")}];(a=new hs.DropDownList({dataSource:o,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,locale:this.parent.locale,index:0,cssClass:"e-pivot-format-grouping-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:this.groupingChange.bind(this)})).isStringTemplate=!0,a.appendTo((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.dialog.element))}if((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.dialog.element)){o=[{index:0,name:0},{index:1,name:1},{index:2,name:2},{index:3,name:3},{index:4,name:4},{index:5,name:5},{index:6,name:6},{index:7,name:7},{index:8,name:8},{index:9,name:9},{index:10,name:10}];var l=new hs.DropDownList({dataSource:o,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,locale:this.parent.locale,index:0,cssClass:"e-pivot-format-decimal-drop"+(this.parent.cssClass?" "+this.parent.cssClass:""),popupHeight:150,width:"100%",change:this.decimalChange.bind(this)});l.isStringTemplate=!0,l.appendTo((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.dialog.element))}if(i.value!==this.parent.localeObj.getConstant("Custom")&&(this.customText.disabled=!0),0!==this.lastFormattedValue.length){e.value=this.lastFormattedValue[0].name;var d=this.lastFormattedValue[0].format,p=""===d?"":d.split("")[0].toLowerCase(),h=this.lastFormattedValue[0].useGrouping?this.parent.localeObj.getConstant("true"):this.parent.localeObj.getConstant("false");this.updateFormattingDialog(d,p,h)}},e.prototype.valueChange=function(e){for(var i=this.newFormat,a=!1,r=0;r<i.length;r++)if(i[r].name===e.value){var n=i[r].format,s=""===n?"":n.split("")[0].toLowerCase(),o=i[r].useGrouping?this.parent.localeObj.getConstant("true"):this.parent.localeObj.getConstant("false");this.updateFormattingDialog(n,s,o),a=!0;break}a||((0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),hs.DropDownList).value=this.parent.localeObj.getConstant("number"),(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),hs.DropDownList).value=0,(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),hs.DropDownList).value=this.parent.localeObj.getConstant("true"))},e.prototype.updateFormattingDialog=function(e,i,a){var r=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),hs.DropDownList);2===e.length&&["n","p","c"].indexOf(i)>-1?(r.value="n"===i?this.parent.localeObj.getConstant("number"):"p"===i?this.parent.localeObj.getConstant("percentage"):"c"===i?this.parent.localeObj.getConstant("currency"):this.parent.localeObj.getConstant("number"),(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),hs.DropDownList).value=Number(e.split("")[1]),(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),hs.DropDownList).value=a):(r.value=this.parent.localeObj.getConstant("Custom"),this.customText.value=e)},e.prototype.customUpdate=function(){if((0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),hs.DropDownList).value===this.parent.localeObj.getConstant("Custom")){var e=this.getIndexValue();this.newFormat[e].format=this.customText.value}},e.prototype.dropDownChange=function(e){var i=this.getIndexValue(),a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),hs.DropDownList),r=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),hs.DropDownList);if(e.value===this.parent.localeObj.getConstant("Custom"))this.customText.disabled=!1,a.enabled=!1,r.enabled=!1,this.newFormat[i].format=this.customText.value;else{var n=this.formattedText();this.newFormat[i].format=n,this.customText.disabled=!0,a.enabled=!0,r.enabled=!0,this.customText.value=""}},e.prototype.groupingChange=function(){var e=this.getIndexValue(),i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),hs.DropDownList);this.newFormat[e].useGrouping=i.value===this.parent.localeObj.getConstant("true")},e.prototype.getIndexValue=function(){for(var e=[],i=0;i<this.newFormat.length;i++)e.push(this.newFormat[i].name);var a=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.parent.element),hs.DropDownList);return e.indexOf(a.value.toString())},e.prototype.decimalChange=function(){var e=this.getIndexValue(),t=this.formattedText();this.newFormat[e].format=t},e.prototype.formattedText=function(){var e=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatDrop",this.parent.element),hs.DropDownList),i=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_DecimalDrop",this.parent.element),hs.DropDownList);return e.value===this.parent.localeObj.getConstant("number")||e.value===this.parent.localeObj.getConstant("percentage")||e.value===this.parent.localeObj.getConstant("currency")?(e.value===this.parent.localeObj.getConstant("number")?"N":e.value===this.parent.localeObj.getConstant("currency")?"C":"P")+i.value:this.customText.value},e.prototype.removeDialog=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),document.getElementById(this.parent.element.id+"_FormatDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_FormatDialog"))},e.prototype.updateFormatting=function(){var e=this,i=this.formattedText(),a=this.getIndexValue();this.newFormat.splice(a,1);for(var n=(0,t.extend)([],this.newFormat,!0),s=this.parent.dataSourceSettings.formatSettings,o=0;o<s.length;o++)this.insertFormat(s[o].name,s[o].format,s[o].type);var l=(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_FormatValueDrop",this.parent.element),hs.DropDownList);if(l.value===this.parent.localeObj.getConstant("AllValues"))for(o=0;o<this.parent.dataSourceSettings.values.length;o++)this.insertFormat(this.parent.dataSourceSettings.values[o].name,i);else this.insertFormat(l.value.toString(),i);var d={formatSettings:r.cloneFormatSettings(this.newFormat),formatName:l.value.toString(),cancel:!1};this.parent.trigger(Ae,d,(function(t){if(t.cancel)e.dialog.close(),e.parent.setProperties({dataSourceSettings:{formatSettings:n}},!0);else{e.parent.setProperties({dataSourceSettings:{formatSettings:t.formatSettings}},!0);var i={numberFormattingInfo:e.parent.dataSourceSettings.formatSettings};e.parent.actionObj.actionInfo=i;try{e.parent.updateDataSource(),e.dialog.close()}catch(t){e.parent.setProperties({dataSourceSettings:{formatSettings:n}},!0),e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("invalidFormat"),e.dialog.element),e.parent.hideWaitingPopup()}}}))},e.prototype.insertFormat=function(e,i,a){for(var r=!1,n={name:e,format:i,useGrouping:(0,t.getInstance)((0,t.select)("#"+this.parent.element.id+"_GroupingDrop",this.parent.element),hs.DropDownList).value===this.parent.localeObj.getConstant("true"),type:a},s=this.newFormat,o=0;o<s.length;o++)s[o].name===e&&(s[o]=n,r=!0);r||s.push(n),this.lastFormattedValue=[],this.lastFormattedValue.push(n)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(at,this.showNumberFormattingDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(at,this.showNumberFormattingDialog)},e.prototype.destroy=function(){this.dialog&&!this.dialog.isDestroyed&&(this.dialog.destroy(),this.dialog=null),this.removeEventListener()},e}(),kl=function(){function e(e){this.dateGroup=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,this.parent=e,this.parent.groupingModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"grouping"},e.prototype.render=function(e){var t=e.target,i=e.option,a=e.parentElement,r=[];this.parentElement=a,this.isUpdate=!1;var n=Number(t.getAttribute("data-colindex")),s=Number(t.getAttribute("index")),o=this.parent.engineModule.pivotValues[s][n],l=o.valueSort.axis.toString();(r=this.getSelectedCells(o.axis,l,o.actualText.toString())).push({axis:o.axis,fieldName:l,name:o.actualText.toString(),cellInfo:o}),-1!==i.replace(a.id,"").indexOf("_custom_group")?this.createGroupSettings(l,r):this.updateUnGroupSettings(l,r)},e.prototype.getSelectedOptions=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var n=a[i];-1===r.inArray(n.name,t)&&t.push(n.name)}return t},e.prototype.createGroupSettings=function(e,t){var i=this.parent.engineModule.fieldList[e],a=this.getGroupSettings(e);if(t.length>0){var r=void 0,n=!1;if(i.isCustomField)if(a)a&&"Custom"===a.type?1===t.length?n=!0:(n=!1,r="custom"):a&&"Number"===a.type&&(n=!1,r="number");else{var s=this.getGroupSettings(e.replace(this.dateGroup,"")),o=this.getGroupSettings(e.replace(/_custom_group/g,""));s?(n=!1,r="date",e=e.replace(this.dateGroup,"")):o&&(n=1===t.length,r="custom")}else a?"Number"===a.type||"Date"===a.type?(n=!1,r="Date"===a.type?"date":"number"):"Custom"===a.type&&(n=1===t.length,r="custom"):"number"===i.type||-1!==["datetime","date"].indexOf(i.type)||this.isDateType(e)?(n=!1,r=1===t.length?-1!==["datetime","date"].indexOf(i.type)||this.isDateType(e)?"date":"number":"custom"):"string"===i.type&&(n=1===t.length,r="custom");n?(this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("warning"),this.parent.localeObj.getConstant("invalidSelection")),this.parent.grid.clearSelection()):r&&""!==r&&this.createGroupDialog(e,r,t)}},e.prototype.updateUnGroupSettings=function(e,t){var i=this.parent.engineModule.fieldList[e],a=r.cloneGroupSettings(this.parent.dataSourceSettings.groupSettings),n=this.getGroupSettings(e);if(t.length>0){var s=void 0;if(i.isCustomField)if(n)"Custom"===n.type&&(s="custom");else{var o=this.getGroupSettings(e.replace(this.dateGroup,"")),l=this.getGroupSettings(e.replace(/_custom_group/g,""));o?(s="date",e=e.replace(this.dateGroup,"")):l&&(s="custom")}else n&&("Number"!==n.type&&"Date"!==n.type||(s="Date"===n.type?"date":"number"));if("date"===s||"number"===s)a=this.validateSettings(e,a,s,[]);else if("custom"===s){var d=this.getSelectedOptions(t);a=this.validateSettings(e,a,s,d)}this.updateDateSource(a,s)}},e.prototype.updateDateSource=function(e,t){this.isUpdate&&(this.parent.setProperties({dataSourceSettings:{groupSettings:e}},!0),this.parent.updateGroupingReport(e,"date"===t?"Date":"custom"===t?"Custom":"Number"),"Server"===this.parent.dataSourceSettings.mode?this.parent.getEngine("onRefresh"):this.parent.initEngine())},e.prototype.removeGroupSettings=function(e,t,i,a){var n=a.indexOf(e);if(-1!==n)for(var s=i[n],o=0,l=s.customGroups.length;o<l;o++)if(s.customGroups[o]){var d=s.customGroups[o];-1!==r.inArray(d.groupName,t)&&(i=this.modifyParentGroupItems(e,i,[d.groupName],d.items,a),s.customGroups.splice(o,1),this.isUpdate=!0,o--,l--)}return delete this.parent.engineModule.groupingFieldsInfo[e],i},e.prototype.getGroupSettings=function(e){for(var t=0,i=this.parent.dataSourceSettings.groupSettings;t<i.length;t++){var a=i[t];if(a.name===e)return a}},e.prototype.isDateType=function(e){for(var t=0,i=this.parent.dataSourceSettings.formatSettings;t<i.length;t++){var a=i[t];if(a.name===e&&a.type)return!0}return!1},e.prototype.getSelectedCells=function(e,t,i){for(var a=[],r=this.parent.element.querySelectorAll("."+Cn+",."+xn),n=0;n<r.length;n++){var s=r[n],o=Number(s.getAttribute("data-colindex")),l=Number(s.getAttribute("index")),d=this.parent.engineModule.pivotValues[l][o];d&&d.axis===e&&"grand sum"!==d.type&&"sum"!==d.type&&d.valueSort.axis===t&&i!==d.actualText.toString()&&a.push({axis:d.axis,fieldName:d.valueSort.axis.toString(),name:d.actualText.toString(),cellInfo:d})}return a},e.prototype.createGroupDialog=function(e,i,a){var r=(0,t.createElement)("div",{id:this.parentElement.id+"_GroupDialog",className:"e-group-field-settings",attrs:{"data-field":e,"data-type":i}});this.parentElement.appendChild(r);var n=new o.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("grouping"),content:this.createGroupOptions(e,i),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:300,height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateGroupSettings.bind(this,a),buttonModel:{cssClass:Ua+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){n.hide()},buttonModel:{cssClass:Ba+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,close:this.removeDialog.bind(this),target:this.parentElement,cssClass:this.parent.cssClass});n.isStringTemplate=!0,n.appendTo(r)},e.prototype.createGroupOptions=function(e,i){var a=this,n=this,s=(0,t.createElement)("div",{className:"e-group-field-div-content",id:this.parentElement.id+"_group_field_div_content",attrs:{"data-fieldName":e,"data-type":i}}),l=(0,t.createElement)("div",{className:"e-group-option-container"});s.appendChild(l);var d=this.parent.dataSourceSettings,p=r.getFieldByName(e,d.groupSettings);switch(i){case"custom":var h=void 0,u=d.rows;u=u.concat(d.columns,d.values,d.filters);var c=r.getFieldByName(e.replace(/_custom_group/g,""),u),g=r.getFieldByName(e,u),m=r.getFieldByName(e+"_custom_group",u);if(g){var f=e+"_custom_group";h=m?m.caption:this.parent.engineModule.fieldList[c.name].caption+(f.match(/_custom_group/g).length+1)}var S=(0,t.createElement)("div",{className:"e-caption-option-text"});S.innerText=this.parent.localeObj.getConstant("groupFieldCaption");var v=(0,t.createElement)("div",{className:"e-group-caption-container"}),y=(0,t.createElement)("input",{id:this.parentElement.id+"group_caption_option",className:"e-group-caption-text",attrs:{type:"text"}});v.appendChild(S),v.appendChild(y),l.appendChild(v);var b=(0,t.createElement)("div",{className:"e-input-option-text"});b.innerText=this.parent.localeObj.getConstant("groupTitle");var C=(0,t.createElement)("div",{className:"e-group-input-container"}),x=(0,t.createElement)("input",{id:this.parentElement.id+"group_input_option",className:"e-group-input-text",attrs:{type:"text"}});C.appendChild(b),C.appendChild(x),l.appendChild(C);var w=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("captionName"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:h,width:"100%",cssClass:this.parent.cssClass});w.isStringTemplate=!0,w.appendTo(y);var T=new ps.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("groupName"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,width:"100%",cssClass:this.parent.cssClass});T.isStringTemplate=!0,T.appendTo(x);break;case"date":case"number":var M=(0,t.createElement)("div",{className:"e-group-start-option-container"}),D=(0,t.createElement)("input",{id:this.parentElement.id+"group_start_option",className:"e-group_start_option",attrs:{type:"checkbox"}}),O=(0,t.createElement)("input",{id:this.parentElement.id+"group_start_input",className:"e-group_start_input",attrs:{type:"text"}});M.appendChild(D),M.appendChild(O),l.appendChild(M);var P=(0,t.createElement)("div",{className:"e-group-end-option-container"}),N=(0,t.createElement)("input",{id:this.parentElement.id+"group_end_option",className:"e-group_end_option",attrs:{type:"checkbox"}}),E=(0,t.createElement)("input",{id:this.parentElement.id+"group_end_input",className:"e-group_end_input",attrs:{type:"text"}});P.appendChild(N),P.appendChild(E),l.appendChild(P);var I=(0,t.createElement)("div",{className:"e-group-interval-option-container"}),F=(0,t.createElement)("div",{className:"e-group-inerval-option-text"});F.innerText=this.parent.localeObj.getConstant("groupBy");var L=(0,t.createElement)("input",{id:this.parentElement.id+"group_interval_input",className:"e-group_interval_input",attrs:{type:"text"}});I.appendChild(F),I.appendChild(L),l.appendChild(I);var A=void 0,R=void 0;if("date"===i){var k=[],j=[{value:"Seconds",text:this.parent.localeObj.getConstant("Seconds")},{value:"Minutes",text:this.parent.localeObj.getConstant("Minutes")},{value:"Hours",text:this.parent.localeObj.getConstant("Hours")},{value:"Days",text:this.parent.localeObj.getConstant("Days")},{value:"Months",text:this.parent.localeObj.getConstant("Months")},{value:"QuarterYear",text:this.parent.localeObj.getConstant("QuarterYear")},{value:"Quarters",text:this.parent.localeObj.getConstant("Quarters")},{value:"Years",text:this.parent.localeObj.getConstant("Years")}];p&&"Date"===p.type?(k=p.groupInterval,A=p.startingAt?p.startingAt.toString():void 0,R=p.endingAt?p.endingAt.toString():void 0):k=["Months"],(H=new ys.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,format:"dd/MM/yyyy hh:mm:ss a",enabled:!(void 0===A),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,H.appendTo(O),(V=new ys.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,format:"dd/MM/yyyy hh:mm:ss a",enabled:!(void 0===R),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,V.appendTo(E),hs.MultiSelect.Inject(hs.CheckBoxSelection);var q=new hs.MultiSelect({dataSource:j,value:k,fields:{text:"text",value:"value"},mode:"CheckBox",showDropDownIcon:!0,enableSelectionOrder:!1,placeholder:this.parent.localeObj.getConstant("selectGroup"),filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+this.parent.localeObj.getConstant("Months"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,select:function(){(0,t.getInstance)((0,t.select)("#"+n.parentElement.id+"_GroupDialog",document),o.Dialog).element.querySelector("."+Ua).removeAttribute("disabled")},removed:function(){var e=q.liCollections,i=0;e.forEach((function(e){e.classList.contains("e-active")&&i++})),0===i&&(0,t.getInstance)((0,t.select)("#"+n.parentElement.id+"_GroupDialog",document),o.Dialog).element.querySelector("."+Ua).setAttribute("disabled","disabled")}});q.isStringTemplate=!0,q.appendTo(L),H.value=void 0===A?null:new Date(A),H.dataBind(),V.value=void 0===R?null:new Date(R),V.dataBind()}else{var H,V,U=void 0;p&&"Number"===p.type?(U=p.rangeInterval,A=p.startingAt?p.startingAt.toString():void 0,R=p.endingAt?p.endingAt.toString():void 0):U=2,(H=new ps.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showClearButton:!0,format:"###",value:void 0===A?void 0:parseInt(A,10),enabled:!(void 0===A),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,H.appendTo(O),(V=new ps.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showClearButton:!0,format:"###",value:void 0===R?void 0:parseInt(R,10),enabled:!(void 0===R),width:"100%",cssClass:this.parent.cssClass})).isStringTemplate=!0,V.appendTo(E);var B=new ps.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showClearButton:!0,format:"###",min:1,value:U,width:"100%",cssClass:this.parent.cssClass});B.isStringTemplate=!0,B.appendTo(L)}var _=new Cs.CheckBox({label:this.parent.localeObj.getConstant("startAt"),checked:!(void 0===A),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,change:function(e){var r="date"===i?(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_start_input"),ys.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_start_input"),ps.NumericTextBox);r.enabled=e.checked,r.dataBind()}});_.isStringTemplate=!0,_.appendTo(D);var G=new Cs.CheckBox({label:this.parent.localeObj.getConstant("endAt"),checked:!(void 0===R),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,change:function(e){var r="date"===i?(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_end_input"),ys.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+a.parentElement.id+"group_end_input"),ps.NumericTextBox);r.enabled=e.checked,r.dataBind()}});G.isStringTemplate=!0,G.appendTo(N)}return s},e.prototype.updateGroupSettings=function(e){var i=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"_GroupDialog",document),o.Dialog),a=i.element,n=a.getAttribute("data-type"),s=a.getAttribute("data-field"),l=r.cloneGroupSettings(this.parent.dataSourceSettings.groupSettings);if(0===l.length&&!this.parent.clonedDataSet&&!this.parent.clonedReport){var d=this.parent.engineModule.data;this.parent.clonedDataSet="CSV"===this.parent.dataSourceSettings.type?r.getClonedCSVData(d):r.getClonedData(d),this.parent.setProperties({dataSourceSettings:{dataSource:[]}},!0),this.parent.clonedReport=(0,t.extend)({},this.parent.dataSourceSettings,null,!0),this.parent.setProperties({dataSourceSettings:{dataSource:d}},!0)}if("custom"===n){var p=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_input_option"),ps.MaskedTextBox),h=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_caption_option"),ps.MaskedTextBox);if((0,t.removeClass)([p.element],pn),null===p.value||""===p.value)return(0,t.addClass)([p.element],pn),void p.element.focus();for(var u=this.getSelectedOptions(e),c={groupName:p.value,items:u},g=[],m=[],f={name:s,caption:h.value,type:"Custom",customGroups:[]},S=!1,v=0,y=l.length;v<y;v++)if(l[v].name===s){(f=l[v]).caption=h.value;for(var b=0,C=f.customGroups.length;b<C;b++)if(f.customGroups[b]){var x=f.customGroups[b];x.items&&sl.isContainCommonElements(x.items,u)&&(g=this.mergeArray(g,[x.groupName]),m=this.mergeArray(m,x.items),f.customGroups.splice(b,1),b--,C--)}for(var w=0,T=u;w<T.length;w++){var M=T[w],D=m.indexOf(M);-1!==D&&m.splice(D,1)}m=this.mergeArray(m,[c.groupName]),f.customGroups.push(c),this.isUpdate=!0,S=!0;break}S||(f.customGroups.push(c),this.isUpdate=!0,l.push(f)),l=this.validateSettings(s,l,n,0===g.length?c.items:g,m)}else if("date"===n||"number"===n){var O=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_start_option"),Cs.CheckBox),P=(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_end_option"),Cs.CheckBox),N="date"===n?(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_start_input"),ys.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_start_input"),ps.NumericTextBox),E="date"===n?(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_end_input"),ys.DateTimePicker):(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_end_input"),ps.NumericTextBox),I="date"===n?(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_interval_input"),hs.MultiSelect):(0,t.getInstance)((0,t.select)("#"+this.parentElement.id+"group_interval_input"),ps.NumericTextBox);f={name:s,startingAt:O.checked?N.value.toString():void 0,endingAt:P.checked?E.value.toString():void 0};if("date"===n){for(var F=[],L=0,A=I.value;L<A.length;L++){var R=A[L];F.push(R)}f.type="Date",f.groupInterval=F}else f.type="Number",f.rangeInterval=I.value;for(S=!1,v=0,y=l.length;v<y;v++)if(l[v].name===s){l.splice(v,1,f),this.isUpdate=!0,S=!0;break}S||(this.isUpdate=!0,l.push(f)),l=this.validateSettings(s,l,n,[],[])}i.close(),this.updateDateSource(l,n)},e.prototype.getGroupBasedSettings=function(e){for(var t={},i=0,a=e;i<a.length;i++){var r=a[i];t[r.type]?t[r.type].push(r):t[r.type]=[r]}return t},e.prototype.getGroupByName=function(e){for(var t={},i=0,a=e;i<a.length;i++){var r=a[i],n=r.name.replace(/_custom_group/g,"");t[n]?t[n].push(r):t[n]=[r]}return t},e.prototype.validateSettings=function(e,t,i,a,r){var n=[],s=this.getGroupBasedSettings(t),o=["Date","Number","Custom"];if(s[o[2]]&&"custom"===i){var l=this.getGroupByName(s[o[2]]);if(l[e.replace(/_custom_group/g,"")]){var d=l[e.replace(/_custom_group/g,"")],p=d.map((function(e){return e.name}));d=r?this.modifyParentGroupItems(e,d,a,r,p):this.removeGroupSettings(e.replace("_custom_group",""),a,d,p)}for(var h=[],u=0,c=Object.keys(l);u<c.length;u++){var g=c[u];p=l[g].map((function(e){return e.name}));h=this.reOrderSettings(l[g],p,h,g)}s[o[2]]=h}else if(("date"===i||"number"===i)&&!r){var m="date"===i?s[o[0]]:s[o[1]];"date"===i?(s[o[0]]=m.filter((function(t){return t.name!==e})),0===s[o[0]].length&&delete this.parent.engineModule.groupingFieldsInfo[e]):s[o[1]]=m.filter((function(t){return t.name!==e})),this.isUpdate=!0}for(var f=0,S=o;f<S.length;f++){var v=S[f];s[v]&&(n=n.concat(s[v]))}return n},e.prototype.reOrderSettings=function(e,t,i,a){var r=t.indexOf(a);return r>-1&&e[r].customGroups&&e[r].customGroups.length>0&&(i.push(e[r]),this.reOrderSettings(e,t,i,a+"_custom_group")),i},e.prototype.modifyParentGroupItems=function(e,t,i,a,r){var n=r.indexOf(e+"_custom_group");if(-1!==n){var s=t[n];if(s.customGroups&&s.customGroups.length>0)for(var o=0,l=s.customGroups.length;o<l;o++)if(s.customGroups[o]){var d=!1,p=s.customGroups[o];if(p.items){for(var h=0,u=i;h<u.length;h++){var c=u[h],g=p.items.indexOf(c);-1!==g&&(p.items.splice(g,1),this.isUpdate=!0,d=!0)}d&&(p.items=this.mergeArray(p.items,a))}}}return t},e.prototype.mergeArray=function(e,t){for(var i=[],a=e.concat(t),r=a.length,n={};r--;){var s=String(a[r]);n[s]||(i.unshift(s),n[s]=!0)}return i},e.prototype.removeDialog=function(){if(!this.parent.grid||!this.parent.grid.isDestroyed){this.parent.grid.clearSelection();var e=(0,t.select)("#"+this.parent.element.id+"_GroupDialog",document),i=e?(0,t.getInstance)(e,o.Dialog):null;i&&!i.isDestroyed&&i.destroy(),this.parent.element&&document.getElementById(this.parent.element.id+"_GroupDialog")&&(0,t.remove)(document.getElementById(this.parent.element.id+"_GroupDialog"))}},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(rt,this.render,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.removeDialog(),this.parent.off(rt,this.render))},e.prototype.destroy=function(){this.removeEventListener()},e}()})(),v})()));