import { Directive, HostBinding, Input, } from '@angular/core';
import * as i0 from "@angular/core";
export class PSMProgressBarDirective {
    constructor(renderer, el) {
        this.renderer = renderer;
        this.el = el;
        this.colors = [];
        this.minProgressVal = 0;
        this.maxProgressVal = 100;
        this.currentProgressVal = 0;
        this.dataPasswordStrength = 0;
        this.defaultColors = [
            'darkred',
            'orangered',
            'orange',
            'yellowgreen',
            'green',
        ];
        this.progressBar = this.el.nativeElement;
    }
    ngOnChanges(changes) {
        if (changes.numberOfProgressBarItems) {
            this.setProgressBarItems();
        }
        this.setProgressBar();
    }
    setProgressBarItems() {
        const progressBarItemContainer = this.progressBar.querySelector('.psm__progress-bar-items');
        const width = 100 / this.numberOfProgressBarItems;
        progressBarItemContainer.childNodes.forEach((item) => {
            this.renderer.removeChild(progressBarItemContainer, item);
        });
        Array(this.numberOfProgressBarItems)
            .fill(1)
            .forEach((_) => {
            const progressBarItem = this.renderer.createElement('div');
            this.renderer.addClass(progressBarItem, 'psm__progress-bar-item');
            this.renderer.setStyle(progressBarItem, 'width', `${width}%`);
            this.renderer.appendChild(progressBarItemContainer, progressBarItem);
        });
    }
    setProgressBar() {
        const progressBarOverlayWidth = this.getFillMeterWidth(this.passwordStrength);
        const progressBarOverlayWidthInPx = `${progressBarOverlayWidth}%`;
        const progressLevelBasedOnItems = (progressBarOverlayWidth / 100) * this.numberOfProgressBarItems;
        const progressBarOverlayColor = this.getMeterFillColor(progressLevelBasedOnItems);
        this.dataPasswordStrength = this.passwordStrength || 0;
        this.currentProgressVal = progressBarOverlayWidth;
        const overlayElement = this.progressBar.querySelector('.psm__progress-bar-overlay');
        if (overlayElement) {
            this.renderer.setStyle(overlayElement, 'width', progressBarOverlayWidthInPx);
            this.renderer.setStyle(overlayElement, 'background-color', progressBarOverlayColor);
        }
    }
    getFillMeterWidth(strength) {
        if (strength === null || strength === undefined) {
            return 0;
        }
        const strengthInPercentage = strength !== null ? ((strength + 1) / 5) * 100 : 0;
        const roundedStrengthInPercentage = this.getRoundedStrength(strengthInPercentage, 100 / this.numberOfProgressBarItems);
        return roundedStrengthInPercentage;
    }
    getMeterFillColor(progressLevel) {
        if (!progressLevel ||
            progressLevel <= 0 ||
            (progressLevel > this.colors.length &&
                progressLevel > this.defaultColors.length)) {
            return this.colors[0] ? this.colors[0] : this.defaultColors[0];
        }
        const index = progressLevel - 1;
        return this.colors[index] ? this.colors[index] : this.defaultColors[index];
    }
    getRoundedStrength(strength, roundTo) {
        return Math.round(strength / roundTo) * roundTo;
    }
}
PSMProgressBarDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PSMProgressBarDirective, deps: [{ token: i0.Renderer2 }, { token: i0.ElementRef }], target: i0.ɵɵFactoryTarget.Directive });
PSMProgressBarDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "15.2.9", type: PSMProgressBarDirective, selector: ".psm__progress-bar", inputs: { numberOfProgressBarItems: "numberOfProgressBarItems", passwordStrength: "passwordStrength", colors: "colors" }, host: { properties: { "attr.aria-valuemin": "this.minProgressVal", "attr.aria-valuemax": "this.maxProgressVal", "attr.aria-valuenow": "this.currentProgressVal", "attr.data-strength": "this.dataPasswordStrength" } }, usesOnChanges: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PSMProgressBarDirective, decorators: [{
            type: Directive,
            args: [{
                    // eslint-disable-next-line
                    selector: '.psm__progress-bar',
                }]
        }], ctorParameters: function () { return [{ type: i0.Renderer2 }, { type: i0.ElementRef }]; }, propDecorators: { numberOfProgressBarItems: [{
                type: Input
            }], passwordStrength: [{
                type: Input
            }], colors: [{
                type: Input
            }], minProgressVal: [{
                type: HostBinding,
                args: ['attr.aria-valuemin']
            }], maxProgressVal: [{
                type: HostBinding,
                args: ['attr.aria-valuemax']
            }], currentProgressVal: [{
                type: HostBinding,
                args: ['attr.aria-valuenow']
            }], dataPasswordStrength: [{
                type: HostBinding,
                args: ['attr.data-strength']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHNtLXByb2dyZXNzLWJhci5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9wYXNzd29yZC1zdHJlbmd0aC1tZXRlci9zcmMvbGliL3BzbS1wcm9ncmVzcy1iYXIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBRVQsV0FBVyxFQUNYLEtBQUssR0FJTixNQUFNLGVBQWUsQ0FBQzs7QUFNdkIsTUFBTSxPQUFPLHVCQUF1QjtJQTRCbEMsWUFDVSxRQUFtQixFQUNuQixFQUE4QjtRQUQ5QixhQUFRLEdBQVIsUUFBUSxDQUFXO1FBQ25CLE9BQUUsR0FBRixFQUFFLENBQTRCO1FBdEJ4QyxXQUFNLEdBQWEsRUFBRSxDQUFDO1FBRWEsbUJBQWMsR0FBRyxDQUFDLENBQUM7UUFFbkIsbUJBQWMsR0FBRyxHQUFHLENBQUM7UUFFckIsdUJBQWtCLEdBQUcsQ0FBQyxDQUFDO1FBRXZCLHlCQUFvQixHQUFHLENBQUMsQ0FBQztRQUlwRCxrQkFBYSxHQUFHO1lBQ3RCLFNBQVM7WUFDVCxXQUFXO1lBQ1gsUUFBUTtZQUNSLGFBQWE7WUFDYixPQUFPO1NBQ1IsQ0FBQztRQU1BLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLENBQUM7SUFDM0MsQ0FBQztJQUVELFdBQVcsQ0FBQyxPQUFzQjtRQUNoQyxJQUFJLE9BQU8sQ0FBQyx3QkFBd0IsRUFBRTtZQUNwQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztTQUM1QjtRQUVELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBRUQsbUJBQW1CO1FBQ2pCLE1BQU0sd0JBQXdCLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQzdELDBCQUEwQixDQUMzQixDQUFDO1FBQ0YsTUFBTSxLQUFLLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQztRQUVsRCx3QkFBd0IsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDbkQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsd0JBQXdCLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDNUQsQ0FBQyxDQUFDLENBQUM7UUFFSCxLQUFLLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDO2FBQ2pDLElBQUksQ0FBQyxDQUFDLENBQUM7YUFDUCxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtZQUNiLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzNELElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLGVBQWUsRUFBRSx3QkFBd0IsQ0FBQyxDQUFDO1lBQ2xFLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLGVBQWUsRUFBRSxPQUFPLEVBQUUsR0FBRyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1lBQzlELElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLHdCQUF3QixFQUFFLGVBQWUsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELGNBQWM7UUFDWixNQUFNLHVCQUF1QixHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FDcEQsSUFBSSxDQUFDLGdCQUFnQixDQUN0QixDQUFDO1FBQ0YsTUFBTSwyQkFBMkIsR0FBRyxHQUFHLHVCQUF1QixHQUFHLENBQUM7UUFFbEUsTUFBTSx5QkFBeUIsR0FDN0IsQ0FBQyx1QkFBdUIsR0FBRyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQUM7UUFDbEUsTUFBTSx1QkFBdUIsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQ3BELHlCQUF5QixDQUMxQixDQUFDO1FBRUYsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsSUFBSSxDQUFDLENBQUM7UUFDdkQsSUFBSSxDQUFDLGtCQUFrQixHQUFHLHVCQUF1QixDQUFDO1FBRWxELE1BQU0sY0FBYyxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUNuRCw0QkFBNEIsQ0FDN0IsQ0FBQztRQUVGLElBQUksY0FBYyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUNwQixjQUFjLEVBQ2QsT0FBTyxFQUNQLDJCQUEyQixDQUM1QixDQUFDO1lBRUYsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQ3BCLGNBQWMsRUFDZCxrQkFBa0IsRUFDbEIsdUJBQXVCLENBQ3hCLENBQUM7U0FDSDtJQUNILENBQUM7SUFFRCxpQkFBaUIsQ0FBQyxRQUFnQjtRQUNoQyxJQUFJLFFBQVEsS0FBSyxJQUFJLElBQUksUUFBUSxLQUFLLFNBQVMsRUFBRTtZQUMvQyxPQUFPLENBQUMsQ0FBQztTQUNWO1FBRUQsTUFBTSxvQkFBb0IsR0FDeEIsUUFBUSxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVyRCxNQUFNLDJCQUEyQixHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FDekQsb0JBQW9CLEVBQ3BCLEdBQUcsR0FBRyxJQUFJLENBQUMsd0JBQXdCLENBQ3BDLENBQUM7UUFDRixPQUFPLDJCQUEyQixDQUFDO0lBQ3JDLENBQUM7SUFFRCxpQkFBaUIsQ0FBQyxhQUFxQjtRQUNyQyxJQUNFLENBQUMsYUFBYTtZQUNkLGFBQWEsSUFBSSxDQUFDO1lBQ2xCLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTTtnQkFDakMsYUFBYSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEVBQzVDO1lBQ0EsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ2hFO1FBRUQsTUFBTSxLQUFLLEdBQUcsYUFBYSxHQUFHLENBQUMsQ0FBQztRQUVoQyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDN0UsQ0FBQztJQUVPLGtCQUFrQixDQUFDLFFBQWdCLEVBQUUsT0FBZTtRQUMxRCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxHQUFHLE9BQU8sQ0FBQztJQUNsRCxDQUFDOztvSEFqSVUsdUJBQXVCO3dHQUF2Qix1QkFBdUI7MkZBQXZCLHVCQUF1QjtrQkFKbkMsU0FBUzttQkFBQztvQkFDVCwyQkFBMkI7b0JBQzNCLFFBQVEsRUFBRSxvQkFBb0I7aUJBQy9CO3lIQUdDLHdCQUF3QjtzQkFEdkIsS0FBSztnQkFJTixnQkFBZ0I7c0JBRGYsS0FBSztnQkFJTixNQUFNO3NCQURMLEtBQUs7Z0JBRzZCLGNBQWM7c0JBQWhELFdBQVc7dUJBQUMsb0JBQW9CO2dCQUVFLGNBQWM7c0JBQWhELFdBQVc7dUJBQUMsb0JBQW9CO2dCQUVFLGtCQUFrQjtzQkFBcEQsV0FBVzt1QkFBQyxvQkFBb0I7Z0JBRUUsb0JBQW9CO3NCQUF0RCxXQUFXO3VCQUFDLG9CQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIERpcmVjdGl2ZSxcbiAgRWxlbWVudFJlZixcbiAgSG9zdEJpbmRpbmcsXG4gIElucHV0LFxuICBPbkNoYW5nZXMsXG4gIFJlbmRlcmVyMixcbiAgU2ltcGxlQ2hhbmdlcyxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBEaXJlY3RpdmUoe1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgc2VsZWN0b3I6ICcucHNtX19wcm9ncmVzcy1iYXInLFxufSlcbmV4cG9ydCBjbGFzcyBQU01Qcm9ncmVzc0JhckRpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG4gIEBJbnB1dCgpXG4gIG51bWJlck9mUHJvZ3Jlc3NCYXJJdGVtczogbnVtYmVyO1xuXG4gIEBJbnB1dCgpXG4gIHBhc3N3b3JkU3RyZW5ndGg6IG51bWJlcjtcblxuICBASW5wdXQoKVxuICBjb2xvcnM6IHN0cmluZ1tdID0gW107XG5cbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtdmFsdWVtaW4nKSBtaW5Qcm9ncmVzc1ZhbCA9IDA7XG5cbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmFyaWEtdmFsdWVtYXgnKSBtYXhQcm9ncmVzc1ZhbCA9IDEwMDtcblxuICBASG9zdEJpbmRpbmcoJ2F0dHIuYXJpYS12YWx1ZW5vdycpIGN1cnJlbnRQcm9ncmVzc1ZhbCA9IDA7XG5cbiAgQEhvc3RCaW5kaW5nKCdhdHRyLmRhdGEtc3RyZW5ndGgnKSBkYXRhUGFzc3dvcmRTdHJlbmd0aCA9IDA7XG5cbiAgcHJvZ3Jlc3NCYXI6IEhUTUxEaXZFbGVtZW50O1xuXG4gIHByaXZhdGUgZGVmYXVsdENvbG9ycyA9IFtcbiAgICAnZGFya3JlZCcsXG4gICAgJ29yYW5nZXJlZCcsXG4gICAgJ29yYW5nZScsXG4gICAgJ3llbGxvd2dyZWVuJyxcbiAgICAnZ3JlZW4nLFxuICBdO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMixcbiAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmPEhUTUxEaXZFbGVtZW50PlxuICApIHtcbiAgICB0aGlzLnByb2dyZXNzQmFyID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50O1xuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGlmIChjaGFuZ2VzLm51bWJlck9mUHJvZ3Jlc3NCYXJJdGVtcykge1xuICAgICAgdGhpcy5zZXRQcm9ncmVzc0Jhckl0ZW1zKCk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRQcm9ncmVzc0JhcigpO1xuICB9XG5cbiAgc2V0UHJvZ3Jlc3NCYXJJdGVtcygpIHtcbiAgICBjb25zdCBwcm9ncmVzc0Jhckl0ZW1Db250YWluZXIgPSB0aGlzLnByb2dyZXNzQmFyLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAnLnBzbV9fcHJvZ3Jlc3MtYmFyLWl0ZW1zJ1xuICAgICk7XG4gICAgY29uc3Qgd2lkdGggPSAxMDAgLyB0aGlzLm51bWJlck9mUHJvZ3Jlc3NCYXJJdGVtcztcblxuICAgIHByb2dyZXNzQmFySXRlbUNvbnRhaW5lci5jaGlsZE5vZGVzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2hpbGQocHJvZ3Jlc3NCYXJJdGVtQ29udGFpbmVyLCBpdGVtKTtcbiAgICB9KTtcblxuICAgIEFycmF5KHRoaXMubnVtYmVyT2ZQcm9ncmVzc0Jhckl0ZW1zKVxuICAgICAgLmZpbGwoMSlcbiAgICAgIC5mb3JFYWNoKChfKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2dyZXNzQmFySXRlbSA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MocHJvZ3Jlc3NCYXJJdGVtLCAncHNtX19wcm9ncmVzcy1iYXItaXRlbScpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHByb2dyZXNzQmFySXRlbSwgJ3dpZHRoJywgYCR7d2lkdGh9JWApO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmFwcGVuZENoaWxkKHByb2dyZXNzQmFySXRlbUNvbnRhaW5lciwgcHJvZ3Jlc3NCYXJJdGVtKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgc2V0UHJvZ3Jlc3NCYXIoKSB7XG4gICAgY29uc3QgcHJvZ3Jlc3NCYXJPdmVybGF5V2lkdGggPSB0aGlzLmdldEZpbGxNZXRlcldpZHRoKFxuICAgICAgdGhpcy5wYXNzd29yZFN0cmVuZ3RoXG4gICAgKTtcbiAgICBjb25zdCBwcm9ncmVzc0Jhck92ZXJsYXlXaWR0aEluUHggPSBgJHtwcm9ncmVzc0Jhck92ZXJsYXlXaWR0aH0lYDtcblxuICAgIGNvbnN0IHByb2dyZXNzTGV2ZWxCYXNlZE9uSXRlbXMgPVxuICAgICAgKHByb2dyZXNzQmFyT3ZlcmxheVdpZHRoIC8gMTAwKSAqIHRoaXMubnVtYmVyT2ZQcm9ncmVzc0Jhckl0ZW1zO1xuICAgIGNvbnN0IHByb2dyZXNzQmFyT3ZlcmxheUNvbG9yID0gdGhpcy5nZXRNZXRlckZpbGxDb2xvcihcbiAgICAgIHByb2dyZXNzTGV2ZWxCYXNlZE9uSXRlbXNcbiAgICApO1xuXG4gICAgdGhpcy5kYXRhUGFzc3dvcmRTdHJlbmd0aCA9IHRoaXMucGFzc3dvcmRTdHJlbmd0aCB8fCAwO1xuICAgIHRoaXMuY3VycmVudFByb2dyZXNzVmFsID0gcHJvZ3Jlc3NCYXJPdmVybGF5V2lkdGg7XG5cbiAgICBjb25zdCBvdmVybGF5RWxlbWVudCA9IHRoaXMucHJvZ3Jlc3NCYXIucXVlcnlTZWxlY3RvcjxIVE1MRGl2RWxlbWVudD4oXG4gICAgICAnLnBzbV9fcHJvZ3Jlc3MtYmFyLW92ZXJsYXknXG4gICAgKTtcblxuICAgIGlmIChvdmVybGF5RWxlbWVudCkge1xuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQsXG4gICAgICAgICd3aWR0aCcsXG4gICAgICAgIHByb2dyZXNzQmFyT3ZlcmxheVdpZHRoSW5QeFxuICAgICAgKTtcblxuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQsXG4gICAgICAgICdiYWNrZ3JvdW5kLWNvbG9yJyxcbiAgICAgICAgcHJvZ3Jlc3NCYXJPdmVybGF5Q29sb3JcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgZ2V0RmlsbE1ldGVyV2lkdGgoc3RyZW5ndGg6IG51bWJlcik6IG51bWJlciB7XG4gICAgaWYgKHN0cmVuZ3RoID09PSBudWxsIHx8IHN0cmVuZ3RoID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIGNvbnN0IHN0cmVuZ3RoSW5QZXJjZW50YWdlID1cbiAgICAgIHN0cmVuZ3RoICE9PSBudWxsID8gKChzdHJlbmd0aCArIDEpIC8gNSkgKiAxMDAgOiAwO1xuXG4gICAgY29uc3Qgcm91bmRlZFN0cmVuZ3RoSW5QZXJjZW50YWdlID0gdGhpcy5nZXRSb3VuZGVkU3RyZW5ndGgoXG4gICAgICBzdHJlbmd0aEluUGVyY2VudGFnZSxcbiAgICAgIDEwMCAvIHRoaXMubnVtYmVyT2ZQcm9ncmVzc0Jhckl0ZW1zXG4gICAgKTtcbiAgICByZXR1cm4gcm91bmRlZFN0cmVuZ3RoSW5QZXJjZW50YWdlO1xuICB9XG5cbiAgZ2V0TWV0ZXJGaWxsQ29sb3IocHJvZ3Jlc3NMZXZlbDogbnVtYmVyKSB7XG4gICAgaWYgKFxuICAgICAgIXByb2dyZXNzTGV2ZWwgfHxcbiAgICAgIHByb2dyZXNzTGV2ZWwgPD0gMCB8fFxuICAgICAgKHByb2dyZXNzTGV2ZWwgPiB0aGlzLmNvbG9ycy5sZW5ndGggJiZcbiAgICAgICAgcHJvZ3Jlc3NMZXZlbCA+IHRoaXMuZGVmYXVsdENvbG9ycy5sZW5ndGgpXG4gICAgKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb2xvcnNbMF0gPyB0aGlzLmNvbG9yc1swXSA6IHRoaXMuZGVmYXVsdENvbG9yc1swXTtcbiAgICB9XG5cbiAgICBjb25zdCBpbmRleCA9IHByb2dyZXNzTGV2ZWwgLSAxO1xuXG4gICAgcmV0dXJuIHRoaXMuY29sb3JzW2luZGV4XSA/IHRoaXMuY29sb3JzW2luZGV4XSA6IHRoaXMuZGVmYXVsdENvbG9yc1tpbmRleF07XG4gIH1cblxuICBwcml2YXRlIGdldFJvdW5kZWRTdHJlbmd0aChzdHJlbmd0aDogbnVtYmVyLCByb3VuZFRvOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLnJvdW5kKHN0cmVuZ3RoIC8gcm91bmRUbykgKiByb3VuZFRvO1xuICB9XG59XG4iXX0=