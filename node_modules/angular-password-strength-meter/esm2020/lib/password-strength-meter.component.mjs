import { Component, Input, Output, EventEmitter, HostBinding, } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "./password-strength-meter.service";
import * as i2 from "@angular/common";
import * as i3 from "./psm-progress-bar.directive";
export class PasswordStrengthMeterComponent {
    constructor(passwordStrengthMeterService) {
        this.passwordStrengthMeterService = passwordStrengthMeterService;
        this.minPasswordLength = 8;
        this.enableFeedback = false;
        this.colors = [];
        this.numberOfProgressBarItems = 5;
        this.strengthChange = new EventEmitter();
        this.baseClass = 'psm';
        this.passwordStrength = null;
        this.feedback = null;
        this.prevPasswordStrength = null;
    }
    ngOnChanges(changes) {
        if (changes.password) {
            this.calculatePasswordStrength();
        }
    }
    calculatePasswordStrength() {
        // TODO validation logic optimization
        if (!this.password) {
            this.passwordStrength = null;
            this.feedback = null;
        }
        else if (this.password && this.password.length < this.minPasswordLength) {
            this.passwordStrength = 0;
            this.feedback = null;
        }
        else {
            if (this.enableFeedback) {
                const result = this.passwordStrengthMeterService.scoreWithFeedback(this.password);
                this.passwordStrength = result.score;
                this.feedback = result.feedback;
            }
            else {
                this.passwordStrength = this.passwordStrengthMeterService.score(this.password);
                this.feedback = null;
            }
        }
        // Only emit the passwordStrength if it changed
        if (this.prevPasswordStrength !== this.passwordStrength) {
            this.strengthChange.emit(this.passwordStrength);
            this.prevPasswordStrength = this.passwordStrength;
        }
    }
}
PasswordStrengthMeterComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PasswordStrengthMeterComponent, deps: [{ token: i1.IPasswordStrengthMeterService }], target: i0.ɵɵFactoryTarget.Component });
PasswordStrengthMeterComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: PasswordStrengthMeterComponent, selector: "password-strength-meter", inputs: { password: "password", minPasswordLength: "minPasswordLength", enableFeedback: "enableFeedback", colors: "colors", numberOfProgressBarItems: "numberOfProgressBarItems" }, outputs: { strengthChange: "strengthChange" }, host: { properties: { "class": "this.baseClass" } }, usesOnChanges: true, ngImport: i0, template: "<div\n  class=\"psm__progress-bar\"\n  role=\"progressbar\"\n  [passwordStrength]=\"passwordStrength\"\n  [numberOfProgressBarItems]=\"numberOfProgressBarItems\"\n  [colors]=\"colors\"\n>\n  <div class=\"psm__progress-bar-items\"></div>\n  <div class=\"psm__progress-bar-overlay\"></div>\n</div>\n<ng-container *ngIf=\"enableFeedback && feedback\">\n  <small class=\"psm__feedback\" *ngIf=\"feedback.warning\">\n    {{ feedback.warning }}\n  </small>\n  <small\n    class=\"psm__suggestion\"\n    *ngIf=\"feedback.suggestions && feedback.suggestions.length\"\n  >\n    <ng-container\n      *ngFor=\"let suggestion of feedback.suggestions; last as isLast\"\n    >\n      {{ suggestion }}{{ isLast ? '' : ' ' }}\n    </ng-container>\n  </small>\n</ng-container>\n", styles: ["*,*:before,*:after{box-sizing:border-box}.psm__progress-bar{position:relative;height:3px;margin:10px auto;border-radius:3px;background:#fff}.psm__progress-bar-items{display:flex;justify-content:space-evenly;width:100%;height:100%;background:#ddd}.psm__progress-bar-item{height:100%;z-index:5;border-right:4px solid #fff}.psm__progress-bar-item:last-child{border-right:0px}.psm__progress-bar-overlay{position:absolute;background:red;border-radius:3px;height:3px;top:0;transition:width .5s ease-in-out,background .25s}.psm__feedback,.psm__suggestion{font-size:70%;font-weight:400;color:#6c757d!important;display:block;margin-top:.25rem}\n"], dependencies: [{ kind: "directive", type: i2.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i3.PSMProgressBarDirective, selector: ".psm__progress-bar", inputs: ["numberOfProgressBarItems", "passwordStrength", "colors"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PasswordStrengthMeterComponent, decorators: [{
            type: Component,
            args: [{ selector: 'password-strength-meter', template: "<div\n  class=\"psm__progress-bar\"\n  role=\"progressbar\"\n  [passwordStrength]=\"passwordStrength\"\n  [numberOfProgressBarItems]=\"numberOfProgressBarItems\"\n  [colors]=\"colors\"\n>\n  <div class=\"psm__progress-bar-items\"></div>\n  <div class=\"psm__progress-bar-overlay\"></div>\n</div>\n<ng-container *ngIf=\"enableFeedback && feedback\">\n  <small class=\"psm__feedback\" *ngIf=\"feedback.warning\">\n    {{ feedback.warning }}\n  </small>\n  <small\n    class=\"psm__suggestion\"\n    *ngIf=\"feedback.suggestions && feedback.suggestions.length\"\n  >\n    <ng-container\n      *ngFor=\"let suggestion of feedback.suggestions; last as isLast\"\n    >\n      {{ suggestion }}{{ isLast ? '' : ' ' }}\n    </ng-container>\n  </small>\n</ng-container>\n", styles: ["*,*:before,*:after{box-sizing:border-box}.psm__progress-bar{position:relative;height:3px;margin:10px auto;border-radius:3px;background:#fff}.psm__progress-bar-items{display:flex;justify-content:space-evenly;width:100%;height:100%;background:#ddd}.psm__progress-bar-item{height:100%;z-index:5;border-right:4px solid #fff}.psm__progress-bar-item:last-child{border-right:0px}.psm__progress-bar-overlay{position:absolute;background:red;border-radius:3px;height:3px;top:0;transition:width .5s ease-in-out,background .25s}.psm__feedback,.psm__suggestion{font-size:70%;font-weight:400;color:#6c757d!important;display:block;margin-top:.25rem}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.IPasswordStrengthMeterService }]; }, propDecorators: { password: [{
                type: Input
            }], minPasswordLength: [{
                type: Input
            }], enableFeedback: [{
                type: Input
            }], colors: [{
                type: Input
            }], numberOfProgressBarItems: [{
                type: Input
            }], strengthChange: [{
                type: Output
            }], baseClass: [{
                type: HostBinding,
                args: ['class']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc3dvcmQtc3RyZW5ndGgtbWV0ZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvcGFzc3dvcmQtc3RyZW5ndGgtbWV0ZXIvc3JjL2xpYi9wYXNzd29yZC1zdHJlbmd0aC1tZXRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy9wYXNzd29yZC1zdHJlbmd0aC1tZXRlci9zcmMvbGliL3Bhc3N3b3JkLXN0cmVuZ3RoLW1ldGVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsS0FBSyxFQUdMLE1BQU0sRUFDTixZQUFZLEVBQ1osV0FBVyxHQUNaLE1BQU0sZUFBZSxDQUFDOzs7OztBQVV2QixNQUFNLE9BQU8sOEJBQThCO0lBcUJ6QyxZQUNVLDRCQUEyRDtRQUEzRCxpQ0FBNEIsR0FBNUIsNEJBQTRCLENBQStCO1FBbkI1RCxzQkFBaUIsR0FBRyxDQUFDLENBQUM7UUFFdEIsbUJBQWMsR0FBRyxLQUFLLENBQUM7UUFFdkIsV0FBTSxHQUFhLEVBQUUsQ0FBQztRQUV0Qiw2QkFBd0IsR0FBRyxDQUFDLENBQUM7UUFFNUIsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBVSxDQUFDO1FBRWhDLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFFeEMscUJBQWdCLEdBQVcsSUFBSSxDQUFDO1FBRWhDLGFBQVEsR0FBK0MsSUFBSSxDQUFDO1FBRXBELHlCQUFvQixHQUFHLElBQUksQ0FBQztJQUlqQyxDQUFDO0lBRUosV0FBVyxDQUFDLE9BQXNCO1FBQ2hDLElBQUksT0FBTyxDQUFDLFFBQVEsRUFBRTtZQUNwQixJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztTQUNsQztJQUNILENBQUM7SUFFTyx5QkFBeUI7UUFDL0IscUNBQXFDO1FBQ3JDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ2xCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUM7WUFDN0IsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7U0FDdEI7YUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixFQUFFO1lBQ3pFLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLENBQUM7WUFDMUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7U0FDdEI7YUFBTTtZQUNMLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtnQkFDdkIsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLDRCQUE0QixDQUFDLGlCQUFpQixDQUNoRSxJQUFJLENBQUMsUUFBUSxDQUNkLENBQUM7Z0JBQ0YsSUFBSSxDQUFDLGdCQUFnQixHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7Z0JBQ3JDLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQzthQUNqQztpQkFBTTtnQkFDTCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLDRCQUE0QixDQUFDLEtBQUssQ0FDN0QsSUFBSSxDQUFDLFFBQVEsQ0FDZCxDQUFDO2dCQUNGLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO2FBQ3RCO1NBQ0Y7UUFFRCwrQ0FBK0M7UUFDL0MsSUFBSSxJQUFJLENBQUMsb0JBQW9CLEtBQUssSUFBSSxDQUFDLGdCQUFnQixFQUFFO1lBQ3ZELElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ2hELElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUM7U0FDbkQ7SUFDSCxDQUFDOzsySEEzRFUsOEJBQThCOytHQUE5Qiw4QkFBOEIsNFdDbEIzQywydkJBeUJBOzJGRFBhLDhCQUE4QjtrQkFOMUMsU0FBUzsrQkFFRSx5QkFBeUI7b0hBSzFCLFFBQVE7c0JBQWhCLEtBQUs7Z0JBRUcsaUJBQWlCO3NCQUF6QixLQUFLO2dCQUVHLGNBQWM7c0JBQXRCLEtBQUs7Z0JBRUcsTUFBTTtzQkFBZCxLQUFLO2dCQUVHLHdCQUF3QjtzQkFBaEMsS0FBSztnQkFFSSxjQUFjO3NCQUF2QixNQUFNO2dCQUVlLFNBQVM7c0JBQTlCLFdBQVc7dUJBQUMsT0FBTyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgSW5wdXQsXG4gIE9uQ2hhbmdlcyxcbiAgU2ltcGxlQ2hhbmdlcyxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RCaW5kaW5nLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgSVBhc3N3b3JkU3RyZW5ndGhNZXRlclNlcnZpY2UgfSBmcm9tICcuL3Bhc3N3b3JkLXN0cmVuZ3RoLW1ldGVyLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC9jb21wb25lbnQtc2VsZWN0b3JcbiAgc2VsZWN0b3I6ICdwYXNzd29yZC1zdHJlbmd0aC1tZXRlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9wYXNzd29yZC1zdHJlbmd0aC1tZXRlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3Bhc3N3b3JkLXN0cmVuZ3RoLW1ldGVyLmNvbXBvbmVudC5zY3NzJ10sXG59KVxuZXhwb3J0IGNsYXNzIFBhc3N3b3JkU3RyZW5ndGhNZXRlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG4gIEBJbnB1dCgpIHBhc3N3b3JkOiBzdHJpbmc7XG5cbiAgQElucHV0KCkgbWluUGFzc3dvcmRMZW5ndGggPSA4O1xuXG4gIEBJbnB1dCgpIGVuYWJsZUZlZWRiYWNrID0gZmFsc2U7XG5cbiAgQElucHV0KCkgY29sb3JzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIEBJbnB1dCgpIG51bWJlck9mUHJvZ3Jlc3NCYXJJdGVtcyA9IDU7XG5cbiAgQE91dHB1dCgpIHN0cmVuZ3RoQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcycpIGJhc2VDbGFzcyA9ICdwc20nO1xuXG4gIHBhc3N3b3JkU3RyZW5ndGg6IG51bWJlciA9IG51bGw7XG5cbiAgZmVlZGJhY2s6IHsgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdOyB3YXJuaW5nOiBzdHJpbmcgfSA9IG51bGw7XG5cbiAgcHJpdmF0ZSBwcmV2UGFzc3dvcmRTdHJlbmd0aCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBwYXNzd29yZFN0cmVuZ3RoTWV0ZXJTZXJ2aWNlOiBJUGFzc3dvcmRTdHJlbmd0aE1ldGVyU2VydmljZVxuICApIHt9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGlmIChjaGFuZ2VzLnBhc3N3b3JkKSB7XG4gICAgICB0aGlzLmNhbGN1bGF0ZVBhc3N3b3JkU3RyZW5ndGgoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNhbGN1bGF0ZVBhc3N3b3JkU3RyZW5ndGgoKSB7XG4gICAgLy8gVE9ETyB2YWxpZGF0aW9uIGxvZ2ljIG9wdGltaXphdGlvblxuICAgIGlmICghdGhpcy5wYXNzd29yZCkge1xuICAgICAgdGhpcy5wYXNzd29yZFN0cmVuZ3RoID0gbnVsbDtcbiAgICAgIHRoaXMuZmVlZGJhY2sgPSBudWxsO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wYXNzd29yZCAmJiB0aGlzLnBhc3N3b3JkLmxlbmd0aCA8IHRoaXMubWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIHRoaXMucGFzc3dvcmRTdHJlbmd0aCA9IDA7XG4gICAgICB0aGlzLmZlZWRiYWNrID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuZW5hYmxlRmVlZGJhY2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5wYXNzd29yZFN0cmVuZ3RoTWV0ZXJTZXJ2aWNlLnNjb3JlV2l0aEZlZWRiYWNrKFxuICAgICAgICAgIHRoaXMucGFzc3dvcmRcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5wYXNzd29yZFN0cmVuZ3RoID0gcmVzdWx0LnNjb3JlO1xuICAgICAgICB0aGlzLmZlZWRiYWNrID0gcmVzdWx0LmZlZWRiYWNrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wYXNzd29yZFN0cmVuZ3RoID0gdGhpcy5wYXNzd29yZFN0cmVuZ3RoTWV0ZXJTZXJ2aWNlLnNjb3JlKFxuICAgICAgICAgIHRoaXMucGFzc3dvcmRcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5mZWVkYmFjayA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gT25seSBlbWl0IHRoZSBwYXNzd29yZFN0cmVuZ3RoIGlmIGl0IGNoYW5nZWRcbiAgICBpZiAodGhpcy5wcmV2UGFzc3dvcmRTdHJlbmd0aCAhPT0gdGhpcy5wYXNzd29yZFN0cmVuZ3RoKSB7XG4gICAgICB0aGlzLnN0cmVuZ3RoQ2hhbmdlLmVtaXQodGhpcy5wYXNzd29yZFN0cmVuZ3RoKTtcbiAgICAgIHRoaXMucHJldlBhc3N3b3JkU3RyZW5ndGggPSB0aGlzLnBhc3N3b3JkU3RyZW5ndGg7XG4gICAgfVxuICB9XG59XG4iLCI8ZGl2XG4gIGNsYXNzPVwicHNtX19wcm9ncmVzcy1iYXJcIlxuICByb2xlPVwicHJvZ3Jlc3NiYXJcIlxuICBbcGFzc3dvcmRTdHJlbmd0aF09XCJwYXNzd29yZFN0cmVuZ3RoXCJcbiAgW251bWJlck9mUHJvZ3Jlc3NCYXJJdGVtc109XCJudW1iZXJPZlByb2dyZXNzQmFySXRlbXNcIlxuICBbY29sb3JzXT1cImNvbG9yc1wiXG4+XG4gIDxkaXYgY2xhc3M9XCJwc21fX3Byb2dyZXNzLWJhci1pdGVtc1wiPjwvZGl2PlxuICA8ZGl2IGNsYXNzPVwicHNtX19wcm9ncmVzcy1iYXItb3ZlcmxheVwiPjwvZGl2PlxuPC9kaXY+XG48bmctY29udGFpbmVyICpuZ0lmPVwiZW5hYmxlRmVlZGJhY2sgJiYgZmVlZGJhY2tcIj5cbiAgPHNtYWxsIGNsYXNzPVwicHNtX19mZWVkYmFja1wiICpuZ0lmPVwiZmVlZGJhY2sud2FybmluZ1wiPlxuICAgIHt7IGZlZWRiYWNrLndhcm5pbmcgfX1cbiAgPC9zbWFsbD5cbiAgPHNtYWxsXG4gICAgY2xhc3M9XCJwc21fX3N1Z2dlc3Rpb25cIlxuICAgICpuZ0lmPVwiZmVlZGJhY2suc3VnZ2VzdGlvbnMgJiYgZmVlZGJhY2suc3VnZ2VzdGlvbnMubGVuZ3RoXCJcbiAgPlxuICAgIDxuZy1jb250YWluZXJcbiAgICAgICpuZ0Zvcj1cImxldCBzdWdnZXN0aW9uIG9mIGZlZWRiYWNrLnN1Z2dlc3Rpb25zOyBsYXN0IGFzIGlzTGFzdFwiXG4gICAgPlxuICAgICAge3sgc3VnZ2VzdGlvbiB9fXt7IGlzTGFzdCA/ICcnIDogJyAnIH19XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvc21hbGw+XG48L25nLWNvbnRhaW5lcj5cbiJdfQ==