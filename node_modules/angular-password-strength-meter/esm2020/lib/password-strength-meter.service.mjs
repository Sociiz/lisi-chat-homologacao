import { Inject, Injectable, Optional } from '@angular/core';
import { zxcvbn, zxcvbnOptions } from '@zxcvbn-ts/core';
import { PSM_CONFIG } from './password-strength-meter.types';
import zxcvbnEnPackage from '@zxcvbn-ts/language-en';
import * as i0 from "@angular/core";
export class IPasswordStrengthMeterService {
}
export const DEFAULT_CONFIG = {
    translations: zxcvbnEnPackage.translations,
};
export class PasswordStrengthMeterService extends IPasswordStrengthMeterService {
    constructor(options) {
        super();
        if (options) {
            zxcvbnOptions.setOptions(options);
        }
        else {
            zxcvbnOptions.setOptions(DEFAULT_CONFIG);
        }
    }
    /**
     *  this will return the password strength score in number
     *  0 - too guessable
     *  1 - very guessable
     *  2 - somewhat guessable
     *  3 - safely unguessable
     *  4 - very unguessable
     *
     *  @param password - Password
     */
    score(password) {
        const result = zxcvbn(password);
        return result.score;
    }
    /**
     * this will return the password strength score with feedback messages
     * return type { score: number; feedback: { suggestions: string[]; warning: string } }
     *
     * @param password - Password
     */
    scoreWithFeedback(password) {
        const result = zxcvbn(password);
        return { score: result.score, feedback: result.feedback };
    }
}
PasswordStrengthMeterService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PasswordStrengthMeterService, deps: [{ token: PSM_CONFIG, optional: true }], target: i0.ɵɵFactoryTarget.Injectable });
PasswordStrengthMeterService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PasswordStrengthMeterService });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: PasswordStrengthMeterService, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: undefined, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [PSM_CONFIG]
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFzc3dvcmQtc3RyZW5ndGgtbWV0ZXIuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL3Bhc3N3b3JkLXN0cmVuZ3RoLW1ldGVyL3NyYy9saWIvcGFzc3dvcmQtc3RyZW5ndGgtbWV0ZXIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFN0QsT0FBTyxFQUFFLE1BQU0sRUFBRSxhQUFhLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN4RCxPQUFPLEVBQWMsVUFBVSxFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFFekUsT0FBTyxlQUFlLE1BQU0sd0JBQXdCLENBQUM7O0FBRXJELE1BQU0sT0FBZ0IsNkJBQTZCO0NBT2xEO0FBRUQsTUFBTSxDQUFDLE1BQU0sY0FBYyxHQUFlO0lBQ3hDLFlBQVksRUFBRSxlQUFlLENBQUMsWUFBWTtDQUMzQyxDQUFDO0FBR0YsTUFBTSxPQUFPLDRCQUE2QixTQUFRLDZCQUE2QjtJQUM3RSxZQUdFLE9BQW1CO1FBRW5CLEtBQUssRUFBRSxDQUFDO1FBRVIsSUFBSSxPQUFPLEVBQUU7WUFDWCxhQUFhLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ25DO2FBQU07WUFDTCxhQUFhLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1NBQzFDO0lBQ0gsQ0FBQztJQUVEOzs7Ozs7Ozs7T0FTRztJQUNILEtBQUssQ0FBQyxRQUFRO1FBQ1osTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2hDLE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQztJQUN0QixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSCxpQkFBaUIsQ0FBQyxRQUFRO1FBSXhCLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNoQyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUM1RCxDQUFDOzt5SEExQ1UsNEJBQTRCLGtCQUc3QixVQUFVOzZIQUhULDRCQUE0QjsyRkFBNUIsNEJBQTRCO2tCQUR4QyxVQUFVOzswQkFHTixRQUFROzswQkFDUixNQUFNOzJCQUFDLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3QsIEluamVjdGFibGUsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IHp4Y3ZibiwgenhjdmJuT3B0aW9ucyB9IGZyb20gJ0B6eGN2Ym4tdHMvY29yZSc7XG5pbXBvcnQgeyBQU01PcHRpb25zLCBQU01fQ09ORklHIH0gZnJvbSAnLi9wYXNzd29yZC1zdHJlbmd0aC1tZXRlci50eXBlcyc7XG5cbmltcG9ydCB6eGN2Ym5FblBhY2thZ2UgZnJvbSAnQHp4Y3Zibi10cy9sYW5ndWFnZS1lbic7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBJUGFzc3dvcmRTdHJlbmd0aE1ldGVyU2VydmljZSB7XG4gIGFic3RyYWN0IHNjb3JlKHBhc3N3b3JkOiBzdHJpbmcpOiBudW1iZXI7XG5cbiAgYWJzdHJhY3Qgc2NvcmVXaXRoRmVlZGJhY2socGFzc3dvcmQ6IHN0cmluZyk6IHtcbiAgICBzY29yZTogbnVtYmVyO1xuICAgIGZlZWRiYWNrOiB7IHdhcm5pbmc6IHN0cmluZzsgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdIH07XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX0NPTkZJRzogUFNNT3B0aW9ucyA9IHtcbiAgdHJhbnNsYXRpb25zOiB6eGN2Ym5FblBhY2thZ2UudHJhbnNsYXRpb25zLFxufTtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFBhc3N3b3JkU3RyZW5ndGhNZXRlclNlcnZpY2UgZXh0ZW5kcyBJUGFzc3dvcmRTdHJlbmd0aE1ldGVyU2VydmljZSB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIEBPcHRpb25hbCgpXG4gICAgQEluamVjdChQU01fQ09ORklHKVxuICAgIG9wdGlvbnM6IFBTTU9wdGlvbnNcbiAgKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICB6eGN2Ym5PcHRpb25zLnNldE9wdGlvbnMob3B0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHp4Y3Zibk9wdGlvbnMuc2V0T3B0aW9ucyhERUZBVUxUX0NPTkZJRyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqICB0aGlzIHdpbGwgcmV0dXJuIHRoZSBwYXNzd29yZCBzdHJlbmd0aCBzY29yZSBpbiBudW1iZXJcbiAgICogIDAgLSB0b28gZ3Vlc3NhYmxlXG4gICAqICAxIC0gdmVyeSBndWVzc2FibGVcbiAgICogIDIgLSBzb21ld2hhdCBndWVzc2FibGVcbiAgICogIDMgLSBzYWZlbHkgdW5ndWVzc2FibGVcbiAgICogIDQgLSB2ZXJ5IHVuZ3Vlc3NhYmxlXG4gICAqXG4gICAqICBAcGFyYW0gcGFzc3dvcmQgLSBQYXNzd29yZFxuICAgKi9cbiAgc2NvcmUocGFzc3dvcmQpOiBudW1iZXIge1xuICAgIGNvbnN0IHJlc3VsdCA9IHp4Y3ZibihwYXNzd29yZCk7XG4gICAgcmV0dXJuIHJlc3VsdC5zY29yZTtcbiAgfVxuXG4gIC8qKlxuICAgKiB0aGlzIHdpbGwgcmV0dXJuIHRoZSBwYXNzd29yZCBzdHJlbmd0aCBzY29yZSB3aXRoIGZlZWRiYWNrIG1lc3NhZ2VzXG4gICAqIHJldHVybiB0eXBlIHsgc2NvcmU6IG51bWJlcjsgZmVlZGJhY2s6IHsgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdOyB3YXJuaW5nOiBzdHJpbmcgfSB9XG4gICAqXG4gICAqIEBwYXJhbSBwYXNzd29yZCAtIFBhc3N3b3JkXG4gICAqL1xuICBzY29yZVdpdGhGZWVkYmFjayhwYXNzd29yZCk6IHtcbiAgICBzY29yZTogbnVtYmVyO1xuICAgIGZlZWRiYWNrOiB7IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXTsgd2FybmluZzogc3RyaW5nIH07XG4gIH0ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHp4Y3ZibihwYXNzd29yZCk7XG4gICAgcmV0dXJuIHsgc2NvcmU6IHJlc3VsdC5zY29yZSwgZmVlZGJhY2s6IHJlc3VsdC5mZWVkYmFjayB9O1xuICB9XG59XG4iXX0=